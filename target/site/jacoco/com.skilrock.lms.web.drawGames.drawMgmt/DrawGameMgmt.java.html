<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DrawGameMgmt.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">lms</a> &gt; <a href="index.source.html" class="el_package">com.skilrock.lms.web.drawGames.drawMgmt</a> &gt; <span class="el_source">DrawGameMgmt.java</span></div><h1>DrawGameMgmt.java</h1><pre class="source lang-java linenums">package com.skilrock.lms.web.drawGames.drawMgmt;


import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.PrintWriter;
import java.sql.Connection;
import java.sql.Timestamp;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Calendar;
import java.util.Date;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.servlet.ServletContext;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.apache.struts2.ServletActionContext;
import org.apache.struts2.interceptor.ServletRequestAware;
import org.apache.struts2.interceptor.ServletResponseAware;

import com.opensymphony.xwork2.ActionContext;
import com.opensymphony.xwork2.ActionSupport;
import com.skilrock.lms.beans.PromoGameBean;
import com.skilrock.lms.beans.RankWiseWinningReportBean;
import com.skilrock.lms.beans.UserInfoBean;
import com.skilrock.lms.common.CommonValidation;
import com.skilrock.lms.common.Utility;
import com.skilrock.lms.common.db.DBConnect;
import com.skilrock.lms.common.exception.LMSErrors;
import com.skilrock.lms.common.exception.LMSException;
import com.skilrock.lms.common.utility.CommonMethods;
import com.skilrock.lms.common.utility.LMSUtility;
import com.skilrock.lms.coreEngine.drawGames.common.DGErrorMsg;
import com.skilrock.lms.coreEngine.drawGames.drawMgmt.DrawGameMgmtHelper;
import com.skilrock.lms.coreEngine.drawGames.playMgmt.DrawGameRPOSHelper;
import com.skilrock.lms.coreEngine.ola.common.OLAUtility;
import com.skilrock.lms.dge.beans.AnalysisBean;
import com.skilrock.lms.dge.beans.AnalysisReportDrawBean;
import com.skilrock.lms.dge.beans.BlockTicketUserBean;
import com.skilrock.lms.dge.beans.CancelTicketBean;
import com.skilrock.lms.dge.beans.DGConsolidateDrawBean;
import com.skilrock.lms.dge.beans.DGConsolidateGameDataBean;
import com.skilrock.lms.dge.beans.DrawDataBean;
import com.skilrock.lms.dge.beans.DrawScheduleBean;
import com.skilrock.lms.dge.beans.DrawScheduleBeanResult;
import com.skilrock.lms.dge.beans.FortunePurchaseBean;
import com.skilrock.lms.dge.beans.KenoPurchaseBean;
import com.skilrock.lms.dge.beans.LottoPurchaseBean;
import com.skilrock.lms.dge.beans.ManualWinningBean;
import com.skilrock.lms.dge.beans.ResultSubmitBean;
import com.skilrock.lms.dge.beans.SchedulerBean;
import com.skilrock.lms.dge.beans.TicketWiseDataBean;
import com.skilrock.lms.dge.gameconstants.FortuneThreeConstants;
import com.skilrock.lms.dge.gameconstants.FortuneTwoConstants;
import com.skilrock.lms.web.drawGames.common.DrawGameRPOS;
import com.skilrock.lms.web.drawGames.common.Util;
import com.skilrock.lms.web.reportsMgmt.common.ReportUtility;

import net.sf.json.JSONObject;


/**
 * 
 * @author Gaurav Ujjwal
 * 
 *         &lt;pre&gt;
 * Change History
 * Change Date     Changed By     Change Description
 * -----------     ----------     ------------------
 * (e.g.)
 * 01-JAN-2005     ABxxxxxx       CR#zzzzzz: blah blah blah... 
 * 28-MAY-2010     Arun Tanwar    CR#L0375:Implementation of winning numbers for manual entry(freezed draws).
 * 02-MAY-2010     Arun Tanwar    CR#L0375:Implementation of winning numbers for manual entry. Method getManualEntryData added.
 * 03-MAY-2010     Arun Tanwar    CR#L0375:Implementation of entering PMEP for ACTIVE draws. Method getManualDeclareData added.
 * &lt;/pre&gt;
 */
<span class="nc" id="L89">public class DrawGameMgmt extends ActionSupport implements ServletRequestAware,ServletResponseAware {</span>

	/**
	 * 
	 */
	private static final long serialVersionUID = 1L;

	public static void main(String[] args) throws Exception {
		// weeklyReport();
<span class="nc" id="L98">	}</span>

	private String agentOrgName;
	private int agentOrgId;
	private String cancelMoneyStatus;
	private int cardType[];
	private String changeType;
	private String draw_day;
	private String[] draw_freeze_time;
	private String[] draw_time;
	private int drawId;
	private int[] drawIds;
	private ArrayList&lt;DrawScheduleBeanResult&gt; drawScheduleBeanResultList;
	private String drawType[];
	private String end_Date;
	private FortunePurchaseBean fortuneBean;
	private int freezeTime;
	private String fromDate;
	private String fromHour;
	private String fromMin;
	private String fromSec;
	private String gameName;
	private String date;
	private String drawIdString;
	private String action;
	private String gameNo;
	private String gameType;
	private String invoker;
	private KenoPurchaseBean kenoPurchaseBean;
<span class="nc" id="L127">	Log logger = LogFactory.getLog(DrawGameMgmt.class);</span>
	private LottoPurchaseBean lottoPurchaseBean;
	private String message;
	String performStatus[];
	private int postponeTime;
	private String[] retName;
	private int retId;
	private int retOrgId;
	private int transNo;
	private String[] reasons ;
	private String reason;
	
	private String archDate;
	private String depDate;
	private  int gameId ;
	private Map&lt;Integer,List&lt;PromoGameBean&gt;&gt; promoGameBeanMap;
	private int promoGameId;
	private int  saleGameId;
	private int promoTicekts;
	private HttpServletResponse response;
	private List&lt;AnalysisReportDrawBean&gt; analist;
	private List&lt;BlockTicketUserBean&gt; blockTicketUserBeanList;
	private HashMap&lt;Integer, String&gt; drawGameInfo;
	private String valueToSend;
	
	private String stateCode;
	private String CityCode;
	private Map&lt;String, String&gt; stateMap;
	private String priv;
<span class="nc" id="L156">	private Map&lt;Integer,RankWiseWinningReportBean&gt; rankWinningData= null;</span>
	
	@Override
	public void setServletResponse(HttpServletResponse response) {
<span class="nc" id="L160">		this.response = response;</span>
<span class="nc" id="L161">	}</span>

	public HttpServletResponse getResponse() {
<span class="nc" id="L164">		return response;</span>
	}
	
	public Map&lt;String, String&gt; getStateMap() {
<span class="nc" id="L168">		return stateMap;</span>
	}

	public void setStateMap(Map&lt;String, String&gt; stateMap) {
<span class="nc" id="L172">		this.stateMap = stateMap;</span>
<span class="nc" id="L173">	}</span>

	public String getStateCode() {
<span class="nc" id="L176">		return stateCode;</span>
	}

	public void setStateCode(String stateCode) {
<span class="nc" id="L180">		this.stateCode = stateCode;</span>
<span class="nc" id="L181">	}</span>

	public String getCityCode() {
<span class="nc" id="L184">		return CityCode;</span>
	}

	public void setCityCode(String cityCode) {
<span class="nc" id="L188">		CityCode = cityCode;</span>
<span class="nc" id="L189">	}</span>

	public String getDepDate() {
<span class="nc" id="L192">		return depDate;</span>
	}

	public void setDepDate(String depDate) {
<span class="nc" id="L196">		this.depDate = depDate;</span>
<span class="nc" id="L197">	}</span>

	public String getArchDate() {
<span class="nc" id="L200">		return archDate;</span>
	}

	public void setArchDate(String archDate) {
<span class="nc" id="L204">		this.archDate = archDate;</span>
<span class="nc" id="L205">	}</span>

	public int getRetId() {
<span class="nc" id="L208">		return retId;</span>
	}

	public void setRetId(int retId) {
<span class="nc" id="L212">		this.retId = retId;</span>
<span class="nc" id="L213">	}</span>

	public int getTransNo() {
<span class="nc" id="L216">		return transNo;</span>
	}

	public void setTransNo(int transNo) {
<span class="nc" id="L220">		this.transNo = transNo;</span>
<span class="nc" id="L221">	}</span>

	public String getPriv() {
<span class="nc" id="L224">		return priv;</span>
	}

	public void setPriv(String priv) {
<span class="nc" id="L228">		this.priv = priv;</span>
<span class="nc" id="L229">	}</span>

	private String retOrgName;
	private String search_type;
	private HttpServletRequest servletRequest;
	private HttpServletResponse servletResponse;
	private String start_date;
	private String sale_date;
	private String status;
	private String subHold;
	private String ticketNo;
	private String ticketNum;
	private String[] ticketNumArr;
	private String toDate;
	private String toHour;
	private String toMin;
	private String toSec;
	private String type;
	private String dateOfDraw;
	private String[] ticketStatusArr;

	private int user1;
	private int user2;
	
	private String winNumber;
	private String macNumber;

	private Integer winNumbers[];
	private Integer macNumbers[];

	private int winNumSize;

	private int msgId;
	private String drawName;
		
	private int[] user;
	private String userStr;
	
	private ArrayList&lt;DGConsolidateDrawBean&gt; drawDataBeanList;
	private HashMap&lt;Integer, String&gt; commSerList;
	private HashMap&lt;Integer, String&gt; drawSerList;
	private Map&lt;Integer, String&gt; olaSerList;

	public String actionData() {
<span class="nc" id="L273">		HttpSession session = servletRequest.getSession();</span>
<span class="nc bnc" id="L274" title="All 2 branches missed.">		for (int s : drawIds) {</span>
<span class="nc" id="L275">			logger.debug(&quot;--------&quot; + s);</span>
		}

<span class="nc" id="L278">		logger.debug(&quot;changeType: &quot; + changeType);</span>
<span class="nc" id="L279">		DrawScheduleBean drawScheduleBean = (DrawScheduleBean) session</span>
				.getAttribute(&quot;DRAW_SCH_LIST&quot;);

<span class="nc" id="L282">		return SUCCESS;</span>
	}

	public String actionOnHold() throws Exception {
<span class="nc" id="L286">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L287">		List&lt;Integer&gt; drawIdList = new ArrayList&lt;Integer&gt;();</span>
<span class="nc bnc" id="L288" title="All 2 branches missed.">		for (int element : drawIds) {</span>
<span class="nc" id="L289">			drawIdList.add(element);</span>
		}
<span class="nc" id="L291">		logger.debug(drawIdList + &quot;--Before Action On HOld--&quot; + subHold);</span>

	//	gameNo = gameNo.substring(0, gameNo.lastIndexOf(&quot;-&quot;));
<span class="nc" id="L294">		DrawScheduleBean drawScheduleBean = new DrawScheduleBean();</span>
<span class="nc" id="L295">		drawScheduleBean.setDrawIdList(drawIdList);</span>
<span class="nc" id="L296">		drawScheduleBean.setGameNo(Integer.parseInt(gameNo));</span>
<span class="nc" id="L297">		drawScheduleBean.setStatus(subHold);</span>
<span class="nc" id="L298">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L299">		SchedulerBean schedulerBean = (SchedulerBean) helper</span>
				.actionOnHold(drawScheduleBean);
<span class="nc" id="L301">		logger.debug(&quot;SchedulelIst Size: &quot;</span>
				+ schedulerBean.getDrawScheduleList().size());

		// schedulerBean.setActionType(&quot;CANCELLED&quot;);
<span class="nc" id="L305">		session.setAttribute(&quot;RESULT_LIST&quot;, schedulerBean);</span>
<span class="nc" id="L306">		logger.debug(&quot;msg--&quot; + schedulerBean.getResponseMessage());</span>
<span class="nc" id="L307">		logger.debug(&quot;msg--&quot; + schedulerBean.getGameNo());</span>
<span class="nc" id="L308">		logger.debug(&quot;After--&quot; + new Date());</span>

<span class="nc" id="L310">		return SUCCESS;</span>
	}

	@SuppressWarnings(&quot;unchecked&quot;)
	public String cancelBlkTicketAtBO() throws Exception {
<span class="nc" id="L315">		logger.debug(&quot;Inside cancelBlkTicketAtBO&quot;);</span>
		
<span class="nc" id="L317">		ServletContext sc = null;</span>
<span class="nc" id="L318">		HttpSession session = null;</span>
<span class="nc" id="L319">		String refMerchantId = null;</span>
<span class="nc" id="L320">		UserInfoBean userInfoBean = null;</span>
<span class="nc" id="L321">		DrawGameMgmtHelper helper = null;</span>
<span class="nc" id="L322">		ArrayList&lt;CancelTicketBean&gt; canTktList = null;</span>
<span class="nc" id="L323">		Map&lt;Integer, Map&lt;Integer, String&gt;&gt; drawIdTableMap = null;</span>
		
		try{
<span class="nc" id="L326">		validateInputForCancel(null, null,ticketNumArr,servletRequest,true);</span>
<span class="nc" id="L327">		sc = ServletActionContext.getServletContext();</span>
<span class="nc" id="L328">		session = servletRequest.getSession();</span>
<span class="nc" id="L329">		userInfoBean = (UserInfoBean) session.getAttribute(&quot;USER_INFO&quot;);</span>
<span class="nc" id="L330">		refMerchantId = (String) sc.getAttribute(&quot;REF_MERCHANT_ID&quot;);</span>
<span class="nc" id="L331">		drawIdTableMap = (Map&lt;Integer, Map&lt;Integer, String&gt;&gt;) sc.getAttribute(&quot;drawIdTableMap&quot;);</span>
<span class="nc" id="L332">		logger.debug(&quot; drawIdTableMap in cancel ticket &quot; + drawIdTableMap);</span>
<span class="nc" id="L333">		helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L334">		canTktList = helper.cancelBlkTicketAtBO(Integer.parseInt((String)sc.getAttribute(&quot;CANCEL_DURATION&quot;)),&quot;true&quot;.equalsIgnoreCase((String)sc.getAttribute(&quot;IS_CANCEL_DURATION&quot;)),ticketNumArr, getReasons(), userInfoBean,search_type, gameNo, refMerchantId,</span>
						drawIdTableMap,(String)sc.getAttribute(&quot;DRAW_GAME_CANCELLATION_CHARGES&quot;));
<span class="nc" id="L336">		}catch (LMSException e) {</span>
<span class="nc" id="L337">			return ERROR;</span>
<span class="nc" id="L338">		}catch (Exception e) {</span>
<span class="nc" id="L339">			return ERROR;</span>
<span class="nc" id="L340">		}</span>
<span class="nc" id="L341">		servletRequest.setAttribute(&quot;canTktList&quot;, canTktList);</span>
<span class="nc" id="L342">		return SUCCESS;</span>

	}

	public String cancelDraw() throws Exception {
<span class="nc" id="L347">		logger.debug(&quot;-----IN CANCEL DRAW-----&quot;);</span>

<span class="nc" id="L349">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L350">		UserInfoBean userInfoBean = (UserInfoBean) session</span>
		.getAttribute(&quot;USER_INFO&quot;);
<span class="nc" id="L352">		List&lt;Integer&gt; drawIdList = new ArrayList&lt;Integer&gt;();</span>
<span class="nc bnc" id="L353" title="All 2 branches missed.">		for (int element : drawIds) {</span>
<span class="nc" id="L354">			drawIdList.add(element);</span>
		}
	//	gameNo = gameNo.substring(0, gameNo.lastIndexOf(&quot;-&quot;));
<span class="nc" id="L357">		DrawScheduleBean drawScheduleBean = new DrawScheduleBean();</span>
<span class="nc" id="L358">		drawScheduleBean.setDrawIdList(drawIdList);</span>
<span class="nc" id="L359">		drawScheduleBean.setGameNo(Integer.parseInt(gameNo));</span>
<span class="nc" id="L360">		drawScheduleBean.setAction(action);</span>
<span class="nc" id="L361">		logger.debug(&quot;selected status in cancel action ::&quot; + status);</span>

<span class="nc" id="L363">		drawScheduleBean.setStatus(status);</span>
<span class="nc" id="L364">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L365">		SchedulerBean schedulerBean = (SchedulerBean) helper</span>
				.cancelDraw(drawScheduleBean, userInfoBean);
<span class="nc" id="L367">		logger.debug(schedulerBean.getDrawScheduleList().size());</span>

		// schedulerBean.setActionType(&quot;CANCELLED&quot;);
<span class="nc" id="L370">		session.setAttribute(&quot;RESULT_LIST&quot;, schedulerBean);</span>
<span class="nc" id="L371">		logger.debug(&quot;msg--&quot; + schedulerBean.getResponseMessage());</span>
<span class="nc" id="L372">		logger.debug(&quot;msg--&quot; + schedulerBean.getGameNo());</span>
<span class="nc" id="L373">		logger.debug(&quot;msg--&quot; + schedulerBean.getFreezeOrPerform().toString());</span>
<span class="nc" id="L374">		logger.debug(&quot;After--&quot; + new Date());</span>

<span class="nc" id="L376">		return SUCCESS;</span>
	}

	public String freezeDraw() throws Exception {
<span class="nc" id="L380">		logger.debug(&quot;-----IN FREEZE DRAW-----&quot;);</span>
		// logger.debug(&quot;LOGGED_IN_USERS map is: &quot; + currentUserSessionMap);
		// logger.debug(&quot;user name is: &quot; + userName);

<span class="nc" id="L384">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L385">		UserInfoBean userInfoBean = (UserInfoBean) session</span>
				.getAttribute(&quot;USER_INFO&quot;);
<span class="nc" id="L387">		List&lt;Integer&gt; drawIdList = new ArrayList&lt;Integer&gt;();</span>
<span class="nc bnc" id="L388" title="All 2 branches missed.">		for (int element : drawIds) {</span>
<span class="nc" id="L389">			drawIdList.add(element);</span>
		}
	//	gameNo = gameNo.substring(0, gameNo.lastIndexOf(&quot;-&quot;));
<span class="nc" id="L392">		DrawScheduleBean drawScheduleBean = new DrawScheduleBean();</span>
<span class="nc" id="L393">		drawScheduleBean.setDrawIdList(drawIdList);</span>
<span class="nc" id="L394">		drawScheduleBean.setGameNo(Integer.parseInt(gameNo));</span>
<span class="nc" id="L395">		logger.debug(&quot;selected status in freeze action ::&quot; + status);</span>

<span class="nc" id="L397">		drawScheduleBean.setStatus(status);</span>
<span class="nc" id="L398">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L399">		SchedulerBean schedulerBean = (SchedulerBean) helper</span>
				.freezeDraw(drawScheduleBean, userInfoBean);
<span class="nc" id="L401">		logger.debug(schedulerBean.getDrawScheduleList().size());</span>

		// schedulerBean.setActionType(&quot;CANCELLED&quot;);
<span class="nc" id="L404">		ServletContext sc = LMSUtility.sc;</span>
<span class="nc" id="L405">		Map&lt;String, HttpSession&gt; currentUserSessionMap = (Map&lt;String, HttpSession&gt;) sc</span>
				.getAttribute(&quot;LOGGED_IN_USERS&quot;);
<span class="nc" id="L407">		session =currentUserSessionMap.get(userInfoBean.getUserName().toLowerCase());</span>
<span class="nc" id="L408">		session.setAttribute(&quot;RESULT_LIST&quot;, schedulerBean);</span>
<span class="nc" id="L409">		logger.debug(&quot;msg--&quot; + schedulerBean.getResponseMessage());</span>
<span class="nc" id="L410">		logger.debug(&quot;msg--&quot; + schedulerBean.getGameNo());</span>
<span class="nc" id="L411">		logger.debug(&quot;msg--&quot; + schedulerBean.getFreezeOrPerform().toString());</span>
<span class="nc" id="L412">		logger.debug(&quot;After--&quot; + new Date());</span>

<span class="nc" id="L414">		return SUCCESS;</span>
	}
	
	@SuppressWarnings(&quot;unchecked&quot;)
	public String cancelTicketAtBO() throws Exception {
<span class="nc" id="L419">		logger.debug(&quot;Inside cancelTicketAtBO&quot;);</span>
<span class="nc" id="L420">		CancelTicketBean cancelTicketBean =null;</span>
<span class="nc" id="L421">		ServletContext sc = null;</span>
<span class="nc" id="L422">		HttpSession session =null;</span>
<span class="nc" id="L423">		UserInfoBean userInfoBean = null;</span>
<span class="nc" id="L424">		String refMerchantId = null;</span>
<span class="nc" id="L425">		String cancelChannel = null;</span>
<span class="nc" id="L426">		String reason = null;</span>
<span class="nc" id="L427">		String cancellationCharges =null;</span>
<span class="nc" id="L428">		DrawGameMgmtHelper helper = null;</span>
<span class="nc" id="L429">		Map&lt;Integer, Map&lt;Integer, String&gt;&gt; drawIdTableMap =null;</span>

		try{
<span class="nc" id="L432">		cancelTicketBean = new CancelTicketBean();</span>
<span class="nc" id="L433">		reason = servletRequest.getParameter(&quot;reason&quot;);</span>
<span class="nc" id="L434">		validateInputForCancel(ticketNo, reason,null,null,false);</span>
		
<span class="nc" id="L436">		sc = ServletActionContext.getServletContext();</span>
<span class="nc" id="L437">		session = servletRequest.getSession();</span>
<span class="nc" id="L438">		userInfoBean = (UserInfoBean) session.getAttribute(&quot;USER_INFO&quot;);</span>

<span class="nc" id="L440">		cancelChannel = &quot;LMS_Web&quot;;</span>
<span class="nc" id="L441">		refMerchantId = (String) sc.getAttribute(&quot;REF_MERCHANT_ID&quot;);</span>
<span class="nc" id="L442">		cancellationCharges = (String)sc.getAttribute(&quot;DRAW_GAME_CANCELLATION_CHARGES&quot;);</span>
<span class="nc" id="L443">		drawIdTableMap = (Map&lt;Integer, Map&lt;Integer, String&gt;&gt;) sc.getAttribute(&quot;drawIdTableMap&quot;);</span>

<span class="nc" id="L445">		logger.debug(&quot; drawIdTableMap in cancel ticket &quot; + drawIdTableMap);</span>
<span class="nc" id="L446">		cancelTicketBean = new CancelTicketBean();</span>
<span class="nc" id="L447">		cancelTicketBean.setReason(reason);</span>
<span class="nc" id="L448">		cancelTicketBean.setTicketNo(ticketNo);</span>
<span class="nc" id="L449">		cancelTicketBean.setCancelChannel(cancelChannel);</span>
<span class="nc" id="L450">		cancelTicketBean.setRefMerchantId(refMerchantId);</span>
<span class="nc" id="L451">		cancelTicketBean.setDrawIdTableMap(drawIdTableMap);</span>
<span class="nc" id="L452">		cancelTicketBean.setCancelDuration(Integer.parseInt((String)sc.getAttribute(&quot;CANCEL_DURATION&quot;)));</span>
<span class="nc" id="L453">		cancelTicketBean.setCancelDuaraion(&quot;true&quot;.equalsIgnoreCase((String)sc.getAttribute(&quot;IS_CANCEL_DURATION&quot;)));</span>
		
<span class="nc" id="L455">		helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L456">		cancelTicketBean = helper.cancelTicketAtBO(cancelTicketBean, userInfoBean,search_type, gameNo,cancellationCharges);</span>
<span class="nc" id="L457">		servletRequest.setAttribute(&quot;CANCEL_BEAN&quot;, cancelTicketBean);</span>
		
<span class="nc" id="L459">		}catch (LMSException e) {</span>
<span class="nc" id="L460">			cancelTicketBean.setErrMsg(e.getErrorMessage());</span>
<span class="nc" id="L461">			return ERROR;</span>
<span class="nc" id="L462">		}catch (Exception e) {</span>
<span class="nc" id="L463">			cancelTicketBean.setErrMsg(LMSErrors.GENERAL_EXCEPTION_ERROR_MESSAGE);</span>
<span class="nc" id="L464">			return ERROR;</span>
<span class="nc" id="L465">		}</span>
<span class="nc" id="L466">		return SUCCESS;</span>
	}

	
	private void validateInputForCancel(String ticketNumber,String reason,String[] ticketNumArr,HttpServletRequest servletRequest,boolean isBulkCancel) throws LMSException{
<span class="nc bnc" id="L471" title="All 2 branches missed.">		if(!isBulkCancel){</span>
<span class="nc bnc" id="L472" title="All 4 branches missed.">		if (ticketNo == null || !CommonValidation.isNumericWithoutDot(ticketNo,false)) </span>
<span class="nc" id="L473">		throw new LMSException(LMSErrors.INVALID_TICKET_ERROR_CODE,LMSErrors.INVALID_TICKET_ERROR_MESSAGE);</span>
		
<span class="nc bnc" id="L475" title="All 4 branches missed.">		if(&quot;-1&quot;.equals(reason) || &quot;&quot;.equals(reason))</span>
<span class="nc" id="L476">			throw new LMSException(LMSErrors.INVALID_REASON_FOR_CANCEL_TICKET_DATA_ERROR_CODE,LMSErrors.INVALID_REASON_FOR_CANCEL_TICKET_DATA_ERROR_MESSAGE);</span>
		}
		else{
<span class="nc bnc" id="L479" title="All 2 branches missed.">			if (ticketNumArr.length &gt; 0) {</span>
<span class="nc" id="L480">				this.reasons = new String[ticketNumArr.length];</span>
<span class="nc bnc" id="L481" title="All 2 branches missed.">				for(int i=0; i&lt;ticketNumArr.length; i++)</span>
				{
<span class="nc" id="L483">					this.reasons[i] = servletRequest.getParameter(&quot;reason_&quot;+ticketNumArr[i]);</span>
<span class="nc bnc" id="L484" title="All 6 branches missed.">					if(this.reasons[i]==null || this.reasons[i].equals(&quot;-1&quot;) || !CommonValidation.isNumericWithoutDot(ticketNumArr[i],false))</span>
<span class="nc" id="L485">						throw new LMSException(LMSErrors.INVALID_REASON_FOR_CANCEL_TICKET_DATA_ERROR_CODE,LMSErrors.INVALID_REASON_FOR_CANCEL_TICKET_DATA_ERROR_MESSAGE);</span>
				}
			}else{
				
			}
		}
		
<span class="nc" id="L492">	}</span>
	
	public String changeFreezeTime() throws Exception {
<span class="nc" id="L495">		logger.debug(&quot;Inside changeFreezeTime&quot;);</span>
<span class="nc" id="L496">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L497">		UserInfoBean userInfoBean = (UserInfoBean) session</span>
		.getAttribute(&quot;USER_INFO&quot;);
<span class="nc" id="L499">		List&lt;Integer&gt; drawIdList = new ArrayList&lt;Integer&gt;();</span>
<span class="nc bnc" id="L500" title="All 2 branches missed.">		for (int element : drawIds) {</span>
<span class="nc" id="L501">			drawIdList.add(element);</span>
		}
	//	gameNo = gameNo.substring(0, gameNo.lastIndexOf(&quot;-&quot;));
<span class="nc" id="L504">		logger.debug(&quot;draw ids----&quot; + drawIdList);</span>

<span class="nc" id="L506">		DrawScheduleBean drawScheduleBean = new DrawScheduleBean();</span>
<span class="nc" id="L507">		drawScheduleBean.setDrawIdList(drawIdList);</span>
<span class="nc" id="L508">		drawScheduleBean.setStatus(status);</span>
<span class="nc" id="L509">		drawScheduleBean.setGameNo(Integer.parseInt(gameNo));</span>
<span class="nc" id="L510">		drawScheduleBean.setFreezeTime(freezeTime);</span>
<span class="nc" id="L511">		logger.debug(&quot;Before--&quot; + new Date());</span>

<span class="nc" id="L513">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L514">		SchedulerBean schedulerBean = (SchedulerBean) helper</span>
				.changeFreezeTime(drawScheduleBean, userInfoBean);
<span class="nc" id="L516">		session.setAttribute(&quot;RESULT_LIST&quot;, schedulerBean);</span>

<span class="nc bnc" id="L518" title="All 2 branches missed.">		for (int i = 0; i &lt; schedulerBean.getDrawScheduleList().size(); i++) {</span>
<span class="nc" id="L519">			drawScheduleBean = schedulerBean.getDrawScheduleList().get(i);</span>
<span class="nc" id="L520">			logger.debug(&quot;---------result--&quot;</span>
					+ drawScheduleBean.getUpdatedFreezeTime());

		}
<span class="nc" id="L524">		return SUCCESS;</span>
	}

	public String checkNextDraw() throws Exception {
<span class="nc" id="L528">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L529">		logger.debug(&quot;Iside checkNestDraw&quot;);</span>
<span class="nc" id="L530">		logger.debug(&quot;Before--&quot; + new Date());</span>

<span class="nc" id="L532">		DrawScheduleBean drawScheduleBean = new DrawScheduleBean();</span>
		// drawScheduleBean.setDrawId(7);
<span class="nc" id="L534">		drawScheduleBean.setGameNo(102);</span>
<span class="nc" id="L535">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L536">		Object message = helper.checkNextDraw(drawScheduleBean);</span>
<span class="nc" id="L537">		logger.debug(&quot;msg---------&quot; + message);</span>
<span class="nc" id="L538">		logger.debug(&quot;After--&quot; + new Date());</span>

<span class="nc" id="L540">		return SUCCESS;</span>
	}

	public String fetchAdvMsgData() throws Exception {
<span class="nc" id="L544">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L545">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L546">		session</span>
				.setAttribute(&quot;RET_MAP&quot;, helper
						.fetchAdvMessageData(search_type));
<span class="nc" id="L549">		logger.debug(&quot;----selection Map--&quot; + session.getAttribute(&quot;RET_MAP&quot;));</span>

<span class="nc" id="L551">		return SUCCESS;</span>

	}

	/*public String getAdvMsgDataForEdit() throws Exception {
		HttpSession session = servletRequest.getSession();
		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();
		session.setAttribute(&quot;ADV_MSG_MAP&quot;, helper.getAdvMsgForEdit());
		logger.debug(&quot;----Adv Msg Map--&quot; + session.getAttribute(&quot;ADV_MSG_MAP&quot;));
		return SUCCESS;
	}*/

	/*public String editAdvMsgData() throws Exception {
		HttpSession session = servletRequest.getSession();
		UserInfoBean userBean = (UserInfoBean) session.getAttribute(&quot;USER_INFO&quot;);
		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();
		boolean status = helper.editAdvMsgStatus(msgId, userBean.getUserId(),userBean.getUserOrgId());
		if (!status) {
			return &quot;applicationError&quot;;
		}
		Util.advMsgDataMap = new DrawGameRPOSHelper().getAdvMsgDataMap();
		return SUCCESS;
	}*/

	public String fetchDrawData() throws Exception {
<span class="nc" id="L576">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L577">		logger.debug(gameNo + &quot;Before--&quot; + new Date());</span>
<span class="nc" id="L578">		DrawDataBean drawDataBean = new DrawDataBean();</span>
<span class="nc" id="L579">		drawDataBean.setGameNo(Integer.parseInt(gameNo));</span>
<span class="nc" id="L580">		drawDataBean.setAgentOrgId(agentOrgId);</span>
<span class="nc" id="L581">		System.out.println(agentOrgId);</span>
<span class="nc" id="L582">		drawDataBean.setFromDate(start_date + &quot; 00:00:00&quot;);</span>
		// The to date has been Hard Code to Avoid Use of calendar and appended
		// with 23:59:59 to achieve the data
		// corresponding to the midnight of given date
<span class="nc" id="L586">		drawDataBean.setToDate(end_Date + &quot; 23:59:59&quot;);</span>
<span class="nc" id="L587">		drawDataBean.setDrawName(drawName);</span>
<span class="nc" id="L588">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
		// helper.fetchDrawData(drawDataBean);
<span class="nc" id="L590">		logger.debug(&quot;startDate is&quot; + start_date);</span>
<span class="nc" id="L591">		logger.debug(&quot;endDate is&quot; + end_Date);</span>
<span class="nc" id="L592">		ServletContext sc = ServletActionContext.getServletContext();</span>
<span class="nc" id="L593">		String raffleTktType = (String) sc.getAttribute(&quot;raffle_ticket_type&quot;);</span>
<span class="nc" id="L594">		session.setAttribute(&quot;DRAW_DATA_LIST&quot;, helper.fetchDrawData(</span>
				drawDataBean, raffleTktType));
<span class="nc" id="L596">		return SUCCESS;</span>
	}
	// start 
	public String fetch15minDrawData() throws Exception {
<span class="nc" id="L600">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L601">		logger.debug(gameNo + &quot;Before--&quot; + new Date());</span>
<span class="nc" id="L602">		DrawDataBean drawDataBean = new DrawDataBean();</span>
<span class="nc" id="L603">		drawDataBean.setGameNo(Integer.parseInt(gameNo));</span>
<span class="nc bnc" id="L604" title="All 2 branches missed.">		if (dateOfDraw != null) {</span>
<span class="nc" id="L605">			String lastDate = CommonMethods.getLastArchDate();</span>
<span class="nc" id="L606">			System.out.println(&quot;last archieve date&quot;+lastDate);</span>
<span class="nc bnc" id="L607" title="All 2 branches missed.">			if(dateOfDraw.compareTo(lastDate)&lt;=0){</span>
<span class="nc" id="L608">				message=&quot;For Details Please Choose start date after &quot;+lastDate;</span>
<span class="nc" id="L609">				return SUCCESS;</span>
			}
		}
<span class="nc" id="L612">		drawDataBean.setFromDate(dateOfDraw + &quot; 00:00:00&quot;);</span>
		
<span class="nc" id="L614">		drawDataBean.setToDate(dateOfDraw + &quot; 23:59:59&quot;);</span>
<span class="nc" id="L615">		drawDataBean.setDrawName(drawName);</span>

<span class="nc" id="L617">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L618">		logger.debug(&quot;startDate is&quot; + dateOfDraw);</span>
	 //	logger.debug(&quot;endDate is&quot; + end_Date);
<span class="nc" id="L620">		ServletContext sc = ServletActionContext.getServletContext();</span>
<span class="nc" id="L621">		String raffleTktType = (String) sc.getAttribute(&quot;raffle_ticket_type&quot;);</span>
		//commented to display all merchant data 31DEC2013
		//String refMerchantId = (String) sc.getAttribute(&quot;REF_MERCHANT_ID&quot;);
<span class="nc" id="L624">		String refMerchantId = &quot;ALL&quot;;</span>
		
<span class="nc" id="L626">		drawDataBean.setMerchantId(refMerchantId);</span>
<span class="nc" id="L627">		session.setAttribute(&quot;DRAW_DATA_LIST&quot;, helper.fetch15minDrawData(</span>
				drawDataBean, raffleTktType));
<span class="nc" id="L629">		return SUCCESS;</span>
	}
	
	// end added by neeraj jain
	
	public String fetchDrawDataMenu() throws Exception {
<span class="nc" id="L635">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L636">		ServletContext sc = session.getServletContext();</span>
		
<span class="nc" id="L638">		session.setAttribute(&quot;presentDate&quot;, new java.sql.Date(new Date()</span>
				.getTime()).toString());
<span class="nc" id="L640">		session.setAttribute(&quot;DRAWGAME_LIST&quot;, ReportUtility.fetchDrawDataMenu());</span>
<span class="nc" id="L641">		session.setAttribute(&quot;OLA_DATA_LIST&quot;, OLAUtility.getOlaWalletDataMap());</span>
		//SimpleDateFormat formatOld = new SimpleDateFormat(&quot;dd-MM-yyyy&quot;);
<span class="nc" id="L643">		SimpleDateFormat format = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span>
<span class="nc" id="L644">		Date strtDate = format.parse(CommonMethods.getLastArchDate());</span>
<span class="nc" id="L645">		Calendar cal1 = Calendar.getInstance();</span>
<span class="nc" id="L646">		cal1.setTime(strtDate);</span>
<span class="nc" id="L647">		cal1.add(Calendar.DATE, 1); </span>
<span class="nc" id="L648">		setArchDate(format.format(cal1.getTime()));</span>
<span class="nc" id="L649">		setDepDate(CommonMethods.convertDateInGlobalFormat((String)sc.getAttribute(&quot;DEPLOYMENT_DATE&quot;), &quot;yyyy-mm-dd&quot;, (String)sc.getAttribute(&quot;date_format&quot;)));</span>
<span class="nc" id="L650">		stateMap = CommonMethods.fetchStateList();</span>
<span class="nc" id="L651">		return SUCCESS;</span>
	}
	
	public String rankWiseReportDrawMenu() throws Exception {
<span class="nc" id="L655">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L656">		ServletContext sc = session.getServletContext();</span>
<span class="nc" id="L657">		session.setAttribute(&quot;presentDate&quot;, new java.sql.Date(new Date().getTime()).toString());</span>
<span class="nc" id="L658">		Map&lt;Integer, String&gt; gameMap = new HashMap&lt;Integer,String&gt;();</span>
<span class="nc" id="L659">		gameMap.put(Util.getGameId(&quot;TwelveByTwentyFour&quot;), ReportUtility.fetchDrawDataMenu().get(Util.getGameId(&quot;TwelveByTwentyFour&quot;)));</span>
<span class="nc" id="L660">		session.setAttribute(&quot;DRAWGAME_LIST&quot;, gameMap);</span>
<span class="nc" id="L661">		SimpleDateFormat format = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span>
<span class="nc" id="L662">		Date strtDate = format.parse(CommonMethods.getLastArchDate());</span>
<span class="nc" id="L663">		Calendar cal1 = Calendar.getInstance();</span>
<span class="nc" id="L664">		cal1.setTime(strtDate);</span>
<span class="nc" id="L665">		cal1.add(Calendar.DATE, 1); </span>
<span class="nc" id="L666">		setArchDate(format.format(cal1.getTime()));</span>
<span class="nc" id="L667">		setDepDate(CommonMethods.convertDateInGlobalFormat((String)sc.getAttribute(&quot;DEPLOYMENT_DATE&quot;), &quot;yyyy-mm-dd&quot;, (String)sc.getAttribute(&quot;date_format&quot;)));</span>
<span class="nc" id="L668">		stateMap = CommonMethods.fetchStateList();</span>
<span class="nc" id="L669">		return SUCCESS;</span>
	}

	public String fetchActiveDrawDataMenu() throws Exception {
<span class="nc" id="L673">		commSerList=null;</span>
<span class="nc" id="L674">		drawSerList=null;</span>
<span class="nc" id="L675">		olaSerList=null;</span>
		try {
<span class="nc" id="L677">			setCommSerList(ReportUtility.fetchActiveCategoriesCommSerData());</span>
<span class="nc" id="L678">			setDrawSerList(ReportUtility.fetchActiveGameDrawDataMenu());</span>
<span class="nc" id="L679">			setOlaSerList(OLAUtility.getOlaWalletDataMap());</span>
<span class="nc" id="L680">		} catch (Exception e) {</span>
<span class="nc" id="L681">			logger.error(&quot; EXCEPTION : &quot; +e );</span>
<span class="nc" id="L682">		}</span>
<span class="nc" id="L683">		return SUCCESS;</span>
	}
	
	/*public String fetchActiveDrawDataMenu() throws Exception {
		HttpSession session = servletRequest.getSession();
		
		session.setAttribute(&quot;presentDate&quot;, new java.sql.Date(new Date()
				.getTime()).toString());
		session.setAttribute(&quot;DRAWGAME_LIST&quot;, ReportUtility.fetchActiveGameDrawDataMenu());
		session.setAttribute(&quot;OLA_DATA_LIST&quot;, OLAUtility.getOlaWalletDataMap());
		return SUCCESS;
	}*/
	
	public String fetchSubDrawResult() throws Exception {
		
<span class="nc" id="L698">		StringBuilder sd=null;</span>
<span class="nc" id="L699">		HttpSession session = null;</span>
<span class="nc" id="L700">		UserInfoBean userBean = null;</span>
<span class="nc" id="L701">		Timestamp toTimeStamp = null;</span>
<span class="nc" id="L702">		Timestamp fromTimeStamp = null;</span>
<span class="nc" id="L703">		DrawGameMgmtHelper helper =  null;</span>
<span class="nc" id="L704">		SimpleDateFormat dateFormat = null;</span>
<span class="nc" id="L705">		DrawScheduleBean drawScheduleBean =null;</span>
		try {
<span class="nc" id="L707">			session = servletRequest.getSession();</span>
<span class="nc" id="L708">			userBean = (UserInfoBean) session.getAttribute(&quot;USER_INFO&quot;);</span>
<span class="nc" id="L709">			dateFormat = new SimpleDateFormat(&quot;dd/MM/yyyy HH:mm:ss&quot;);</span>
			
<span class="nc bnc" id="L711" title="All 4 branches missed.">		if (fromDate != null &amp;&amp; fromDate.length() == 0) </span>
<span class="nc" id="L712">				fromDate = null;</span>
<span class="nc bnc" id="L713" title="All 4 branches missed.">		if (toDate != null &amp;&amp; toDate.length() == 0) </span>
<span class="nc" id="L714">				toDate = null;</span>

<span class="nc" id="L716">		setGameName(Util.getGameName(Integer.parseInt(gameNo)));</span>
<span class="nc bnc" id="L717" title="All 2 branches missed.">		if (fromDate != null) {</span>
<span class="nc" id="L718">				sd =new StringBuilder(fromDate).append(&quot; &quot;).append(fromHour).append(&quot;:&quot;).append(fromMin).append(&quot;:&quot;).append(fromSec);</span>
<span class="nc" id="L719">				fromTimeStamp=new Timestamp(dateFormat.parse(sd.toString()).getTime());</span>
			}
<span class="nc bnc" id="L721" title="All 2 branches missed.">			if (toDate != null) {</span>
<span class="nc" id="L722">				sd=new StringBuilder(toDate).append(&quot; &quot;).append(toHour).append(&quot;:&quot;).append(toMin).append(&quot;:&quot;).append(toSec);</span>
<span class="nc" id="L723">				toTimeStamp=new Timestamp(dateFormat.parse(sd.toString()).getTime());</span>
			}
<span class="nc" id="L725">		}catch (ParseException e) {</span>
<span class="nc" id="L726">			logger.error(&quot;Parsing Exception : &quot; + e);</span>
		}
<span class="nc" id="L728">		catch (Exception e) {</span>
<span class="nc" id="L729">			logger.error(&quot;General Exception : &quot; + e);</span>
<span class="nc" id="L730">		}</span>
<span class="nc" id="L731">		drawScheduleBean = new DrawScheduleBean();</span>
<span class="nc" id="L732">		drawScheduleBean.setDraw_id(drawId);</span>
<span class="nc" id="L733">		drawScheduleBean.setEndDate(toTimeStamp);</span>
<span class="nc" id="L734">		drawScheduleBean.setStartDate(fromTimeStamp);</span>
<span class="nc" id="L735">		drawScheduleBean.setGameNo(Integer.parseInt(gameNo));</span>
<span class="nc" id="L736">		drawScheduleBean.setUserId(userBean.getUserId());</span>
<span class="nc" id="L737">		helper = new DrawGameMgmtHelper();</span>
<span class="nc bnc" id="L738" title="All 2 branches missed.">		if (!helper.authorizeUser(userBean.getUserId())) </span>
<span class="nc" id="L739">			return &quot;unauthorize&quot;;</span>

<span class="nc" id="L741">		session.setAttribute(&quot;DRAW_SCH_LIST&quot;, helper.fetchSubDrawResult(drawScheduleBean));</span>
<span class="nc" id="L742">		return SUCCESS;</span>
	}

	public String getAgentOrgName() {
<span class="nc" id="L746">		return agentOrgName;</span>
	}

	public String getCancelMoneyStatus() {
<span class="nc" id="L750">		return cancelMoneyStatus;</span>
	}

	public int[] getCardType() {
<span class="nc" id="L754">		return cardType;</span>
	}

	public String getChangeType() {
<span class="nc" id="L758">		return changeType;</span>
	}

	public String getDraw_day() {
<span class="nc" id="L762">		return draw_day;</span>
	}

	public String[] getDraw_freeze_time() {
<span class="nc" id="L766">		return draw_freeze_time;</span>
	}

	public String[] getDraw_time() {
<span class="nc" id="L770">		return draw_time;</span>
	}

	public int getDrawId() {
<span class="nc" id="L774">		return drawId;</span>
	}

	public int[] getDrawIds() {
<span class="nc" id="L778">		return drawIds;</span>
	}

	public String getDrawSchdule() throws Exception {
		
<span class="nc" id="L783">		logger.debug(&quot;Before--&quot; + new Date());</span>
<span class="nc" id="L784">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L785">		Calendar fromDrawCal = Calendar.getInstance();</span>
<span class="nc" id="L786">		Calendar toDrawCal = Calendar.getInstance();</span>
<span class="nc" id="L787">		Calendar startTimeForDraw = Calendar.getInstance();</span>
<span class="nc" id="L788">		SimpleDateFormat format = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;);</span>
<span class="nc" id="L789">		Date frdate = null;</span>
<span class="nc" id="L790">		Date todateObj = null;</span>
<span class="nc" id="L791">		Timestamp fromTimeStamp = null;</span>
<span class="nc" id="L792">		Timestamp toTimeStamp = null;</span>
<span class="nc" id="L793">		List&lt;Integer&gt; drawIdList = new ArrayList&lt;Integer&gt;();</span>
<span class="nc" id="L794">		gameName = Util.getGameName(gameId);</span>
<span class="nc" id="L795">		logger.debug(&quot;status === &quot; + status + &quot;--draw ids--&quot; + drawIds);</span>
<span class="nc bnc" id="L796" title="All 2 branches missed.">		if (fromDate != null) {</span>
<span class="nc bnc" id="L797" title="All 2 branches missed.">			if (fromDate.length() == 0) {</span>
<span class="nc" id="L798">				fromDate = null;</span>
			} else {
<span class="nc" id="L800">				logger.debug(&quot;len-----&quot; + fromDate.length());</span>
			}
		}
<span class="nc bnc" id="L803" title="All 2 branches missed.">		if (toDate != null) {</span>
<span class="nc bnc" id="L804" title="All 2 branches missed.">			if (toDate.length() == 0) {</span>
<span class="nc" id="L805">				toDate = null;</span>
			}
		}
<span class="nc bnc" id="L808" title="All 2 branches missed.">		if (drawId == 0) {</span>
<span class="nc" id="L809">			drawIdList.add(0);</span>
		} else {
<span class="nc" id="L811">			drawIdList.add(drawId);</span>
		}
<span class="nc" id="L813">		logger.debug(&quot;from date---&quot; + fromDate + &quot;--toDate---&quot; + toDate</span>
				+ &quot;----draw id---&quot; + drawId + &quot;----g no--&quot; + gameNo);

		
		try {
<span class="nc bnc" id="L818" title="All 2 branches missed.">			if (fromDate != null) {</span>
<span class="nc" id="L819">				frdate = format.parse(fromDate);</span>
<span class="nc" id="L820">				fromDrawCal.setTime(frdate);</span>
<span class="nc" id="L821">				fromDrawCal.set(Calendar.HOUR, Integer.parseInt(fromHour));</span>
<span class="nc" id="L822">				fromDrawCal.set(Calendar.MINUTE, Integer.parseInt(fromMin));</span>
<span class="nc" id="L823">				fromDrawCal.set(Calendar.SECOND, Integer.parseInt(fromSec));</span>
<span class="nc" id="L824">				fromTimeStamp = new Timestamp(fromDrawCal.getTime().getTime());</span>
			}
<span class="nc bnc" id="L826" title="All 2 branches missed.">			if (toDate != null) {</span>
<span class="nc" id="L827">				todateObj = format.parse(toDate);</span>
<span class="nc" id="L828">				toDrawCal.setTime(todateObj);</span>
<span class="nc" id="L829">				toDrawCal.set(Calendar.HOUR, Integer.parseInt(toHour));</span>
<span class="nc" id="L830">				toDrawCal.set(Calendar.MINUTE, Integer.parseInt(toMin));</span>
<span class="nc" id="L831">				toDrawCal.set(Calendar.SECOND, Integer.parseInt(toSec));</span>
<span class="nc" id="L832">				toTimeStamp = new Timestamp(toDrawCal.getTime().getTime());</span>
			}
<span class="nc bnc" id="L834" title="All 2 branches missed.">			if(todateObj.compareTo(frdate)&lt;0){</span>
<span class="nc" id="L835">				System.out.println(&quot;From Date Should be less than To Date&quot;);</span>
<span class="nc" id="L836">				addActionMessage(getText(&quot;label.invalid.date.todate.shouldbe.after.fromdate&quot;));</span>
<span class="nc" id="L837">				session.setAttribute(&quot;DRAW_SCH_LIST&quot;, null);</span>
<span class="nc bnc" id="L838" title="All 2 branches missed.">				if (&quot;CLAIM HOLD&quot;.equalsIgnoreCase(status.trim())) {</span>
<span class="nc" id="L839">					return &quot;performed&quot;;</span>
<span class="nc bnc" id="L840" title="All 2 branches missed.">				} else if (&quot;FREEZE&quot;.equalsIgnoreCase(status.trim())) {</span>
<span class="nc" id="L841">					return &quot;freeze&quot;;</span>
<span class="nc bnc" id="L842" title="All 4 branches missed.">				} else if (&quot;ACTIVE&quot;.equalsIgnoreCase(status.trim())</span>
						|| &quot;INACTIVE&quot;.equalsIgnoreCase(status.trim())) {
<span class="nc" id="L844">					return &quot;active&quot;;</span>
<span class="nc bnc" id="L845" title="All 2 branches missed.">				} else if (&quot;HOLD&quot;.equalsIgnoreCase(status.trim())) {</span>
<span class="nc" id="L846">					return &quot;hold&quot;;</span>
				} else {
<span class="nc" id="L848">					return INPUT;</span>
				}
				
			}
<span class="nc" id="L852">		} catch (Exception e) {</span>
<span class="nc" id="L853">			e.printStackTrace();</span>
<span class="nc" id="L854">		}</span>
<span class="nc" id="L855">		ServletContext sc = ServletActionContext.getServletContext();</span>
<span class="nc" id="L856">		int DrawScheduleResultDelay =Integer.parseInt( (String) sc.getAttribute(&quot;Draw_Schedule_Result_Delay&quot;));</span>
<span class="nc" id="L857">		startTimeForDraw.add(Calendar.HOUR_OF_DAY,DrawScheduleResultDelay);</span>
<span class="nc" id="L858">		DrawScheduleBean drawScheduleBean = new DrawScheduleBean();</span>
<span class="nc" id="L859">		drawScheduleBean.setDraw_day(draw_day);</span>
<span class="nc" id="L860">		drawScheduleBean.setDrawIdList(drawIdList);</span>
<span class="nc" id="L861">		drawScheduleBean.setGameNo(gameId);</span>
<span class="nc" id="L862">		drawScheduleBean.setStartDate(fromTimeStamp);</span>
<span class="nc" id="L863">		drawScheduleBean.setEndDate(toTimeStamp);</span>
<span class="nc" id="L864">		drawScheduleBean.setStatus(status);</span>
<span class="nc" id="L865">		drawScheduleBean.setStartTimeForDraws(new Timestamp(startTimeForDraw.getTime().getTime()));</span>
<span class="nc" id="L866">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L867">		session.setAttribute(&quot;DRAW_SCH_LIST&quot;, helper</span>
				.getDrawSchdule(drawScheduleBean));
<span class="nc" id="L869">		logger.debug(&quot;After--&quot; + new Date());</span>

<span class="nc bnc" id="L871" title="All 2 branches missed.">		if (&quot;CLAIM ALLOW&quot;.equalsIgnoreCase(status.trim())) {</span>
<span class="nc" id="L872">			return &quot;allow&quot;;</span>
<span class="nc bnc" id="L873" title="All 2 branches missed.">		}else if (&quot;CLAIM HOLD&quot;.equalsIgnoreCase(status.trim())) {</span>
<span class="nc" id="L874">			return &quot;performed&quot;;</span>
<span class="nc bnc" id="L875" title="All 2 branches missed.">		} else if (&quot;FREEZE&quot;.equalsIgnoreCase(status.trim())) {</span>
<span class="nc" id="L876">			return &quot;freeze&quot;;</span>
<span class="nc bnc" id="L877" title="All 4 branches missed.">		} else if (&quot;ACTIVE&quot;.equalsIgnoreCase(status.trim())</span>
				|| &quot;INACTIVE&quot;.equalsIgnoreCase(status.trim())) {
<span class="nc" id="L879">			return &quot;active&quot;;</span>
<span class="nc bnc" id="L880" title="All 2 branches missed.">		} else if (&quot;HOLD&quot;.equalsIgnoreCase(status.trim())) {</span>
<span class="nc" id="L881">			return &quot;hold&quot;;</span>
		} else {
<span class="nc" id="L883">			return INPUT;</span>
		}

	}

	public ArrayList&lt;DrawScheduleBeanResult&gt; getDrawScheduleBeanResultList() {
<span class="nc" id="L889">		return drawScheduleBeanResultList;</span>
	}

	public String[] getDrawType() {
<span class="nc" id="L893">		return drawType;</span>
	}

	public String getEnd_Date() {
<span class="nc" id="L897">		return end_Date;</span>
	}

	public FortunePurchaseBean getFortuneBean() {
<span class="nc" id="L901">		return fortuneBean;</span>
	}

	public int getFreezeTime() {
<span class="nc" id="L905">		return freezeTime;</span>
	}

	public String getFromDate() {
<span class="nc" id="L909">		return fromDate;</span>
	}

	public String getFromHour() {
<span class="nc" id="L913">		return fromHour;</span>
	}

	public String getFromMin() {
<span class="nc" id="L917">		return fromMin;</span>
	}

	public String getFromSec() {
<span class="nc" id="L921">		return fromSec;</span>
	}

	public String getGameData() {
<span class="nc" id="L925">		logger.debug(&quot;Inside getGameData&quot;);</span>
<span class="nc bnc" id="L926" title="All 2 branches missed.">		if(!(&quot;GHANA&quot;.equalsIgnoreCase(Utility.getPropertyValue(&quot;COUNTRY_DEPLOYED&quot;)))) {</span>
<span class="nc" id="L927">			String actionName = ActionContext.getContext().getName();</span>
<span class="nc" id="L928">			Map&lt;Integer, String&gt; gameMap = ReportUtility.fetchActiveGameDrawDataMenu();</span>
<span class="nc bnc" id="L929" title="All 2 branches missed.">			if(&quot;bo_dg_machineNumberEntry&quot;.equals(actionName)) {</span>
<span class="nc" id="L930">				int raffleGameId = Util.getGameId(&quot;RaffleGame1&quot;);</span>
<span class="nc" id="L931">				gameMap.remove(raffleGameId);</span>
	
<span class="nc" id="L933">				int kenoSevenGameId = Util.getGameId(&quot;KenoSeven&quot;);</span>
<span class="nc" id="L934">				gameMap.remove(kenoSevenGameId);</span>
				
<span class="nc" id="L936">				int kenoNineGameId = Util.getGameId(&quot;KenoNine&quot;);</span>
<span class="nc" id="L937">				gameMap.remove(kenoNineGameId);</span>
			}
		}
<span class="nc" id="L940">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L941">		SimpleDateFormat format = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;);</span>
<span class="nc" id="L942">		Date date = Calendar.getInstance().getTime();</span>
<span class="nc" id="L943">		String today = format.format(date);</span>
<span class="nc" id="L944">		session.setAttribute(&quot;CURR_TIME&quot;, today);</span>
<span class="nc" id="L945">		session.setAttribute(&quot;DRAWGAME_LIST&quot;, ReportUtility.fetchActiveGameDrawDataMenu());</span>
<span class="nc" id="L946">		session.setAttribute(&quot;INVOKER&quot;, invoker);</span>
<span class="nc" id="L947">		return SUCCESS;</span>
	}

	public String getGameDataForTrackTx(){
<span class="nc" id="L951">		HttpSession session = getServletRequest().getSession();</span>
<span class="nc" id="L952">		session.setAttribute(&quot;DRAWGAME_LIST&quot;, ReportUtility.fetchActiveGameDrawDataMenu());</span>
<span class="nc" id="L953">		return SUCCESS;</span>
	}
	
	
	public String getGameDataDec() {
<span class="nc" id="L958">		invoker = &quot;ManualDeclare&quot;;</span>
<span class="nc" id="L959">		return getGameData();</span>
	}

	public String getGameDataWin() {
<span class="nc" id="L963">		invoker = &quot;ManualEntry&quot;;</span>
<span class="nc" id="L964">		return getGameData();</span>
	}

	public String getGameName() {
<span class="nc" id="L968">		return gameName;</span>
	}

	public String getGameNo() {
<span class="nc" id="L972">		return gameNo;</span>
	}

	public int getGameId() {
<span class="nc" id="L976">		return gameId;</span>
	}

	public void setGameId(int gameId) {
<span class="nc" id="L980">		this.gameId = gameId;</span>
<span class="nc" id="L981">	}</span>

	public String getGameType() {
<span class="nc" id="L984">		return gameType;</span>
	}

	public KenoPurchaseBean getKenoPurchaseBean() {
<span class="nc" id="L988">		return kenoPurchaseBean;</span>
	}

	public String getLastTenTicket() throws NumberFormatException, LMSException {
<span class="nc" id="L992">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L993">		Map ticketMap = helper.getLastTenTicket(Integer.parseInt(gameNo),</span>
				retOrgId);
<span class="nc" id="L995">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L996">		session.setAttribute(&quot;ticketMap&quot;, ticketMap);</span>
<span class="nc" id="L997">		return SUCCESS;</span>
	}

	public LottoPurchaseBean getLottoPurchaseBean() {
<span class="nc" id="L1001">		return lottoPurchaseBean;</span>
	}

	/**
	 * This method fetches draws with draw_status as 'ACTIVE'.
	 * 
	 * @return
	 * @throws Exception
	 */
	public String getManualDeclareData() throws Exception {
<span class="nc" id="L1011">		logger.debug(&quot;INside getManualDeclareData&quot;);</span>
		
<span class="nc" id="L1013">		logger.debug(&quot;Before--&quot; + new Date());</span>
<span class="nc" id="L1014">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L1015">		Calendar fromDrawCal = Calendar.getInstance();</span>
<span class="nc" id="L1016">		Calendar toDrawCal = Calendar.getInstance();</span>
<span class="nc" id="L1017">		SimpleDateFormat format = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;);</span>
<span class="nc" id="L1018">		Date frdate = null;</span>
<span class="nc" id="L1019">		Date todateObj = null;</span>
<span class="nc" id="L1020">		Timestamp fromTimeStamp = null;</span>
<span class="nc" id="L1021">		Timestamp toTimeStamp = null;</span>
<span class="nc bnc" id="L1022" title="All 2 branches missed.">		if (fromDate != null) {</span>
<span class="nc bnc" id="L1023" title="All 2 branches missed.">			if (fromDate.length() == 0) {</span>
<span class="nc" id="L1024">				fromDate = null;</span>
			} else {
<span class="nc" id="L1026">				logger.debug(&quot;len-----&quot; + fromDate.length());</span>

			}
		}
<span class="nc bnc" id="L1030" title="All 2 branches missed.">		if (toDate != null) {</span>
<span class="nc bnc" id="L1031" title="All 2 branches missed.">			if (toDate.length() == 0) {</span>
<span class="nc" id="L1032">				toDate = null;</span>
			}
		}
		
<span class="nc" id="L1036">		gameName = Util.getGameName(Integer.parseInt(gameNo));</span>
		try {
<span class="nc bnc" id="L1038" title="All 2 branches missed.">			if (fromDate != null) {</span>
<span class="nc" id="L1039">				frdate = format.parse(fromDate);</span>
<span class="nc" id="L1040">				fromDrawCal.setTime(frdate);</span>
<span class="nc" id="L1041">				fromDrawCal.set(Calendar.HOUR, Integer.parseInt(fromHour));</span>
<span class="nc" id="L1042">				fromDrawCal.set(Calendar.MINUTE, Integer.parseInt(fromMin));</span>
<span class="nc" id="L1043">				fromDrawCal.set(Calendar.SECOND, Integer.parseInt(fromSec));</span>
<span class="nc" id="L1044">				fromTimeStamp = new Timestamp(fromDrawCal.getTime().getTime());</span>
			}
<span class="nc bnc" id="L1046" title="All 2 branches missed.">			if (toDate != null) {</span>
<span class="nc" id="L1047">				todateObj = format.parse(toDate);</span>
<span class="nc" id="L1048">				toDrawCal.setTime(todateObj);</span>
<span class="nc" id="L1049">				toDrawCal.set(Calendar.HOUR, Integer.parseInt(toHour));</span>
<span class="nc" id="L1050">				toDrawCal.set(Calendar.MINUTE, Integer.parseInt(toMin));</span>
<span class="nc" id="L1051">				toDrawCal.set(Calendar.SECOND, Integer.parseInt(toSec));</span>
<span class="nc" id="L1052">				toTimeStamp = new Timestamp(toDrawCal.getTime().getTime());</span>
			}
<span class="nc" id="L1054">		} catch (Exception e) {</span>
<span class="nc" id="L1055">			e.printStackTrace();</span>
<span class="nc" id="L1056">		}</span>

<span class="nc" id="L1058">		DrawScheduleBean drawScheduleBean = new DrawScheduleBean();</span>
<span class="nc" id="L1059">		drawScheduleBean.setDraw_id(drawId);</span>
<span class="nc" id="L1060">		drawScheduleBean.setGameNo(Integer.parseInt(gameNo));</span>
<span class="nc" id="L1061">		drawScheduleBean.setStartDate(fromTimeStamp);</span>
<span class="nc" id="L1062">		drawScheduleBean.setEndDate(toTimeStamp);</span>

<span class="nc" id="L1064">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L1065">		session.setAttribute(&quot;DRAW_SCH_LIST&quot;, helper</span>
				.getManualDeclareData(drawScheduleBean));
<span class="nc" id="L1067">		return SUCCESS;</span>
	}

	/**
	 * This method fetches draws with draw_status as 'FREEZE' if Perform Status
	 * is &quot;ALL&quot; else all draws with perform_status = 'PMEP'
	 * 
	 * @return
	 * @throws Exception
	 */
	public String getManualEntryData() throws Exception {
<span class="nc" id="L1078">		logger.debug(&quot;INside getManualEntryData&quot;);</span>
<span class="nc" id="L1079">		logger.debug(&quot;action call------------------&quot;);</span>
<span class="nc" id="L1080">		logger.debug(&quot;Before--&quot; + new Date());</span>

<span class="nc" id="L1082">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L1083">		UserInfoBean userBean = (UserInfoBean) session</span>
				.getAttribute(&quot;USER_INFO&quot;);
<span class="nc" id="L1085">		Calendar fromDrawCal = Calendar.getInstance();</span>
<span class="nc" id="L1086">		Calendar toDrawCal = Calendar.getInstance();</span>
<span class="nc" id="L1087">		SimpleDateFormat format = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;);</span>
<span class="nc" id="L1088">		Date frdate = null;</span>
<span class="nc" id="L1089">		Date todateObj = null;</span>
<span class="nc" id="L1090">		Timestamp fromTimeStamp = null;</span>
<span class="nc" id="L1091">		Timestamp toTimeStamp = null;</span>
<span class="nc bnc" id="L1092" title="All 2 branches missed.">		if (fromDate != null) {</span>
<span class="nc bnc" id="L1093" title="All 2 branches missed.">			if (fromDate.length() == 0) {</span>
<span class="nc" id="L1094">				fromDate = null;</span>
			} else {
<span class="nc" id="L1096">				logger.debug(&quot;len-----&quot; + fromDate.length());</span>

			}
		}
<span class="nc bnc" id="L1100" title="All 2 branches missed.">		if (toDate != null) {</span>
<span class="nc bnc" id="L1101" title="All 2 branches missed.">			if (toDate.length() == 0) {</span>
<span class="nc" id="L1102">				toDate = null;</span>
			}
		}
<span class="nc bnc" id="L1105" title="All 12 branches missed.">		if (fromHour != null &amp;&amp; fromMin != null &amp;&amp; fromSec != null</span>
				&amp;&amp; toHour != null &amp;&amp; toMin != null &amp;&amp; toSec != null) {

<span class="nc bnc" id="L1108" title="All 2 branches missed.">			if (fromHour.length() == 0) {</span>
<span class="nc" id="L1109">				fromHour = &quot;00&quot;;</span>
			}
<span class="nc bnc" id="L1111" title="All 2 branches missed.">			if (fromMin.length() == 0) {</span>
<span class="nc" id="L1112">				fromMin = &quot;00&quot;;</span>
			}
<span class="nc bnc" id="L1114" title="All 2 branches missed.">			if (fromSec.length() == 0) {</span>
<span class="nc" id="L1115">				fromSec = &quot;00&quot;;</span>
			}
<span class="nc bnc" id="L1117" title="All 2 branches missed.">			if (toHour.length() == 0) {</span>
<span class="nc" id="L1118">				toHour = &quot;23&quot;;</span>
			}
<span class="nc bnc" id="L1120" title="All 2 branches missed.">			if (toMin.length() == 0) {</span>
<span class="nc" id="L1121">				toMin = &quot;59&quot;;</span>
			}
<span class="nc bnc" id="L1123" title="All 2 branches missed.">			if (toSec.length() == 0) {</span>
<span class="nc" id="L1124">				toSec = &quot;59&quot;;</span>
			}
		}
		
<span class="nc" id="L1128">		gameName = Util.getGameName(gameId);</span>
		try {
<span class="nc bnc" id="L1130" title="All 2 branches missed.">			if (fromDate != null) {</span>
<span class="nc" id="L1131">				frdate = format.parse(fromDate);</span>
<span class="nc" id="L1132">				fromDrawCal.setTime(frdate);</span>
<span class="nc" id="L1133">				fromDrawCal.set(Calendar.HOUR, Integer.parseInt(fromHour));</span>
<span class="nc" id="L1134">				fromDrawCal.set(Calendar.MINUTE, Integer.parseInt(fromMin));</span>
<span class="nc" id="L1135">				fromDrawCal.set(Calendar.SECOND, Integer.parseInt(fromSec));</span>
<span class="nc" id="L1136">				fromTimeStamp = new Timestamp(fromDrawCal.getTime().getTime());</span>
			}
<span class="nc bnc" id="L1138" title="All 2 branches missed.">			if (toDate != null) {</span>
<span class="nc" id="L1139">				todateObj = format.parse(toDate);</span>
<span class="nc" id="L1140">				toDrawCal.setTime(todateObj);</span>
<span class="nc" id="L1141">				toDrawCal.set(Calendar.HOUR, Integer.parseInt(toHour));</span>
<span class="nc" id="L1142">				toDrawCal.set(Calendar.MINUTE, Integer.parseInt(toMin));</span>
<span class="nc" id="L1143">				toDrawCal.set(Calendar.SECOND, Integer.parseInt(toSec));</span>
<span class="nc" id="L1144">				toTimeStamp = new Timestamp(toDrawCal.getTime().getTime());</span>
			}
<span class="nc" id="L1146">		} catch (Exception e) {</span>
<span class="nc" id="L1147">			e.printStackTrace();</span>
<span class="nc" id="L1148">		}</span>

<span class="nc" id="L1150">		DrawScheduleBean drawScheduleBean = new DrawScheduleBean();</span>
<span class="nc" id="L1151">		drawScheduleBean.setDraw_id(drawId);</span>
		//drawScheduleBean.setGameNo(Integer.parseInt(gameNo));
<span class="nc" id="L1153">		drawScheduleBean.setGameId(gameId);</span>
<span class="nc" id="L1154">		drawScheduleBean.setStartDate(fromTimeStamp);</span>
<span class="nc" id="L1155">		drawScheduleBean.setEndDate(toTimeStamp);</span>
<span class="nc bnc" id="L1156" title="All 2 branches missed.">		drawScheduleBean.setStatus(performStatus[0].equals(&quot;ALL&quot;) ? &quot;FREEZE&quot;</span>
				: null);
<span class="nc" id="L1158">		System.out.println(&quot;heej&quot; + performStatus[0]);</span>
<span class="nc" id="L1159">		drawScheduleBean.setUserId(userBean.getUserId());</span>
<span class="nc" id="L1160">		drawScheduleBean.setPerformStatus(performStatus);</span>
<span class="nc" id="L1161">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L1162">		session.setAttribute(&quot;DRAW_SCH_LIST&quot;, helper</span>
				.getManualEntryData(drawScheduleBean));
<span class="nc" id="L1164">		return SUCCESS;</span>
	}

	public String getManualMachineNumberEntryData() throws Exception {
<span class="nc" id="L1168">		System.out.println(&quot;getManualMachineNumberEntryData()&quot;);</span>
<span class="nc" id="L1169">		logger.debug(&quot;INside getManualEntryData&quot;);</span>
<span class="nc" id="L1170">		logger.debug(&quot;action call------------------&quot;);</span>
<span class="nc" id="L1171">		logger.debug(&quot;Before--&quot; + new Date());</span>

<span class="nc" id="L1173">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L1174">		UserInfoBean userBean = (UserInfoBean) session</span>
				.getAttribute(&quot;USER_INFO&quot;);
<span class="nc" id="L1176">		Calendar fromDrawCal = Calendar.getInstance();</span>
<span class="nc" id="L1177">		Calendar toDrawCal = Calendar.getInstance();</span>
<span class="nc" id="L1178">		SimpleDateFormat format = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;);</span>
<span class="nc" id="L1179">		Date frdate = null;</span>
<span class="nc" id="L1180">		Date todateObj = null;</span>
<span class="nc" id="L1181">		Timestamp fromTimeStamp = null;</span>
<span class="nc" id="L1182">		Timestamp toTimeStamp = null;</span>
<span class="nc bnc" id="L1183" title="All 2 branches missed.">		if (fromDate != null) {</span>
<span class="nc bnc" id="L1184" title="All 2 branches missed.">			if (fromDate.length() == 0) {</span>
<span class="nc" id="L1185">				fromDate = null;</span>
			} else {
<span class="nc" id="L1187">				logger.debug(&quot;len-----&quot; + fromDate.length());</span>

			}
		}
<span class="nc bnc" id="L1191" title="All 2 branches missed.">		if (toDate != null) {</span>
<span class="nc bnc" id="L1192" title="All 2 branches missed.">			if (toDate.length() == 0) {</span>
<span class="nc" id="L1193">				toDate = null;</span>
			}
		}

		
<span class="nc" id="L1198">		gameName = Util.getGameName(Integer.parseInt(gameNo));</span>
		try {
<span class="nc bnc" id="L1200" title="All 2 branches missed.">			if (fromDate != null) {</span>
<span class="nc" id="L1201">				frdate = format.parse(fromDate);</span>
<span class="nc" id="L1202">				fromDrawCal.setTime(frdate);</span>
<span class="nc" id="L1203">				fromDrawCal.set(Calendar.HOUR, Integer.parseInt(fromHour));</span>
<span class="nc" id="L1204">				fromDrawCal.set(Calendar.MINUTE, Integer.parseInt(fromMin));</span>
<span class="nc" id="L1205">				fromDrawCal.set(Calendar.SECOND, Integer.parseInt(fromSec));</span>
<span class="nc" id="L1206">				fromTimeStamp = new Timestamp(fromDrawCal.getTime().getTime());</span>
			}
<span class="nc bnc" id="L1208" title="All 2 branches missed.">			if (toDate != null) {</span>
<span class="nc" id="L1209">				todateObj = format.parse(toDate);</span>
<span class="nc" id="L1210">				toDrawCal.setTime(todateObj);</span>
<span class="nc" id="L1211">				toDrawCal.set(Calendar.HOUR, Integer.parseInt(toHour));</span>
<span class="nc" id="L1212">				toDrawCal.set(Calendar.MINUTE, Integer.parseInt(toMin));</span>
<span class="nc" id="L1213">				toDrawCal.set(Calendar.SECOND, Integer.parseInt(toSec));</span>
<span class="nc" id="L1214">				toTimeStamp = new Timestamp(toDrawCal.getTime().getTime());</span>
			}
<span class="nc" id="L1216">		} catch (Exception e) {</span>
<span class="nc" id="L1217">			e.printStackTrace();</span>
<span class="nc" id="L1218">		}</span>

<span class="nc" id="L1220">		DrawScheduleBean drawScheduleBean = new DrawScheduleBean();</span>
<span class="nc" id="L1221">		drawScheduleBean.setDraw_id(drawId);</span>
<span class="nc" id="L1222">		drawScheduleBean.setGameNo(Integer.parseInt(gameNo));</span>
<span class="nc" id="L1223">		drawScheduleBean.setStartDate(fromTimeStamp);</span>
<span class="nc" id="L1224">		drawScheduleBean.setEndDate(toTimeStamp);</span>
<span class="nc bnc" id="L1225" title="All 2 branches missed.">		drawScheduleBean.setStatus(performStatus[0].equals(&quot;ALL&quot;) ? &quot;FREEZE&quot;</span>
				: null);
<span class="nc" id="L1227">		System.out.println(&quot;hello&quot; + (performStatus[0]));</span>
<span class="nc" id="L1228">		drawScheduleBean.setUserId(userBean.getUserId());</span>
<span class="nc" id="L1229">		drawScheduleBean.setPerformStatus(performStatus);</span>
<span class="nc" id="L1230">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L1231">		session.setAttribute(&quot;DRAW_MACHINE_NUMBER_SCH_LIST&quot;, helper</span>
				.getManualMachineNumberEntryData(drawScheduleBean));
		// session.setAttribute(&quot;DRAW_MACHINE_NUMBER_SCH_LIST&quot;, helper
		// .getManualMachineNumberEntryData(drawScheduleBean));
<span class="nc" id="L1235">		return SUCCESS;</span>
	}

	public String getMessage() {
<span class="nc" id="L1239">		return message;</span>
	}

	public String[] getPerformStatus() {
<span class="nc" id="L1243">		return performStatus;</span>
	}

	public int getPostponeTime() {
<span class="nc" id="L1247">		return postponeTime;</span>
	}

	public String[] getRetName() {
<span class="nc" id="L1251">		return retName;</span>
	}

	public String getRetOrgName() {
<span class="nc" id="L1255">		return retOrgName;</span>
	}

	public String getSearch_type() {
<span class="nc" id="L1259">		return search_type;</span>
	}

	public String getStart_date() {
<span class="nc" id="L1263">		return start_date;</span>
	}

	public String getStatus() {
<span class="nc" id="L1267">		return status;</span>
	}

	public String getSubHold() {
<span class="nc" id="L1271">		return subHold;</span>
	}

	public String getTicketNo() {
<span class="nc" id="L1275">		return ticketNo;</span>
	}

	public String getTicketNum() {
<span class="nc" id="L1279">		return ticketNum;</span>
	}

	public String[] getTicketNumArr() {
<span class="nc" id="L1283">		return ticketNumArr;</span>
	}

	public String getToDate() {
<span class="nc" id="L1287">		return toDate;</span>
	}

	public String getToHour() {
<span class="nc" id="L1291">		return toHour;</span>
	}

	public String getToMin() {
<span class="nc" id="L1295">		return toMin;</span>
	}

	public String getToSec() {
<span class="nc" id="L1299">		return toSec;</span>
	}

	public String getType() {
<span class="nc" id="L1303">		return type;</span>
	}

	public int getUser1() {
<span class="nc" id="L1307">		return user1;</span>
	}

	public int getUser2Id() {
<span class="nc" id="L1311">		return user2;</span>
	}

	public String getWinNumber() {
<span class="nc" id="L1315">		return winNumber;</span>
	}

	public Integer[] getWinNumbers() {
<span class="nc" id="L1319">		return winNumbers;</span>
	}

	public int getWinNumSize() {
<span class="nc" id="L1323">		return winNumSize;</span>
	}

	public Integer[] getMacNumbers() {
<span class="nc" id="L1327">		return macNumbers;</span>
	}

	public void setMacNumbers(Integer[] macNumbers) {
<span class="nc" id="L1331">		this.macNumbers = macNumbers;</span>
<span class="nc" id="L1332">	}</span>
	
	public String getMacNumber() {
<span class="nc" id="L1335">		return macNumber;</span>
	}

	public void setMacNumber(String macNumber) {
<span class="nc" id="L1339">		this.macNumber = macNumber;</span>
<span class="nc" id="L1340">	}</span>

	public String holdDraw() throws Exception {
<span class="nc" id="L1343">		logger.debug(&quot;Inside holdDraw&quot;);</span>
<span class="nc" id="L1344">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L1345">		List&lt;Integer&gt; drawIdList = new ArrayList&lt;Integer&gt;();</span>
<span class="nc bnc" id="L1346" title="All 2 branches missed.">		for (int element : drawIds) {</span>
<span class="nc" id="L1347">			drawIdList.add(element);</span>
		}
	//	gameNo = gameNo.substring(0, gameNo.lastIndexOf(&quot;-&quot;));
<span class="nc" id="L1350">		DrawScheduleBean drawScheduleBean = new DrawScheduleBean();</span>
<span class="nc" id="L1351">		drawScheduleBean.setDrawIdList(drawIdList);</span>
<span class="nc" id="L1352">		drawScheduleBean.setGameNo(Integer.parseInt(gameNo));</span>
<span class="nc" id="L1353">		drawScheduleBean.setStatus(status);</span>
<span class="nc" id="L1354">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L1355">		SchedulerBean schedulerBean = (SchedulerBean) helper</span>
				.holdDraw(drawScheduleBean);
<span class="nc" id="L1357">		logger.debug(&quot;Inside holdDraw&quot;);</span>

		// schedulerBean.setActionType(&quot;CANCELLED&quot;);
<span class="nc" id="L1360">		session.setAttribute(&quot;RESULT_LIST&quot;, schedulerBean);</span>
<span class="nc" id="L1361">		logger.debug(&quot;msg--&quot; + schedulerBean.getResponseMessage());</span>
<span class="nc" id="L1362">		logger.debug(&quot;msg--&quot; + schedulerBean.getGameNo());</span>
<span class="nc" id="L1363">		logger.debug(&quot;msg--&quot; + schedulerBean.getFreezeOrPerform().toString());</span>
<span class="nc" id="L1364">		logger.debug(&quot;After--&quot; + new Date());</span>

<span class="nc" id="L1366">		return SUCCESS;</span>
	}

	public String initiateDrawSchedule() throws Exception {
<span class="nc" id="L1370">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L1371">		logger.debug(&quot;Before--&quot; + new Date());</span>
<span class="nc" id="L1372">		DrawScheduleBean drawScheduleBean = new DrawScheduleBean();</span>
<span class="nc" id="L1373">		drawScheduleBean.setGameNo(101);</span>
<span class="nc" id="L1374">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L1375">		helper.initiateDrawSchdule(drawScheduleBean);</span>
<span class="nc" id="L1376">		logger.debug(&quot;After--&quot; + new Date());</span>
<span class="nc" id="L1377">		return SUCCESS;</span>

	}

	public String manualWiningEntry() {
<span class="nc" id="L1382">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L1383">		ArrayList&lt;DrawScheduleBeanResult&gt; list = (ArrayList&lt;DrawScheduleBeanResult&gt;) session</span>
				.getAttribute(&quot;DRAW_SCH_LIST&quot;);
<span class="nc" id="L1385">		drawScheduleBeanResultList = new ArrayList&lt;DrawScheduleBeanResult&gt;();</span>
<span class="nc" id="L1386">		DrawScheduleBeanResult checkedDrawBean = null;</span>
<span class="nc" id="L1387">		int i = -1;</span>
<span class="nc bnc" id="L1388" title="All 2 branches missed.">		for (int drawId : drawIds) {</span>
<span class="nc" id="L1389">			checkedDrawBean = new DrawScheduleBeanResult();</span>
<span class="nc" id="L1390">			checkedDrawBean.setDrawId(drawId);</span>
<span class="nc bnc" id="L1391" title="All 2 branches missed.">			if ((i = list.indexOf(checkedDrawBean)) &gt; -1) {</span>
<span class="nc" id="L1392">				drawScheduleBeanResultList.add(list.get(i));</span>
			}
		}
<span class="nc" id="L1395">		setGameNo(Util.getGameNumberFromGameId(gameId)+&quot;&quot;);</span>
<span class="nc" id="L1396">		setBonusBallEnable(Util.getLmsGameMap().get(gameId).getBonusBallEnable());</span>
<span class="nc" id="L1397">		logger.debug(&quot;drawScheduleBeanResultList ==== &quot;</span>
				+ drawScheduleBeanResultList);
<span class="nc" id="L1399">		return SUCCESS;</span>
	}

	public String manualWiningMachineNumberEntry() {
<span class="nc" id="L1403">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L1404">		ArrayList&lt;DrawScheduleBeanResult&gt; list = (ArrayList&lt;DrawScheduleBeanResult&gt;) session</span>
				.getAttribute(&quot;DRAW_MACHINE_NUMBER_SCH_LIST&quot;);
<span class="nc" id="L1406">		drawScheduleBeanResultList = new ArrayList&lt;DrawScheduleBeanResult&gt;();</span>
<span class="nc" id="L1407">		DrawScheduleBeanResult checkedDrawBean = null;</span>
<span class="nc" id="L1408">		int i = -1;</span>
<span class="nc bnc" id="L1409" title="All 2 branches missed.">		for (int drawId : drawIds) {</span>
<span class="nc" id="L1410">			checkedDrawBean = new DrawScheduleBeanResult();</span>
<span class="nc" id="L1411">			checkedDrawBean.setDrawId(drawId);</span>
<span class="nc bnc" id="L1412" title="All 2 branches missed.">			if ((i = list.indexOf(checkedDrawBean)) &gt; -1) {</span>
<span class="nc" id="L1413">				drawScheduleBeanResultList.add(list.get(i));</span>
			}
		}
<span class="nc" id="L1416">		logger.debug(&quot;drawScheduleBeanResultList ==== &quot;</span>
				+ drawScheduleBeanResultList);
<span class="nc" id="L1418">		return SUCCESS;</span>
	}

	/**
	 * This method sets the perform_status of a selected ACTIVE draws to 'PMEP'
	 * so that they are not selected for scheduling by scheduler in DrawGameWeb.
	 * 
	 * @return
	 * @throws Exception
	 */
	public String performManualDeclareEntry() throws Exception {
<span class="nc" id="L1429">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L1430">		List&lt;Integer&gt; drawIdList = new ArrayList&lt;Integer&gt;();</span>
<span class="nc bnc" id="L1431" title="All 2 branches missed.">		for (int element : drawIds) {</span>
<span class="nc" id="L1432">			drawIdList.add(element);</span>
		}
<span class="nc" id="L1434">		DrawScheduleBean drawScheduleBean = new DrawScheduleBean();</span>
<span class="nc" id="L1435">		drawScheduleBean.setDrawIdList(drawIdList);</span>
<span class="nc" id="L1436">		drawScheduleBean.setGameNo(Integer.parseInt(gameNo));</span>
<span class="nc" id="L1437">		String[] performStatus = { &quot;PMEP&quot; };</span>
<span class="nc" id="L1438">		drawScheduleBean.setPerformStatus(performStatus);</span>
<span class="nc" id="L1439">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>

<span class="nc" id="L1441">		session.setAttribute(&quot;MESSAGE&quot;, helper</span>
				.performManualDeclareEntry(drawScheduleBean));
<span class="nc" id="L1443">		return SUCCESS;</span>
	}

	/**
	 * This method invokes the game respective PerformDraw class of
	 * DrawGameEngine to perform the manual draw.
	 * 
	 * @return
	 * @throws Exception
	 */
	public String performManualWinningEntry() throws Exception {
<span class="nc" id="L1454">		logger.debug(&quot;Start Result Submission Process&quot;);</span>
<span class="nc" id="L1455">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L1456">		UserInfoBean userBean = (UserInfoBean) session.getAttribute(&quot;USER_INFO&quot;);</span>
<span class="nc" id="L1457">		ManualWinningBean mwBean = new ManualWinningBean();</span>
<span class="nc" id="L1458">		mwBean.setGameId(gameId);</span>
<span class="nc" id="L1459">		mwBean.setDrawIds(drawIds);</span>
<span class="nc" id="L1460">		mwBean.setDrawType(drawType);</span>
<span class="nc" id="L1461">		System.out.println(&quot;Draw Type&quot; + mwBean.getDrawType());</span>
		
		// For Verification Engine
		
		/*ArrayList&lt;DrawScheduleBeanResult&gt; list = (ArrayList&lt;DrawScheduleBeanResult&gt;) session
		.getAttribute(&quot;DRAW_SCH_LIST&quot;);
		DrawScheduleBeanResult checkedDrawBean = null, drawBean = null;
		DrawGameRPOSHelper dgHelper = new DrawGameRPOSHelper();
		int i = -1;
		for (int drawId : drawIds) {
			checkedDrawBean = new DrawScheduleBeanResult();
			drawBean = new DrawScheduleBeanResult();
			checkedDrawBean.setDrawId(drawId);
			if ((i = list.indexOf(checkedDrawBean)) &gt; -1) {
				drawBean = list.get(i);
				dgHelper.getUnsoldTkts(Integer.parseInt(gameNo), getStartDate(drawBean.getFreezeDateTime()), drawBean.getFreezeDateTime());
			}
		}*/
		
<span class="nc" id="L1480">		mwBean.setCardType(cardType);</span>
<span class="nc" id="L1481">		System.out.println(&quot;Card Type&quot; + cardType);</span>
<span class="nc bnc" id="L1482" title="All 2 branches missed.">		if (winNumbers != null) {</span>
<span class="nc" id="L1483">			List&lt;Integer&gt; tmpList=new ArrayList&lt;Integer&gt;();</span>
<span class="nc bnc" id="L1484" title="All 2 branches missed.">			for(Integer winNum:winNumbers){</span>
<span class="nc bnc" id="L1485" title="All 2 branches missed.">				if(winNum!=null){</span>
<span class="nc" id="L1486">					tmpList.add(winNum);</span>
				}
			}
<span class="nc" id="L1489">			winNumbers=tmpList.toArray(new Integer[0]);</span>
<span class="nc" id="L1490">			winNumSize = winNumbers.length;</span>
		}
<span class="nc" id="L1492">		mwBean.setWinningNumbers(winNumbers);</span>
<span class="nc" id="L1493">		System.out.println(&quot;winning numberas&quot; + mwBean.getWinningNumbers());</span>
		//winNumSize = winNumbers.length;
<span class="nc" id="L1495">		mwBean.setWinNumSize(winNumSize);</span>
<span class="nc" id="L1496">		mwBean.setUserId(userBean.getUserId());</span>
<span class="nc" id="L1497">		mwBean.setMachineNumbers(macNumbers);</span>
<span class="nc" id="L1498">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L1499">		session.setAttribute(&quot;MESSAGE&quot;, helper</span>
				.performManualWinningEntry(mwBean));
<span class="nc" id="L1501">		DrawGameRPOS.onStartNewData();</span>
		//logger.debug(&quot;Returning Success&quot;);
<span class="nc" id="L1503">		return SUCCESS;</span>
	}

	public String performManualWinningMachineNumberEntry() throws Exception {
<span class="nc" id="L1507">		logger.debug(&quot;123456&quot;);</span>
<span class="nc" id="L1508">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L1509">		UserInfoBean userBean = (UserInfoBean) session</span>
				.getAttribute(&quot;USER_INFO&quot;);
<span class="nc" id="L1511">		ManualWinningBean mwBean = new ManualWinningBean();</span>
<span class="nc" id="L1512">		mwBean.setGameNumber(gameNo);</span>
<span class="nc" id="L1513">		mwBean.setDrawIds(drawIds);</span>
<span class="nc" id="L1514">		mwBean.setDrawType(drawType);</span>
<span class="nc" id="L1515">		System.out.println(&quot;sfd&quot; + mwBean.getDrawType());</span>

<span class="nc" id="L1517">		System.out.println(&quot;wdraw type&quot; + drawType);</span>
<span class="nc" id="L1518">		mwBean.setCardType(cardType);</span>
<span class="nc" id="L1519">		System.out.println(&quot;sd&quot; + cardType);</span>
<span class="nc" id="L1520">		mwBean.setWinningNumbers(winNumbers);</span>
<span class="nc" id="L1521">		System.out.println(&quot;winning numberas&quot; + mwBean.getWinningNumbers());</span>
<span class="nc" id="L1522">		mwBean.setWinNumSize(winNumSize);</span>
<span class="nc" id="L1523">		mwBean.setUserId(userBean.getUserId());</span>
<span class="nc" id="L1524">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L1525">		session.setAttribute(&quot;MESSAGE&quot;, helper</span>
				.performManualWinningMachineNumberEntry(mwBean));
<span class="nc" id="L1527">		DrawGameRPOS.onStartNewData();</span>
<span class="nc" id="L1528">		return SUCCESS;</span>
	}

	public String postponeDraw() throws Exception {
<span class="nc" id="L1532">		logger.debug(&quot;Inside postponeDraw&quot;);</span>
<span class="nc" id="L1533">		logger.debug(&quot;Before--&quot; + new Date());</span>

<span class="nc" id="L1535">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L1536">		UserInfoBean userInfoBean = (UserInfoBean) session</span>
		.getAttribute(&quot;USER_INFO&quot;);
<span class="nc" id="L1538">		SimpleDateFormat format = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;);</span>
<span class="nc" id="L1539">		Date todateObj = null;</span>
<span class="nc" id="L1540">		Timestamp toTimeStamp = null;</span>
<span class="nc" id="L1541">		Calendar toDrawCal = Calendar.getInstance();</span>
<span class="nc" id="L1542">		DrawScheduleBean drawScheduleBean = new DrawScheduleBean();</span>
<span class="nc" id="L1543">		List&lt;Integer&gt; drawIdList = new ArrayList&lt;Integer&gt;();</span>
<span class="nc bnc" id="L1544" title="All 2 branches missed.">		for (int element : drawIds) {</span>
<span class="nc" id="L1545">			drawIdList.add(element);</span>
		}
		//gameNo = gameNo.substring(0, gameNo.lastIndexOf(&quot;-&quot;));

<span class="nc bnc" id="L1549" title="All 2 branches missed.">		if (toDate != null) {</span>
<span class="nc bnc" id="L1550" title="All 2 branches missed.">			if (toDate.length() == 0) {</span>
<span class="nc" id="L1551">				toDate = null;</span>
			}
		}
		try {

<span class="nc bnc" id="L1556" title="All 2 branches missed.">			if (toDate != null) {</span>
<span class="nc" id="L1557">				todateObj = format.parse(toDate);</span>
<span class="nc" id="L1558">				toDrawCal.setTime(todateObj);</span>
<span class="nc" id="L1559">				toDrawCal.set(Calendar.HOUR, Integer.parseInt(toHour));</span>
<span class="nc" id="L1560">				toDrawCal.set(Calendar.MINUTE, Integer.parseInt(toMin));</span>
<span class="nc" id="L1561">				toDrawCal.set(Calendar.SECOND, Integer.parseInt(toSec));</span>
<span class="nc" id="L1562">				toTimeStamp = new Timestamp(toDrawCal.getTime().getTime());</span>
			}

<span class="nc" id="L1565">		} catch (Exception e) {</span>
<span class="nc" id="L1566">			e.printStackTrace();</span>
<span class="nc" id="L1567">		}</span>
<span class="nc" id="L1568">		drawScheduleBean.setGameNo(Integer.parseInt(gameNo));</span>
<span class="nc" id="L1569">		drawScheduleBean.setDrawIdList(drawIdList);</span>
<span class="nc" id="L1570">		drawScheduleBean.setPostponeMin(postponeTime);</span>
<span class="nc" id="L1571">		drawScheduleBean.setPostponeDate(toTimeStamp);</span>
<span class="nc" id="L1572">		logger.debug(&quot;selected status in postpone action ::&quot; + status);</span>

<span class="nc" id="L1574">		drawScheduleBean.setStatus(status);</span>
<span class="nc" id="L1575">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L1576">		SchedulerBean schedulerBean = (SchedulerBean) helper</span>
				.postponeDraw(drawScheduleBean,userInfoBean);
<span class="nc" id="L1578">		session.setAttribute(&quot;RESULT_LIST&quot;, schedulerBean);</span>
<span class="nc" id="L1579">		logger.debug(&quot;After--&quot; + new Date());</span>

<span class="nc" id="L1581">		return SUCCESS;</span>
	}

	public String rankChkDraw() throws Exception {
<span class="nc" id="L1585">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L1586">		UserInfoBean userInfoBean = (UserInfoBean) session</span>
		.getAttribute(&quot;USER_INFO&quot;);
<span class="nc" id="L1588">		List&lt;Integer&gt; drawIdList = new ArrayList&lt;Integer&gt;();</span>
<span class="nc bnc" id="L1589" title="All 2 branches missed.">		for (int element : drawIds) {</span>
<span class="nc" id="L1590">			drawIdList.add(element);</span>
		}
<span class="nc" id="L1592">		logger.debug(drawIdList + &quot;--Before Action On HOld--&quot; + subHold);</span>

	//	gameNo = gameNo.substring(0, gameNo.lastIndexOf(&quot;-&quot;));
<span class="nc" id="L1595">		DrawScheduleBean drawScheduleBean = new DrawScheduleBean();</span>
<span class="nc" id="L1596">		drawScheduleBean.setDrawIdList(drawIdList);</span>
<span class="nc" id="L1597">		drawScheduleBean.setGameNo(Integer.parseInt(gameNo));</span>
<span class="nc" id="L1598">		drawScheduleBean.setStatus(subHold);</span>
<span class="nc" id="L1599">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L1600">		SchedulerBean schedulerBean = (SchedulerBean) helper</span>
				.rankChkDraw(drawScheduleBean,userInfoBean);
<span class="nc" id="L1602">		logger.debug(&quot;schedulerBean.getDrawScheduleList().size()&quot;</span>
				+ schedulerBean.getDrawScheduleList().size());

		// schedulerBean.setActionType(&quot;CANCELLED&quot;);
<span class="nc" id="L1606">		session.setAttribute(&quot;RESULT_LIST&quot;, schedulerBean);</span>
<span class="nc" id="L1607">		logger.debug(&quot;msg--&quot; + schedulerBean.getResponseMessage());</span>
<span class="nc" id="L1608">		logger.debug(&quot;msg--&quot; + schedulerBean.getGameNo());</span>
<span class="nc" id="L1609">		logger.debug(&quot;After--&quot; + new Date());</span>

<span class="nc" id="L1611">		return SUCCESS;</span>
	}

	public String reprintTicket() {
<span class="nc" id="L1615">		logger.debug(&quot;-------BO Ticket Reprint-------&quot;);</span>
<span class="nc" id="L1616">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L1617">		logger.debug(&quot;Inside reprintTicket&quot;);</span>
		// UserInfoBean userInfoBean = (UserInfoBean) session
		// .getAttribute(&quot;USER_INFO&quot;);
<span class="nc" id="L1620">		logger.debug(&quot;Before--&quot; + new Date());</span>
<span class="nc" id="L1621">		logger.debug(&quot;Before--&quot; + new Date());</span>
<span class="nc" id="L1622">		String errMsg = &quot;Last Transaction Not Sale&quot;;</span>
<span class="nc" id="L1623">		DrawGameRPOSHelper helper = new DrawGameRPOSHelper();</span>
<span class="nc" id="L1624">		Object gameBean = null;</span>
<span class="nc" id="L1625">		UserInfoBean userInfoBean = new UserInfoBean();</span>

<span class="nc" id="L1627">		userInfoBean.setOrgName(Util.getOrgName(Util.fetchOrgIdOfUser(Integer</span>
				.parseInt(ticketNum.substring(0, 4)))));
<span class="nc" id="L1629">		userInfoBean.setUserOrgId(Util.fetchOrgIdOfUser(Integer</span>
				.parseInt(ticketNum.substring(0, 4))));
<span class="nc" id="L1631">		userInfoBean.setUserId(Integer.parseInt(ticketNum.substring(0, 3)));</span>
<span class="nc" id="L1632">		session.setAttribute(&quot;boReprintRetOrgName&quot;, userInfoBean.getOrgName());</span>
<span class="nc" id="L1633">		gameBean = helper.reprintTicket(userInfoBean, ticketNum);</span>
<span class="nc" id="L1634">		logger.debug(&quot;******gameBean::&quot; + gameBean);</span>

<span class="nc bnc" id="L1636" title="All 2 branches missed.">		if (gameBean instanceof FortunePurchaseBean) {</span>
<span class="nc" id="L1637">			logger.debug(&quot; FortunePurchaseBean reprint &quot;);</span>
<span class="nc" id="L1638">			FortunePurchaseBean fortuneBean = (FortunePurchaseBean) gameBean;</span>
<span class="nc" id="L1639">			setFortuneBean(fortuneBean);</span>
<span class="nc" id="L1640">			session.setAttribute(&quot;REPRINT_TYPE&quot;, Util.getGameName(</span>
					fortuneBean.getGame_no()).toUpperCase()
					+ &quot;_REPRINT&quot;);
<span class="nc" id="L1643">			return SUCCESS;</span>
<span class="nc bnc" id="L1644" title="All 2 branches missed.">		} else if (gameBean instanceof LottoPurchaseBean) {</span>

<span class="nc" id="L1646">			LottoPurchaseBean lottoPurchaseBean = (LottoPurchaseBean) gameBean;</span>
<span class="nc" id="L1647">			setLottoPurchaseBean(lottoPurchaseBean);</span>
<span class="nc" id="L1648">			session.setAttribute(&quot;REPRINT_TYPE&quot;, Util.getGameName(</span>
					lottoPurchaseBean.getGame_no()).toUpperCase()
					+ &quot;_REPRINT&quot;);
<span class="nc" id="L1651">			return SUCCESS;</span>
<span class="nc bnc" id="L1652" title="All 2 branches missed.">		} else if (gameBean instanceof KenoPurchaseBean) {</span>
<span class="nc" id="L1653">			logger.debug(&quot; kenoPurchaseBean reprint &quot;);</span>
<span class="nc" id="L1654">			KenoPurchaseBean kenoPurchaseBean = (KenoPurchaseBean) gameBean;</span>
<span class="nc" id="L1655">			setKenoPurchaseBean(kenoPurchaseBean);</span>
<span class="nc" id="L1656">			session.setAttribute(&quot;REPRINT_TYPE&quot;, Util.getGameName(</span>
					kenoPurchaseBean.getGame_no()).toUpperCase()
					+ &quot;_REPRINT&quot;);
<span class="nc" id="L1659">			return SUCCESS;</span>
<span class="nc bnc" id="L1660" title="All 4 branches missed.">		} else if (gameBean instanceof String</span>
				&amp;&amp; &quot;RG_RPERINT&quot;.equals(gameBean.toString())) {
<span class="nc" id="L1662">			errMsg = DGErrorMsg.buyErrMsg(gameBean.toString());</span>
<span class="nc" id="L1663">			session.setAttribute(&quot;REPRINT_TYPE_ERROR&quot;, errMsg);</span>
<span class="nc" id="L1664">			session.setAttribute(&quot;boReprintErrMsg&quot;, errMsg);</span>
<span class="nc" id="L1665">			return ERROR;</span>
<span class="nc bnc" id="L1666" title="All 2 branches missed.">		} else if (gameBean instanceof String) {</span>
<span class="nc" id="L1667">			errMsg = (String) gameBean;</span>
<span class="nc" id="L1668">			session.setAttribute(&quot;REPRINT_TYPE_ERROR&quot;, errMsg);</span>
<span class="nc" id="L1669">			session.setAttribute(&quot;boReprintErrMsg&quot;, errMsg);</span>
<span class="nc" id="L1670">			return ERROR;</span>
		}
<span class="nc" id="L1672">		session.setAttribute(&quot;boReprintErrMsg&quot;, errMsg);</span>

<span class="nc" id="L1674">		return ERROR;</span>
	}

	public String resultUserAssignEdit() {
<span class="nc" id="L1678">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L1679">		UserInfoBean userBean = (UserInfoBean) session</span>
				.getAttribute(&quot;USER_INFO&quot;);
<span class="nc" id="L1681">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc bnc" id="L1682" title="All 2 branches missed.">		if (!helper.authorizeUser(userBean.getUserId())) {</span>
<span class="nc" id="L1683">			return &quot;unauthorize&quot;;</span>
		}
		
<span class="nc bnc" id="L1686" title="All 2 branches missed.">		if(userStr != null){</span>
<span class="nc" id="L1687">			String[] userIdArr = userStr.split(&quot;,&quot;);</span>
<span class="nc" id="L1688">			user = new int[userIdArr.length];</span>
<span class="nc bnc" id="L1689" title="All 2 branches missed.">			for (int i = 0; i &lt; userIdArr.length; i++) {</span>
<span class="nc" id="L1690">				user[i] = Integer.parseInt(userIdArr[i]);</span>
			}
		}
		
<span class="nc" id="L1694">		int temp = 0;</span>
<span class="nc bnc" id="L1695" title="All 2 branches missed.">		for (int i = 0; i &lt; user.length; i++) {</span>
<span class="nc bnc" id="L1696" title="All 2 branches missed.">			if(user[i] == -1){</span>
<span class="nc bnc" id="L1697" title="All 2 branches missed.">				for (int j = i+1; j &lt; user.length; j++) {</span>
<span class="nc bnc" id="L1698" title="All 2 branches missed.">					if(user[j] != -1){</span>
<span class="nc" id="L1699">						temp = user[j];</span>
<span class="nc" id="L1700">						user[j] = user[i];</span>
<span class="nc" id="L1701">						user[i] = temp;</span>
					}
				}
			}
		}
		
<span class="nc" id="L1707">		session.setAttribute(&quot;BO_USER_ASSIGN_MESSAGE&quot;, helper.resultUserAssignEdit(gameId, user));</span>
<span class="nc" id="L1708">		return SUCCESS;</span>
	}

	public String resultUserAssignFetch() {
<span class="nc" id="L1712">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L1713">		UserInfoBean userBean = (UserInfoBean) session</span>
				.getAttribute(&quot;USER_INFO&quot;);
<span class="nc" id="L1715">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L1716">		List&lt;ResultSubmitBean&gt; userList = helper.resultUserAssignFetch();</span>
<span class="nc bnc" id="L1717" title="All 2 branches missed.">		if (!helper.authorizeUser(userBean.getUserId())) {</span>
<span class="nc" id="L1718">			return &quot;unauthorize&quot;;</span>
		}
<span class="nc" id="L1720">		resultUserAssignMenu();</span>
<span class="nc" id="L1721">		session.setAttribute(&quot;USER_LIST&quot;, userList);</span>
<span class="nc" id="L1722">		return SUCCESS;</span>
	}

	public String resultUserAssignMenu() {
<span class="nc" id="L1726">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L1727">		UserInfoBean userBean = (UserInfoBean) session</span>
				.getAttribute(&quot;USER_INFO&quot;);
<span class="nc" id="L1729">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
		//List&lt;ResultSubmitBean&gt; userList = helper.resultUserAssignFetch();
<span class="nc bnc" id="L1731" title="All 2 branches missed.">		if (!helper.authorizeUser(userBean.getUserId())) {</span>
<span class="nc" id="L1732">			return &quot;unauthorize&quot;;</span>
		}
<span class="nc" id="L1734">		int resultSubmitUsersCount = Integer.parseInt((String)ServletActionContext.getServletContext().getAttribute(&quot;RESULT_SUBMIT_USERS_COUNT&quot;));</span>
<span class="nc" id="L1735">		Map&lt;Integer, String&gt; boUsersMap = helper.fetchBoUserList(userBean.getUserId(), userBean.getUserType());</span>
<span class="nc" id="L1736">		session.setAttribute(&quot;BO_USER_LIST&quot;, boUsersMap);</span>
<span class="nc" id="L1737">		int resultSubmitUsersDB = boUsersMap.size();</span>
		
<span class="nc" id="L1739">		ArrayList&lt;Integer&gt; usersCount = new ArrayList&lt;Integer&gt;();</span>
<span class="nc" id="L1740">		int min = resultSubmitUsersCount;</span>
<span class="nc bnc" id="L1741" title="All 2 branches missed.">		if(resultSubmitUsersCount &gt; resultSubmitUsersDB){</span>
<span class="nc" id="L1742">			min = resultSubmitUsersDB;</span>
		}
		
<span class="nc bnc" id="L1745" title="All 2 branches missed.">		for (int i = 0; i &lt; min; i++) {</span>
<span class="nc" id="L1746">			usersCount.add(99);</span>
		}
		
<span class="nc" id="L1749">		session.setAttribute(&quot;BO_RESULT_ASSIGN_USERS_COUNT&quot;, usersCount);</span>
<span class="nc" id="L1750">		getGameData();</span>
<span class="nc" id="L1751">		return SUCCESS;</span>
	}

	public String resultUserAssignSave() {
<span class="nc" id="L1755">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L1756">		int gameId = Integer.parseInt(this.gameNo.split(&quot;-&quot;)[0]);</span>
<span class="nc" id="L1757">		int gameNo = Util.getGameNumberFromGameId(gameId);</span>
		
<span class="nc" id="L1759">		int temp = 0;</span>
<span class="nc bnc" id="L1760" title="All 2 branches missed.">		for (int i = 0; i &lt; user.length; i++) {</span>
<span class="nc bnc" id="L1761" title="All 2 branches missed.">			if(user[i] == -1){</span>
<span class="nc bnc" id="L1762" title="All 2 branches missed.">				for (int j = i+1; j &lt; user.length; j++) {</span>
<span class="nc bnc" id="L1763" title="All 2 branches missed.">					if(user[j] != -1){</span>
<span class="nc" id="L1764">						temp = user[j];</span>
<span class="nc" id="L1765">						user[j] = user[i];</span>
<span class="nc" id="L1766">						user[i] = temp;</span>
					}
				}
			}
		}
		
<span class="nc" id="L1772">		session.setAttribute(&quot;BO_USER_ASSIGN_MESSAGE&quot;, new DrawGameMgmtHelper().resultUserAssignSave(gameId, gameNo, user));</span>
<span class="nc" id="L1773">		return SUCCESS;</span>
	}

	public String saveDrawResult() throws Exception {
<span class="nc" id="L1777">		logger.debug(drawId + &quot;******&quot; + gameNo + &quot;**********&quot; + winNumber);</span>
<span class="nc" id="L1778">		int cardTypeVal = 0;</span>
<span class="nc" id="L1779">		String[] macNum = null;</span>
<span class="nc bnc" id="L1780" title="All 2 branches missed.">		if (winNumbers != null) {</span>
<span class="nc" id="L1781">			List&lt;Integer&gt; tmpList=new ArrayList&lt;Integer&gt;();</span>
<span class="nc bnc" id="L1782" title="All 2 branches missed.">			for(Integer winNum:winNumbers){</span>
<span class="nc bnc" id="L1783" title="All 2 branches missed.">				if(winNum!=null){</span>
<span class="nc" id="L1784">					tmpList.add(winNum);</span>
				}
			}
<span class="nc" id="L1787">			winNumbers=tmpList.toArray(new Integer[0]);</span>
		}
<span class="nc bnc" id="L1789" title="All 2 branches missed.">		if (winNumber.indexOf(&quot;,&quot;) != -1) {</span>
<span class="nc" id="L1790">			String[] winNum = winNumber.trim().split(&quot;,&quot;);</span>
<span class="nc" id="L1791">			winNumbers = new Integer[winNum.length];</span>
<span class="nc bnc" id="L1792" title="All 2 branches missed.">			if (&quot;FortuneTwo&quot;.equalsIgnoreCase(Util.getGameName(Integer</span>
					.parseInt(gameNo.trim())))) {
<span class="nc bnc" id="L1794" title="All 2 branches missed.">				for (int i = 0; i &lt; winNum.length; i++) {</span>
<span class="nc" id="L1795">					winNumbers[i] = Arrays.asList(</span>
							FortuneTwoConstants.fortuneData).indexOf(
							winNum[i].trim());
				}
<span class="nc bnc" id="L1799" title="All 2 branches missed.">			} else if (&quot;FortuneThree&quot;.equalsIgnoreCase(Util.getGameName(Integer</span>
					.parseInt(gameNo.trim())))) {
<span class="nc bnc" id="L1801" title="All 2 branches missed.">				for (int i = 0; i &lt; winNum.length; i++) {</span>
<span class="nc" id="L1802">					winNumbers[i] = Arrays.asList(</span>
							FortuneThreeConstants.fortuneData).indexOf(
							winNum[i].trim());
				}
<span class="nc bnc" id="L1806" title="All 2 branches missed.">			} else if(&quot;RainbowGame&quot;.equalsIgnoreCase(Util.getGameName(Integer.parseInt(gameNo.trim())))) {</span>
<span class="nc" id="L1807">				final String[][] colorArray = new String[][]{{&quot;13&quot;, &quot;Voilet&quot;}, {&quot;14&quot;, &quot;Indigo&quot;}, {&quot;15&quot;, &quot;Blue&quot;}, {&quot;16&quot;, &quot;Green&quot;}, {&quot;17&quot;, &quot;Yellow&quot;}, {&quot;18&quot;, &quot;Orange&quot;}, {&quot;19&quot;, &quot;Red&quot;}};</span>

<span class="nc bnc" id="L1809" title="All 2 branches missed.">				for (int i=0; i&lt;3; i++) {</span>
<span class="nc" id="L1810">					winNumbers[i] = Integer.parseInt(winNum[i].trim());</span>
				}
<span class="nc bnc" id="L1812" title="All 2 branches missed.">				for (int i=3; i&lt;winNum.length; i++) {</span>
<span class="nc bnc" id="L1813" title="All 2 branches missed.">					for(int j=0; j&lt;7; j++) {</span>
<span class="nc bnc" id="L1814" title="All 2 branches missed.">						if((winNum[i].trim()).equals(colorArray[j][1])) {</span>
<span class="nc" id="L1815">							winNumbers[i] = Integer.parseInt(colorArray[j][0]);</span>
<span class="nc" id="L1816">							break;</span>
						}
					}
				}
<span class="nc" id="L1820">			} else {</span>
<span class="nc bnc" id="L1821" title="All 4 branches missed.">				if(&quot;KenoFive&quot;.equalsIgnoreCase(Util.getGameMap().get(Integer.parseInt(gameNo)).getGameNameDev()) || &quot;KenoFour&quot;.equalsIgnoreCase(Util.getGameMap().get(Integer.parseInt(gameNo)).getGameNameDev())){</span>
<span class="nc" id="L1822">					macNum = macNumber.trim().split(&quot;,&quot;);</span>
<span class="nc" id="L1823">					macNumbers = new Integer[macNum.length];</span>
				}
<span class="nc bnc" id="L1825" title="All 2 branches missed.">				for (int i = 0; i &lt; winNum.length; i++) {</span>
<span class="nc" id="L1826">					winNumbers[i] = Integer.parseInt(winNum[i].trim());</span>
<span class="nc bnc" id="L1827" title="All 4 branches missed.">					if(&quot;KenoFive&quot;.equalsIgnoreCase(Util.getGameMap().get(Integer.parseInt(gameNo)).getGameNameDev()) ||  &quot;KenoFour&quot;.equalsIgnoreCase(Util.getGameMap().get(Integer.parseInt(gameNo)).getGameNameDev()))</span>
<span class="nc" id="L1828">						macNumbers[i] = Integer.parseInt(macNum[i].trim());</span>
				}
			}
<span class="nc" id="L1831">			winNumSize = winNum.length;</span>
<span class="nc" id="L1832">		} else {</span>
			try {
<span class="nc" id="L1834">				cardTypeVal = Integer.parseInt(winNumber);</span>
<span class="nc" id="L1835">			} catch (Exception e) {</span>
<span class="nc" id="L1836">			}</span>
		}
<span class="nc bnc" id="L1838" title="All 2 branches missed.">		if (winNumbers != null) {</span>
<span class="nc" id="L1839">			winNumSize = winNumbers.length;</span>
		}
<span class="nc" id="L1841">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L1842">		UserInfoBean userBean = (UserInfoBean) session</span>
				.getAttribute(&quot;USER_INFO&quot;);
<span class="nc" id="L1844">		System.out</span>
				.println(&quot;****userid**&quot; + userBean.getUserId() + &quot;**********&quot;);
<span class="nc" id="L1846">		ManualWinningBean mwBean = new ManualWinningBean();</span>
<span class="nc" id="L1847">		mwBean.setGameNumber(Util.getGameNumberFromGameId(Integer.parseInt(gameNo.toString()))+&quot;&quot;);</span>
<span class="nc" id="L1848">		mwBean.setGameId(Integer.parseInt(gameNo.toString()));</span>
<span class="nc" id="L1849">		mwBean.setDrawIds(new int[] { drawId });</span>
<span class="nc" id="L1850">		mwBean.setDrawType(new String[] { &quot;PMEM&quot; });</span>
<span class="nc" id="L1851">		mwBean.setCardType(new int[] { cardTypeVal });</span>
<span class="nc" id="L1852">		mwBean.setWinningNumbers(winNumbers);</span>
<span class="nc" id="L1853">		mwBean.setMachineNumbers(macNumbers);</span>
<span class="nc" id="L1854">		mwBean.setWinNumSize(winNumSize);</span>
<span class="nc" id="L1855">		mwBean.setUserId(userBean.getUserId());</span>
<span class="nc" id="L1856">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L1857">		session.setAttribute(&quot;MESSAGE&quot;, helper.saveDrawResult(mwBean));</span>
<span class="nc" id="L1858">		DrawGameRPOS.onStartNewData();</span>
<span class="nc" id="L1859">		return SUCCESS;</span>
	}

	public String getStartDate(String s) {
<span class="nc" id="L1863">		SimpleDateFormat df=new SimpleDateFormat(&quot;yyyy-mm-dd hh:mm:ss&quot;);</span>
<span class="nc" id="L1864">	    Calendar cal=Calendar.getInstance();</span>
	    Date d1;
<span class="nc" id="L1866">	    String str = null;</span>
	    try {
<span class="nc" id="L1868">			d1 = df.parse(s);</span>
		
<span class="nc" id="L1870">	    cal.setTime(d1);</span>
<span class="nc" id="L1871">	    cal.add(Calendar.DAY_OF_MONTH, -5);</span>
<span class="nc" id="L1872">		str = new Timestamp(cal.getTimeInMillis()).toString();</span>
<span class="nc" id="L1873">	    } catch (ParseException e) {</span>
<span class="nc" id="L1874">			e.printStackTrace();</span>
<span class="nc" id="L1875">		}</span>
<span class="nc" id="L1876">		return (str.substring(0, str.length()-2));</span>
	  }
	
	public void setAgentOrgName(String agentOrgName) {
<span class="nc" id="L1880">		this.agentOrgName = agentOrgName;</span>
<span class="nc" id="L1881">	}</span>

	public void setCancelMoneyStatus(String cancelMoneyStatus) {
<span class="nc" id="L1884">		this.cancelMoneyStatus = cancelMoneyStatus;</span>
<span class="nc" id="L1885">	}</span>

	public void setCardType(int[] cardType) {
<span class="nc" id="L1888">		this.cardType = cardType;</span>
<span class="nc" id="L1889">	}</span>

	public void setChangeType(String changeType) {
<span class="nc" id="L1892">		this.changeType = changeType;</span>
<span class="nc" id="L1893">	}</span>

	public void setDraw_day(String draw_day) {
<span class="nc" id="L1896">		this.draw_day = draw_day;</span>
<span class="nc" id="L1897">	}</span>

	public void setDraw_freeze_time(String[] draw_freeze_time) {
<span class="nc" id="L1900">		this.draw_freeze_time = draw_freeze_time;</span>
<span class="nc" id="L1901">	}</span>

	public void setDraw_time(String[] draw_time) {
<span class="nc" id="L1904">		this.draw_time = draw_time;</span>
<span class="nc" id="L1905">	}</span>

	public void setDrawId(int drawId) {
<span class="nc" id="L1908">		this.drawId = drawId;</span>
<span class="nc" id="L1909">	}</span>

	public void setDrawIds(int[] drawIds) {
<span class="nc" id="L1912">		this.drawIds = drawIds;</span>
<span class="nc" id="L1913">	}</span>

	public void setDrawScheduleBeanResultList(
			ArrayList&lt;DrawScheduleBeanResult&gt; drawScheduleBeanResultList) {
<span class="nc" id="L1917">		this.drawScheduleBeanResultList = drawScheduleBeanResultList;</span>
<span class="nc" id="L1918">	}</span>

	public void setDrawType(String[] drawType) {
<span class="nc" id="L1921">		this.drawType = drawType;</span>
<span class="nc" id="L1922">	}</span>

	public void setEnd_Date(String end_Date) {
<span class="nc" id="L1925">		this.end_Date = end_Date;</span>
<span class="nc" id="L1926">	}</span>

	public void setFortuneBean(FortunePurchaseBean fortuneBean) {
<span class="nc" id="L1929">		this.fortuneBean = fortuneBean;</span>
<span class="nc" id="L1930">	}</span>

	public void setFreezeTime(int freezeTime) {
<span class="nc" id="L1933">		this.freezeTime = freezeTime;</span>
<span class="nc" id="L1934">	}</span>

	public void setFromDate(String fromDate) {
<span class="nc" id="L1937">		this.fromDate = fromDate;</span>
<span class="nc" id="L1938">	}</span>

	public void setFromHour(String fromHour) {
<span class="nc" id="L1941">		this.fromHour = fromHour;</span>
<span class="nc" id="L1942">	}</span>

	public void setFromMin(String fromMin) {
<span class="nc" id="L1945">		this.fromMin = fromMin;</span>
<span class="nc" id="L1946">	}</span>

	public void setFromSec(String fromSec) {
<span class="nc" id="L1949">		this.fromSec = fromSec;</span>
<span class="nc" id="L1950">	}</span>

	public void setGameName(String gameName) {
<span class="nc" id="L1953">		this.gameName = gameName;</span>
<span class="nc" id="L1954">	}</span>

	public void setGameNo(String gameNo) {
<span class="nc" id="L1957">		this.gameNo = gameNo;</span>
<span class="nc" id="L1958">	}</span>

	public void setGameType(String gameType) {
<span class="nc" id="L1961">		this.gameType = gameType;</span>
<span class="nc" id="L1962">	}</span>

	public void setKenoPurchaseBean(KenoPurchaseBean kenoPurchaseBean) {
<span class="nc" id="L1965">		this.kenoPurchaseBean = kenoPurchaseBean;</span>
<span class="nc" id="L1966">	}</span>

	public void setLottoPurchaseBean(LottoPurchaseBean lottoPurchaseBean) {
<span class="nc" id="L1969">		this.lottoPurchaseBean = lottoPurchaseBean;</span>
<span class="nc" id="L1970">	}</span>

	public void setMessage(String message) {
<span class="nc" id="L1973">		this.message = message;</span>
<span class="nc" id="L1974">	}</span>

	public void setPerformStatus(String[] performStatus) {
<span class="nc" id="L1977">		this.performStatus = performStatus;</span>
<span class="nc" id="L1978">	}</span>

	public void setPostponeTime(int postponeTime) {
<span class="nc" id="L1981">		this.postponeTime = postponeTime;</span>
<span class="nc" id="L1982">	}</span>

	public void setRetName(String[] retName) {
<span class="nc" id="L1985">		this.retName = retName;</span>
<span class="nc" id="L1986">	}</span>

	public void setRetOrgName(String retOrgName) {
<span class="nc" id="L1989">		this.retOrgName = retOrgName;</span>
<span class="nc" id="L1990">	}</span>

	public void setSearch_type(String search_type) {
<span class="nc" id="L1993">		this.search_type = search_type;</span>
<span class="nc" id="L1994">	}</span>

	public void setServletRequest(HttpServletRequest servletRequest) {
<span class="nc" id="L1997">		this.servletRequest = servletRequest;</span>

<span class="nc" id="L1999">	}</span>

	public void setStart_date(String start_date) {
<span class="nc" id="L2002">		this.start_date = start_date;</span>
<span class="nc" id="L2003">	}</span>

	public void setStatus(String status) {
<span class="nc" id="L2006">		this.status = status;</span>
<span class="nc" id="L2007">	}</span>

	public void setSubHold(String subHold) {
<span class="nc" id="L2010">		this.subHold = subHold;</span>
<span class="nc" id="L2011">	}</span>

	public String setTempBean() {
<span class="nc" id="L2014">		System.out.println(&quot;inside initiate&quot;);</span>
<span class="nc" id="L2015">		HttpSession session = servletRequest.getSession();</span>
<span class="nc bnc" id="L2016" title="All 2 branches missed.">		if (gameType.equalsIgnoreCase(&quot;fortune&quot;)) {</span>
<span class="nc" id="L2017">			setFortuneBean((FortunePurchaseBean) session</span>
					.getAttribute(&quot;TEMP_BEAN&quot;));
<span class="nc bnc" id="L2019" title="All 2 branches missed.">		} else if (gameType.equalsIgnoreCase(&quot;lotto&quot;)) {</span>
<span class="nc" id="L2020">			setLottoPurchaseBean((LottoPurchaseBean) session</span>
					.getAttribute(&quot;TEMP_BEAN&quot;));
<span class="nc bnc" id="L2022" title="All 2 branches missed.">		} else if (gameType.equalsIgnoreCase(&quot;keno&quot;)) {</span>
<span class="nc" id="L2023">			setKenoPurchaseBean((KenoPurchaseBean) session</span>
					.getAttribute(&quot;TEMP_BEAN&quot;));
		}
<span class="nc" id="L2026">		return SUCCESS;</span>
	}

	public void setTicketNo(String ticketNo) {
<span class="nc" id="L2030">		this.ticketNo = ticketNo;</span>
<span class="nc" id="L2031">	}</span>

	public void setTicketNum(String ticketNum) {
<span class="nc" id="L2034">		this.ticketNum = ticketNum;</span>
<span class="nc" id="L2035">	}</span>

	public void setTicketNumArr(String[] ticketNumArr) {
<span class="nc" id="L2038">		this.ticketNumArr = ticketNumArr;</span>
<span class="nc" id="L2039">	}</span>

	public void setToDate(String toDate) {
<span class="nc" id="L2042">		this.toDate = toDate;</span>
<span class="nc" id="L2043">	}</span>

	public void setToHour(String toHour) {
<span class="nc" id="L2046">		this.toHour = toHour;</span>
<span class="nc" id="L2047">	}</span>

	public void setToMin(String toMin) {
<span class="nc" id="L2050">		this.toMin = toMin;</span>
<span class="nc" id="L2051">	}</span>

	public void setToSec(String toSec) {
<span class="nc" id="L2054">		this.toSec = toSec;</span>
<span class="nc" id="L2055">	}</span>

	public void setType(String type) {
<span class="nc" id="L2058">		this.type = type;</span>
<span class="nc" id="L2059">	}</span>

	public void setUser1(int user1) {
<span class="nc" id="L2062">		this.user1 = user1;</span>
<span class="nc" id="L2063">	}</span>

	public void setUser2(int user2) {
<span class="nc" id="L2066">		this.user2 = user2;</span>
<span class="nc" id="L2067">	}</span>

	public void setWinNumber(String winNumber) {
<span class="nc" id="L2070">		this.winNumber = winNumber;</span>
<span class="nc" id="L2071">	}</span>

	public void setWinNumbers(Integer[] winNumbers) {
<span class="nc" id="L2074">		this.winNumbers = winNumbers;</span>
<span class="nc" id="L2075">	}</span>

	public void setWinNumSize(int winNumSize) {
<span class="nc" id="L2078">		this.winNumSize = winNumSize;</span>
<span class="nc" id="L2079">	}</span>

	public String ticketCancellationMenu() throws LMSException {
		try {
<span class="nc" id="L2083">			HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L2084">			UserInfoBean userBean = (UserInfoBean) session</span>
					.getAttribute(&quot;USER_INFO&quot;);
			//List&lt;String&gt; agentOrgList = new AjaxRequestHelper().getAgents(
				//	&quot;agent&quot;, userBean);
			// session.setAttribute(&quot;AgentOrgList&quot;, agentOrgList);
<span class="nc" id="L2089">			session.setAttribute(&quot;DRAWGAME_LIST&quot;,ReportUtility.fetchGameMapWithoutPromo());</span>
<span class="nc" id="L2090">			session.setAttribute(&quot;RetOrgList&quot;, new ArrayList&lt;String&gt;());</span>
<span class="nc" id="L2091">		} catch (Exception e) {</span>
<span class="nc" id="L2092">			e.printStackTrace();</span>
<span class="nc" id="L2093">			throw new LMSException(&quot;Error in ticketCancellationMenu&quot;);</span>
<span class="nc" id="L2094">		}</span>
<span class="nc" id="L2095">		return SUCCESS;</span>
	}

	public String ticketWinStatus() throws Exception {
<span class="nc" id="L2099">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L2100">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L2101">		session.setAttribute(&quot;TKT_WIN_STATUS&quot;, helper</span>
				.ticketWinStatus(ticketNum));
<span class="nc" id="L2103">		return SUCCESS;</span>
	}

	public String transTicketWinStatus() throws Exception {
		
<span class="nc" id="L2108">		Connection con = null;</span>
<span class="nc" id="L2109">		ServletContext sc = null;</span>
<span class="nc" id="L2110">		HttpSession session = null;</span>
<span class="nc" id="L2111">		SimpleDateFormat sdf = null;</span>
<span class="nc" id="L2112">		Timestamp txDateDate = null;</span>
<span class="nc" id="L2113">		Timestamp uIdChangeDate = null; </span>
		
<span class="nc" id="L2115">		int userId=0;</span>
<span class="nc" id="L2116">		int gameId = 0;</span>
<span class="nc" id="L2117">		int gameNumber = 0;</span>
<span class="nc" id="L2118">		int dayOfYear = 0;</span>
<span class="nc" id="L2119">		long transTickNum = 0;</span>

<span class="nc" id="L2121">		String tickNum = &quot;&quot;;</span>
<span class="nc" id="L2122">		String[] arr = null;</span>
<span class="nc" id="L2123">		Calendar cal = null;</span>
<span class="nc" id="L2124">		String query =  null;</span>
		try {
<span class="nc" id="L2126">			session = servletRequest.getSession();</span>
<span class="nc" id="L2127">			session.setAttribute(&quot;TKT_WIN_STATUS&quot; , null);</span>
<span class="nc" id="L2128">			sc = ServletActionContext.getServletContext();</span>
<span class="nc" id="L2129">			gameId = Integer.parseInt(gameNo);</span>
<span class="nc" id="L2130">			gameNumber = Util.getGameNumberFromGameId(gameId);</span>

<span class="nc" id="L2132">			sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span>
<span class="nc" id="L2133">			txDateDate = new java.sql.Timestamp(sdf.parse(sale_date).getTime());</span>
<span class="nc" id="L2134">			uIdChangeDate = new java.sql.Timestamp(sdf.parse((String) sc.getAttribute(&quot;USER_MAPPING_ID_DEPLOYMENT_DATE&quot;)).getTime());</span>
<span class="nc" id="L2135">			arr = sale_date.split(&quot;-&quot;);</span>
<span class="nc" id="L2136">			cal = Calendar.getInstance();</span>
<span class="nc" id="L2137">			cal.set(Integer.parseInt(arr[0]), Integer.parseInt(arr[1]) - 1,	Integer.parseInt(arr[2]));</span>
<span class="nc" id="L2138">			dayOfYear = cal.get(Calendar.DAY_OF_YEAR);</span>

<span class="nc" id="L2140">			con = DBConnect.getConnection();</span>
<span class="nc" id="L2141">			userId = ReportUtility.getUserIdFromOrgId(retOrgId , con);</span>
<span class="nc bnc" id="L2142" title="All 2 branches missed.">			if (uIdChangeDate.after(txDateDate)) { // OLD TICKET</span>
<span class="nc" id="L2143">				transTickNum = ((long) (((userId * 10 + gameNumber) * 1000) + dayOfYear) * 10000 + transNo);</span>
<span class="nc" id="L2144">				query = &quot;select ticket_nbr from st_dg_ret_sale_&quot; + gameId</span>
						+ &quot; where ticket_nbr like '&quot; + transTickNum + &quot;%'&quot;;
			} else { // NEW TICKET
<span class="nc" id="L2147">				userId = Util.getMappingIdFromTxId(txDateDate, userId , con);</span>
<span class="nc" id="L2148">				transTickNum = (long)(((3 * 10 + gameNumber) * 1000) + dayOfYear)*100000000 + (userId * 1000 + transNo);</span>
<span class="nc" id="L2149">				query = &quot;select ticket_nbr from st_dg_ret_sale_&quot; + gameId</span>
						+ &quot; where ticket_nbr like '%&quot; + transTickNum + &quot;%'&quot;;
			}

<span class="nc" id="L2153">			tickNum = Util.getTickNumberFromTransTickNo(transTickNum, gameId,query,con);</span>
<span class="nc" id="L2154">			DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L2155">			session.setAttribute(&quot;TKT_WIN_STATUS&quot;, helper.ticketWinStatus(tickNum));</span>
<span class="nc" id="L2156">		}catch (LMSException e) {</span>
<span class="nc" id="L2157">			e.printStackTrace();</span>
<span class="nc" id="L2158">		}catch (Exception e) {</span>
<span class="nc" id="L2159">			e.printStackTrace();</span>
		}finally{
<span class="nc" id="L2161">			DBConnect.closeCon(con);</span>
<span class="nc" id="L2162">		}</span>

<span class="nc" id="L2164">		return SUCCESS;</span>
	}
	
	public String agtTrackTicket() throws Exception {
<span class="nc" id="L2168">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L2169">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L2170">		session.setAttribute(&quot;TKT_WIN_STATUS&quot;, helper</span>
				.ticketWinStatus(ticketNum));
<span class="nc" id="L2172">		return SUCCESS;</span>
	}
	
	public void fetchCancelDrawData() throws IOException{
<span class="nc" id="L2176">		PrintWriter out = response.getWriter();</span>
<span class="nc" id="L2177">		List&lt;Integer&gt; drawIdList = new ArrayList&lt;Integer&gt;();</span>
<span class="nc" id="L2178">		drawIdList.add(Integer.parseInt(drawIdString));</span>
	//	gameNo = gameNo.substring(0, gameNo.lastIndexOf(&quot;-&quot;));
<span class="nc" id="L2180">		DrawScheduleBean drawScheduleBean = new DrawScheduleBean();</span>
<span class="nc" id="L2181">		drawScheduleBean.setDrawIdList(drawIdList);</span>
<span class="nc" id="L2182">		drawScheduleBean.setGameNo(Integer.parseInt(gameNo));</span>
<span class="nc" id="L2183">		DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L2184">		String res = helper.fetchCancelDrawData(drawScheduleBean);</span>
<span class="nc" id="L2185">		out.write(res);</span>
<span class="nc" id="L2186">		out.flush();</span>
<span class="nc" id="L2187">	}</span>
/**
 * This Method Show Draw Wise+Agent Wise  DATA OF LMS SALE IN DGE. 
 * @return
 * @throws Exception
 */
	public String fetchDrawDataForLMS() throws Exception {

<span class="nc" id="L2195">		logger.info(&quot;startDate is&quot; + dateOfDraw + &quot; endDate is&quot; + end_Date</span>
				+ &quot; agentOrgId &quot; + agentOrgId + &quot; gameNo&quot; + gameNo + &quot;Before--&quot;
				+ new Date());
		try {
		
<span class="nc" id="L2200">			int gameId = Integer.parseInt(gameNo);</span>
<span class="nc bnc" id="L2201" title="All 4 branches missed.">			if (gameId &gt; 0 &amp;&amp; dateOfDraw != null) {</span>
<span class="nc" id="L2202">				DrawDataBean drawDataBean = new DrawDataBean();</span>
<span class="nc" id="L2203">				drawDataBean.setAgentOrgId(agentOrgId);</span>
				// The to date has been Hard Code to Avoid Use of calendar and
				// appended
				// with 23:59:59 to achieve the data
				// corresponding to the midnight of given date
<span class="nc" id="L2208">				drawDataBean.setFromDate(dateOfDraw + &quot; 00:00:00&quot;);</span>
<span class="nc" id="L2209">				drawDataBean.setToDate(end_Date + &quot; 23:59:59&quot;);</span>
<span class="nc" id="L2210">				drawDataBean.setGameNo(gameId);</span>
<span class="nc" id="L2211">				drawDataBean.setDrawName(drawName);</span>
				
<span class="nc" id="L2213">				ServletContext sc = ServletActionContext.getServletContext();</span>
<span class="nc" id="L2214">				String raffleTktType = (String) sc.getAttribute(&quot;raffle_ticket_type&quot;);</span>
<span class="nc" id="L2215">				String refMerchantId = (String) sc.getAttribute(&quot;REF_MERCHANT_ID&quot;);</span>
<span class="nc" id="L2216">				drawDataBean.setMerchantId(refMerchantId);</span>
<span class="nc" id="L2217">				DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L2218">				DGConsolidateGameDataBean gameDataBean = null;</span>
<span class="nc" id="L2219">				gameDataBean = helper.fetchDrawGameDataForLMS(drawDataBean,</span>
						raffleTktType, stateCode, CityCode);
<span class="nc bnc" id="L2221" title="All 2 branches missed.">				if (gameDataBean != null) {</span>
<span class="nc" id="L2222">					drawDataBeanList = (ArrayList&lt;DGConsolidateDrawBean&gt;) gameDataBean</span>
							.getDrawDataBeanList();
<span class="nc" id="L2224">					logger.info(&quot;Got Draw Game Data : &quot;+drawDataBeanList.size());</span>
<span class="nc" id="L2225">					setGameId(gameId);</span>
<span class="nc" id="L2226">					return SUCCESS;</span>
				}
<span class="nc" id="L2228">			} else {</span>
<span class="nc" id="L2229">				logger.info(&quot;Incorrect Inputs &quot;);</span>
<span class="nc" id="L2230">				addActionMessage(&quot;Please Enter Correct Values&quot;);</span>
<span class="nc" id="L2231">				return ERROR;</span>
			}
<span class="nc" id="L2233">		}catch(Exception e){</span>
<span class="nc" id="L2234">			e.printStackTrace();</span>
<span class="nc" id="L2235">			addActionMessage(&quot;Some Error In Draw Data &quot;);</span>
			
<span class="nc" id="L2237">		}</span>
<span class="nc" id="L2238">		return ERROR;</span>
		
	}
	public String  fetchPromoGameDetails(){
<span class="nc" id="L2242">		ObjectOutputStream oos =null;</span>
<span class="nc" id="L2243">		ObjectInputStream ois =null;</span>
		try{
<span class="nc" id="L2245">			ByteArrayOutputStream bos =new ByteArrayOutputStream();</span>
<span class="nc" id="L2246">			oos =new ObjectOutputStream(bos);</span>
<span class="nc" id="L2247">			oos.writeObject(Util.promoGameBeanMap);</span>
<span class="nc" id="L2248">			oos.flush();    </span>
<span class="nc" id="L2249">			ByteArrayInputStream bin =  new ByteArrayInputStream(bos.toByteArray()); </span>
<span class="nc" id="L2250">			ois = new ObjectInputStream(bin);  </span>
<span class="nc" id="L2251">			setPromoGameBeanMap((Map&lt;Integer, List&lt;PromoGameBean&gt;&gt;) ois.readObject());</span>
<span class="nc" id="L2252">		}catch(Exception e){</span>
<span class="nc" id="L2253">			addActionMessage(&quot;Some Internal Error IN Displaying Game Info&quot;);</span>
<span class="nc" id="L2254">			logger.error(&quot;Errro&quot;,e);</span>
<span class="nc" id="L2255">		}</span>
<span class="nc" id="L2256">	return SUCCESS;</span>
		
		
	}
	
	public void  updateFreeTicket(){
		
<span class="nc" id="L2263">		boolean isUpdated=false;</span>
		try{
<span class="nc" id="L2265">			PrintWriter out = servletResponse.getWriter();</span>
<span class="nc" id="L2266">			servletResponse.setContentType(&quot;text/html&quot;);</span>
<span class="nc" id="L2267">			logger.debug(promoGameId+saleGameId+promoTicekts);</span>
			
			
<span class="nc bnc" id="L2270" title="All 6 branches missed.">			if(promoGameId&lt;=0 ||saleGameId&lt;=0||promoTicekts&lt;0){</span>
<span class="nc" id="L2271">				out.print(&quot;Error | Please Provide Valid Input&quot;);</span>
<span class="nc" id="L2272">				return ;</span>
			}
<span class="nc bnc" id="L2274" title="All 2 branches missed.">			if(promoTicekts&gt;15){</span>
<span class="nc" id="L2275">				out.print(&quot;Error |Please Provide Valid Value For Promo Tickets&quot;);</span>
<span class="nc" id="L2276">				return ;</span>
			}
<span class="nc" id="L2278">			HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L2279">			UserInfoBean uib = (UserInfoBean) session.getAttribute(&quot;USER_INFO&quot;);</span>
<span class="nc" id="L2280">			 isUpdated =DrawGameMgmtHelper.updateFreeTicket(uib,saleGameId, promoGameId, promoTicekts);</span>
<span class="nc bnc" id="L2281" title="All 2 branches missed.">			 if(isUpdated){</span>
<span class="nc" id="L2282">				 out.print(&quot;Success|Promo Ticket Value Updated Successfully&quot;+&quot;|&quot;+promoTicekts);</span>
<span class="nc" id="L2283">				 return ;</span>
			 }else{
				 
<span class="nc" id="L2286">				 out.print(&quot;Error|Error In Promo Ticket Value Updatation&quot;);</span>
<span class="nc" id="L2287">				 return ;</span>
			 }
			 
<span class="nc" id="L2290">		}catch (Exception e) {</span>
<span class="nc" id="L2291">			addActionError(&quot;Error In Promo Ticket Udpation !!&quot;);</span>
<span class="nc" id="L2292">			logger.error(&quot;Exception in update free ticket&quot;,e);</span>
		}
<span class="nc" id="L2294">		return ;</span>
	
		
	}
	
	public String drawWiseWinTicketDetails() {
<span class="nc" id="L2300">		SimpleDateFormat sdf = null;</span>
<span class="nc" id="L2301">		Timestamp uIdChangeDate = null;</span>
<span class="nc" id="L2302">		TicketWiseDataBean ticketBean = null;</span>
<span class="nc" id="L2303">		AnalysisBean anaBean=null;</span>
		try{
<span class="nc" id="L2305">			anaBean = new AnalysisBean();</span>
<span class="nc" id="L2306">			ServletContext sc = ServletActionContext.getServletContext();</span>
<span class="nc" id="L2307">			String refMerchantId = (String) sc.getAttribute(&quot;REF_MERCHANT_ID&quot;);</span>
<span class="nc" id="L2308">			setDrawName(drawName);</span>
<span class="nc" id="L2309">			sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span>
<span class="nc" id="L2310">			anaBean.setMerchantId(refMerchantId);</span>
<span class="nc" id="L2311">			uIdChangeDate = new java.sql.Timestamp(sdf.parse(Utility.getPropertyValue(&quot;USER_MAPPING_ID_DEPLOYMENT_DATE&quot;)).getTime());</span>
<span class="nc" id="L2312">			ticketBean = new DrawGameMgmtHelper().getConsolidatedTicketsForDraw(gameId,agentOrgId,drawName,start_date,uIdChangeDate,anaBean,status);</span>
<span class="nc" id="L2313">			setAnalist(ticketBean.getAnaBeanList());</span>
<span class="nc" id="L2314">			setMessage(ticketBean.getErrorMessage());</span>
<span class="nc" id="L2315">			setStart_date(start_date);	</span>
<span class="nc" id="L2316">		}catch (Exception e) {</span>
<span class="nc" id="L2317">			e.printStackTrace();</span>
<span class="nc bnc" id="L2318" title="All 2 branches missed.">			if(ticketBean == null){</span>
<span class="nc" id="L2319">				ticketBean = new TicketWiseDataBean();</span>
<span class="nc" id="L2320">				ticketBean.setErrorCode(LMSErrors.GENERAL_EXCEPTION_ERROR_CODE);</span>
<span class="nc" id="L2321">				ticketBean.setErrorMessage(LMSErrors.GENERAL_EXCEPTION_ERROR_MESSAGE);</span>
			}
<span class="nc" id="L2323">		}</span>
<span class="nc" id="L2324">		return SUCCESS;</span>
	}
	
	public void drawWiseWinTicketDetailsExport() throws IOException {
<span class="nc" id="L2328">		response.setContentType(&quot;application/vnd.ms-excel&quot;);</span>
<span class="nc" id="L2329">		response.setHeader(&quot;Content-Disposition&quot;,&quot;attachment; filename=TicketWiseDetails.xls&quot;);</span>
<span class="nc" id="L2330">		PrintWriter out = response.getWriter();</span>
<span class="nc bnc" id="L2331" title="All 2 branches missed.">		if (valueToSend != null) {</span>
<span class="nc" id="L2332">			valueToSend = valueToSend.replaceAll(&quot;&lt;tbody&gt;&quot;, &quot;&quot;).replaceAll(&quot;&lt;/tbody&gt;&quot;, &quot;&quot;).trim();</span>
<span class="nc" id="L2333">			out.write(valueToSend);</span>
		}
<span class="nc" id="L2335">	}</span>
	
	public String fetchGameInfo(){
<span class="nc" id="L2338">		setDrawGameInfo(ReportUtility.fetchActiveGameDrawDataMenu());</span>
<span class="nc" id="L2339">		return SUCCESS;</span>
	}
	
	public String blockBunchTicket() throws ParseException{
		try{
<span class="nc" id="L2344">			int userId =  ((UserInfoBean) servletRequest.getSession().getAttribute(&quot;USER_INFO&quot;)).getUserId();</span>
<span class="nc" id="L2345">			ServletContext sc=LMSUtility.sc;</span>
<span class="nc" id="L2346">			String countryName=(String)sc.getAttribute(&quot;COUNTRY_DEPLOYED&quot;);</span>
<span class="nc" id="L2347">			Timestamp requesInitiateTime = new Timestamp(System.currentTimeMillis());</span>
<span class="nc" id="L2348">			List&lt;BlockTicketUserBean&gt; blockTicketUserBeanList = new DrawGameMgmtHelper().blockBunchTicket</span>
														(userId, ticketNumArr , requesInitiateTime, &quot;&quot; ,ticketStatusArr,countryName);
<span class="nc bnc" id="L2350" title="All 2 branches missed.">			if(blockTicketUserBeanList == null){</span>
<span class="nc" id="L2351">				setMessage(&quot; Contact Customer Support for this ticket !!!! &quot;);</span>
			}else {
<span class="nc" id="L2353">				setMessage(null);</span>
			}
<span class="nc" id="L2355">			setBlockTicketUserBeanList(blockTicketUserBeanList);</span>
<span class="nc" id="L2356">		}catch (Exception e) {</span>
<span class="nc" id="L2357">			e.printStackTrace();</span>
<span class="nc" id="L2358">			setMessage(&quot; Contact Customer Support for this ticket !!!! &quot;);</span>
<span class="nc" id="L2359">		}</span>
<span class="nc" id="L2360">		return SUCCESS;</span>
	}
	
	private String criteria;
	
	public String getTicketsToUnblock() throws ParseException{
		
		try{
<span class="nc" id="L2368">			List&lt;BlockTicketUserBean&gt; blockTicketUserBeanList = new DrawGameMgmtHelper().getTicketsToBlockUnblock(criteria , ticketNo , agentOrgId , retOrgId , Integer.parseInt(gameNo) , reason);</span>
<span class="nc bnc" id="L2369" title="All 2 branches missed.">			if(blockTicketUserBeanList == null){</span>
<span class="nc" id="L2370">				setMessage(&quot; Contact Customer Support for this ticket !!!! &quot;);</span>
			}else {
<span class="nc" id="L2372">				setBlockTicketUserBeanList(blockTicketUserBeanList);</span>
			}
<span class="nc" id="L2374">			setReasons(null);</span>
<span class="nc" id="L2375">		}catch (Exception e) {</span>
<span class="nc" id="L2376">			e.printStackTrace();</span>
<span class="nc" id="L2377">			setMessage(&quot; Contact Customer Support for this ticket !!!! &quot;);</span>
<span class="nc" id="L2378">		}</span>
<span class="nc" id="L2379">		return SUCCESS;</span>
	}
	
	public String unblockSpecificTicket() throws ParseException{
		
		try{
<span class="nc" id="L2385">			int userId =  ((UserInfoBean) servletRequest.getSession().getAttribute(&quot;USER_INFO&quot;)).getUserId();</span>
<span class="nc" id="L2386">			ServletContext sc=LMSUtility.sc;</span>
<span class="nc" id="L2387">			String countryName=(String)sc.getAttribute(&quot;COUNTRY_DEPLOYED&quot;);</span>
<span class="nc" id="L2388">			Timestamp requesInitiateTime = new Timestamp(System.currentTimeMillis());</span>
<span class="nc" id="L2389">			ArrayList&lt;BlockTicketUserBean&gt; blockTicketUserBeanList = new DrawGameMgmtHelper().unblockBunchTicket</span>
														(userId, ticketNumArr , requesInitiateTime, reasons,countryName);
<span class="nc bnc" id="L2391" title="All 2 branches missed.">			if(blockTicketUserBeanList == null){</span>
<span class="nc" id="L2392">				setMessage(&quot; Contact Customer Support for this ticket !!!! &quot;);</span>
			}else {
<span class="nc" id="L2394">				setBlockTicketUserBeanList(blockTicketUserBeanList);</span>
			}
<span class="nc" id="L2396">		}catch (Exception e) {</span>
<span class="nc" id="L2397">			e.printStackTrace();</span>
<span class="nc" id="L2398">			setMessage(&quot; Contact Customer Support for this ticket !!!! &quot;);</span>
<span class="nc" id="L2399">		}</span>
<span class="nc" id="L2400">		return SUCCESS;</span>
	}
	
	public void validate (){
<span class="nc" id="L2404">	}</span>
	public int getMsgId() {
<span class="nc" id="L2406">		return msgId;</span>
	}

	public void setMsgId(int msgId) {
<span class="nc" id="L2410">		this.msgId = msgId;</span>
<span class="nc" id="L2411">	}</span>

	public String getDrawName() {
<span class="nc" id="L2414">		return drawName;</span>
	}

	public void setDrawName(String drawName) {
<span class="nc" id="L2418">		this.drawName = drawName;</span>
<span class="nc" id="L2419">	}</span>

	public int[] getUser() {
<span class="nc" id="L2422">		return user;</span>
	}

	public void setUser(int[] user) {
<span class="nc" id="L2426">		this.user = user;</span>
<span class="nc" id="L2427">	}</span>

	public String getUserStr() {
<span class="nc" id="L2430">		return userStr;</span>
	}

	public void setUserStr(String userStr) {
<span class="nc" id="L2434">		this.userStr = userStr;</span>
<span class="nc" id="L2435">	}</span>

	public int getAgentOrgId() {
<span class="nc" id="L2438">		return agentOrgId;</span>
	}

	public void setAgentOrgId(int agentOrgId) {
<span class="nc" id="L2442">		this.agentOrgId = agentOrgId;</span>
<span class="nc" id="L2443">	}</span>

	public int getRetOrgId() {
<span class="nc" id="L2446">		return retOrgId;</span>
	}

	public void setRetOrgId(int retOrgId) {
<span class="nc" id="L2450">		this.retOrgId = retOrgId;</span>
<span class="nc" id="L2451">	}</span>

	public String getSale_date() {
<span class="nc" id="L2454">		return sale_date;</span>
	}

	public void setSale_date(String saleDate) {
<span class="nc" id="L2458">		sale_date = saleDate;</span>
<span class="nc" id="L2459">	}</span>

	public String getDrawIdString() {
<span class="nc" id="L2462">		return drawIdString;</span>
	}

	public void setDrawIdString(String drawIdString) {
<span class="nc" id="L2466">		this.drawIdString = drawIdString;</span>
<span class="nc" id="L2467">	}</span>

	public HttpServletResponse getServletResponse() {
<span class="nc" id="L2470">		return servletResponse;</span>
	}

	public HttpServletRequest getServletRequest() {
<span class="nc" id="L2474">		return servletRequest;</span>
	}

	public String getAction() {
<span class="nc" id="L2478">		return action;</span>
	}

	public void setAction(String action) {
<span class="nc" id="L2482">		this.action = action;</span>
<span class="nc" id="L2483">	}</span>

	public ArrayList&lt;DGConsolidateDrawBean&gt; getDrawDataBeanList() {
<span class="nc" id="L2486">		return drawDataBeanList;</span>
	}

	public void setDrawDataBeanList(
			ArrayList&lt;DGConsolidateDrawBean&gt; drawDataBeanList) {
<span class="nc" id="L2491">		this.drawDataBeanList = drawDataBeanList;</span>
<span class="nc" id="L2492">	}</span>

	public String getDateOfDraw() {
<span class="nc" id="L2495">		return dateOfDraw;</span>
	}

	public void setDateOfDraw(String dateOfDraw) {
<span class="nc" id="L2499">		this.dateOfDraw = dateOfDraw;</span>
<span class="nc" id="L2500">	}</span>

	public String[] getReasons() {
<span class="nc" id="L2503">		return reasons;</span>
	}

	public void setReasons(String[] reasons) {
<span class="nc" id="L2507">		this.reasons = reasons;</span>
<span class="nc" id="L2508">	}</span>

	public HashMap&lt;Integer, String&gt; getCommSerList() {
<span class="nc" id="L2511">		return commSerList;</span>
	}

	public void setCommSerList(HashMap&lt;Integer, String&gt; commSerList) {
<span class="nc" id="L2515">		this.commSerList = commSerList;</span>
<span class="nc" id="L2516">	}</span>

	public HashMap&lt;Integer, String&gt; getDrawSerList() {
<span class="nc" id="L2519">		return drawSerList;</span>
	}

	public void setDrawSerList(HashMap&lt;Integer, String&gt; drawSerList) {
<span class="nc" id="L2523">		this.drawSerList = drawSerList;</span>
<span class="nc" id="L2524">	}</span>

	public Map&lt;Integer, String&gt; getOlaSerList() {
<span class="nc" id="L2527">		return olaSerList;</span>
	}

	public void setOlaSerList(Map&lt;Integer, String&gt; olaSerList) {
<span class="nc" id="L2531">		this.olaSerList = olaSerList;</span>
<span class="nc" id="L2532">	}</span>

	public Map&lt;Integer, List&lt;PromoGameBean&gt;&gt; getPromoGameBeanMap() {
<span class="nc" id="L2535">		return promoGameBeanMap;</span>
	}

	public void setPromoGameBeanMap(
			Map&lt;Integer, List&lt;PromoGameBean&gt;&gt; promoGameBeanMap) {
<span class="nc" id="L2540">		this.promoGameBeanMap = promoGameBeanMap;</span>
<span class="nc" id="L2541">	}</span>

	public int getPromoGameId() {
<span class="nc" id="L2544">		return promoGameId;</span>
	}

	public int getSaleGameId() {
<span class="nc" id="L2548">		return saleGameId;</span>
	}

	public int getPromoTicekts() {
<span class="nc" id="L2552">		return promoTicekts;</span>
	}

	public void setPromoGameId(int promoGameId) {
<span class="nc" id="L2556">		this.promoGameId = promoGameId;</span>
<span class="nc" id="L2557">	}</span>

	public void setSaleGameId(int saleGameId) {
<span class="nc" id="L2560">		this.saleGameId = saleGameId;</span>
<span class="nc" id="L2561">	}</span>

	public void setPromoTicekts(int promoTicekts) {
<span class="nc" id="L2564">		this.promoTicekts = promoTicekts;</span>
<span class="nc" id="L2565">	}</span>

	public List&lt;AnalysisReportDrawBean&gt; getAnalist() {
<span class="nc" id="L2568">		return analist;</span>
	}

	public void setAnalist(List&lt;AnalysisReportDrawBean&gt; analist) {
<span class="nc" id="L2572">		this.analist = analist;</span>
<span class="nc" id="L2573">	}</span>

	public String[] getTicketStatusArr() {
<span class="nc" id="L2576">		return ticketStatusArr;</span>
	}

	public void setTicketStatusArr(String[] ticketStatusArr) {
<span class="nc" id="L2580">		this.ticketStatusArr = ticketStatusArr;</span>
<span class="nc" id="L2581">	}</span>

	public List&lt;BlockTicketUserBean&gt; getBlockTicketUserBeanList() {
<span class="nc" id="L2584">		return blockTicketUserBeanList;</span>
	}

	public void setBlockTicketUserBeanList(
			List&lt;BlockTicketUserBean&gt; blockTicketUserBeanList) {
<span class="nc" id="L2589">		this.blockTicketUserBeanList = blockTicketUserBeanList;</span>
<span class="nc" id="L2590">	}</span>

	public HashMap&lt;Integer, String&gt; getDrawGameInfo() {
<span class="nc" id="L2593">		return drawGameInfo;</span>
	}

	public void setDrawGameInfo(HashMap&lt;Integer, String&gt; drawGameInfo) {
<span class="nc" id="L2597">		this.drawGameInfo = drawGameInfo;</span>
<span class="nc" id="L2598">	}</span>

	public String getCriteria() {
<span class="nc" id="L2601">		return criteria;</span>
	}

	public void setCriteria(String criteria) {
<span class="nc" id="L2605">		this.criteria = criteria;</span>
<span class="nc" id="L2606">	}</span>

	public String getReason() {
<span class="nc" id="L2609">		return reason;</span>
	}

	public void setReason(String reason) {
<span class="nc" id="L2613">		this.reason = reason;</span>
<span class="nc" id="L2614">	}</span>

	public String getValueToSend() {
<span class="nc" id="L2617">		return valueToSend;</span>
	}

	public void setValueToSend(String valueToSend) {
<span class="nc" id="L2621">		this.valueToSend = valueToSend;</span>
<span class="nc" id="L2622">	}</span>
	
	
	public String fetchPromoDrawDataMenu() throws Exception {
<span class="nc" id="L2626">		HttpSession session = servletRequest.getSession();</span>
<span class="nc" id="L2627">		ServletContext sc = session.getServletContext();</span>
		
<span class="nc" id="L2629">		session.setAttribute(&quot;presentDate&quot;, new java.sql.Date(new Date()</span>
				.getTime()).toString());
<span class="nc" id="L2631">		session.setAttribute(&quot;DRAWGAME_LIST&quot;, ReportUtility.fetchDrawDataMenu());</span>
		//SimpleDateFormat formatOld = new SimpleDateFormat(&quot;dd-MM-yyyy&quot;);
<span class="nc" id="L2633">		SimpleDateFormat format = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span>
<span class="nc" id="L2634">		Date strtDate = format.parse(CommonMethods.getLastArchDate());</span>
<span class="nc" id="L2635">		Calendar cal1 = Calendar.getInstance();</span>
<span class="nc" id="L2636">		cal1.setTime(strtDate);</span>
<span class="nc" id="L2637">		cal1.add(Calendar.DATE, 1); </span>
<span class="nc" id="L2638">		setArchDate(format.format(cal1.getTime()));</span>
<span class="nc" id="L2639">		setDepDate(CommonMethods.convertDateInGlobalFormat((String)sc.getAttribute(&quot;DEPLOYMENT_DATE&quot;), &quot;yyyy-mm-dd&quot;, (String)sc.getAttribute(&quot;date_format&quot;)));</span>
<span class="nc" id="L2640">		return SUCCESS;</span>
	}
	
	public String fetchPromoDrawDataForLMS() throws Exception {
<span class="nc" id="L2644">		logger.info(&quot;startDate is&quot; + dateOfDraw + &quot; endDate is&quot; + end_Date</span>
				+ &quot; agentOrgId &quot; + agentOrgId + &quot; gameNo&quot; + gameNo + &quot;Before--&quot;
				+ new Date());
		try {
<span class="nc" id="L2648">			String gameName = Util.getGameName(Integer.parseInt(gameNo));</span>
<span class="nc bnc" id="L2649" title="All 2 branches missed.">			if(!&quot;TwelveByTwentyFour&quot;.equals(gameName)) {</span>
<span class="nc" id="L2650">				message=&quot;Report is Not Available for This Game.&quot;;</span>
<span class="nc" id="L2651">				return SUCCESS;</span>
			}

<span class="nc" id="L2654">			int gameId = Integer.parseInt(gameNo);</span>
<span class="nc bnc" id="L2655" title="All 4 branches missed.">			if (gameId &gt; 0 &amp;&amp; dateOfDraw != null) {</span>
<span class="nc" id="L2656">				DrawDataBean drawDataBean = new DrawDataBean();</span>
//				drawDataBean.setAgentOrgId(agentOrgId);
<span class="nc" id="L2658">				drawDataBean.setAgentOrgId(-1);</span>
				// The to date has been Hard Code to Avoid Use of calendar and
				// appended
				// with 23:59:59 to achieve the data
				// corresponding to the midnight of given date
<span class="nc" id="L2663">				drawDataBean.setFromDate(dateOfDraw + &quot; 00:00:00&quot;);</span>
<span class="nc" id="L2664">				drawDataBean.setToDate(end_Date + &quot; 23:59:59&quot;);</span>
<span class="nc" id="L2665">				drawDataBean.setGameNo(gameId);</span>
<span class="nc" id="L2666">				drawDataBean.setDrawName(drawName);</span>

<span class="nc" id="L2668">				ServletContext sc = ServletActionContext.getServletContext();</span>
<span class="nc" id="L2669">				String raffleTktType = (String) sc.getAttribute(&quot;raffle_ticket_type&quot;);</span>
<span class="nc" id="L2670">				String refMerchantId = (String) sc.getAttribute(&quot;REF_MERCHANT_ID&quot;);</span>
<span class="nc" id="L2671">				drawDataBean.setMerchantId(refMerchantId);</span>
<span class="nc" id="L2672">				DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L2673">				DGConsolidateGameDataBean gameDataBean = null;</span>
<span class="nc" id="L2674">				gameDataBean = helper.fetchPromoDrawGameDataForLMS(drawDataBean, raffleTktType);</span>
<span class="nc bnc" id="L2675" title="All 2 branches missed.">				if (gameDataBean != null) {</span>
<span class="nc" id="L2676">					drawDataBeanList = (ArrayList&lt;DGConsolidateDrawBean&gt;) gameDataBean.getDrawDataBeanList();</span>
<span class="nc" id="L2677">					logger.info(&quot;Got Draw Game Data : &quot; + drawDataBeanList.size());</span>
<span class="nc" id="L2678">					setGameId(gameId);</span>
<span class="nc" id="L2679">					return SUCCESS;</span>
				}
<span class="nc" id="L2681">			} else {</span>
<span class="nc" id="L2682">				logger.info(&quot;Incorrect Inputs &quot;);</span>
<span class="nc" id="L2683">				addActionMessage(&quot;Please Enter Correct Values&quot;);</span>
<span class="nc" id="L2684">				return ERROR;</span>
			}
<span class="nc" id="L2686">		} catch (Exception e) {</span>
<span class="nc" id="L2687">			e.printStackTrace();</span>
<span class="nc" id="L2688">			addActionMessage(&quot;Some Error In Draw Data &quot;);</span>
<span class="nc" id="L2689">		}</span>
<span class="nc" id="L2690">		return ERROR;</span>
	}
	
	/* Fetch Rank Wise Winning Data for 12/24 game */
	
	public String fatchRankWiseWinningData() throws Exception {

<span class="nc" id="L2697">		logger.info(&quot;startDate is&quot; + dateOfDraw + &quot; 00:00:00&quot; + &quot; endDate is&quot; + dateOfDraw + &quot; 23:59:59&quot; + &quot; gameNo&quot; + gameNo + &quot;Before--&quot;+ new Date() + &quot; drawName: &quot;+drawName);</span>
		try {
			
<span class="nc bnc" id="L2700" title="All 2 branches missed.">			int gameId = Integer.parseInt(gameNo.contains(&quot;,&quot;) ? gameNo.split(&quot;,&quot;)[0] : gameNo);</span>
<span class="nc bnc" id="L2701" title="All 2 branches missed.">			String dName = drawName.contains(&quot;,&quot;) ? drawName.split(&quot;,&quot;)[0] : drawName;</span>
<span class="nc bnc" id="L2702" title="All 6 branches missed.">			if (gameId &gt; 0 &amp;&amp; dateOfDraw != null &amp;&amp; !dName.equals(&quot;ALL&quot;)) {</span>
<span class="nc" id="L2703">				DrawDataBean drawDataBean = new DrawDataBean();</span>
				// The to date has been Hard Code to Avoid Use of calendar and
				// appended
				// with 23:59:59 to achieve the data
				// corresponding to the midnight of given date
<span class="nc" id="L2708">				drawDataBean.setFromDate(dateOfDraw + &quot; 00:00:00&quot;);</span>
<span class="nc" id="L2709">				drawDataBean.setToDate(dateOfDraw + &quot; 23:59:59&quot;);</span>
<span class="nc" id="L2710">				drawDataBean.setGameNo(gameId);</span>
<span class="nc" id="L2711">				drawDataBean.setDrawName(dName);</span>
				
<span class="nc" id="L2713">				ServletContext sc = ServletActionContext.getServletContext();</span>
<span class="nc" id="L2714">				String refMerchantId = (String) sc.getAttribute(&quot;REF_MERCHANT_ID&quot;);</span>
<span class="nc" id="L2715">				drawDataBean.setMerchantId(refMerchantId);</span>
<span class="nc" id="L2716">				DrawGameMgmtHelper helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L2717">				Map&lt;Integer, RankWiseWinningReportBean&gt; dataMap = null;</span>
<span class="nc" id="L2718">				dataMap = helper.fetchRankWiseWinningData(drawDataBean);</span>
<span class="nc bnc" id="L2719" title="All 2 branches missed.">				if (dataMap != null) {</span>
<span class="nc" id="L2720">					rankWinningData = dataMap;</span>
<span class="nc" id="L2721">					return SUCCESS;</span>
				}
<span class="nc" id="L2723">			} else {</span>
<span class="nc" id="L2724">				logger.info(&quot;Incorrect Inputs &quot;);</span>
<span class="nc" id="L2725">				addActionMessage(&quot;Please Enter Correct Values&quot;);</span>
<span class="nc" id="L2726">				return ERROR;</span>
			}
<span class="nc" id="L2728">		}catch(Exception e){</span>
<span class="nc" id="L2729">			e.printStackTrace();</span>
<span class="nc" id="L2730">			addActionMessage(&quot;Some Error In Draw Data &quot;);</span>
			
<span class="nc" id="L2732">		}</span>
<span class="nc" id="L2733">		return ERROR;</span>
		
	}

	public void setRankWinningData(Map&lt;Integer,RankWiseWinningReportBean&gt; rankWinningData) {
<span class="nc" id="L2738">		this.rankWinningData = rankWinningData;</span>
<span class="nc" id="L2739">	}</span>

	public Map&lt;Integer,RankWiseWinningReportBean&gt; getRankWinningData() {
<span class="nc" id="L2742">		return rankWinningData;</span>
	}
	
	private String reportData;
	
	public String getReportData() {
<span class="nc" id="L2748">		return reportData;</span>
	}

	public void setReportData(String reportData) {
<span class="nc" id="L2752">		this.reportData = reportData;</span>
<span class="nc" id="L2753">	}</span>

	public void exportAsExcel() throws IOException {
<span class="nc" id="L2756">		response.setContentType(&quot;application/vnd.ms-excel&quot;);</span>
<span class="nc" id="L2757">		response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment; filename=Rank Wise Winning Report.xls&quot;);</span>
<span class="nc" id="L2758">		PrintWriter out = response.getWriter();</span>
<span class="nc bnc" id="L2759" title="All 2 branches missed.">		if (reportData != null) {</span>
<span class="nc" id="L2760">			reportData = reportData.replaceAll(&quot;&lt;tbody&gt;&quot;, &quot;&quot;).replaceAll(&quot;&lt;/tbody&gt;&quot;, &quot;&quot;).trim();</span>
<span class="nc" id="L2761">			out.write(reportData);</span>
		}
<span class="nc" id="L2763">		out.flush();</span>
<span class="nc" id="L2764">		out.close();</span>
<span class="nc" id="L2765">	}</span>
	
	private String DrawDateTime;
	private String freezeDateTime;
	
	
	
	public String getDrawDateTime() {
<span class="nc" id="L2773">		return DrawDateTime;</span>
	}

	public void setDrawDateTime(String drawDateTime) {
<span class="nc" id="L2777">		DrawDateTime = drawDateTime;</span>
<span class="nc" id="L2778">	}</span>

	public String getFreezeDateTime() {
<span class="nc" id="L2781">		return freezeDateTime;</span>
	}

	public void setFreezeDateTime(String freezeDateTime) {
<span class="nc" id="L2785">		this.freezeDateTime = freezeDateTime;</span>
<span class="nc" id="L2786">	}</span>

	public void getResponseFromDGW() throws IOException{
<span class="nc" id="L2789">		logger.info(&quot;Draw DateTime is :&quot; + DrawDateTime + &quot; Freeze DateTime is :&quot; + freezeDateTime+ &quot; drawId is :&quot; + drawId + &quot; gameId is :&quot; + gameId);</span>
<span class="nc" id="L2790">		StringBuilder resp=null;</span>
<span class="nc" id="L2791">		PrintWriter out=null;</span>
<span class="nc" id="L2792">		DrawDataBean drawDataBean=null;</span>
<span class="nc" id="L2793">		DrawGameMgmtHelper helper=null;</span>
		try{
<span class="nc" id="L2795">		    drawDataBean=new DrawDataBean();</span>
<span class="nc" id="L2796">			drawDataBean.setDrawTime(DrawDateTime);</span>
<span class="nc" id="L2797">			drawDataBean.setFromDate(freezeDateTime);</span>
<span class="nc" id="L2798">			drawDataBean.setDrawId(drawId);</span>
<span class="nc" id="L2799">			drawDataBean.setGameName(gameName);</span>
<span class="nc" id="L2800">			helper = new DrawGameMgmtHelper();</span>
<span class="nc" id="L2801">			resp=helper.getAutumaticResultSubmissionResponse(drawDataBean);</span>
<span class="nc" id="L2802">			out = response.getWriter();</span>
		
		}
<span class="nc" id="L2805">		catch(Exception e){</span>
<span class="nc" id="L2806">			JSONObject jsonResponse = new JSONObject();</span>
<span class="nc" id="L2807">			 jsonResponse.put(&quot;isSuccess&quot;,false);</span>
<span class="nc" id="L2808">			 jsonResponse.put(&quot;responseMessage&quot;,&quot;Internal system error !!!&quot;);</span>
<span class="nc" id="L2809">			 resp.append(jsonResponse);</span>
			
<span class="nc" id="L2811">		}</span>
<span class="nc" id="L2812">		out.write(resp.toString());</span>
<span class="nc" id="L2813">	}</span>
	
	private String bonusBallEnable;

	public String getBonusBallEnable() {
<span class="nc" id="L2818">		return bonusBallEnable;</span>
	}
	public void setBonusBallEnable(String bonusBallEnable) {
<span class="nc" id="L2821">		this.bonusBallEnable = bonusBallEnable;</span>
<span class="nc" id="L2822">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>