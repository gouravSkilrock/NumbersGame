<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SLEAgentReportDaoImpl.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">lms</a> &gt; <a href="index.source.html" class="el_package">com.skilrock.lms.web.sportsLottery.reportsMgmt.daoImpl</a> &gt; <span class="el_source">SLEAgentReportDaoImpl.java</span></div><h1>SLEAgentReportDaoImpl.java</h1><pre class="source lang-java linenums">
package com.skilrock.lms.web.sportsLottery.reportsMgmt.daoImpl;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.sql.Timestamp;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.HashMap;
import java.util.Map;

import com.skilrock.lms.common.db.DBConnect;
import com.skilrock.lms.common.exception.GenericException;
import com.skilrock.lms.common.exception.LMSErrors;
import com.skilrock.lms.web.sportsLottery.reportsMgmt.beans.SLEOrgReportRequestBean;
import com.skilrock.lms.web.sportsLottery.reportsMgmt.beans.SLEOrgReportResponseBean;

<span class="nc" id="L20">public class SLEAgentReportDaoImpl {</span>

	// private static final Logger logger = LoggerFactory
	// .getLogger(&quot;SLAgentReportDaoImpl&quot;);

	/**
	 * @param args
	 * @throws Exception
	 */
	/**
	 * @param args
	 * @throws Exception
	 */
	/**
	 * @param args
	 * @throws Exception
	 */
	public static void main(String[] args) throws Exception {
<span class="nc" id="L38">		DateFormat dateFormat = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);</span>
<span class="nc" id="L39">		SLEOrgReportRequestBean requestBean = new SLEOrgReportRequestBean();</span>
<span class="nc" id="L40">		requestBean.setOrgId(3);</span>
<span class="nc" id="L41">		requestBean.setFromDate(new Timestamp(dateFormat.parse(</span>
				&quot;2014-11-01 00:00:00&quot;).getTime()));
<span class="nc" id="L43">		requestBean.setToDate(new Timestamp(dateFormat.parse(</span>
				&quot;2014-11-11 00:00:00&quot;).getTime()));

		/*
		 * requestBean.setGameId(2); Map&lt;Integer, SLEOrgReportResponseBean&gt;
		 * responseMap = fetchDirPlyPWTDataGameWiseMultipleAgent( requestBean,
		 * DBConnect.getConnection()); System.out.println(&quot;Res Map:&quot; +
		 * responseMap);
		 */

<span class="nc" id="L53">		requestBean.setGameId(1);</span>
<span class="nc" id="L54">		requestBean.setOrgId(1);</span>
<span class="nc" id="L55">		Map&lt;Integer, SLEOrgReportResponseBean&gt; responseMap = fetchCancelDataGameWiseMultipleAgent(</span>
				requestBean, DBConnect.getConnection());

<span class="nc" id="L58">		System.out.println(&quot;Res Map:&quot; + responseMap);</span>
		// System.out.println(&quot;Res Map:&quot; + responseMap.get(1));
<span class="nc" id="L60">	}</span>

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;Integer, SLEOrgReportResponseBean&gt; fetchSaleDataGameWiseMultipleAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L72">		Map&lt;Integer, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L73">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L74">		Statement stmt = null;</span>
<span class="nc" id="L75">		ResultSet rs = null;</span>
<span class="nc" id="L76">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L78">			responseBeanMap = new HashMap&lt;Integer, SLEOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L83">			String archiveAppender = &quot; UNION ALL select organization_id,ifnull(sum(sale_net),0.0) as sale from st_rep_sle_agent where game_id=&quot;</span>
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by organization_id&quot;;

<span class="nc" id="L93">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L94">			saleQueryBuilder</span>
					.append(
							&quot;select parent_id,sum(main.sale) as sale from(select sale.parent_id,sum(sale) sale from(select organization_id,parent_id,SUM(ifnull(sale,0.0)) sale from st_lms_organization_master om left outer join (select srs.retailer_org_id,sum(agent_net_amt) as sale from st_sle_ret_sale srs inner join st_lms_retailer_transaction_master rtm on srs.transaction_id=rtm.transaction_id&quot;)
					.append(&quot; WHERE srs.game_id=&quot;)
					.append(requestBean.getGameId())
					.append(
							&quot; AND rtm.transaction_type in('SLE_SALE') and rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; group by srs.retailer_org_id) sale on om.organization_id=retailer_org_id where om.organization_type='RETAILER' group by parent_id ) sale group by parent_id&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.parent_id&quot;);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L114">			stmt = connection.createStatement();</span>
<span class="nc" id="L115">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L116" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L117">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L118">				responseBean.setSaleAmt(rs.getDouble(&quot;sale&quot;));</span>
<span class="nc" id="L119">				responseBeanMap.put(rs.getInt(&quot;parent_id&quot;), responseBean);</span>
			}
<span class="nc" id="L121">		} catch (SQLException se) {</span>
<span class="nc" id="L122">			se.printStackTrace();</span>
<span class="nc" id="L123">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L124">		} catch (Exception e) {</span>
<span class="nc" id="L125">			e.printStackTrace();</span>
<span class="nc" id="L126">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L128">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L129">		}</span>

<span class="nc" id="L131">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;Integer, SLEOrgReportResponseBean&gt; fetchSaleDataAllGameMultipleAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L144">		Map&lt;Integer, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L145">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L146">		Statement stmt = null;</span>
<span class="nc" id="L147">		ResultSet rs = null;</span>
<span class="nc" id="L148">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L150">			responseBeanMap = new HashMap&lt;Integer, SLEOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L155">			String archiveAppender = &quot; UNION ALL select organization_id,ifnull(sum(sale_net),0.0) as sale from st_rep_sle_agent where organization_id in (select organization_id from st_lms_user_master where termination_date&gt;'&quot;+requestBean.getFromDate()+&quot;' or registration_date &lt;'&quot;+requestBean.getToDate()+&quot;' and isrolehead='Y' and organization_type='AGENT' ) and  finaldate&gt;=date('&quot;</span>
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by organization_id&quot;;

<span class="nc" id="L163">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L164">			saleQueryBuilder</span>
					.append(
							&quot;select parent_id,sum(main.sale) as sale from(select sale.parent_id,sum(sale) sale from(select organization_id,parent_id,ifnull(sum(sale),0.0) sale from st_lms_organization_master om left outer join (select drs.retailer_org_id,sum(agent_net_amt) as sale from st_sle_ret_sale&quot;)
					.append(
							&quot; drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.retailer_org_id in (select organization_id from st_lms_user_master where parent_user_id not in (select user_id from st_lms_user_master where termination_date&lt;'&quot;+requestBean.getFromDate()+&quot;' or registration_date &gt;'&quot;+requestBean.getToDate()+&quot;' and isrolehead='Y' and organization_type='AGENT' ) AND  organization_type='RETAILER' ) and  rtm.transaction_type in('SLE_SALE') and rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; group by drs.retailer_org_id) sale on om.organization_id=retailer_org_id where om.organization_type='RETAILER' group by parent_id ) sale group by parent_id&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.parent_id&quot;);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L182">			System.out.println(&quot;fetchSaleDataMultipleAgent - &quot;+saleQueryBuilder.toString());</span>
			
<span class="nc" id="L184">			stmt = connection.createStatement();</span>
<span class="nc" id="L185">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L186" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L187">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L188">				responseBean.setSaleAmt(rs.getDouble(&quot;sale&quot;));</span>
<span class="nc" id="L189">				responseBeanMap.put(rs.getInt(&quot;parent_id&quot;), responseBean);</span>
			}
<span class="nc" id="L191">		} catch (SQLException se) {</span>
<span class="nc" id="L192">			se.printStackTrace();</span>
<span class="nc" id="L193">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L194">		} catch (Exception e) {</span>
<span class="nc" id="L195">			e.printStackTrace();</span>
<span class="nc" id="L196">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L198">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L199">		}</span>

<span class="nc" id="L201">		return responseBeanMap;</span>
	}
	
	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static void fetchSaleDataAllGameSingleAgent(
			SLEOrgReportRequestBean requestBean, SLEOrgReportResponseBean responseBean, Connection connection)
			throws GenericException {
<span class="nc" id="L214">		Statement stmt = null;</span>
<span class="nc" id="L215">		ResultSet rs = null;</span>
<span class="nc" id="L216">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L218">			String archiveAppender = &quot; UNION ALL SELECT organization_id,IFNULL(SUM(sale_net),0.0) AS sale FROM st_rep_sle_agent WHERE organization_id=&quot;</span>
					+ requestBean.getOrgId()
					+ &quot; AND finaldate&gt;=DATE('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=DATE('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;;

<span class="nc" id="L227">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L228">			saleQueryBuilder</span>
					.append(
							&quot;select parent_id,sum(main.sale) as sale from (select sale.parent_id,sum(sale) sale from (select organization_id,parent_id,ifnull(sale,0.0) sale from st_lms_organization_master om left outer join (select retailer_org_id,sum(agent_net_amt) as sale from st_sle_ret_sale WHERE transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(&quot; group by retailer_org_id) sale on om.organization_id=retailer_org_id where om.organization_type='RETAILER' and om.parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(&quot;) sale&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.parent_id&quot;);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L245">			System.out.println(&quot;fetchSaleDataAllGameSingleAgent - &quot;+saleQueryBuilder.toString());</span>
			
<span class="nc" id="L247">			stmt = connection.createStatement();</span>
<span class="nc" id="L248">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L249" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L250">				responseBean.setSaleAmt(responseBean.getSaleAmt()+ rs.getDouble(&quot;sale&quot;));</span>
			}
<span class="nc" id="L252">		} catch (SQLException se) {</span>
<span class="nc" id="L253">			se.printStackTrace();</span>
<span class="nc" id="L254">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L255">		} catch (Exception e) {</span>
<span class="nc" id="L256">			e.printStackTrace();</span>
<span class="nc" id="L257">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L259">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L260">		}</span>
		
<span class="nc" id="L262">	}</span>

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchSaleDataDayWisePerGameForBO(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L274">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L275">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L276">		Statement stmt = null;</span>
<span class="nc" id="L277">		ResultSet rs = null;</span>
<span class="nc" id="L278">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L280">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

<span class="nc" id="L282">			String archiveAppender = &quot; union all select finaldate as alldate, SUM(sale_net) as sale from st_rep_sle_agent where organization_id in (select organization_id from st_lms_user_master  where (termination_date &gt; '&quot;+requestBean.getFromDate()+&quot;' or registration_date&lt; '&quot;+requestBean.getToDate()+&quot;') and isrolehead='Y' and organization_type='AGENT') and  game_id=&quot;</span>
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY alldate&quot;;

<span class="nc" id="L292">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L293">			saleQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.sale)as sale from (select sale.alldate,ifnull(sale,0.0) sale from(select alldate,sale from tempdate left outer join (select date(rtm.transaction_date) tx_date,sum(agent_net_amt) sale from st_sle_ret_sale&quot;)
					.append(
							&quot; srs inner join st_lms_retailer_transaction_master rtm on srs.transaction_id=rtm.transaction_id where rtm.retailer_org_id in (select organization_id from st_lms_user_master where parent_user_id not in (select user_id from st_lms_user_master  where (termination_date &lt; '&quot;+requestBean.getFromDate()+&quot;' or registration_date&gt; '&quot;+requestBean.getToDate()+&quot;') and isrolehead='Y' and organization_type='AGENT') and organization_type='RETAILER' ) and srs.game_id=&quot;)
					.append(requestBean.getGameId())
					.append(&quot; AND rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('SLE_SALE') group by tx_date) sale on alldate=sale.tx_date) sale&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L313">			System.out.println(&quot;fetchSaleDataSingleAgent - &quot;</span>
					+ saleQueryBuilder.toString());

<span class="nc" id="L316">			stmt = connection.createStatement();</span>
<span class="nc" id="L317">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L318" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L319">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L320">				responseBean.setSaleAmt(rs.getDouble(&quot;sale&quot;));</span>
<span class="nc" id="L321">				responseBeanMap.put(rs.getDate(&quot;alldate&quot;).toString(), responseBean);</span>
			}
<span class="nc" id="L323">		} catch (SQLException se) {</span>
<span class="nc" id="L324">			se.printStackTrace();</span>
<span class="nc" id="L325">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L326">		} catch (Exception e) {</span>
<span class="nc" id="L327">			e.printStackTrace();</span>
<span class="nc" id="L328">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L330">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L331">		}</span>
		 
		
<span class="nc" id="L334">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchSaleDataDayWiseAllGameForBO(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L347">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L348">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L349">		Statement stmt = null;</span>
<span class="nc" id="L350">		ResultSet rs = null;</span>
<span class="nc" id="L351">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L353">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

<span class="nc" id="L355">			String archiveAppender = &quot; union all select finaldate as alldate, SUM(sale_net) as sale from st_rep_sle_agent where finaldate&gt;=date('&quot;</span>
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY organization_id&quot;;

<span class="nc" id="L363">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L364">			saleQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.sale)as sale from (select sale.alldate,ifnull(sale,0.0) sale from(select alldate,sale from tempdate left outer join (select date(rtm.transaction_date) tx_date,sum(agent_net_amt) sale from st_sle_ret_sale&quot;)
					.append(
							&quot; drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('SLE_SALE') group by tx_date) sale on alldate=sale.tx_date) sale&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L382">			System.out.println(&quot;fetchSaleDataSingleAgent - &quot;</span>
					+ saleQueryBuilder.toString());

<span class="nc" id="L385">			stmt = connection.createStatement();</span>
<span class="nc" id="L386">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L387" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L388">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L389">				responseBean.setSaleAmt(rs.getDouble(&quot;sale&quot;));</span>
<span class="nc" id="L390">				responseBeanMap.put(rs.getString(&quot;alldate&quot;), responseBean);</span>
			}
<span class="nc" id="L392">		} catch (SQLException se) {</span>
<span class="nc" id="L393">			se.printStackTrace();</span>
<span class="nc" id="L394">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L395">		} catch (Exception e) {</span>
<span class="nc" id="L396">			e.printStackTrace();</span>
<span class="nc" id="L397">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L399">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L400">		}</span>

<span class="nc" id="L402">		return responseBeanMap;</span>
	}

	/**
	 * For Sale-PWT Report view by Agent
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchSaleDataDayWisePerGameForAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L416">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L417">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L418">		Statement stmt = null;</span>
<span class="nc" id="L419">		ResultSet rs = null;</span>
<span class="nc" id="L420">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L422">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>
//TODO: Check this for single Agent...
<span class="nc" id="L424">			String archiveAppender = &quot; UNION ALL select finaldate,ifnull(sum(sale_net),0.0) as sale from st_rep_sle_agent where organization_id in (select organization_id from st_lms_user_master where termination_date&gt;'&quot;+requestBean.getFromDate()+&quot;' or registration_date &lt;'&quot;+requestBean.getToDate()+&quot;' and isrolehead='Y' and organization_type='AGENT' and organization_id = &quot;</span>
					+ requestBean.getOrgId() + &quot;) and  finaldate&gt;=date('&quot;
				+ requestBean.getFromDate()
				+ &quot;')&quot;
				+ &quot; AND finaldate&lt;=date('&quot;
				+ requestBean.getToDate()
				+ &quot;')&quot;
				+ &quot; group by finaldate&quot;;

<span class="nc" id="L433">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L434">			saleQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.sale)as sale from (select sale.alldate,ifnull(sale,0.0) sale from(select alldate,sale1.sale from tempdate left outer join (select organization_id,sale.tx_date,sale.sale from st_lms_organization_master om left outer join (select date(rtm.transaction_date) tx_date,sum(agent_net_amt) sale, rtm.retailer_org_id from st_sle_ret_sale drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where drs.game_id=&quot;)
					.append(requestBean.getGameId())
					.append(&quot; AND rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; AND rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('SLE_SALE') group by tx_date,retailer_org_id) sale on retailer_org_id=om.organization_id where parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(
							&quot; group by sale.tx_date,organization_id) sale1 on alldate=sale1.tx_date) sale&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L455">			System.out.println(&quot;fetchSaleDataSingleAgentViewByAgent - &quot;</span>
					+ saleQueryBuilder.toString());

<span class="nc" id="L458">			stmt = connection.createStatement();</span>
<span class="nc" id="L459">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L460" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L461">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L462">				responseBean.setSaleAmt(rs.getDouble(&quot;sale&quot;));</span>
<span class="nc" id="L463">				responseBeanMap.put(rs.getString(&quot;alldate&quot;).split(&quot; &quot;)[0], responseBean);</span>
			}
<span class="nc" id="L465">		} catch (SQLException se) {</span>
<span class="nc" id="L466">			se.printStackTrace();</span>
<span class="nc" id="L467">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L468">		} catch (Exception e) {</span>
<span class="nc" id="L469">			e.printStackTrace();</span>
<span class="nc" id="L470">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L472">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L473">		}</span>

<span class="nc" id="L475">		return responseBeanMap;</span>
	}

	/**
	 * For Sale-PWT Report view by Agent
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchSaleDataDayWiseAllGameForAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L489">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L490">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L491">		Statement stmt = null;</span>
<span class="nc" id="L492">		ResultSet rs = null;</span>
<span class="nc" id="L493">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L495">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

<span class="nc" id="L497">			String archiveAppender = &quot; union all select sgr.finaldate as alldate,sum(sgr.sale_net) as sale from st_rep_sle_retailer as sgr left outer join  st_rep_sle_agent as sga on sgr.finaldate=sga.finaldate and sgr.parent_id=sga.parent_id where sgr.parent_id=&quot;</span>
					+ requestBean.getOrgId()
					// + &quot; AND sgr.game_id=&quot;
					// + requestBean.getGameId()
					+ &quot; AND sgr.finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND sgr.finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by sgr.finaldate&quot;;

<span class="nc" id="L509">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L510">			saleQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.sale)as sale from (select sale.alldate,ifnull(sale,0.0) sale from(select alldate,sale1.sale from tempdate left outer join (select organization_id,sale.tx_date,sale.sale from st_lms_organization_master om left outer join (select date(rtm.transaction_date) tx_date,sum(retailer_net_amt) sale, rtm.retailer_org_id from st_sle_ret_sale&quot;)
					// .append(requestBean.getGameId())
					.append(
							&quot; drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('SLE_SALE')) sale on retailer_org_id=om.organization_id where parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(
							&quot; group by sale.tx_date) sale1 on alldate=sale1.tx_date) sale&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L532">			System.out.println(&quot;fetchSaleDataSingleAgentViewByAgent - &quot;</span>
					+ saleQueryBuilder.toString());

<span class="nc" id="L535">			stmt = connection.createStatement();</span>
<span class="nc" id="L536">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L537" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L538">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L539">				responseBean.setSaleAmt(rs.getDouble(&quot;sale&quot;));</span>
<span class="nc" id="L540">				responseBeanMap.put(rs.getString(&quot;alldate&quot;), responseBean);</span>
			}
<span class="nc" id="L542">		} catch (SQLException se) {</span>
<span class="nc" id="L543">			se.printStackTrace();</span>
<span class="nc" id="L544">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L545">		} catch (Exception e) {</span>
<span class="nc" id="L546">			e.printStackTrace();</span>
<span class="nc" id="L547">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L549">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L550">		}</span>

<span class="nc" id="L552">		return responseBeanMap;</span>
	}
	
	/**
	 * For Payment-Ledger Report view by BO
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchSaleDataDayWiseAllGameSingleAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L566">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L567">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L568">		Statement stmt = null;</span>
<span class="nc" id="L569">		ResultSet rs = null;</span>
<span class="nc" id="L570">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L572">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

<span class="nc" id="L574">			String archiveAppender = &quot; union all SELECT finaldate,organization_id,SUM(sale_net) AS sale FROM st_rep_sle_agent WHERE finaldate&gt;='&quot;</span>
					+ requestBean.getFromDate()
					+ &quot;' AND finaldate&lt;='&quot;
					+ requestBean.getToDate()
					+ &quot;'AND organization_id=&quot;
					+ requestBean.getOrgId()
					+ &quot; GROUP BY finaldate&quot;;

<span class="nc" id="L582">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L583">			saleQueryBuilder</span>
					.append(
							&quot;SELECT DATE(transaction_date) DATE,parent_id,SUM(sale) AS sale FROM (SELECT retailer_org_id,SUM(agent_net_amt) AS sale,transaction_DATE FROM st_sle_ret_sale WHERE transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;' AND transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;' AND retailer_org_id IN (SELECT organization_id FROM st_lms_organization_master WHERE organization_type='RETAILER') GROUP BY DATE(transaction_date),retailer_org_id)aa,st_lms_organization_master bb WHERE retailer_org_id=organization_id AND parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(&quot; GROUP BY DATE(transaction_date)&quot;)
					.append(archiveAppender);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L597">			System.out.println(&quot;fetchSaleDataDayWiseAllGameSingleAgent - &quot;</span>
					+ saleQueryBuilder.toString());

<span class="nc" id="L600">			stmt = connection.createStatement();</span>
<span class="nc" id="L601">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L602" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L603">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L604">				responseBean.setSaleAmt(rs.getDouble(&quot;sale&quot;));</span>
<span class="nc" id="L605">				responseBeanMap.put(rs.getString(&quot;date&quot;), responseBean);</span>
			}
<span class="nc" id="L607">		} catch (SQLException se) {</span>
<span class="nc" id="L608">			se.printStackTrace();</span>
<span class="nc" id="L609">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L610">		} catch (Exception e) {</span>
<span class="nc" id="L611">			e.printStackTrace();</span>
<span class="nc" id="L612">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L614">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L615">		}</span>

<span class="nc" id="L617">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;Integer, SLEOrgReportResponseBean&gt; fetchCancelDataGameWiseMultipleAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L630">		Map&lt;Integer, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L631">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L632">		Statement stmt = null;</span>
<span class="nc" id="L633">		ResultSet rs = null;</span>
<span class="nc" id="L634">		StringBuilder cancelQueryBuilder = null;</span>
		try {
<span class="nc" id="L636">			responseBeanMap = new HashMap&lt;Integer, SLEOrgReportResponseBean&gt;();</span>

<span class="nc" id="L638">			String archiveAppender = &quot; UNION ALL select organization_id,sum(ref_net_amt) as cancel from st_rep_sle_agent where game_id=&quot;</span>
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by organization_id&quot;;

<span class="nc" id="L648">			cancelQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L649">			cancelQueryBuilder</span>
					.append(
							&quot;select parent_id,sum(main.cancel) as cancel from (select cancel.parent_id,sum(cancel) cancel from (select organization_id,parent_id,ifnull(sum(cancel),0.0) cancel from st_lms_organization_master om left outer join (select drs.retailer_org_id,sum(agent_net_amt) as cancel from st_sle_ret_sale_refund drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where drs.game_id=&quot;)
					.append(requestBean.getGameId())
					.append(
							&quot; AND rtm.transaction_type in('SLE_REFUND_CANCEL','SLE_REFUND_FAILED') and rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; AND rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; group by drs.retailer_org_id)cancel on om.organization_id=retailer_org_id where om.organization_type='RETAILER' group by parent_id ) cancel group by parent_id&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.parent_id&quot;);
			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L667">			System.out.println(&quot;fetchCancelDataMultipleAgent - &quot;</span>
					+ cancelQueryBuilder.toString());

<span class="nc" id="L670">			stmt = connection.createStatement();</span>
<span class="nc" id="L671">			rs = stmt.executeQuery(cancelQueryBuilder.toString());</span>
<span class="nc bnc" id="L672" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L673">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L674">				responseBean.setCancelAmt(rs.getDouble(&quot;cancel&quot;));</span>
<span class="nc" id="L675">				responseBeanMap.put(rs.getInt(&quot;parent_id&quot;), responseBean);</span>
			}
<span class="nc" id="L677">			System.out.println(&quot;fetchCancelDataMultipleAgent - &quot;</span>
					+ cancelQueryBuilder.toString());
<span class="nc" id="L679">		} catch (SQLException se) {</span>
<span class="nc" id="L680">			se.printStackTrace();</span>
<span class="nc" id="L681">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L682">		} catch (Exception e) {</span>
<span class="nc" id="L683">			e.printStackTrace();</span>
<span class="nc" id="L684">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L686">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L687">		}</span>

<span class="nc" id="L689">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;Integer, SLEOrgReportResponseBean&gt; fetchCancelDataAllGameMultipleAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L702">		Map&lt;Integer, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L703">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L704">		Statement stmt = null;</span>
<span class="nc" id="L705">		ResultSet rs = null;</span>
<span class="nc" id="L706">		StringBuilder cancelQueryBuilder = null;</span>
		try {
<span class="nc" id="L708">			responseBeanMap = new HashMap&lt;Integer, SLEOrgReportResponseBean&gt;();</span>

<span class="nc" id="L710">			String archiveAppender = &quot; UNION ALL select organization_id,sum(ref_net_amt) as cancel from st_rep_sle_agent where organization_id in (select organization_id from st_lms_user_master where termination_date&gt;'&quot;+requestBean.getFromDate()+&quot;' or registration_date &lt;'&quot;+requestBean.getToDate()+&quot;' and isrolehead='Y' and organization_type='AGENT' ) and finaldate&gt;=date('&quot;</span>
					// + requestBean.getGameId()
					// + &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by organization_id&quot;;

<span class="nc" id="L720">			cancelQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L721">			cancelQueryBuilder</span>
					.append(
							&quot;select parent_id,sum(main.cancel) as cancel from (select cancel.parent_id,sum(cancel) cancel from (select organization_id,parent_id,ifnull(sum(cancel),0.0) cancel from st_lms_organization_master om left outer join (select drs.retailer_org_id,sum(agent_net_amt) as cancel from st_sle_ret_sale_refund&quot;)
					// .append(requestBean.getGameId())
					.append(
							&quot; drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.retailer_org_id in (select organization_id from st_lms_user_master where parent_user_id not in (select user_id from st_lms_user_master where termination_date&lt;'&quot;+requestBean.getFromDate()+&quot;' or registration_date &gt;'&quot;+requestBean.getToDate()+&quot;' and isrolehead='Y' and organization_type='AGENT' ) AND  organization_type='RETAILER' ) and  rtm.transaction_type in('SLE_REFUND_CANCEL','SLE_REFUND_FAILED') and rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; group by drs.retailer_org_id)cancel on om.organization_id=retailer_org_id where om.organization_type='RETAILER' group by parent_id ) cancel group by parent_id&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.parent_id&quot;);
			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L739">			System.out.println(&quot;fetchCancelDataMultipleAgent - &quot;</span>
					+ cancelQueryBuilder.toString());

<span class="nc" id="L742">			stmt = connection.createStatement();</span>
<span class="nc" id="L743">			rs = stmt.executeQuery(cancelQueryBuilder.toString());</span>
<span class="nc bnc" id="L744" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L745">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L746">				responseBean.setCancelAmt(rs.getDouble(&quot;cancel&quot;));</span>
<span class="nc" id="L747">				responseBeanMap.put(rs.getInt(&quot;parent_id&quot;), responseBean);</span>
			}
<span class="nc" id="L749">			System.out.println(&quot;fetchCancelDataMultipleAgent - &quot;</span>
					+ cancelQueryBuilder.toString());
<span class="nc" id="L751">		} catch (SQLException se) {</span>
<span class="nc" id="L752">			se.printStackTrace();</span>
<span class="nc" id="L753">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L754">		} catch (Exception e) {</span>
<span class="nc" id="L755">			e.printStackTrace();</span>
<span class="nc" id="L756">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L758">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L759">		}</span>

<span class="nc" id="L761">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchCancelDataDayWisePerGameForBO(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L774">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L775">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L776">		Statement stmt = null;</span>
<span class="nc" id="L777">		ResultSet rs = null;</span>
<span class="nc" id="L778">		StringBuilder cancelQueryBuilder = null;</span>
		try {
<span class="nc" id="L780">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L785">			String archiveAppender = &quot; union all select finaldate as alldate, SUM(ref_net_amt) as cancel from st_rep_sle_agent where organization_id in (select organization_id from st_lms_user_master  where (termination_date &gt; '&quot;+requestBean.getFromDate()+&quot;' or registration_date&lt; '&quot;+requestBean.getToDate()+&quot;') and isrolehead='Y' and organization_type='AGENT') and  game_id=&quot;</span>
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY alldate&quot;;

<span class="nc" id="L795">			cancelQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L796">			cancelQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.cancel)as cancel from (select cancel.alldate,ifnull(cancel,0.0) cancel from(select alldate,cancel from tempdate left outer join (select date(rtm.transaction_date) tx_date,sum(agent_net_amt) cancel from st_sle_ret_sale_refund drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.retailer_org_id in (select organization_id from st_lms_user_master where parent_user_id not in (select user_id from st_lms_user_master  where (termination_date &lt; '&quot;+requestBean.getFromDate()+&quot;' or registration_date&gt; '&quot;+requestBean.getToDate()+&quot;') and isrolehead='Y' and organization_type='AGENT') and organization_type='RETAILER' ) and  drs.game_id=&quot;)
					.append(requestBean.getGameId())
					.append(&quot; AND rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; AND rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('SLE_REFUND_CANCEL','SLE_REFUND_FAILED') group by tx_date) cancel on alldate=cancel.tx_date) cancel&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchCancelDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L814">			System.out.println(&quot;fetchCancelDataDayWisePerGameSingleAgent - &quot;</span>
					+ cancelQueryBuilder.toString());

<span class="nc" id="L817">			stmt = connection.createStatement();</span>
<span class="nc" id="L818">			rs = stmt.executeQuery(cancelQueryBuilder.toString());</span>
<span class="nc bnc" id="L819" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L820">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L821">				responseBean.setCancelAmt(rs.getDouble(&quot;cancel&quot;));</span>
<span class="nc" id="L822">				responseBeanMap.put(rs.getDate(&quot;alldate&quot;).toString(), responseBean);</span>
			}
<span class="nc" id="L824">		} catch (SQLException se) {</span>
<span class="nc" id="L825">			se.printStackTrace();</span>
<span class="nc" id="L826">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L827">		} catch (Exception e) {</span>
<span class="nc" id="L828">			e.printStackTrace();</span>
<span class="nc" id="L829">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L831">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L832">		}</span>

<span class="nc" id="L834">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchCancelDataDayWiseAllGameForBO(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L847">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L848">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L849">		Statement stmt = null;</span>
<span class="nc" id="L850">		ResultSet rs = null;</span>
<span class="nc" id="L851">		StringBuilder cancelQueryBuilder = null;</span>
		try {
<span class="nc" id="L853">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L858">			String archiveAppender = &quot; union all select finaldate as alldate, SUM(ref_net_amt) as cancel from st_rep_sle_agent where finaldate&gt;=date('&quot;</span>
					// + requestBean.getGameId()
					// + &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY organization_id&quot;;

<span class="nc" id="L868">			cancelQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L869">			cancelQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.cancel)as cancel from (select cancel.alldate,ifnull(cancel,0.0) cancel from(select alldate,cancel from tempdate left outer join (select date(transaction_date) tx_date,sum(agent_net_amt) cancel from st_sle_ret_sale_refund drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					// .append(requestBean.getGameId())
					// .append(
					// &quot; drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('SLE_REFUND_CANCEL','SLE_REFUND_FAILED') group by tx_date) cancel on alldate=cancel.tx_date) cancel&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchCancelDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L888">			System.out.println(&quot;fetchCancelDataDayWisePerGameSingleAgent - &quot;</span>
					+ cancelQueryBuilder.toString());

<span class="nc" id="L891">			stmt = connection.createStatement();</span>
<span class="nc" id="L892">			rs = stmt.executeQuery(cancelQueryBuilder.toString());</span>
<span class="nc bnc" id="L893" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L894">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L895">				responseBean.setCancelAmt(rs.getDouble(&quot;cancel&quot;));</span>
<span class="nc" id="L896">				responseBeanMap.put(rs.getString(&quot;alldate&quot;), responseBean);</span>
			}
<span class="nc" id="L898">		} catch (SQLException se) {</span>
<span class="nc" id="L899">			se.printStackTrace();</span>
<span class="nc" id="L900">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L901">		} catch (Exception e) {</span>
<span class="nc" id="L902">			e.printStackTrace();</span>
<span class="nc" id="L903">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L905">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L906">		}</span>

<span class="nc" id="L908">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchCancelDataDayWisePerGameForAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L921">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L922">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L923">		Statement stmt = null;</span>
<span class="nc" id="L924">		ResultSet rs = null;</span>
<span class="nc" id="L925">		StringBuilder cancelQueryBuilder = null;</span>
		try {
<span class="nc" id="L927">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L932">			String archiveAppender = &quot; union all select sgr.finaldate as alldate,sum(sgr.ref_net_amt) as cancel from st_rep_sle_retailer as sgr left outer join  st_rep_sle_agent as sga on sgr.finaldate=sga.finaldate and sgr.parent_id=sga.parent_id where sgr.parent_id=&quot;</span>
					+ requestBean.getOrgId()
					+ &quot; AND sgr.game_id=&quot;
					+ requestBean.getGameId()
					+ &quot; AND sgr.finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND sgr.finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot; + &quot; group by sgr.finaldate&quot;;

<span class="nc" id="L943">			cancelQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L944">			cancelQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.cancel)as cancel from (select cancel.alldate,ifnull(cancel,0.0) cancel from(select alldate,cancel1.cancel from tempdate left outer join (select organization_id,cancel.tx_date,cancel.cancel from st_lms_organization_master om left outer join (select date(rtm.transaction_date) tx_date,sum(retailer_net_amt) cancel, rtm.retailer_org_id from st_sle_ret_sale_refund srs inner join st_lms_retailer_transaction_master rtm on srs.transaction_id=rtm.transaction_id where srs.game_id=&quot;)
					.append(requestBean.getGameId())
					.append(&quot; AND rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; AND rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('SLE_REFUND_CANCEL','SLE_REFUND_FAILED') group by tx_date,retailer_org_id) cancel on retailer_org_id=om.organization_id where parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(
							&quot; group by cancel.tx_date,organization_id) cancel1 on alldate=cancel1.tx_date) cancel&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchCancelDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L965">			System.out</span>
					.println(&quot;fetchCancelDataDayWisePerGameSingleAgentViewByAgent - &quot;
							+ cancelQueryBuilder.toString());

<span class="nc" id="L969">			stmt = connection.createStatement();</span>
<span class="nc" id="L970">			rs = stmt.executeQuery(cancelQueryBuilder.toString());</span>
<span class="nc bnc" id="L971" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L972">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L973">				responseBean.setCancelAmt(rs.getDouble(&quot;cancel&quot;));</span>
<span class="nc" id="L974">				responseBeanMap.put(rs.getString(&quot;alldate&quot;).split(&quot; &quot;)[0], responseBean);</span>
			}
<span class="nc" id="L976">		} catch (SQLException se) {</span>
<span class="nc" id="L977">			se.printStackTrace();</span>
<span class="nc" id="L978">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L979">		} catch (Exception e) {</span>
<span class="nc" id="L980">			e.printStackTrace();</span>
<span class="nc" id="L981">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L983">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L984">		}</span>

<span class="nc" id="L986">		return responseBeanMap;</span>
	}
	
	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static void fetchCancelDataAllGameSingleAgent(
			SLEOrgReportRequestBean requestBean, SLEOrgReportResponseBean responseBean, Connection connection)
			throws GenericException {
<span class="nc" id="L999">		Statement stmt = null;</span>
<span class="nc" id="L1000">		ResultSet rs = null;</span>
<span class="nc" id="L1001">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L1003">			String archiveAppender = &quot; UNION ALL SELECT organization_id,IFNULL(SUM(ref_net_amt),0.0) AS cancel FROM st_rep_sle_agent WHERE organization_id=&quot;</span>
					+ requestBean.getOrgId()
					+ &quot; AND finaldate&gt;=DATE('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=DATE('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;;

<span class="nc" id="L1012">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1013">			saleQueryBuilder</span>
					.append(
							&quot;SELECT parent_id,sum(main.cancel) as cancel from (select cancel.parent_id,sum(cancel) cancel from (select organization_id,parent_id,ifnull(cancel,0.0) cancel from st_lms_organization_master om left outer join (select retailer_org_id,sum(agent_net_amt) as cancel from st_sle_ret_sale_refund WHERE transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; AND transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(&quot; group by retailer_org_id) cancel on om.organization_id=retailer_org_id where om.organization_type='RETAILER' and om.parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(&quot;) cancel&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.parent_id&quot;);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L1030">			System.out.println(&quot;fetchCancelDataAllGameSingleAgent - &quot;+saleQueryBuilder.toString());</span>
			
<span class="nc" id="L1032">			stmt = connection.createStatement();</span>
<span class="nc" id="L1033">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L1034" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1035">				responseBean.setCancelAmt(responseBean.getCancelAmt() + rs.getDouble(&quot;cancel&quot;));</span>
			}
<span class="nc" id="L1037">		} catch (SQLException se) {</span>
<span class="nc" id="L1038">			se.printStackTrace();</span>
<span class="nc" id="L1039">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1040">		} catch (Exception e) {</span>
<span class="nc" id="L1041">			e.printStackTrace();</span>
<span class="nc" id="L1042">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1044">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1045">		}</span>

<span class="nc" id="L1047">	}</span>

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchCancelDataDayWiseAllGameForAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1059">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1060">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1061">		Statement stmt = null;</span>
<span class="nc" id="L1062">		ResultSet rs = null;</span>
<span class="nc" id="L1063">		StringBuilder cancelQueryBuilder = null;</span>
		try {
<span class="nc" id="L1065">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L1070">			String archiveAppender = &quot; union all select sgr.finaldate as alldate,sum(sgr.ref_net_amt) as cancel from st_rep_sle_retailer as sgr left outer join  st_rep_sle_agent as sga on sgr.finaldate=sga.finaldate and sgr.parent_id=sga.parent_id where sgr.parent_id=&quot;</span>
					+ requestBean.getOrgId()
					// + &quot; AND sgr.game_id=&quot;
					// + requestBean.getGameId()
					+ &quot; AND sgr.finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND sgr.finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by sgr.finaldate&quot;;

<span class="nc" id="L1082">			cancelQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1083">			cancelQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.cancel)as cancel from (select cancel.alldate,ifnull(cancel,0.0) cancel from(select alldate,cancel1.cancel from tempdate left outer join (select organization_id,cancel.tx_date,cancel.cancel from st_lms_organization_master om left outer join (select date(rtm.transaction_date) tx_date,sum(agent_net_amt) cancel, rtm.retailer_org_id from st_sle_ret_sale_refund srs inner join st_lms_retailer_transaction_master rtm on srs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					// .append(requestBean.getGameId())
					// .append(
					// &quot; srs inner join st_lms_retailer_transaction_master rtm on srs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('SLE_REFUND_CANCEL','SLE_REFUND_FAILED')) cancel on retailer_org_id=om.organization_id where parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(
							&quot; group by cancel.tx_date) cancel1 on alldate=cancel1.tx_date) cancel&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchCancelDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L1105">			System.out</span>
					.println(&quot;fetchCancelDataDayWisePerGameSingleAgentViewByAgent - &quot;
							+ cancelQueryBuilder.toString());

<span class="nc" id="L1109">			stmt = connection.createStatement();</span>
<span class="nc" id="L1110">			rs = stmt.executeQuery(cancelQueryBuilder.toString());</span>
<span class="nc bnc" id="L1111" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1112">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L1113">				responseBean.setCancelAmt(rs.getDouble(&quot;cancel&quot;));</span>
<span class="nc" id="L1114">				responseBeanMap.put(rs.getString(&quot;alldate&quot;), responseBean);</span>
			}
<span class="nc" id="L1116">		} catch (SQLException se) {</span>
<span class="nc" id="L1117">			se.printStackTrace();</span>
<span class="nc" id="L1118">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1119">		} catch (Exception e) {</span>
<span class="nc" id="L1120">			e.printStackTrace();</span>
<span class="nc" id="L1121">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1123">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1124">		}</span>

<span class="nc" id="L1126">		return responseBeanMap;</span>
	}
	
	/**
	 * For Payment-Ledger Report view by BO
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchCancelDataDayWiseAllGameSingleAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1140">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1141">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1142">		Statement stmt = null;</span>
<span class="nc" id="L1143">		ResultSet rs = null;</span>
<span class="nc" id="L1144">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L1146">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

<span class="nc" id="L1148">			String archiveAppender = &quot; UNION ALL SELECT finaldate,organization_id,SUM(ref_net_amt) AS cancel FROM st_rep_sle_agent WHERE finaldate&gt;='&quot;</span>
					+ requestBean.getFromDate()
					+ &quot;' AND finaldate&lt;='&quot;
					+ requestBean.getToDate()
					+ &quot;'AND organization_id=&quot;
					+ requestBean.getOrgId()
					+ &quot; GROUP BY finaldate&quot;;

<span class="nc" id="L1156">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1157">			saleQueryBuilder</span>
					.append(&quot;SELECT DATE(transaction_date) DATE,parent_id,SUM(cancel) AS cancel FROM (SELECT retailer_org_id,SUM(agent_net_amt) AS cancel,transaction_date FROM st_sle_ret_sale_refund WHERE transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;' AND transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;' AND retailer_org_id IN (SELECT organization_id FROM st_lms_organization_master WHERE organization_type='RETAILER') GROUP BY DATE(transaction_date),retailer_org_id)aa,st_lms_organization_master bb WHERE retailer_org_id=organization_id AND parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(&quot; GROUP BY DATE(transaction_date)&quot;)
					.append(archiveAppender);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L1170">			System.out.println(&quot;fetchCancelDataDayWiseAllGameSingleAgent - &quot;+ saleQueryBuilder.toString());</span>

<span class="nc" id="L1172">			stmt = connection.createStatement();</span>
<span class="nc" id="L1173">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L1174" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1175">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L1176">				responseBean.setCancelAmt(rs.getDouble(&quot;cancel&quot;));</span>
<span class="nc" id="L1177">				responseBeanMap.put(rs.getString(&quot;date&quot;), responseBean);</span>
			}
<span class="nc" id="L1179">		} catch (SQLException se) {</span>
<span class="nc" id="L1180">			se.printStackTrace();</span>
<span class="nc" id="L1181">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1182">		} catch (Exception e) {</span>
<span class="nc" id="L1183">			e.printStackTrace();</span>
<span class="nc" id="L1184">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1186">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1187">		}</span>

<span class="nc" id="L1189">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;Integer, SLEOrgReportResponseBean&gt; fetchPWTDataGameWiseMultipleAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1202">		Map&lt;Integer, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1203">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1204">		Statement stmt = null;</span>
<span class="nc" id="L1205">		ResultSet rs = null;</span>
<span class="nc" id="L1206">		StringBuilder pwtQueryBuilder = null;</span>
		try {
<span class="nc" id="L1208">			responseBeanMap = new HashMap&lt;Integer, SLEOrgReportResponseBean&gt;();</span>

<span class="nc" id="L1210">			String archiveAppender = &quot; UNION ALL select organization_id,sum(pwt_net_amt) as pwt from st_rep_sle_agent where game_id=&quot;</span>
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by organization_id&quot;;

<span class="nc" id="L1220">			pwtQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1221">			pwtQueryBuilder</span>
					.append(
							&quot;select parent_id,sum(main.pwt) as pwt from (select pwt.parent_id,sum(pwt) pwt from (select organization_id,parent_id,ifnull(sum(pwt),0.0) pwt from st_lms_organization_master om left outer join (select drs.retailer_org_id,sum(pwt_amt+agt_claim_comm-govt_claim_comm) as pwt from st_sle_ret_pwt drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where drs.game_id=&quot;)
					.append(requestBean.getGameId())
					.append(
							&quot; AND rtm.transaction_type in('SLE_PWT_AUTO','SLE_PWT_PLR','SLE_PWT') and rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; group by drs.retailer_org_id) pwt on om.organization_id=retailer_org_id where om.organization_type='RETAILER' group by parent_id ) pwt group by parent_id&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.parent_id&quot;);
			// logger.debug(&quot;fetchPWTDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L1239">			System.out.println(&quot;fetchPWTDataMultipleAgent - &quot;</span>
					+ pwtQueryBuilder.toString());

<span class="nc" id="L1242">			stmt = connection.createStatement();</span>
<span class="nc" id="L1243">			rs = stmt.executeQuery(pwtQueryBuilder.toString());</span>
<span class="nc bnc" id="L1244" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1245">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L1246">				responseBean.setPwtAmt(rs.getDouble(&quot;pwt&quot;));</span>
<span class="nc" id="L1247">				responseBeanMap.put(rs.getInt(&quot;parent_id&quot;), responseBean);</span>
			}
<span class="nc" id="L1249">		} catch (SQLException se) {</span>
<span class="nc" id="L1250">			se.printStackTrace();</span>
<span class="nc" id="L1251">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1252">		} catch (Exception e) {</span>
<span class="nc" id="L1253">			e.printStackTrace();</span>
<span class="nc" id="L1254">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1256">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1257">		}</span>

<span class="nc" id="L1259">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;Integer, SLEOrgReportResponseBean&gt; fetchPWTDataAllGameMultipleAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1272">		Map&lt;Integer, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1273">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1274">		Statement stmt = null;</span>
<span class="nc" id="L1275">		ResultSet rs = null;</span>
<span class="nc" id="L1276">		StringBuilder pwtQueryBuilder = null;</span>
		try {
<span class="nc" id="L1278">			responseBeanMap = new HashMap&lt;Integer, SLEOrgReportResponseBean&gt;();</span>

<span class="nc" id="L1280">			String archiveAppender = &quot; UNION ALL select organization_id,sum(pwt_net_amt) as pwt from st_rep_sle_agent where organization_id in (select organization_id from st_lms_user_master where termination_date&gt;'&quot;+requestBean.getFromDate()+&quot;' or registration_date &lt;'&quot;+requestBean.getToDate()+&quot;' and isrolehead='Y' and organization_type='AGENT' ) and  finaldate&gt;=date('&quot;</span>
					// + requestBean.getGameId()
					// + &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by organization_id&quot;;

<span class="nc" id="L1290">			pwtQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1291">			pwtQueryBuilder</span>
					.append(
							&quot;select parent_id,sum(main.pwt) as pwt from (select pwt.parent_id,sum(pwt) pwt from (select organization_id,parent_id,ifnull(sum(pwt),0.0) pwt from st_lms_organization_master om left outer join (select drs.retailer_org_id,sum(pwt_amt+agt_claim_comm-govt_claim_comm) as pwt from st_sle_ret_pwt drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where  rtm.retailer_org_id in (select organization_id from st_lms_user_master where parent_user_id not in (select user_id from st_lms_user_master where termination_date&lt;'&quot;+requestBean.getFromDate()+&quot;' or registration_date &gt;'&quot;+requestBean.getToDate()+&quot;' and isrolehead='Y' and organization_type='AGENT' ) AND  organization_type='RETAILER' ) and  rtm.transaction_type in('SLE_PWT_AUTO','SLE_PWT_PLR','SLE_PWT') and rtm.transaction_date&gt;='&quot;)
					// .append(requestBean.getGameId())
					// .append(
					// &quot; drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.transaction_type in('SLE_PWT_AUTO','SLE_PWT_PLR','SLE_PWT') and rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; group by drs.retailer_org_id) pwt on om.organization_id=retailer_org_id where om.organization_type='RETAILER' group by parent_id ) pwt group by parent_id&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.parent_id&quot;);
			// logger.debug(&quot;fetchPWTDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L1309">			System.out.println(&quot;fetchPWTDataMultipleAgent - &quot;</span>
					+ pwtQueryBuilder.toString());

<span class="nc" id="L1312">			stmt = connection.createStatement();</span>
<span class="nc" id="L1313">			rs = stmt.executeQuery(pwtQueryBuilder.toString());</span>
<span class="nc bnc" id="L1314" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1315">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L1316">				responseBean.setPwtAmt(rs.getDouble(&quot;pwt&quot;));</span>
<span class="nc" id="L1317">				responseBeanMap.put(rs.getInt(&quot;parent_id&quot;), responseBean);</span>
			}
<span class="nc" id="L1319">		} catch (SQLException se) {</span>
<span class="nc" id="L1320">			se.printStackTrace();</span>
<span class="nc" id="L1321">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1322">		} catch (Exception e) {</span>
<span class="nc" id="L1323">			e.printStackTrace();</span>
<span class="nc" id="L1324">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1326">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1327">		}</span>

<span class="nc" id="L1329">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchPWTDataDayWisePerGameForBO(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1342">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1343">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1344">		Statement stmt = null;</span>
<span class="nc" id="L1345">		ResultSet rs = null;</span>
<span class="nc" id="L1346">		StringBuilder pwtQueryBuilder = null;</span>
		try {
<span class="nc" id="L1348">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L1353">			String archiveAppender = &quot; union all select finaldate as alldate, SUM(pwt_net_amt) as pwt from st_rep_sle_agent where organization_id in (select organization_id from st_lms_user_master  where (termination_date &gt; '&quot;+requestBean.getFromDate()+&quot;' or registration_date&lt; '&quot;+requestBean.getToDate()+&quot;') and isrolehead='Y' and organization_type='AGENT') and  game_id=&quot;</span>
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY alldate&quot;;

<span class="nc" id="L1363">			pwtQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1364">			pwtQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.pwt)as pwt from (select pwt.alldate,ifnull(pwt,0.0) pwt from(select alldate,pwt from tempdate left outer join (select date(rtm.transaction_date) tx_date,sum(pwt_amt+agt_claim_comm - govt_claim_comm) pwt from st_sle_ret_pwt drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.retailer_org_id in (select organization_id from st_lms_user_master where parent_user_id not in (select user_id from st_lms_user_master  where (termination_date &lt; '&quot;+requestBean.getFromDate()+&quot;' or registration_date&gt; '&quot;+requestBean.getToDate()+&quot;') and isrolehead='Y' and organization_type='AGENT') and organization_type='RETAILER' ) and drs.game_id=&quot;)
					.append(requestBean.getGameId())
					.append(&quot; AND rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; AND rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('SLE_PWT_AUTO','SLE_PWT_PLR','SLE_PWT') group by tx_date) pwt on alldate=pwt.tx_date) pwt&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L1382">			System.out.println(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;</span>
					+ pwtQueryBuilder.toString());

<span class="nc" id="L1385">			stmt = connection.createStatement();</span>
<span class="nc" id="L1386">			rs = stmt.executeQuery(pwtQueryBuilder.toString());</span>
<span class="nc bnc" id="L1387" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1388">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L1389">				responseBean.setPwtAmt(rs.getDouble(&quot;pwt&quot;));</span>
<span class="nc" id="L1390">				responseBeanMap.put(rs.getDate(&quot;alldate&quot;).toString(), responseBean);</span>
			}
<span class="nc" id="L1392">		} catch (SQLException se) {</span>
<span class="nc" id="L1393">			se.printStackTrace();</span>
<span class="nc" id="L1394">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1395">		} catch (Exception e) {</span>
<span class="nc" id="L1396">			e.printStackTrace();</span>
<span class="nc" id="L1397">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1399">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1400">		}</span>

<span class="nc" id="L1402">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchPWTDataDayWiseAllGameForBO(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1415">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1416">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1417">		Statement stmt = null;</span>
<span class="nc" id="L1418">		ResultSet rs = null;</span>
<span class="nc" id="L1419">		StringBuilder pwtQueryBuilder = null;</span>
		try {
<span class="nc" id="L1421">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L1426">			String archiveAppender = &quot; union all select finaldate as alldate, SUM(pwt_net_amt) as pwt from st_rep_sle_agent where finaldate&gt;=date('&quot;</span>
					// + requestBean.getGameId()
					// + &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY organization_id&quot;;

<span class="nc" id="L1436">			pwtQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1437">			pwtQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.pwt)as pwt from (select pwt.alldate,ifnull(pwt,0.0) pwt from(select alldate,pwt from tempdate left outer join (select date(rtm.transaction_date) tx_date,sum(pwt_amt+agt_claim_comm-govt_claim_comm) pwt from st_sle_ret_pwt drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					// .append(requestBean.getGameId())
					// .append(
					// &quot; drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('SLE_PWT_AUTO','SLE_PWT_PLR','SLE_PWT') group by tx_date) pwt on alldate=pwt.tx_date) pwt&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L1456">			System.out.println(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;</span>
					+ pwtQueryBuilder.toString());

<span class="nc" id="L1459">			stmt = connection.createStatement();</span>
<span class="nc" id="L1460">			rs = stmt.executeQuery(pwtQueryBuilder.toString());</span>
<span class="nc bnc" id="L1461" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1462">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L1463">				responseBean.setPwtAmt(rs.getDouble(&quot;pwt&quot;));</span>
<span class="nc" id="L1464">				responseBeanMap.put(rs.getString(&quot;alldate&quot;), responseBean);</span>
			}
<span class="nc" id="L1466">		} catch (SQLException se) {</span>
<span class="nc" id="L1467">			se.printStackTrace();</span>
<span class="nc" id="L1468">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1469">		} catch (Exception e) {</span>
<span class="nc" id="L1470">			e.printStackTrace();</span>
<span class="nc" id="L1471">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1473">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1474">		}</span>

<span class="nc" id="L1476">		return responseBeanMap;</span>
	}
	
	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchPWTDataDayWisePerGameForAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1489">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1490">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1491">		Statement stmt = null;</span>
<span class="nc" id="L1492">		ResultSet rs = null;</span>
<span class="nc" id="L1493">		StringBuilder pwtQueryBuilder = null;</span>
		try {
<span class="nc" id="L1495">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L1500">			String archiveAppender = &quot; union all select sgr.finaldate as alldate,sum(sgr.pwt_net_amt) as pwt from st_rep_sle_retailer as sgr left outer join  st_rep_sle_agent as sga on sgr.finaldate=sga.finaldate and sgr.parent_id=sga.parent_id where sgr.parent_id=&quot;</span>
					+ requestBean.getOrgId()
					+ &quot; AND sgr.game_id=&quot;
					+ requestBean.getGameId()
					+ &quot; AND sgr.finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND sgr.finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot; + &quot; GROUP BY sgr.finaldate&quot;;

<span class="nc" id="L1511">			pwtQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1512">			pwtQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.pwt)as pwt from (select pwt.alldate,ifnull(pwt,0.0) pwt from(select alldate,pwt1.pwt from tempdate left outer join (select organization_id,pwt.tx_date,pwt.pwt from st_lms_organization_master om left outer join (select date(rtm.transaction_date) tx_date,sum(pwt_amt+retailer_claim_comm-govt_claim_comm) pwt, rtm.retailer_org_id from st_sle_ret_pwt srs inner join st_lms_retailer_transaction_master rtm on srs.transaction_id=rtm.transaction_id where srs.game_id=&quot;)
					.append(requestBean.getGameId())
					.append(&quot; AND rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; AND rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('SLE_PWT_AUTO','SLE_PWT_PLR','SLE_PWT') group by tx_date,retailer_org_id) pwt on retailer_org_id=om.organization_id where parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(
							&quot; group by pwt.tx_date, organization_id) pwt1 on alldate=pwt1.tx_date) pwt&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L1533">			System.out.println(&quot;fetchPWTDataDayWisePerGameForAgent - &quot;</span>
					+ pwtQueryBuilder.toString());

<span class="nc" id="L1536">			stmt = connection.createStatement();</span>
<span class="nc" id="L1537">			rs = stmt.executeQuery(pwtQueryBuilder.toString());</span>
<span class="nc bnc" id="L1538" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1539">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L1540">				responseBean.setPwtAmt(rs.getDouble(&quot;pwt&quot;));</span>
<span class="nc" id="L1541">				responseBeanMap.put(rs.getString(&quot;alldate&quot;).split(&quot; &quot;)[0], responseBean);</span>
			}
<span class="nc" id="L1543">		} catch (SQLException se) {</span>
<span class="nc" id="L1544">			se.printStackTrace();</span>
<span class="nc" id="L1545">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1546">		} catch (Exception e) {</span>
<span class="nc" id="L1547">			e.printStackTrace();</span>
<span class="nc" id="L1548">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1550">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1551">		}</span>

<span class="nc" id="L1553">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchPWTDataDayWiseAllGameForAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1566">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1567">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1568">		Statement stmt = null;</span>
<span class="nc" id="L1569">		ResultSet rs = null;</span>
<span class="nc" id="L1570">		StringBuilder pwtQueryBuilder = null;</span>
		try {
<span class="nc" id="L1572">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L1577">			String archiveAppender = &quot; union all select sgr.finaldate as alldate,sum(sgr.pwt_net_amt) as pwt from st_rep_sle_retailer as sgr left outer join  st_rep_sle_agent as sga on sgr.finaldate=sga.finaldate and sgr.parent_id=sga.parent_id where sgr.parent_id=&quot;</span>
					+ requestBean.getOrgId()
					// + &quot; AND sgr.game_id=&quot;
					// + requestBean.getGameId()
					+ &quot; AND sgr.finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND sgr.finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY sgr.finaldate&quot;;

<span class="nc" id="L1589">			pwtQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1590">			pwtQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.pwt)as pwt from (select pwt.alldate,ifnull(pwt,0.0) pwt from(select alldate,pwt1.pwt from tempdate left outer join (select organization_id,pwt.tx_date,pwt.pwt from st_lms_organization_master om left outer join (select date(rtm.transaction_date) tx_date,sum(pwt_amt+retailer_claim_comm) pwt, rtm.retailer_org_id from st_sle_ret_pwt srs inner join st_lms_retailer_transaction_master rtm on srs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					// .append(requestBean.getGameId())
					// .append(
					// &quot; srs inner join st_lms_retailer_transaction_master rtm on srs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('SLE_PWT_AUTO','SLE_PWT_PLR','SLE_PWT')) pwt on retailer_org_id=om.organization_id where parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(
							&quot; group by pwt.tx_date) pwt1 on alldate=pwt1.tx_date) pwt&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L1612">			System.out.println(&quot;fetchPWTDataDayWisePerGameForAgent - &quot;</span>
					+ pwtQueryBuilder.toString());

<span class="nc" id="L1615">			stmt = connection.createStatement();</span>
<span class="nc" id="L1616">			rs = stmt.executeQuery(pwtQueryBuilder.toString());</span>
<span class="nc bnc" id="L1617" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1618">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L1619">				responseBean.setPwtAmt(rs.getDouble(&quot;pwt&quot;));</span>
<span class="nc" id="L1620">				responseBeanMap.put(rs.getString(&quot;alldate&quot;), responseBean);</span>
			}
<span class="nc" id="L1622">		} catch (SQLException se) {</span>
<span class="nc" id="L1623">			se.printStackTrace();</span>
<span class="nc" id="L1624">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1625">		} catch (Exception e) {</span>
<span class="nc" id="L1626">			e.printStackTrace();</span>
<span class="nc" id="L1627">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1629">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1630">		}</span>

<span class="nc" id="L1632">		return responseBeanMap;</span>
	}
	
	/**
	 * For Payment-Ledger Report view by BO
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchPWTDataDayWiseAllGameSingleAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1646">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1647">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1648">		Statement stmt = null;</span>
<span class="nc" id="L1649">		ResultSet rs = null;</span>
<span class="nc" id="L1650">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L1652">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

<span class="nc" id="L1654">			String archiveAppender = &quot; UNION ALL SELECT finaldate,organization_id,SUM(pwt_net_amt) AS pwt FROM st_rep_sle_agent WHERE finaldate&gt;='&quot;</span>
					+ requestBean.getFromDate()
					+ &quot;' AND finaldate&lt;='&quot;
					+ requestBean.getToDate()
					+ &quot;'AND organization_id=&quot;
					+ requestBean.getOrgId()
					+ &quot; GROUP BY finaldate&quot;;

<span class="nc" id="L1662">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1663">			saleQueryBuilder</span>
					.append(&quot;SELECT DATE(transaction_date) DATE,parent_id,SUM(pwt) AS pwt FROM (SELECT retailer_org_id,SUM(pwt_amt+agt_claim_comm- govt_claim_comm) AS pwt,transaction_date FROM st_sle_ret_pwt WHERE transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;' AND transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;' AND retailer_org_id IN (SELECT organization_id FROM st_lms_organization_master WHERE organization_type='RETAILER') GROUP BY DATE(transaction_date),retailer_org_id)aa,st_lms_organization_master bb WHERE retailer_org_id=organization_id AND parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(&quot; GROUP BY DATE(transaction_date)&quot;)
					.append(archiveAppender);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L1676">			System.out.println(&quot;fetchPWTDataDayWiseAllGameSingleAgent - &quot;+ saleQueryBuilder.toString());</span>

<span class="nc" id="L1678">			stmt = connection.createStatement();</span>
<span class="nc" id="L1679">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L1680" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1681">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L1682">				responseBean.setPwtAmt(rs.getDouble(&quot;pwt&quot;));</span>
<span class="nc" id="L1683">				responseBeanMap.put(rs.getString(&quot;date&quot;), responseBean);</span>
			}
<span class="nc" id="L1685">		} catch (SQLException se) {</span>
<span class="nc" id="L1686">			se.printStackTrace();</span>
<span class="nc" id="L1687">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1688">		} catch (Exception e) {</span>
<span class="nc" id="L1689">			e.printStackTrace();</span>
<span class="nc" id="L1690">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1692">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1693">		}</span>

<span class="nc" id="L1695">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;Integer, SLEOrgReportResponseBean&gt; fetchDirPlyPWTDataGameWiseMultipleAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1708">		Map&lt;Integer, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1709">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1710">		Statement stmt = null;</span>
<span class="nc" id="L1711">		ResultSet rs = null;</span>
<span class="nc" id="L1712">		StringBuilder pwtDirQueryBuilder = null;</span>
		try {
<span class="nc" id="L1714">			responseBeanMap = new HashMap&lt;Integer, SLEOrgReportResponseBean&gt;();</span>

<span class="nc" id="L1716">			String archiveAppender = &quot; UNION ALL select organization_id,sum(direct_pwt_net_amt) as pwtDir from st_rep_sle_agent where organization_id in (select organization_id from st_lms_user_master where termination_date&gt;'&quot;+requestBean.getFromDate()+&quot;' or registration_date &lt;'&quot;+requestBean.getToDate()+&quot;' and isrolehead='Y' and organization_type='AGENT' )&quot;</span>
					//+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by organization_id&quot;;

<span class="nc" id="L1726">			pwtDirQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1727">			pwtDirQueryBuilder</span>
					.append(
							&quot;select parent_id,sum(main.pwtDir) as pwtDir from (select organization_id as parent_id,ifnull(sum(pwt_amt+agt_claim_comm-tax_amt),0.0) pwtDir from st_lms_organization_master left outer join st_sle_agent_direct_plr_pwt on organization_id=agent_org_id where agent_org_id in (select organization_id from st_lms_user_master where termination_date&gt;'&quot;+requestBean.getFromDate()+&quot;' or registration_date &lt;'&quot;+requestBean.getToDate()+&quot;' and isrolehead='Y' and organization_type='AGENT' ) and  transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate()).append(&quot;'&quot;).append(
							&quot; and transaction_date&lt;='&quot;).append(
							requestBean.getToDate()).append(&quot;'&quot;).append(
							&quot; and organization_type='AGENT'&quot;)
					//.append(requestBean.getGameId())
							.append(
							&quot; group by agent_org_id&quot;).append(archiveAppender)
					.append(&quot;)as main group by main.parent_id&quot;);
			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L1741">			System.out.println(&quot;fetchPWTDirDataMultipleAgent - &quot;</span>
					+ pwtDirQueryBuilder.toString());

<span class="nc" id="L1744">			stmt = connection.createStatement();</span>
<span class="nc" id="L1745">			rs = stmt.executeQuery(pwtDirQueryBuilder.toString());</span>
<span class="nc bnc" id="L1746" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1747">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L1748">				responseBean.setSaleAmt(rs.getDouble(&quot;pwtDir&quot;));</span>
<span class="nc" id="L1749">				responseBeanMap.put(rs.getInt(&quot;parent_id&quot;), responseBean);</span>
			}
<span class="nc" id="L1751">		} catch (SQLException se) {</span>
<span class="nc" id="L1752">			se.printStackTrace();</span>
<span class="nc" id="L1753">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1754">		} catch (Exception e) {</span>
<span class="nc" id="L1755">			e.printStackTrace();</span>
<span class="nc" id="L1756">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1758">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1759">		}</span>

<span class="nc" id="L1761">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;Integer, SLEOrgReportResponseBean&gt; fetchDirPlyPWTDataAllGameMultipleAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1774">		Map&lt;Integer, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1775">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1776">		Statement stmt = null;</span>
<span class="nc" id="L1777">		ResultSet rs = null;</span>
<span class="nc" id="L1778">		StringBuilder pwtDirQueryBuilder = null;</span>
		try {
<span class="nc" id="L1780">			responseBeanMap = new HashMap&lt;Integer, SLEOrgReportResponseBean&gt;();</span>

<span class="nc" id="L1782">			String archiveAppender = &quot; UNION ALL select organization_id,sum(direct_pwt_net_amt) as pwtDir from st_rep_sle_agent where finaldate&gt;=date('&quot;</span>
					// + requestBean.getGameId()
					// + &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by organization_id&quot;;

<span class="nc" id="L1792">			pwtDirQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1793">			pwtDirQueryBuilder</span>
					.append(
							&quot;select parent_id,sum(main.pwtDir) as pwtDir from (select organization_id as parent_id,ifnull(sum(pwt_amt+agt_claim_comm-tax_amt),0.0) pwtDir from st_lms_organization_master left outer join st_sle_agent_direct_plr_pwt on organization_id=agent_org_id where transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate()).append(&quot;'&quot;).append(
							&quot; and transaction_date&lt;='&quot;).append(
							requestBean.getToDate()).append(&quot;'&quot;).append(
					// &quot; and organization_type='AGENT' and game_id=&quot;)
							// .append(requestBean.getGameId()).append(
							&quot; and organization_type='AGENT'&quot;).append(
							&quot; group by agent_org_id&quot;).append(archiveAppender)
					.append(&quot;)as main group by main.parent_id&quot;);
			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L1807">			System.out.println(&quot;fetchPWTDirDataMultipleAgent - &quot;</span>
					+ pwtDirQueryBuilder.toString());

<span class="nc" id="L1810">			stmt = connection.createStatement();</span>
<span class="nc" id="L1811">			rs = stmt.executeQuery(pwtDirQueryBuilder.toString());</span>
<span class="nc bnc" id="L1812" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1813">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L1814">				responseBean.setSaleAmt(rs.getDouble(&quot;pwtDir&quot;));</span>
<span class="nc" id="L1815">				responseBeanMap.put(rs.getInt(&quot;parent_id&quot;), responseBean);</span>
			}
<span class="nc" id="L1817">		} catch (SQLException se) {</span>
<span class="nc" id="L1818">			se.printStackTrace();</span>
<span class="nc" id="L1819">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1820">		} catch (Exception e) {</span>
<span class="nc" id="L1821">			e.printStackTrace();</span>
<span class="nc" id="L1822">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1824">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1825">		}</span>

<span class="nc" id="L1827">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchDirPlyPWTDataDayWisePerGameForBO(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1840">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1841">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1842">		Statement stmt = null;</span>
<span class="nc" id="L1843">		ResultSet rs = null;</span>
<span class="nc" id="L1844">		StringBuilder dirPWTQueryBuilder = null;</span>
		try {
<span class="nc" id="L1846">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L1851">			String archiveAppender = &quot; union all select finaldate as alldate, SUM(direct_pwt_net_amt) as pwtDir from st_rep_sle_agent where organization_id in (select organization_id from st_lms_user_master  where (termination_date &gt; '&quot;+requestBean.getFromDate()+&quot;' or registration_date&lt; '&quot;+requestBean.getToDate()+&quot;') and isrolehead='Y' and organization_type='AGENT') and  game_id=&quot;</span>
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY organization_id&quot;;

<span class="nc" id="L1861">			dirPWTQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1862">			dirPWTQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.pwtDir)as pwtDir from (select pwtDir.alldate,ifnull(pwtDir,0.0) pwtDir from(select alldate,pwtDir from tempdate left outer join (select date(transaction_date) tx_date ,sum(pwt_amt+agt_claim_comm - tax_amt) pwtDir from st_sle_agent_direct_plr_pwt where agent_org_id not in (select organization_id from st_lms_user_master where (termination_date &gt; '&quot;+requestBean.getFromDate()+&quot;' or registration_date&lt; '&quot;+requestBean.getToDate()+&quot;') and isrolehead='Y' and organization_type='AGENT' ) and transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(&quot; and game_id=&quot;)
					.append(requestBean.getGameId())
					.append(
							&quot; group by tx_date) pwtDir on alldate=pwtDir.tx_date) pwtDir&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L1880">			System.out.println(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;</span>
					+ dirPWTQueryBuilder.toString());

<span class="nc" id="L1883">			stmt = connection.createStatement();</span>
<span class="nc" id="L1884">			rs = stmt.executeQuery(dirPWTQueryBuilder.toString());</span>
<span class="nc bnc" id="L1885" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1886">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L1887">				responseBean.setPwtDirAmt(rs.getDouble(&quot;pwtDir&quot;));</span>
<span class="nc" id="L1888">				responseBeanMap.put(rs.getDate(&quot;alldate&quot;).toString(), responseBean);</span>
			}
<span class="nc" id="L1890">		} catch (SQLException se) {</span>
<span class="nc" id="L1891">			se.printStackTrace();</span>
<span class="nc" id="L1892">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1893">		} catch (Exception e) {</span>
<span class="nc" id="L1894">			e.printStackTrace();</span>
<span class="nc" id="L1895">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1897">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1898">		}</span>

<span class="nc" id="L1900">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchDirPlyPWTDataDayWiseAllGameForBO(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1913">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1914">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1915">		Statement stmt = null;</span>
<span class="nc" id="L1916">		ResultSet rs = null;</span>
<span class="nc" id="L1917">		StringBuilder dirPWTQueryBuilder = null;</span>
		try {
<span class="nc" id="L1919">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L1924">			String archiveAppender = &quot; union all select finaldate as alldate, SUM(direct_pwt_net_amt) as pwtDir from st_rep_sle_agent where game_id=&quot;</span>
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY organization_id&quot;;

<span class="nc" id="L1934">			dirPWTQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1935">			dirPWTQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.pwtDir)as pwtDir from (select pwtDir.alldate,ifnull(pwtDir,0.0) pwtDir from(select alldate,pwtDir from tempdate left outer join (select date(transaction_date) tx_date ,sum(pwt_amt+agt_claim_comm) pwtDir from st_sle_agent_direct_plr_pwt where transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					// .append(&quot; and game_id=&quot;)
					// .append(requestBean.getGameId())
					.append(
							&quot; group by tx_date) pwtDir on alldate=pwtDir.tx_date) pwtDir&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L1953">			System.out.println(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;</span>
					+ dirPWTQueryBuilder.toString());

<span class="nc" id="L1956">			stmt = connection.createStatement();</span>
<span class="nc" id="L1957">			rs = stmt.executeQuery(dirPWTQueryBuilder.toString());</span>
<span class="nc bnc" id="L1958" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1959">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L1960">				responseBean.setPwtDirAmt(rs.getDouble(&quot;pwtDir&quot;));</span>
<span class="nc" id="L1961">				responseBeanMap.put(rs.getString(&quot;alldate&quot;), responseBean);</span>
			}
<span class="nc" id="L1963">		} catch (SQLException se) {</span>
<span class="nc" id="L1964">			se.printStackTrace();</span>
<span class="nc" id="L1965">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1966">		} catch (Exception e) {</span>
<span class="nc" id="L1967">			e.printStackTrace();</span>
<span class="nc" id="L1968">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1970">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1971">		}</span>

<span class="nc" id="L1973">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchDirPlyPWTDataDayWisePerGameForAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1986">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1987">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1988">		Statement stmt = null;</span>
<span class="nc" id="L1989">		ResultSet rs = null;</span>
<span class="nc" id="L1990">		StringBuilder dirPWTQueryBuilder = null;</span>
		try {
<span class="nc" id="L1992">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L1997">			String archiveAppender = &quot; union all select sgr.finaldate as alldate,sum(ifnull(sga.direct_pwt_net_amt,0.00))as pwtDir from st_rep_sle_retailer as sgr left outer join  st_rep_sle_agent as sga on sgr.finaldate=sga.finaldate and sgr.parent_id=sga.parent_id where sgr.parent_id=&quot;</span>
					+ requestBean.getOrgId()
					+ &quot; AND sgr.game_id=&quot;
					+ requestBean.getGameId()
					+ &quot; AND sgr.finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND sgr.finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot; + &quot; GROUP BY sgr.finaldate&quot;;

<span class="nc" id="L2008">			dirPWTQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L2009">			dirPWTQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.pwtDir)as pwtDir from (select pwtDir.alldate,ifnull(pwtDir,0.0) pwtDir from(select alldate,pwtDir from tempdate left outer join (select date(transaction_date) tx_date ,sum(pwt_amt+agt_claim_comm-tax_amt) pwtDir from st_sle_agent_direct_plr_pwt where transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(&quot; and game_id=&quot;)
					.append(requestBean.getGameId())
					.append(&quot; and agent_org_id=&quot;)
					.append(requestBean.getOrgId())
					.append(
							&quot; group by tx_date) pwtDir on alldate=pwtDir.tx_date) pwtDir&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L2029">			System.out.println(&quot;fetchDirPWTDataDayWisePerGameForAgent - &quot;</span>
					+ dirPWTQueryBuilder.toString());

<span class="nc" id="L2032">			stmt = connection.createStatement();</span>
<span class="nc" id="L2033">			rs = stmt.executeQuery(dirPWTQueryBuilder.toString());</span>
<span class="nc bnc" id="L2034" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L2035">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L2036">				responseBean.setPwtDirAmt(rs.getDouble(&quot;pwtDir&quot;));</span>
<span class="nc" id="L2037">				responseBeanMap.put(rs.getString(&quot;alldate&quot;).split(&quot; &quot;)[0], responseBean);</span>
			}
<span class="nc" id="L2039">		} catch (SQLException se) {</span>
<span class="nc" id="L2040">			se.printStackTrace();</span>
<span class="nc" id="L2041">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L2042">		} catch (Exception e) {</span>
<span class="nc" id="L2043">			e.printStackTrace();</span>
<span class="nc" id="L2044">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L2046">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L2047">		}</span>

<span class="nc" id="L2049">		return responseBeanMap;</span>
	}
	
	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static void fetchPWTDataAllGameSingleAgent(
			SLEOrgReportRequestBean requestBean, SLEOrgReportResponseBean responseBean, Connection connection)
			throws GenericException {
<span class="nc" id="L2062">		Statement stmt = null;</span>
<span class="nc" id="L2063">		ResultSet rs = null;</span>
<span class="nc" id="L2064">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L2066">			String archiveAppender = &quot; UNION ALL SELECT organization_id as parent_id,IFNULL(SUM(pwt_net_amt),0.0) AS pwt FROM st_rep_sle_agent WHERE organization_id=&quot;</span>
					+ requestBean.getOrgId()
					+ &quot; AND finaldate&gt;=DATE('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=DATE('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;;

<span class="nc" id="L2075">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L2076">			saleQueryBuilder</span>
					.append(
							&quot;SELECT parent_id,SUM(main.pwt) AS pwt FROM (SELECT pwt.parent_id,SUM(pwt) pwt FROM (SELECT organization_id,parent_id,IFNULL(pwt,0.0) pwt FROM st_lms_organization_master om LEFT OUTER JOIN (SELECT retailer_org_id,SUM(agent_net_amt) AS pwt FROM st_sle_ret_pwt WHERE transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; AND transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(&quot; GROUP BY retailer_org_id) pwt on om.organization_id=retailer_org_id WHERE om.organization_type='RETAILER' AND om.parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(&quot;) pwt&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.parent_id&quot;);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L2093">			System.out.println(&quot;fetchPWTDataAllGameSingleAgent - &quot;+saleQueryBuilder.toString());</span>
			
<span class="nc" id="L2095">			stmt = connection.createStatement();</span>
<span class="nc" id="L2096">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L2097" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L2098">				responseBean.setPwtAmt(responseBean.getPwtAmt() + rs.getDouble(&quot;pwt&quot;));</span>
			}
<span class="nc" id="L2100">		} catch (SQLException se) {</span>
<span class="nc" id="L2101">			se.printStackTrace();</span>
<span class="nc" id="L2102">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L2103">		} catch (Exception e) {</span>
<span class="nc" id="L2104">			e.printStackTrace();</span>
<span class="nc" id="L2105">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L2107">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L2108">		}</span>


<span class="nc" id="L2111">	}</span>

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchDirPlyPWTDataDayWiseAllGameForAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L2123">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L2124">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L2125">		Statement stmt = null;</span>
<span class="nc" id="L2126">		ResultSet rs = null;</span>
<span class="nc" id="L2127">		StringBuilder dirPWTQueryBuilder = null;</span>
		try {
<span class="nc" id="L2129">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L2134">			String archiveAppender = &quot; union all select sgr.finaldate as alldate,sum(ifnull(sga.direct_pwt_net_amt,0.00))as pwtDir from st_rep_sle_retailer as sgr left outer join  st_rep_sle_agent as sga on sgr.finaldate=sga.finaldate and sgr.parent_id=sga.parent_id where sgr.parent_id=&quot;</span>
					+ requestBean.getOrgId()
					// + &quot; AND sgr.game_id=&quot;
					// + requestBean.getGameId()
					+ &quot; AND sgr.finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND sgr.finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY sgr.finaldate&quot;;

<span class="nc" id="L2146">			dirPWTQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L2147">			dirPWTQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.pwtDir)as pwtDir from (select pwtDir.alldate,ifnull(pwtDir,0.0) pwtDir from(select alldate,pwtDir from tempdate left outer join (select date(transaction_date) tx_date ,sum(pwt_amt+agt_claim_comm-tax_amt) pwtDir from st_sle_agent_direct_plr_pwt where transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					// .append(&quot; and game_id=&quot;)
					// .append(requestBean.getGameId())
					.append(&quot; and agent_org_id=&quot;)
					.append(requestBean.getOrgId())
					.append(
							&quot; group by tx_date) pwtDir on alldate=pwtDir.tx_date) pwtDir&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L2167">			System.out.println(&quot;fetchDirPWTDataDayWisePerGameForAgent - &quot;</span>
					+ dirPWTQueryBuilder.toString());

<span class="nc" id="L2170">			stmt = connection.createStatement();</span>
<span class="nc" id="L2171">			rs = stmt.executeQuery(dirPWTQueryBuilder.toString());</span>
<span class="nc bnc" id="L2172" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L2173">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L2174">				responseBean.setPwtDirAmt(rs.getDouble(&quot;pwtDir&quot;));</span>
<span class="nc" id="L2175">				responseBeanMap.put(rs.getString(&quot;alldate&quot;), responseBean);</span>
			}
<span class="nc" id="L2177">		} catch (SQLException se) {</span>
<span class="nc" id="L2178">			se.printStackTrace();</span>
<span class="nc" id="L2179">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L2180">		} catch (Exception e) {</span>
<span class="nc" id="L2181">			e.printStackTrace();</span>
<span class="nc" id="L2182">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L2184">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L2185">		}</span>

<span class="nc" id="L2187">		return responseBeanMap;</span>
	}

	public static void fetchSLEDirectPlyPwtofAgent(
			SLEOrgReportRequestBean requestBean, SLEOrgReportResponseBean responseBean, Connection connection)
			throws GenericException {
<span class="nc" id="L2193">		Statement stmt = null;</span>
<span class="nc" id="L2194">		ResultSet rs = null;</span>
<span class="nc" id="L2195">		StringBuilder dirPWTQueryBuilder = null;</span>
		try {
<span class="nc" id="L2197">			String archiveAppender = &quot; UNION ALL select organization_id as agent_org_id,sum(direct_pwt_amt+direct_pwt_comm-direct_pwt_tax)as pwtDir from st_rep_sle_agent where organization_id=&quot;</span>
					+ requestBean.getOrgId()
					+ &quot; AND finaldate&gt;='&quot;
					+ requestBean.getFromDate()
					+ &quot;'&quot;
					+ &quot; AND finaldate&lt;='&quot;
					+ requestBean.getToDate()
					+ &quot;'&quot;
					+ &quot; GROUP BY organization_id&quot;;

<span class="nc" id="L2207">			dirPWTQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L2208">			dirPWTQueryBuilder</span>
					.append(
							&quot;select agent_org_id,sum(main.pwtDir)as pwtDir from (select agent_org_id,sum(pwt_amt+agt_claim_comm-tax_amt) pwtDir from st_sle_agent_direct_plr_pwt where transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate()).append(&quot;'&quot;).append(
							&quot; AND transaction_date&lt;='&quot;).append(
							requestBean.getToDate()).append(&quot;'&quot;).append(
							&quot; AND agent_org_id=&quot;)
					.append(requestBean.getOrgId()).append(
							&quot; GROUP BY agent_org_id&quot;).append(archiveAppender)
					.append(&quot;)as main GROUP BY main.agent_org_id&quot;);

			// logger.debug(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L2222">			stmt = connection.createStatement();</span>
<span class="nc" id="L2223">			rs = stmt.executeQuery(dirPWTQueryBuilder.toString());</span>
<span class="nc bnc" id="L2224" title="All 2 branches missed.">			if (rs.next()) {</span>
<span class="nc" id="L2225">				responseBean.setPwtDirAmt(rs.getDouble(&quot;pwtDir&quot;));</span>
			} else {
<span class="nc" id="L2227">				responseBean.setPwtDirAmt(0.0);</span>
			}
<span class="nc" id="L2229">		} catch (SQLException se) {</span>
<span class="nc" id="L2230">			se.printStackTrace();</span>
<span class="nc" id="L2231">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L2232">		} catch (Exception e) {</span>
<span class="nc" id="L2233">			e.printStackTrace();</span>
<span class="nc" id="L2234">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L2236">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L2237">		}</span>

<span class="nc" id="L2239">	}</span>
	
	/**
	 * For Payment-Ledger Report view by BO
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, SLEOrgReportResponseBean&gt; fetchDirectPlyPWTDataDayWiseAllGameSingleAgent(
			SLEOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L2252">		Map&lt;String, SLEOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L2253">		SLEOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L2254">		Statement stmt = null;</span>
<span class="nc" id="L2255">		ResultSet rs = null;</span>
<span class="nc" id="L2256">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L2258">			responseBeanMap = new HashMap&lt;String, SLEOrgReportResponseBean&gt;();</span>

<span class="nc" id="L2260">			String archiveAppender = &quot; UNION ALL SELECT finaldate,organization_id,SUM(direct_pwt_net_amt) AS pwtDir FROM st_rep_sle_agent WHERE finaldate&gt;='&quot;</span>
					+ requestBean.getFromDate()
					+ &quot;' AND finaldate&lt;='&quot;
					+ requestBean.getToDate()
					+ &quot;'AND organization_id=&quot;
					+ requestBean.getOrgId()
					+ &quot; GROUP BY finaldate&quot;;

<span class="nc" id="L2268">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L2269">			saleQueryBuilder</span>
					.append(&quot;SELECT DATE(transaction_date) date,agent_org_id,SUM(pwt_amt+agt_claim_comm-tax_amt) pwtDir FROM st_sle_agent_direct_plr_pwt WHERE transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;' AND transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;' AND agent_org_id=&quot;)
					.append(requestBean.getOrgId())
					.append(&quot; GROUP BY DATE(transaction_date)&quot;)
					.append(archiveAppender);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L2282">			System.out.println(&quot;fetchDirectPlyPWTDataDayWiseAllGameSingleAgent - &quot;+ saleQueryBuilder.toString());</span>

<span class="nc" id="L2284">			stmt = connection.createStatement();</span>
<span class="nc" id="L2285">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L2286" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L2287">				responseBean = new SLEOrgReportResponseBean();</span>
<span class="nc" id="L2288">				responseBean.setPwtDirAmt(rs.getDouble(&quot;pwtDir&quot;));</span>
<span class="nc" id="L2289">				responseBeanMap.put(rs.getString(&quot;date&quot;), responseBean);</span>
			}
<span class="nc" id="L2291">		} catch (SQLException se) {</span>
<span class="nc" id="L2292">			se.printStackTrace();</span>
<span class="nc" id="L2293">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L2294">		} catch (Exception e) {</span>
<span class="nc" id="L2295">			e.printStackTrace();</span>
<span class="nc" id="L2296">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L2298">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L2299">		}</span>

<span class="nc" id="L2301">		return responseBeanMap;</span>
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>