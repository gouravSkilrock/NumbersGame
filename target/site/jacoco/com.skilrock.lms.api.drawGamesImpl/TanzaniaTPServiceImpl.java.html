<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TanzaniaTPServiceImpl.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">lms</a> &gt; <a href="index.source.html" class="el_package">com.skilrock.lms.api.drawGamesImpl</a> &gt; <span class="el_source">TanzaniaTPServiceImpl.java</span></div><h1>TanzaniaTPServiceImpl.java</h1><pre class="source lang-java linenums">package com.skilrock.lms.api.drawGamesImpl;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.servlet.ServletContext;
import javax.servlet.http.HttpServletRequest;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.apache.struts2.ServletActionContext;
import org.codehaus.xfire.transport.http.XFireServletController;

import com.skilrock.lms.api.beans.CancelBean;
import com.skilrock.lms.api.beans.DrawDetailsBean;
import com.skilrock.lms.api.beans.GameDrawInfoBean;
import com.skilrock.lms.api.beans.GameInfoBean;
import com.skilrock.lms.api.beans.PWTApiBean;
import com.skilrock.lms.api.beans.PanelBean;
import com.skilrock.lms.api.beans.RaffleBean;
import com.skilrock.lms.api.beans.ReprintBean;
import com.skilrock.lms.api.beans.TPGameDetailsBean;
import com.skilrock.lms.api.beans.TPKenoPurchaseBean;
import com.skilrock.lms.api.beans.TPLottoPurchaseBean;
import com.skilrock.lms.api.beans.TPUserBalaanceBean;
import com.skilrock.lms.api.beans.TicketHeaderInfoBean;
import com.skilrock.lms.api.drawGames.ITanzaniaTPService;
import com.skilrock.lms.beans.UserInfoBean;
import com.skilrock.lms.common.exception.LMSException;
import com.skilrock.lms.common.utility.LMSUtility;

<span class="nc" id="L33">public class TanzaniaTPServiceImpl implements ITanzaniaTPService {</span>
<span class="nc" id="L34">	static Log logger = LogFactory.getLog(TanzaniaTPServiceImpl.class);</span>

	public TPLottoPurchaseBean bonusBallLottoSale(
			TPLottoPurchaseBean bonusBallLottoBean) {
<span class="nc" id="L38">		String userName = bonusBallLottoBean.getUserName();</span>
<span class="nc" id="L39">		String password = bonusBallLottoBean.getPassword();</span>
<span class="nc" id="L40">		String ip = XFireServletController.getRequest().getRemoteHost();</span>
<span class="nc" id="L41">		String usrReqStr = &quot;TP REQUEST bonusBallLottoSale=userName:&quot; + userName</span>
				+ &quot;|pasword:&quot; + password + &quot;|ip:&quot; + ip + &quot;|&quot;;
<span class="nc" id="L43">		String resStr = &quot;TP RESPONSE bonusBallLottoSale=|userName:&quot; + userName;</span>
<span class="nc" id="L44">		StringBuilder raffleData = new StringBuilder(&quot;#Raffle Data:&quot;);</span>
<span class="nc" id="L45">		StringBuilder panelArr = new StringBuilder(&quot;#Panel Data:&quot;);</span>
<span class="nc" id="L46">		String dataStr = &quot;|gameCode:&quot; + bonusBallLottoBean.getGameCode()</span>
				+ &quot;|Balance:&quot; + bonusBallLottoBean.getBalance() + &quot;|ErrorCode:&quot;
				+ bonusBallLottoBean.getErrorCode() + &quot;|AdvancedPlay:&quot;
				+ bonusBallLottoBean.getIsAdvancedPlay() + &quot;|LmsTranxId:&quot;
				+ bonusBallLottoBean.getLmsTranxId() + &quot;|MobileNumber:&quot;
				+ bonusBallLottoBean.getMobileNumber() + &quot;|NoOfDraws:&quot;
				+ bonusBallLottoBean.getNoOfDraws() + &quot;|NoPicked:&quot;
				+ bonusBallLottoBean.getNoPicked() + &quot;|PurchaseTime:&quot;
				+ bonusBallLottoBean.getPurchaseTime() + &quot;|RefTransId:&quot;
				+ bonusBallLottoBean.getRefTransId() + &quot;|TicketCost:&quot;
				+ bonusBallLottoBean.getTicketCost() + &quot;|TicketNumber:&quot;
				+ bonusBallLottoBean.getTicketNumber() + &quot;|TotalPurchaseAmt:&quot;
				+ bonusBallLottoBean.getTotalPurchaseAmt();
<span class="nc bnc" id="L59" title="All 2 branches missed.">		for (int i = 0; i &lt; bonusBallLottoBean.getPickedNumbers().length; i++) {</span>
<span class="nc" id="L60">			panelArr.append(&quot;|Pick Numbers:&quot;</span>
					+ bonusBallLottoBean.getPickedNumbers()[i]);
		}
<span class="nc bnc" id="L63" title="All 2 branches missed.">		if (bonusBallLottoBean.isRaffle()) {</span>
<span class="nc" id="L64">			raffleData.append(&quot;|isRaffle:&quot; + bonusBallLottoBean.isRaffle()</span>
					+ &quot;|RaffleTicketNumber:&quot;
					+ bonusBallLottoBean.getRaffleData().getTicketNumber());
		}
<span class="nc" id="L68">		logger.debug(usrReqStr + dataStr + panelArr + raffleData);</span>
<span class="nc" id="L69">		UserInfoBean userBean = DrawGameAPIHelper.getUserData(userName);</span>
<span class="nc bnc" id="L70" title="All 2 branches missed.">		if (userBean != null) {</span>
<span class="nc bnc" id="L71" title="All 2 branches missed.">			if (APIUtility.validateUser(userBean, ip, password)) {</span>
<span class="nc" id="L72">				HttpServletRequest request = XFireServletController</span>
						.getRequest();
<span class="nc" id="L74">				request.setAttribute(&quot;code&quot;, &quot;DG&quot;);</span>
<span class="nc" id="L75">				request.setAttribute(&quot;interfaceType&quot;, &quot;TERMINAL&quot;);</span>
<span class="nc" id="L76">				ServletActionContext.setRequest(request);</span>

				try {
<span class="nc" id="L79">					BonusBallLottoAction.purchaseTicketProcess(</span>
							bonusBallLottoBean, userBean);
<span class="nc bnc" id="L81" title="All 2 branches missed.">					if (&quot;100&quot;.equalsIgnoreCase(bonusBallLottoBean</span>
							.getErrorCode())) {
<span class="nc" id="L83">						StringBuilder raffleData1 = new StringBuilder(</span>
								&quot;#Raffle Data:&quot;);
<span class="nc" id="L85">						StringBuilder panelArr1 = new StringBuilder(</span>
								&quot;#Panel Data:&quot;);
<span class="nc" id="L87">						String finalResp = &quot;|gameCode:&quot;</span>
								+ bonusBallLottoBean.getGameCode()
								+ &quot;|Balance:&quot; + bonusBallLottoBean.getBalance()
								+ &quot;|ErrorCode:&quot;
								+ bonusBallLottoBean.getErrorCode()
								+ &quot;|AdvancedPlay:&quot;
								+ bonusBallLottoBean.getIsAdvancedPlay()
								+ &quot;|LmsTranxId:&quot;
								+ bonusBallLottoBean.getLmsTranxId()
								+ &quot;|MobileNumber:&quot;
								+ bonusBallLottoBean.getMobileNumber()
								+ &quot;|NoOfDraws:&quot;
								+ bonusBallLottoBean.getNoOfDraws()
								+ &quot;|DrawDateTime:&quot;
								+ bonusBallLottoBean.getDrawDateTime()
								+ &quot;|NoPicked:&quot;
								+ bonusBallLottoBean.getNoPicked()
								+ &quot;|PurchaseTime:&quot;
								+ bonusBallLottoBean.getPurchaseTime()
								+ &quot;|RefTransId:&quot;
								+ bonusBallLottoBean.getRefTransId()
								+ &quot;|TicketCost:&quot;
								+ bonusBallLottoBean.getTicketCost()
								+ &quot;|TicketNumber:&quot;
								+ bonusBallLottoBean.getTicketNumber()
								+ &quot;|TotalPurchaseAmt:&quot;
								+ bonusBallLottoBean.getTotalPurchaseAmt()
								+ &quot;|TopAdMessageList:&quot;
								+ bonusBallLottoBean.getTopAdMessageList()
								+ &quot;|BottomAdMessageList:&quot;
								+ bonusBallLottoBean.getBottomAdMessageList();
<span class="nc bnc" id="L118" title="All 2 branches missed.">						for (int i = 0; i &lt; bonusBallLottoBean</span>
<span class="nc" id="L119">								.getPickedNumbers().length; i++) {</span>
<span class="nc" id="L120">							panelArr1.append(&quot;|Pick Numbers:&quot;</span>
									+ bonusBallLottoBean.getPickedNumbers()[i]
									+ &quot;|QpStatus:&quot;
									+ bonusBallLottoBean.getQpStatus()[i]);
						}
<span class="nc bnc" id="L125" title="All 2 branches missed.">						if (bonusBallLottoBean.isRaffle()) {</span>
<span class="nc" id="L126">							raffleData1.append(&quot;|isRaffle:&quot;</span>
									+ bonusBallLottoBean.isRaffle()
									+ &quot;|RaffleTicketNumber:&quot;
									+ bonusBallLottoBean.getRaffleData()
											.getTicketNumber());
						}
<span class="nc" id="L132">						logger.debug(resStr + finalResp + panelArr1</span>
								+ raffleData1);
<span class="nc" id="L134">					} else {</span>
<span class="nc" id="L135">						logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
								+ bonusBallLottoBean.getErrorCode());
					}
<span class="nc" id="L138">				} catch (Exception e) {</span>
<span class="nc" id="L139">					e.printStackTrace();</span>
<span class="nc" id="L140">					bonusBallLottoBean.setSuccess(false);</span>
<span class="nc" id="L141">					bonusBallLottoBean.setErrorCode(&quot;500&quot;);// internal server</span>
					// error
<span class="nc" id="L143">					logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
							+ bonusBallLottoBean.getErrorCode());
<span class="nc" id="L145">					return bonusBallLottoBean;</span>
<span class="nc" id="L146">				}</span>

<span class="nc" id="L148">			} else {</span>
<span class="nc" id="L149">				bonusBallLottoBean.setSuccess(false);</span>
<span class="nc" id="L150">				bonusBallLottoBean.setErrorCode(&quot;102&quot;);// Invalid User</span>
<span class="nc" id="L151">				logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
						+ bonusBallLottoBean.getErrorCode());
			}

		} else {
<span class="nc" id="L156">			bonusBallLottoBean.setSuccess(false);</span>
<span class="nc" id="L157">			bonusBallLottoBean.setErrorCode(&quot;103&quot;);// Please call gameInfo first</span>
<span class="nc" id="L158">			logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
					+ bonusBallLottoBean.getErrorCode());
<span class="nc" id="L160">			return bonusBallLottoBean;</span>
		}
<span class="nc" id="L162">		return bonusBallLottoBean;</span>
	}

	public CancelBean cancelTicket(String userName, String password,
			String lmsTranxIdToRefund, String refTransId, String mobileNumber) {
<span class="nc" id="L167">		CancelBean cancelBean = new CancelBean();</span>
<span class="nc" id="L168">		String ip = XFireServletController.getRequest().getRemoteHost();</span>
<span class="nc" id="L169">		logger.debug(&quot;TP REQUEST cancelTicket=userName:&quot; + userName</span>
				+ &quot;|pasword:&quot; + password + &quot;|ip:&quot; + ip + &quot;|&quot;
				+ &quot;|lmsTranxIdToRefund:&quot; + lmsTranxIdToRefund + &quot;|refTransId:&quot;
				+ refTransId + &quot;|mobileNumber:&quot; + mobileNumber);
<span class="nc" id="L173">		String resStr = &quot;TP RESPONSE cancelTicket=|userName:&quot; + userName;</span>
<span class="nc" id="L174">		UserInfoBean userBean = DrawGameAPIHelper.getUserData(userName);</span>
<span class="nc bnc" id="L175" title="All 2 branches missed.">		if (userBean != null) {</span>
<span class="nc bnc" id="L176" title="All 2 branches missed.">			if (APIUtility.validateUser(userBean, ip, password)) {</span>
<span class="nc" id="L177">				HttpServletRequest request = XFireServletController</span>
						.getRequest();
<span class="nc" id="L179">				request.setAttribute(&quot;code&quot;, &quot;DG&quot;);</span>
<span class="nc" id="L180">				request.setAttribute(&quot;interfaceType&quot;, &quot;TERMINAL&quot;);</span>
<span class="nc" id="L181">				ServletActionContext.setRequest(request);</span>
				try {
<span class="nc" id="L183">					cancelBean = DrawGameAPIHelper.cancelTicket(userBean,</span>
							lmsTranxIdToRefund, refTransId, mobileNumber);
<span class="nc bnc" id="L185" title="All 2 branches missed.">					if (&quot;100&quot;.equalsIgnoreCase(cancelBean.getErrorCode())) {</span>
<span class="nc" id="L186">						String finalResp = &quot;|ErrorCode:&quot;</span>
								+ cancelBean.getErrorCode() + &quot;|RefundAmount:&quot;
								+ cancelBean.getRefundAmount()
								+ &quot;|TicketNumber:&quot;
								+ cancelBean.getTicketNumber() + &quot;|Balance:&quot;
								+ cancelBean.getBalance() + &quot;|LmsTransId:&quot;
								+ cancelBean.getLmsTransId()
								+ &quot;|LmsTranxIdToRefund:&quot;
								+ cancelBean.getLmsTranxIdToRefund()
								+ &quot;|refTransId:&quot; + refTransId;
<span class="nc" id="L196">						logger.debug(resStr + finalResp);</span>
<span class="nc" id="L197">					} else {</span>
<span class="nc" id="L198">						logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
								+ cancelBean.getErrorCode());
					}
<span class="nc" id="L201">				} catch (Exception e) {</span>
<span class="nc" id="L202">					e.printStackTrace();</span>
<span class="nc" id="L203">					cancelBean.setErrorCode(&quot;500&quot;);</span>
<span class="nc" id="L204">					cancelBean.setSuccess(false);</span>
<span class="nc" id="L205">					logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
							+ cancelBean.getErrorCode());
<span class="nc" id="L207">					return cancelBean;</span>
<span class="nc" id="L208">				}</span>

<span class="nc" id="L210">			} else {</span>
<span class="nc" id="L211">				cancelBean.setSuccess(false);</span>
<span class="nc" id="L212">				cancelBean.setErrorCode(&quot;102&quot;);// Invalid User</span>
<span class="nc" id="L213">				logger</span>
						.debug(resStr + &quot;|ErrorCode:&quot;
								+ cancelBean.getErrorCode());
			}
		} else {
<span class="nc" id="L218">			cancelBean.setSuccess(false);</span>
<span class="nc" id="L219">			cancelBean.setErrorCode(&quot;103&quot;);// Please call gameInfo first</span>
<span class="nc" id="L220">			logger.debug(resStr + &quot;|ErrorCode:&quot; + cancelBean.getErrorCode());</span>
		}

<span class="nc" id="L223">		return cancelBean;</span>
	}

	public List&lt;GameDrawInfoBean&gt; drawResult(String userName, String password,
			String gameCode, String date) {
<span class="nc" id="L228">		String ip = XFireServletController.getRequest().getRemoteHost();</span>
<span class="nc" id="L229">		logger.debug(&quot;TP REQUEST drawResult=userName:&quot; + userName + &quot;|pasword:&quot;</span>
				+ password + &quot;|ip:&quot; + ip + &quot;|&quot; + &quot;|gameCode:&quot; + gameCode
				+ &quot;|date:&quot; + date);
<span class="nc" id="L232">		String resStr = &quot;TP RESPONSE drawResult=|userName:&quot; + userName;</span>
<span class="nc" id="L233">		List&lt;GameDrawInfoBean&gt; returnList = null;</span>
<span class="nc" id="L234">		UserInfoBean userBean = DrawGameAPIHelper.getUserData(userName);</span>
<span class="nc bnc" id="L235" title="All 2 branches missed.">		if (userBean != null) {</span>
<span class="nc bnc" id="L236" title="All 2 branches missed.">			if (APIUtility.validateUser(userBean, ip, password)) {</span>
<span class="nc" id="L237">				returnList = DrawGameAPIHelper.drawResult(gameCode, date);</span>
<span class="nc bnc" id="L238" title="All 4 branches missed.">				if (returnList != null &amp;&amp; returnList.size() &gt; 0) {</span>
<span class="nc" id="L239">					StringBuilder finalStr = new StringBuilder(</span>
							&quot;#Draw Result Data:&quot;);
<span class="nc" id="L241">					GameDrawInfoBean bean = null;</span>
<span class="nc bnc" id="L242" title="All 2 branches missed.">					for (int i = 0; i &lt; returnList.size(); i++) {</span>
<span class="nc" id="L243">						bean = returnList.get(i);</span>
<span class="nc" id="L244">						finalStr.append(&quot;|GameCode:&quot; + bean.getGameCode());</span>
<span class="nc bnc" id="L245" title="All 4 branches missed.">						if (bean.getDrawResultList() != null</span>
								&amp;&amp; bean.getDrawResultList().size() &gt; 0) {
<span class="nc" id="L247">							DrawDetailsBean drawBean = null;</span>
<span class="nc bnc" id="L248" title="All 2 branches missed.">							for (int j = 0; j &lt; bean.getDrawResultList().size(); j++) {</span>
<span class="nc" id="L249">								drawBean = bean.getDrawResultList().get(j);</span>
<span class="nc" id="L250">								finalStr</span>
										.append(&quot;|DrawId:&quot;
												+ drawBean.getDrawId()
												+ &quot;|DrawDateTime:&quot;
												+ drawBean.getDrawDateTime()
												+ &quot;|Symbols:&quot;
												+ drawBean.getSymbols()
												+ &quot;|DrawName:&quot;
												+ drawBean.getDrawName());
							}
						}
					}
<span class="nc" id="L262">					logger.debug(resStr + finalStr);</span>
<span class="nc" id="L263">				} else {</span>
<span class="nc" id="L264">					logger.debug(resStr + &quot;result list is null&quot;);</span>
				}
<span class="nc" id="L266">				return returnList;</span>
			}
		}

<span class="nc" id="L270">		return returnList;</span>

	}

	@SuppressWarnings(&quot;unchecked&quot;)
	public TPGameDetailsBean gameInfo(String userName, String password) {
<span class="nc" id="L276">		String ip = XFireServletController.getRequest().getRemoteHost();</span>
<span class="nc" id="L277">		logger.debug(&quot;TP REQUEST gameInfo=userName:&quot; + userName + &quot;|password:&quot;</span>
				+ password + &quot;|ip:&quot; + ip + &quot;|&quot;);
<span class="nc" id="L279">		String resStr = &quot;TP RESPONSE gameInfo=|userName:&quot; + userName;</span>
<span class="nc" id="L280">		TPGameDetailsBean tpGameReturnBean = new TPGameDetailsBean();</span>
<span class="nc bnc" id="L281" title="All 2 branches missed.">		if (APIUtility.isValidUser(userName, password, ip)) {</span>
<span class="nc" id="L282">			ServletContext sc = LMSUtility.sc;</span>
<span class="nc" id="L283">			System.out.println(&quot;Valid user with ip:&quot; + ip);</span>
<span class="nc" id="L284">			Map&lt;String, UserInfoBean&gt; currentUsersMap = (Map&lt;String, UserInfoBean&gt;) sc</span>
					.getAttribute(&quot;API_LOGGED_IN_USERS_MAP&quot;);
<span class="nc bnc" id="L286" title="All 2 branches missed.">			if (currentUsersMap == null) {</span>
<span class="nc" id="L287">				currentUsersMap = new HashMap&lt;String, UserInfoBean&gt;();</span>
			}

<span class="nc" id="L290">			UserInfoBean userBean = currentUsersMap.get(userName);</span>
<span class="nc bnc" id="L291" title="All 2 branches missed.">			if (userBean == null) {</span>
<span class="nc" id="L292">				userBean = DrawGameAPIHelper.createUserData(userName, password);</span>
<span class="nc bnc" id="L293" title="All 2 branches missed.">				if (userBean == null) {</span>
<span class="nc" id="L294">					tpGameReturnBean.setSuccess(false);</span>
<span class="nc" id="L295">					tpGameReturnBean.setErrorCode(&quot;102&quot;);// Invalid User</span>
<span class="nc" id="L296">					logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
							+ tpGameReturnBean.getErrorCode());
<span class="nc" id="L298">					return tpGameReturnBean;</span>
				} else {
<span class="nc" id="L300">					currentUsersMap.put(userName, userBean);</span>
<span class="nc" id="L301">					sc.setAttribute(&quot;API_LOGGED_IN_USERS_MAP&quot;, currentUsersMap);</span>
				}
			}

			try {
<span class="nc bnc" id="L306" title="All 2 branches missed.">				if (userBean != null) {</span>
<span class="nc" id="L307">					tpGameReturnBean = DrawGameAPIHelper.apiDgData(userBean);</span>
<span class="nc bnc" id="L308" title="All 2 branches missed.">					if (&quot;100&quot;.equalsIgnoreCase(tpGameReturnBean.getErrorCode())) {</span>
<span class="nc" id="L309">						StringBuilder gameData = new StringBuilder(</span>
								&quot;#Game Data:&quot;);
<span class="nc" id="L311">						String finlResp = &quot;|NextTimeTogGetInfo:&quot;</span>
								+ tpGameReturnBean.getNextTimeTogGetInfo()
								+ &quot;|ErrorCode:&quot;
								+ tpGameReturnBean.getErrorCode();
<span class="nc bnc" id="L315" title="All 4 branches missed.">						if (tpGameReturnBean.getGameBeanList() != null</span>
								&amp;&amp; tpGameReturnBean.getGameBeanList().size() &gt; 0) {
<span class="nc" id="L317">							GameInfoBean gameBean = null;</span>
<span class="nc bnc" id="L318" title="All 2 branches missed.">							for (int i = 0; i &lt; tpGameReturnBean</span>
<span class="nc" id="L319">									.getGameBeanList().size(); i++) {</span>
<span class="nc" id="L320">								StringBuilder drawData = new StringBuilder(</span>
										&quot;#Draw Data:&quot;);
<span class="nc" id="L322">								gameBean = tpGameReturnBean.getGameBeanList()</span>
										.get(i);
<span class="nc" id="L324">								gameData.append(&quot;|GameCode:&quot;</span>
										+ gameBean.getGameCode()
										+ &quot;|GameDisplayName:&quot;
										+ gameBean.getGameDisplayName()
										+ &quot;|GameNo:&quot; + gameBean.getGameNo()
										+ &quot;|JackpotAmount:&quot;
										+ gameBean.getJackpotAmount()
										+ &quot;|NoOfDraws:&quot;
										+ gameBean.getNoOfDraws()
										+ &quot;|Ticket_validity:&quot;
										+ gameBean.getTicket_validity()
										+ &quot;|Online_FTG:&quot;
										+ gameBean.getOnline_FTG() + &quot;|Type:&quot;
										+ gameBean.getType()
										+ &quot;|TypeSpecificInfo:&quot;
										+ gameBean.getTypeSpecificInfo()
										+ &quot;|Unit_price:&quot;
										+ gameBean.getUnit_price());
<span class="nc bnc" id="L342" title="All 4 branches missed.">								if (gameBean.getDrawBeanList() != null</span>
										&amp;&amp; gameBean.getDrawBeanList().size() &gt; 0) {
<span class="nc bnc" id="L344" title="All 2 branches missed.">									for (int j = 0; j &lt; gameBean</span>
<span class="nc" id="L345">											.getDrawBeanList().size(); j++) {</span>
<span class="nc" id="L346">										drawData.append(&quot;|DrawDateTime:&quot;</span>
												+ gameBean.getDrawBeanList()
														.get(j)
														.getDrawDateTime()
												+ &quot;|DrawId:&quot;
												+ gameBean.getDrawBeanList()
														.get(j).getDrawId()
												+ &quot;|DrawName:&quot;
												+ gameBean.getDrawBeanList()
														.get(j).getDrawName());

									}
								}
<span class="nc" id="L359">								gameData.append(drawData);</span>

							}
						}
<span class="nc" id="L363">						logger.debug(resStr + finlResp + gameData);</span>
<span class="nc" id="L364">					} else {</span>
<span class="nc" id="L365">						logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
								+ tpGameReturnBean.getErrorCode());
					}
				}
<span class="nc" id="L369">			} catch (LMSException e) {</span>
<span class="nc" id="L370">				e.printStackTrace();</span>
<span class="nc" id="L371">				tpGameReturnBean.setSuccess(false);</span>
<span class="nc" id="L372">				tpGameReturnBean.setErrorCode(&quot;500&quot;);// Internal server error</span>
<span class="nc" id="L373">				logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
						+ tpGameReturnBean.getErrorCode());
<span class="nc" id="L375">				return tpGameReturnBean;</span>
<span class="nc" id="L376">			}</span>
<span class="nc" id="L377">		} else {</span>
<span class="nc" id="L378">			tpGameReturnBean.setSuccess(false);</span>
<span class="nc" id="L379">			tpGameReturnBean.setErrorCode(&quot;102&quot;);// Invalid User</span>
<span class="nc" id="L380">			logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
					+ tpGameReturnBean.getErrorCode());
<span class="nc" id="L382">			return tpGameReturnBean;</span>
		}
<span class="nc" id="L384">		tpGameReturnBean.setSuccess(true);</span>
<span class="nc" id="L385">		tpGameReturnBean.setErrorCode(&quot;100&quot;);// success</span>
<span class="nc" id="L386">		return tpGameReturnBean;</span>
	}

	public TPUserBalaanceBean getBalanceInfo(String userName, String password) {
<span class="nc" id="L390">		String ip = XFireServletController.getRequest().getRemoteHost();</span>
<span class="nc" id="L391">		logger.debug(&quot;TP REQUEST getBalanceInfo=userName:&quot; + userName</span>
				+ &quot;|password:&quot; + password + &quot;|ip:&quot; + ip + &quot;|&quot;);
<span class="nc" id="L393">		String resStr = &quot;TP RESPONSE getBalanceInfo=|userName:&quot; + userName;</span>
<span class="nc" id="L394">		TPUserBalaanceBean returnBalBean = new TPUserBalaanceBean();</span>
<span class="nc" id="L395">		UserInfoBean userBean = DrawGameAPIHelper.getUserData(userName);</span>
<span class="nc bnc" id="L396" title="All 2 branches missed.">		if (userBean != null) {</span>
<span class="nc bnc" id="L397" title="All 2 branches missed.">			if (APIUtility.validateUser(userBean, ip, password)) {</span>
<span class="nc" id="L398">				logger.debug(&quot;valid user ... getting balance info...&quot;);</span>
<span class="nc" id="L399">				returnBalBean = DrawGameAPIHelper.getUserBal(userBean);</span>
<span class="nc" id="L400">				logger.debug(resStr + &quot;|Balance:&quot; + returnBalBean.getBalance()</span>
						+ &quot;|ErrorCode:&quot; + returnBalBean.getErrorCode());
			} else {
<span class="nc" id="L403">				returnBalBean.setSuccess(false);</span>
<span class="nc" id="L404">				returnBalBean.setErrorCode(&quot;102&quot;);// Invalid User</span>
<span class="nc" id="L405">				logger.debug(resStr + &quot;|Balance:&quot; + returnBalBean.getBalance()</span>
						+ &quot;|ErrorCode:&quot; + returnBalBean.getErrorCode());
			}

		} else {
<span class="nc" id="L410">			System.out.println(&quot;user bean is null...&quot;);</span>
			// System.out.println(&quot;Invalid user&quot;);
<span class="nc" id="L412">			returnBalBean.setSuccess(false);</span>
<span class="nc" id="L413">			returnBalBean.setErrorCode(&quot;103&quot;);// Please call gameInfo first</span>
<span class="nc" id="L414">			logger.debug(resStr + &quot;|Balance:&quot; + returnBalBean.getBalance()</span>
					+ &quot;|ErrorCode:&quot; + returnBalBean.getErrorCode());
		}

<span class="nc" id="L418">		return returnBalBean;</span>
	}

	public TPKenoPurchaseBean kenoSale(TPKenoPurchaseBean kenoPurchaseBean) {
<span class="nc" id="L422">		String userName = kenoPurchaseBean.getUserName();</span>
<span class="nc" id="L423">		String password = kenoPurchaseBean.getPassword();</span>
<span class="nc" id="L424">		String ip = XFireServletController.getRequest().getRemoteHost();</span>
<span class="nc" id="L425">		String usrReqStr = &quot;TP REQUEST kenoSale=userName:&quot; + userName</span>
				+ &quot;|pasword:&quot; + password + &quot;|ip:&quot; + ip + &quot;|&quot;;
<span class="nc" id="L427">		String resStr = &quot;TP RESPONSE kenoSale=|userName:&quot; + userName;</span>
<span class="nc" id="L428">		StringBuilder panelStr = new StringBuilder(&quot;#Panel Data&quot;);</span>
<span class="nc" id="L429">		String dataStr = &quot;|gameCode:&quot; + kenoPurchaseBean.getGameCode()</span>
				+ &quot;|Balance:&quot; + kenoPurchaseBean.getBalance() + &quot;|ErrorCode:&quot;
				+ kenoPurchaseBean.getErrorCode() + &quot;|LmsTranxId:&quot;
				+ kenoPurchaseBean.getLmsTranxId() + &quot;|MobileNumber:&quot;
				+ &quot;|IsAdvancePlay:&quot; + kenoPurchaseBean.getIsAdvancePlay()
				+ kenoPurchaseBean.getMobileNumber() + &quot;|NoOfDraws:&quot;
				+ kenoPurchaseBean.getNoOfDraws() + &quot;|DrawDateTimeList:&quot;
				+ kenoPurchaseBean.getDrawDateTimeList() + &quot;|PurchaseTime:&quot;
				+ kenoPurchaseBean.getPurchaseTime() + &quot;|RefTransId:&quot;
				+ kenoPurchaseBean.getRefTransId() + &quot;|TicketCost:&quot;
				+ kenoPurchaseBean.getTicketCost() + &quot;|TicketNumber:&quot;
				+ kenoPurchaseBean.getTicketNumber() + &quot;|TotalPurchaseAmt:&quot;
				+ kenoPurchaseBean.getTotalPurchaseAmt() + &quot;|TopAdMessageList:&quot;
				+ kenoPurchaseBean.getTopAdMessageList()
				+ &quot;|BottomAdMessageList:&quot;
				+ kenoPurchaseBean.getBottomAdMessageList();
<span class="nc bnc" id="L445" title="All 4 branches missed.">		if (kenoPurchaseBean.getPanelList() != null</span>
				&amp;&amp; kenoPurchaseBean.getPanelList().size() &gt; 0) {
<span class="nc bnc" id="L447" title="All 2 branches missed.">			for (PanelBean panelBean : kenoPurchaseBean.getPanelList()) {</span>
<span class="nc" id="L448">				panelStr.append(&quot;|PickedNumbers:&quot;</span>
						+ panelBean.getPickedNumbers() + &quot;|NoPicked:&quot;
						+ panelBean.getNoPicked() + &quot;|PlayType:&quot;
						+ panelBean.getPlayType() + &quot;|BetAmountMultiple:&quot;
						+ panelBean.getBetAmountMultiple() + &quot;|IsQp:&quot;
						+ panelBean.getIsQp());
<span class="nc" id="L454">			}</span>
		}
<span class="nc" id="L456">		logger.debug(usrReqStr + panelStr + dataStr);</span>
<span class="nc" id="L457">		UserInfoBean userBean = DrawGameAPIHelper.getUserData(userName);</span>
<span class="nc bnc" id="L458" title="All 2 branches missed.">		if (userBean != null) {</span>
<span class="nc bnc" id="L459" title="All 2 branches missed.">			if (APIUtility.validateUser(userBean, ip, password)) {</span>
<span class="nc" id="L460">				HttpServletRequest request = XFireServletController</span>
						.getRequest();
<span class="nc" id="L462">				request.setAttribute(&quot;code&quot;, &quot;DG&quot;);</span>
<span class="nc" id="L463">				request.setAttribute(&quot;interfaceType&quot;, &quot;TERMINAL&quot;);</span>
<span class="nc" id="L464">				ServletActionContext.setRequest(request);</span>
<span class="nc" id="L465">				KenoAction.purchaseTicketProcess(kenoPurchaseBean, userBean);</span>
<span class="nc bnc" id="L466" title="All 2 branches missed.">				if (&quot;100&quot;.equalsIgnoreCase(kenoPurchaseBean.getErrorCode())) {</span>
<span class="nc" id="L467">					StringBuilder panelStr1 = new StringBuilder(&quot;#Panel Data&quot;);</span>
<span class="nc" id="L468">					StringBuilder raffleData = new StringBuilder(</span>
							&quot;#Raffle Data:&quot;);
<span class="nc" id="L470">					String finalResp = &quot;|gameCode:&quot;</span>
							+ kenoPurchaseBean.getGameCode() + &quot;|Balance:&quot;
							+ kenoPurchaseBean.getBalance() + &quot;|ErrorCode:&quot;
							+ kenoPurchaseBean.getErrorCode() + &quot;|LmsTranxId:&quot;
							+ kenoPurchaseBean.getLmsTranxId()
							+ &quot;|MobileNumber:&quot;
							+ kenoPurchaseBean.getMobileNumber()
							+ &quot;|NoOfDraws:&quot; + kenoPurchaseBean.getNoOfDraws()
							+ &quot;|IsAdvancePlay:&quot;
							+ kenoPurchaseBean.getIsAdvancePlay()
							+ &quot;|DrawDateTimeList:&quot;
							+ kenoPurchaseBean.getDrawDateTimeList()
							+ &quot;|PurchaseTime:&quot;
							+ kenoPurchaseBean.getPurchaseTime()
							+ &quot;|RefTransId:&quot; + kenoPurchaseBean.getRefTransId()
							+ &quot;|TicketCost:&quot; + kenoPurchaseBean.getTicketCost()
							+ &quot;|TicketNumber:&quot;
							+ kenoPurchaseBean.getTicketNumber()
							+ &quot;|TotalPurchaseAmt:&quot;
							+ kenoPurchaseBean.getTotalPurchaseAmt()
							+ &quot;|TopAdMessageList:&quot;
							+ kenoPurchaseBean.getTopAdMessageList()
							+ &quot;|BottomAdMessageList:&quot;
							+ kenoPurchaseBean.getBottomAdMessageList();
<span class="nc bnc" id="L494" title="All 4 branches missed.">					if (kenoPurchaseBean.getPanelList() != null</span>
							&amp;&amp; kenoPurchaseBean.getPanelList().size() &gt; 0) {
<span class="nc bnc" id="L496" title="All 2 branches missed.">						for (PanelBean panelBean : kenoPurchaseBean</span>
								.getPanelList()) {
<span class="nc" id="L498">							panelStr1.append(&quot;|PickedNumbers:&quot;</span>
									+ panelBean.getPickedNumbers()
									+ &quot;|NoPicked:&quot; + panelBean.getNoPicked()
									+ &quot;|PlayType:&quot; + panelBean.getPlayType()
									+ &quot;|BetAmountMultiple:&quot;
									+ panelBean.getBetAmountMultiple()
									+ &quot;|IsQp:&quot; + panelBean.getIsQp());
<span class="nc" id="L505">						}</span>
					}
<span class="nc bnc" id="L507" title="All 2 branches missed.">					if (kenoPurchaseBean.isRaffle()) {</span>
<span class="nc" id="L508">						raffleData.append(&quot;|isRaffle:&quot;</span>
								+ kenoPurchaseBean.isRaffle()
								+ &quot;|RaffleTicketNumber:&quot;
								+ kenoPurchaseBean.getRaffleData()
										.getTicketNumber());
					}
<span class="nc" id="L514">					logger.debug(resStr + panelStr1 + finalResp + raffleData);</span>
<span class="nc" id="L515">				} else {</span>
<span class="nc" id="L516">					logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
							+ kenoPurchaseBean.getErrorCode());
				}

<span class="nc" id="L520">			} else {</span>
<span class="nc" id="L521">				kenoPurchaseBean.setSuccess(false);</span>
<span class="nc" id="L522">				kenoPurchaseBean.setErrorCode(&quot;102&quot;);// Invalid User</span>
<span class="nc" id="L523">				logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
						+ kenoPurchaseBean.getErrorCode());
			}
		} else {
<span class="nc" id="L527">			kenoPurchaseBean.setSuccess(false);</span>
<span class="nc" id="L528">			kenoPurchaseBean.setErrorCode(&quot;103&quot;);// Please call gameInfo first</span>
<span class="nc" id="L529">			logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
					+ kenoPurchaseBean.getErrorCode());
<span class="nc" id="L531">			return kenoPurchaseBean;</span>
		}

<span class="nc" id="L534">		return kenoPurchaseBean;</span>
	}

	public PWTApiBean pwtPayment(String userName, String password,
			String ticketNo, String refTransId, String mobileNumber) {
<span class="nc" id="L539">		PWTApiBean pwtBean = new PWTApiBean();</span>
<span class="nc" id="L540">		String ip = XFireServletController.getRequest().getRemoteHost();</span>
<span class="nc" id="L541">		UserInfoBean userBean = DrawGameAPIHelper.getUserData(userName);</span>
<span class="nc" id="L542">		logger.debug(&quot;TP REQUEST pwtPayment=userName:&quot; + userName + &quot;|pasword:&quot;</span>
				+ password + &quot;|ip:&quot; + ip + &quot;|refTransId:&quot; + refTransId
				+ &quot;|mobileNumber:&quot; + mobileNumber + &quot;|ticketNo:&quot; + ticketNo);
<span class="nc" id="L545">		String resStr = &quot;TP RESPONSE pwtPayment=|userName:&quot; + userName;</span>
<span class="nc bnc" id="L546" title="All 2 branches missed.">		if (userBean != null) {</span>
<span class="nc bnc" id="L547" title="All 2 branches missed.">			if (APIUtility.validateUser(userBean, ip, password)) {</span>
<span class="nc" id="L548">				HttpServletRequest request = XFireServletController</span>
						.getRequest();
<span class="nc" id="L550">				request.setAttribute(&quot;code&quot;, &quot;DG&quot;);</span>
<span class="nc" id="L551">				request.setAttribute(&quot;interfaceType&quot;, &quot;TERMINAL&quot;);</span>
<span class="nc" id="L552">				ServletActionContext.setRequest(request);</span>
<span class="nc" id="L553">				pwtBean.setTicketNo(ticketNo);</span>
<span class="nc" id="L554">				pwtBean = DrawGameAPIHelper.pwtPayment(userBean, ticketNo,</span>
						refTransId, mobileNumber);
<span class="nc bnc" id="L556" title="All 2 branches missed.">				if (&quot;100&quot;.equalsIgnoreCase(pwtBean.getErrorCode())) {</span>
<span class="nc" id="L557">					StringBuilder panelStr = new StringBuilder(&quot;#Panel Data&quot;);</span>
<span class="nc" id="L558">					StringBuilder drawStr = new StringBuilder(&quot;#Draw Str :&quot;);</span>
<span class="nc" id="L559">					StringBuilder raffleStr = new StringBuilder(&quot;#Raffle Data :&quot;);</span>
<span class="nc" id="L560">					String finalResp = &quot;|gameCode:&quot; + pwtBean.getGameCode()</span>
							+ &quot;|Balance:&quot; + pwtBean.getBalance()
							+ &quot;|ErrorCode:&quot; + pwtBean.getErrorCode()
							+ &quot;|RefTransId:&quot; + pwtBean.getRefTransId()
							+ &quot;|ReprintTicketGameCode:&quot;
							+ pwtBean.getReprintTicketGameCode() + &quot;|TicketNo:&quot;
							+ pwtBean.getTicketNo() + &quot;|TotalWinning:&quot;
							+ pwtBean.getTotalWinning() + &quot;|LmsTranxIdList:&quot;
							+ pwtBean.getLmsTranxIdList() + &quot;|ReprintBean:&quot;
							+ pwtBean.getReprintBean();
<span class="nc bnc" id="L570" title="All 4 branches missed.">					if (pwtBean.getDrawBeanList() != null</span>
							&amp;&amp; pwtBean.getDrawBeanList().size() &gt; 0) {
<span class="nc" id="L572">						DrawDetailsBean drawBean = null;</span>
<span class="nc bnc" id="L573" title="All 2 branches missed.">						for (int i = 0; i &lt; pwtBean.getDrawBeanList().size(); i++) {</span>
<span class="nc" id="L574">							drawBean = pwtBean.getDrawBeanList().get(i);</span>
<span class="nc" id="L575">							drawStr.append(&quot;|DrawDateTime:&quot;</span>
									+ drawBean.getDrawDateTime());
<span class="nc bnc" id="L577" title="All 2 branches missed.">							if (drawBean.getPanelBean() != null) {</span>
<span class="nc" id="L578">								panelStr.append(&quot;|Message:&quot;</span>
										+ drawBean.getPanelBean().getMessage()
										+ &quot;|NoOfPanels:&quot;
										+ drawBean.getPanelBean()
												.getNoOfPanels());
							}
<span class="nc" id="L584">							drawStr.append(panelStr);</span>
						}
					}
<span class="nc" id="L587">					 RaffleBean raffleApiBean=null;</span>
<span class="nc bnc" id="L588" title="All 2 branches missed.">                     if(pwtBean.getRaffleBean()!=null){</span>
<span class="nc" id="L589">                    	 raffleApiBean=pwtBean.getRaffleBean();</span>
<span class="nc" id="L590">	                 raffleStr.append(&quot;|DrawDateTime:&quot; + raffleApiBean.getDrawDateTime()</span>
	                		 + &quot;|Message:&quot;+raffleApiBean.getMessage()
	                		 +&quot;|Raffle Ticket Number:&quot;+raffleApiBean.getTicketNumber());
                             }
<span class="nc" id="L594">					logger.debug(resStr + finalResp + drawStr+raffleStr);</span>
<span class="nc" id="L595">				} else {</span>
<span class="nc" id="L596">					logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
							+ pwtBean.getErrorCode());
				}
<span class="nc" id="L599">			} else {</span>
<span class="nc" id="L600">				pwtBean.setSuccess(false);</span>
<span class="nc" id="L601">				pwtBean.setErrorCode(&quot;102&quot;);// Invalid User</span>
<span class="nc" id="L602">				logger.debug(resStr + &quot;|ErrorCode:&quot; + pwtBean.getErrorCode());</span>
			}
		} else {
<span class="nc" id="L605">			pwtBean.setSuccess(false);</span>
<span class="nc" id="L606">			pwtBean.setErrorCode(&quot;103&quot;);// Please call gameInfo first</span>
<span class="nc" id="L607">			logger.debug(resStr + &quot;|ErrorCode:&quot; + pwtBean.getErrorCode());</span>
<span class="nc" id="L608">			return pwtBean;</span>
		}

<span class="nc" id="L611">		return pwtBean;</span>
	}

	public PWTApiBean pwtVerification(String userName, String password,
			String ticketNo) {
<span class="nc" id="L616">		PWTApiBean pwtBean = new PWTApiBean();</span>
<span class="nc" id="L617">		String ip = XFireServletController.getRequest().getRemoteHost();</span>
<span class="nc" id="L618">		UserInfoBean userBean = DrawGameAPIHelper.getUserData(userName);</span>
<span class="nc" id="L619">		logger.debug(&quot;TP REQUEST pwtVerification=userName:&quot; + userName</span>
				+ &quot;|pasword:&quot; + password + &quot;|ip:&quot; + ip + &quot;|ticketNo:&quot;
				+ ticketNo);
<span class="nc" id="L622">		String resStr = &quot;TP RESPONSE pwtVerification=|userName:&quot; + userName;</span>
<span class="nc bnc" id="L623" title="All 2 branches missed.">		if (userBean != null) {</span>
<span class="nc bnc" id="L624" title="All 2 branches missed.">			if (APIUtility.validateUser(userBean, ip, password)) {</span>
<span class="nc" id="L625">				System.out.println(&quot;Valid User verifying PWT for &quot; + ticketNo);</span>
<span class="nc" id="L626">				pwtBean.setTicketNo(ticketNo);</span>
<span class="nc" id="L627">				pwtBean = DrawGameAPIHelper.pwtVerification(userBean, ticketNo);</span>
<span class="nc bnc" id="L628" title="All 2 branches missed.">				if (&quot;100&quot;.equalsIgnoreCase(pwtBean.getErrorCode())) {</span>
<span class="nc" id="L629">					StringBuilder panelStr = new StringBuilder(&quot;#Panel Data&quot;);</span>
<span class="nc" id="L630">					StringBuilder drawStr = new StringBuilder(&quot;#Draw Str :&quot;);</span>
<span class="nc" id="L631">					StringBuilder raffleStr = new StringBuilder(&quot;#Raffle Data :&quot;);</span>
<span class="nc" id="L632">					String finalResp = &quot;|gameCode:&quot; + pwtBean.getGameCode()</span>
							+ &quot;|Balance:&quot; + pwtBean.getBalance()
							+ &quot;|ErrorCode:&quot; + pwtBean.getErrorCode()
							+ &quot;|RefTransactionId:&quot; + pwtBean.getRefTransId()
							+ &quot;|ReprintTicketGameCode:&quot;
							+ pwtBean.getReprintTicketGameCode() + &quot;|TicketNo:&quot;
							+ pwtBean.getTicketNo() + &quot;|TotalWinning:&quot;
							+ pwtBean.getTotalWinning();
<span class="nc bnc" id="L640" title="All 4 branches missed.">					if (pwtBean.getDrawBeanList() != null</span>
							&amp;&amp; pwtBean.getDrawBeanList().size() &gt; 0) {
<span class="nc" id="L642">						DrawDetailsBean drawBean = null;</span>
<span class="nc bnc" id="L643" title="All 2 branches missed.">						for (int i = 0; i &lt; pwtBean.getDrawBeanList().size(); i++) {</span>
<span class="nc" id="L644">							drawBean = pwtBean.getDrawBeanList().get(i);</span>
<span class="nc" id="L645">							drawStr.append(&quot;|DrawDateTime:&quot;</span>
									+ drawBean.getDrawDateTime());
<span class="nc bnc" id="L647" title="All 2 branches missed.">							if (drawBean.getPanelBean() != null) {</span>
<span class="nc" id="L648">								panelStr.append(&quot;|Message:&quot;</span>
										+ drawBean.getPanelBean().getMessage()
										+ &quot;|NoOfPanels:&quot;
										+ drawBean.getPanelBean()
												.getNoOfPanels());
							}

						}
<span class="nc" id="L656">						drawStr.append(panelStr);</span>
					}
<span class="nc" id="L658">					 RaffleBean raffleApiBean=null;</span>
<span class="nc bnc" id="L659" title="All 2 branches missed.">                     if(pwtBean.getRaffleBean()!=null){</span>
<span class="nc" id="L660">                    	 raffleApiBean=pwtBean.getRaffleBean();</span>
<span class="nc" id="L661">	                 raffleStr.append(&quot;|DrawDateTime:&quot; + raffleApiBean.getDrawDateTime()</span>
	                		 + &quot;|Message:&quot;+raffleApiBean.getMessage()
	                		 +&quot;|Raffle Ticket Number:&quot;+raffleApiBean.getTicketNumber());
                             }
<span class="nc" id="L665">					logger.debug(resStr + finalResp + drawStr+raffleStr);</span>
<span class="nc" id="L666">				} else {</span>
<span class="nc" id="L667">					logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
							+ pwtBean.getErrorCode());
				}
			} else {
<span class="nc" id="L671">				pwtBean.setSuccess(false);</span>
<span class="nc" id="L672">				pwtBean.setErrorCode(&quot;102&quot;);// Invalid User</span>
<span class="nc" id="L673">				logger.debug(resStr + &quot;|ErrorCode:&quot; + pwtBean.getErrorCode());</span>
			}
		} else {
<span class="nc" id="L676">			pwtBean.setSuccess(false);</span>
<span class="nc" id="L677">			pwtBean.setErrorCode(&quot;103&quot;);// Please call gameInfo first</span>
<span class="nc" id="L678">			logger.debug(resStr + &quot;|ErrorCode:&quot; + pwtBean.getErrorCode());</span>
		}

<span class="nc" id="L681">		return pwtBean;</span>
	}

	public ReprintBean rePrintTicket(String userName, String password,
			String lmsTranxIdToReprint) {
<span class="nc" id="L686">		ReprintBean reprintBean = new ReprintBean();</span>
<span class="nc" id="L687">		String ip = XFireServletController.getRequest().getRemoteHost();</span>
<span class="nc" id="L688">		UserInfoBean userBean = DrawGameAPIHelper.getUserData(userName);</span>
<span class="nc" id="L689">		logger.debug(&quot;TP REQUEST rePrintTicket=userName:&quot; + userName</span>
				+ &quot;|pasword:&quot; + password + &quot;|ip:&quot; + ip
				+ &quot;|lmsTranxIdToReprint:&quot; + lmsTranxIdToReprint);
<span class="nc" id="L692">		String resStr = &quot;TP RESPONSE rePrintTicket=|userName:&quot; + userName;</span>
<span class="nc bnc" id="L693" title="All 2 branches missed.">		if (userBean != null) {</span>
<span class="nc bnc" id="L694" title="All 2 branches missed.">			if (APIUtility.validateUser(userBean, ip, password)) {</span>
<span class="nc" id="L695">				reprintBean = DrawGameAPIHelper.reprintTicket(userBean,</span>
						lmsTranxIdToReprint);
<span class="nc bnc" id="L697" title="All 2 branches missed.">				if (&quot;100&quot;.equalsIgnoreCase(reprintBean.getErrorCode())) {</span>
<span class="nc" id="L698">					StringBuilder panelArr = new StringBuilder(&quot;#Panel Data=&quot;);</span>
<span class="nc" id="L699">					String finalResp = &quot;|ErrorCode:&quot;</span>
							+ reprintBean.getErrorCode();
<span class="nc" id="L701">					StringBuilder gameStr = new StringBuilder(&quot;#Game Data&quot;);</span>
<span class="nc bnc" id="L702" title="All 2 branches missed.">					if (reprintBean.getKenoBean() != null) {</span>
<span class="nc" id="L703">						TPKenoPurchaseBean kenoBean = reprintBean.getKenoBean();</span>
<span class="nc" id="L704">						gameStr.append(&quot;|gameCode:&quot; + kenoBean.getGameCode()</span>
								+ &quot;|Balance:&quot; + kenoBean.getBalance()
								+ &quot;|ErrorCode:&quot; + kenoBean.getErrorCode()
								+ &quot;|LmsTranxId:&quot; + kenoBean.getLmsTranxId()
								+ &quot;|MobileNumber:&quot; + kenoBean.getMobileNumber()
								+ &quot;|NoOfDraws:&quot; + kenoBean.getNoOfDraws()
								+ &quot;|DrawDateTimeList:&quot;
								+ kenoBean.getDrawDateTimeList()
								+ &quot;|PurchaseTime:&quot; + kenoBean.getPurchaseTime()
								+ &quot;|RefTransId:&quot; + kenoBean.getRefTransId()
								+ &quot;|TicketCost:&quot; + kenoBean.getTicketCost()
								+ &quot;|TicketNumber:&quot; + kenoBean.getTicketNumber()
								+ &quot;|TotalPurchaseAmt:&quot;
								+ kenoBean.getTotalPurchaseAmt());
<span class="nc bnc" id="L718" title="All 4 branches missed.">						if (kenoBean.getPanelList() != null</span>
								&amp;&amp; kenoBean.getPanelList().size() &gt; 0) {
<span class="nc bnc" id="L720" title="All 2 branches missed.">							for (PanelBean panelBean : kenoBean.getPanelList()) {</span>
<span class="nc" id="L721">								panelArr.append(&quot;|PickedNumbers:&quot;</span>
										+ panelBean.getPickedNumbers()
										+ &quot;|NoPicked:&quot;
										+ panelBean.getNoPicked()
										+ &quot;|PlayType:&quot;
										+ panelBean.getPlayType()
										+ &quot;|BetAmountMultiple:&quot;
										+ panelBean.getBetAmountMultiple()
										+ &quot;|IsQp:&quot; + panelBean.getIsQp());
<span class="nc" id="L730">							}</span>
						}

<span class="nc bnc" id="L733" title="All 2 branches missed.">					} else if (reprintBean.getLottoBean() != null) {</span>
<span class="nc" id="L734">						gameStr.append(&quot;|gameCode:&quot;</span>
								+ reprintBean.getLottoBean().getGameCode()
								+ &quot;|Balance:&quot;
								+ reprintBean.getLottoBean().getBalance()
								+ &quot;|ErrorCode:&quot;
								+ reprintBean.getLottoBean().getErrorCode()
								+ &quot;|AdvancedPlay:&quot;
								+ reprintBean.getLottoBean()
										.getIsAdvancedPlay()
								+ &quot;|DrawDateTimeList:&quot;
								+ reprintBean.getLottoBean().getDrawDateTime()
								+ &quot;|LmsTranxId:&quot;
								+ reprintBean.getLottoBean().getLmsTranxId()
								+ &quot;|MobileNumber:&quot;
								+ reprintBean.getLottoBean().getMobileNumber()
								+ &quot;|NoOfDraws:&quot;
								+ reprintBean.getLottoBean().getNoOfDraws()
								+ &quot;|NoPicked:&quot;
								+ reprintBean.getLottoBean().getNoPicked()
								+ &quot;|PurchaseTime:&quot;
								+ reprintBean.getLottoBean().getPurchaseTime()
								+ &quot;|RefTransId:&quot;
								+ reprintBean.getLottoBean().getRefTransId()
								+ &quot;|TicketCost:&quot;
								+ reprintBean.getLottoBean().getTicketCost()
								+ &quot;|TicketNumber:&quot;
								+ reprintBean.getLottoBean().getTicketNumber()
								+ &quot;|TotalPurchaseAmt:&quot;
								+ reprintBean.getLottoBean()
										.getTotalPurchaseAmt());
<span class="nc bnc" id="L764" title="All 2 branches missed.">						for (int i = 0; i &lt; reprintBean.getLottoBean()</span>
<span class="nc" id="L765">								.getPickedNumbers().length; i++) {</span>

<span class="nc" id="L767">							panelArr</span>
									.append(&quot;|Pick Numbers:&quot;
											+ reprintBean.getLottoBean()
													.getPickedNumbers()[i]
											+ &quot;|QpStatus:&quot;
											+ reprintBean.getLottoBean()
													.getQpStatus()[i]);
						}
					}
<span class="nc" id="L776">					logger.debug(resStr + finalResp + gameStr + panelArr);</span>
<span class="nc" id="L777">				} else {</span>
<span class="nc" id="L778">					logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
							+ reprintBean.getErrorCode());
				}
			} else {
<span class="nc" id="L782">				reprintBean.setSuccess(false);</span>
<span class="nc" id="L783">				reprintBean.setErrorCode(&quot;102&quot;);// Invalid User</span>
<span class="nc" id="L784">				logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
						+ reprintBean.getErrorCode());
			}
		} else {
<span class="nc" id="L788">			reprintBean.setSuccess(false);</span>
<span class="nc" id="L789">			reprintBean.setErrorCode(&quot;103&quot;);// Please call gameInfo first</span>
<span class="nc" id="L790">			logger.debug(resStr + &quot;|ErrorCode:&quot; + reprintBean.getErrorCode());</span>
		}

<span class="nc" id="L793">		return reprintBean;</span>
	}
	
	public ReprintBean getTransactionStatusAndData(String userName, String password,
			String refTxnId) {
<span class="nc" id="L798">		ReprintBean reprintBean = new ReprintBean();</span>
<span class="nc" id="L799">		String ip = XFireServletController.getRequest().getRemoteHost();</span>
<span class="nc" id="L800">		UserInfoBean userBean = DrawGameAPIHelper.getUserData(userName);</span>
<span class="nc" id="L801">		logger.debug(&quot;TP REQUEST getTransactionStatusAndData=userName:&quot; + userName</span>
				+ &quot;|pasword:&quot; + password + &quot;|ip:&quot; + ip
				+ &quot;|refTxnId:&quot; + refTxnId);
<span class="nc" id="L804">		String resStr = &quot;TP RESPONSE getTransactionStatusAndData=|userName:&quot; + userName;</span>
<span class="nc bnc" id="L805" title="All 2 branches missed.">		if (userBean != null) {</span>
<span class="nc bnc" id="L806" title="All 2 branches missed.">			if (APIUtility.validateUser(userBean, ip, password)) {</span>
<span class="nc" id="L807">				List&lt;Long&gt; lmsTxnIdList = DrawGameAPIHelper.getLMSTxnIdList(userBean.getUserOrgId(), refTxnId);</span>
<span class="nc" id="L808">				String mobileNo = DrawGameAPIHelper.getMobileNo(userBean.getUserOrgId(), refTxnId);</span>
				
<span class="nc" id="L810">				List&lt;String&gt; lmsTranxIdTypeList = DrawGameAPIHelper.getTransactionType(lmsTxnIdList);</span>
<span class="nc" id="L811">				reprintBean = DrawGameAPIHelper.getTransactionStatusAndData(userBean, refTxnId, lmsTxnIdList, lmsTranxIdTypeList, mobileNo);</span>
				
<span class="nc bnc" id="L813" title="All 2 branches missed.">				if (&quot;100&quot;.equalsIgnoreCase(reprintBean.getErrorCode())) {</span>
<span class="nc" id="L814">					StringBuilder panelArr = new StringBuilder(&quot;#Panel Data=&quot;);</span>
<span class="nc" id="L815">					String finalResp = &quot;|ErrorCode:&quot;</span>
							+ reprintBean.getErrorCode();
<span class="nc" id="L817">					StringBuilder gameStr = new StringBuilder(&quot;#Game Data&quot;);</span>
<span class="nc bnc" id="L818" title="All 2 branches missed.">					if (reprintBean.getKenoBean() != null) {</span>
<span class="nc" id="L819">						TPKenoPurchaseBean kenoBean = reprintBean.getKenoBean();</span>
<span class="nc" id="L820">						gameStr.append(&quot;|gameCode:&quot; + kenoBean.getGameCode()</span>
								+ &quot;|Balance:&quot; + kenoBean.getBalance()
								+ &quot;|ErrorCode:&quot; + kenoBean.getErrorCode()
								+ &quot;|LmsTranxId:&quot; + kenoBean.getLmsTranxId()
								+ &quot;|MobileNumber:&quot; + kenoBean.getMobileNumber()
								+ &quot;|NoOfDraws:&quot; + kenoBean.getNoOfDraws()
								+ &quot;|DrawDateTimeList:&quot;
								+ kenoBean.getDrawDateTimeList()
								+ &quot;|PurchaseTime:&quot; + kenoBean.getPurchaseTime()
								+ &quot;|RefTransId:&quot; + kenoBean.getRefTransId()
								+ &quot;|TicketCost:&quot; + kenoBean.getTicketCost()
								+ &quot;|TicketNumber:&quot; + kenoBean.getTicketNumber()
								+ &quot;|TotalPurchaseAmt:&quot;
								+ kenoBean.getTotalPurchaseAmt());
<span class="nc bnc" id="L834" title="All 4 branches missed.">						if (kenoBean.getPanelList() != null</span>
								&amp;&amp; kenoBean.getPanelList().size() &gt; 0) {
<span class="nc bnc" id="L836" title="All 2 branches missed.">							for (PanelBean panelBean : kenoBean.getPanelList()) {</span>
<span class="nc" id="L837">								panelArr.append(&quot;|PickedNumbers:&quot;</span>
										+ panelBean.getPickedNumbers()
										+ &quot;|NoPicked:&quot;
										+ panelBean.getNoPicked()
										+ &quot;|PlayType:&quot;
										+ panelBean.getPlayType()
										+ &quot;|BetAmountMultiple:&quot;
										+ panelBean.getBetAmountMultiple()
										+ &quot;|IsQp:&quot; + panelBean.getIsQp());
<span class="nc" id="L846">							}</span>
						}

<span class="nc bnc" id="L849" title="All 2 branches missed.">					} else if (reprintBean.getLottoBean() != null) {</span>
<span class="nc" id="L850">						gameStr.append(&quot;|gameCode:&quot;</span>
								+ reprintBean.getLottoBean().getGameCode()
								+ &quot;|Balance:&quot;
								+ reprintBean.getLottoBean().getBalance()
								+ &quot;|ErrorCode:&quot;
								+ reprintBean.getLottoBean().getErrorCode()
								+ &quot;|AdvancedPlay:&quot;
								+ reprintBean.getLottoBean()
										.getIsAdvancedPlay()
								+ &quot;|DrawDateTimeList:&quot;
								+ reprintBean.getLottoBean().getDrawDateTime()
								+ &quot;|LmsTranxId:&quot;
								+ reprintBean.getLottoBean().getLmsTranxId()
								+ &quot;|MobileNumber:&quot;
								+ reprintBean.getLottoBean().getMobileNumber()
								+ &quot;|NoOfDraws:&quot;
								+ reprintBean.getLottoBean().getNoOfDraws()
								+ &quot;|NoPicked:&quot;
								+ reprintBean.getLottoBean().getNoPicked()
								+ &quot;|PurchaseTime:&quot;
								+ reprintBean.getLottoBean().getPurchaseTime()
								+ &quot;|RefTransId:&quot;
								+ reprintBean.getLottoBean().getRefTransId()
								+ &quot;|TicketCost:&quot;
								+ reprintBean.getLottoBean().getTicketCost()
								+ &quot;|TicketNumber:&quot;
								+ reprintBean.getLottoBean().getTicketNumber()
								+ &quot;|TotalPurchaseAmt:&quot;
								+ reprintBean.getLottoBean()
										.getTotalPurchaseAmt());
<span class="nc bnc" id="L880" title="All 2 branches missed.">						for (int i = 0; i &lt; reprintBean.getLottoBean()</span>
<span class="nc" id="L881">								.getPickedNumbers().length; i++) {</span>

<span class="nc" id="L883">							panelArr</span>
									.append(&quot;|Pick Numbers:&quot;
											+ reprintBean.getLottoBean()
													.getPickedNumbers()[i]
											+ &quot;|QpStatus:&quot;
											+ reprintBean.getLottoBean()
													.getQpStatus()[i]);
						}
					}
<span class="nc" id="L892">					logger.debug(resStr + finalResp + gameStr + panelArr);</span>
<span class="nc" id="L893">				} else {</span>
<span class="nc" id="L894">					logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
							+ reprintBean.getErrorCode());
				}
<span class="nc" id="L897">			} else {</span>
<span class="nc" id="L898">				reprintBean.setSuccess(false);</span>
<span class="nc" id="L899">				reprintBean.setErrorCode(&quot;102&quot;);// Invalid User</span>
<span class="nc" id="L900">				logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
						+ reprintBean.getErrorCode());
			}
		} else {
<span class="nc" id="L904">			reprintBean.setSuccess(false);</span>
<span class="nc" id="L905">			reprintBean.setErrorCode(&quot;103&quot;);// Please call gameInfo first</span>
<span class="nc" id="L906">			logger.debug(resStr + &quot;|ErrorCode:&quot; + reprintBean.getErrorCode());</span>
		}

<span class="nc" id="L909">		return reprintBean;</span>
	}

	public TPLottoPurchaseBean tanzaniaLottoSale(
			TPLottoPurchaseBean tanzaniaLottoBean) {
<span class="nc" id="L914">		String userName = tanzaniaLottoBean.getUserName();</span>
<span class="nc" id="L915">		String password = tanzaniaLottoBean.getPassword();</span>
<span class="nc" id="L916">		String ip = XFireServletController.getRequest().getRemoteHost();</span>
<span class="nc" id="L917">		String usrReqStr = &quot;TP REQUEST tanzaniaLottoSale=userName:&quot; + userName</span>
				+ &quot;|pasword:&quot; + password + &quot;|ip:&quot; + ip + &quot;|&quot;;
<span class="nc" id="L919">		String resStr = &quot;TP RESPONSE tanzaniaLottoSale=|userName:&quot; + userName;</span>
<span class="nc" id="L920">		StringBuilder panelArr = new StringBuilder(&quot;#Panel Data:&quot;);</span>
<span class="nc" id="L921">		String dataStr = &quot;|gameCode:&quot; + tanzaniaLottoBean.getGameCode()</span>
				+ &quot;|Balance:&quot; + tanzaniaLottoBean.getBalance() + &quot;|ErrorCode:&quot;
				+ tanzaniaLottoBean.getErrorCode() + &quot;|AdvancedPlay:&quot;
				+ tanzaniaLottoBean.getIsAdvancedPlay() + &quot;|LmsTranxId:&quot;
				+ tanzaniaLottoBean.getLmsTranxId() + &quot;|MobileNumber:&quot;
				+ tanzaniaLottoBean.getMobileNumber() + &quot;|NoOfDraws:&quot;
				+ tanzaniaLottoBean.getNoOfDraws() + &quot;|NoPicked:&quot;
				+ tanzaniaLottoBean.getNoPicked() + &quot;|PurchaseTime:&quot;
				+ tanzaniaLottoBean.getPurchaseTime() + &quot;|RefTransId:&quot;
				+ tanzaniaLottoBean.getRefTransId() + &quot;|TicketCost:&quot;
				+ tanzaniaLottoBean.getTicketCost() + &quot;|TicketNumber:&quot;
				+ tanzaniaLottoBean.getTicketNumber() + &quot;|TotalPurchaseAmt:&quot;
				+ tanzaniaLottoBean.getTotalPurchaseAmt();
<span class="nc bnc" id="L934" title="All 2 branches missed.">		for (int i = 0; i &lt; tanzaniaLottoBean.getPickedNumbers().length; i++) {</span>
<span class="nc" id="L935">			panelArr.append(&quot;|Pick Numbers:&quot;</span>
					+ tanzaniaLottoBean.getPickedNumbers()[i]);
		}
<span class="nc" id="L938">		logger.debug(usrReqStr + dataStr + panelArr);</span>
<span class="nc" id="L939">		UserInfoBean userBean = DrawGameAPIHelper.getUserData(userName);</span>
<span class="nc bnc" id="L940" title="All 2 branches missed.">		if (userBean != null) {</span>
<span class="nc bnc" id="L941" title="All 2 branches missed.">			if (APIUtility.validateUser(userBean, ip, password)) {</span>
<span class="nc" id="L942">				HttpServletRequest request = XFireServletController</span>
						.getRequest();
<span class="nc" id="L944">				request.setAttribute(&quot;code&quot;, &quot;DG&quot;);</span>
<span class="nc" id="L945">				request.setAttribute(&quot;interfaceType&quot;, &quot;TERMINAL&quot;);</span>
<span class="nc" id="L946">				ServletActionContext.setRequest(request);</span>
<span class="nc" id="L947">				TanzaniaLottoAction.purchaseTicketProcess(tanzaniaLottoBean,</span>
						userBean);
<span class="nc bnc" id="L949" title="All 2 branches missed.">				if (&quot;100&quot;.equalsIgnoreCase(tanzaniaLottoBean.getErrorCode())) {</span>
<span class="nc" id="L950">					StringBuilder panelArr1 = new StringBuilder(&quot;#Panel Data:&quot;);</span>
<span class="nc" id="L951">					StringBuilder raffleData = new StringBuilder(</span>
							&quot;#Raffle Data:&quot;);
<span class="nc" id="L953">					String finalResp = &quot;|gameCode:&quot;</span>
							+ tanzaniaLottoBean.getGameCode() + &quot;|Balance:&quot;
							+ tanzaniaLottoBean.getBalance() + &quot;|ErrorCode:&quot;
							+ tanzaniaLottoBean.getErrorCode()
							+ &quot;|AdvancedPlay:&quot;
							+ tanzaniaLottoBean.getIsAdvancedPlay()
							+ &quot;|LmsTranxId:&quot;
							+ tanzaniaLottoBean.getLmsTranxId()
							+ &quot;|MobileNumber:&quot;
							+ tanzaniaLottoBean.getMobileNumber()
							+ &quot;|NoOfDraws:&quot; + tanzaniaLottoBean.getNoOfDraws()
							+ &quot;|DrawDateTime:&quot;
							+ tanzaniaLottoBean.getDrawDateTime()
							+ &quot;|NoPicked:&quot; + tanzaniaLottoBean.getNoPicked()
							+ &quot;|PurchaseTime:&quot;
							+ tanzaniaLottoBean.getPurchaseTime()
							+ &quot;|RefTransId:&quot;
							+ tanzaniaLottoBean.getRefTransId()
							+ &quot;|TicketCost:&quot;
							+ tanzaniaLottoBean.getTicketCost()
							+ &quot;|TicketNumber:&quot;
							+ tanzaniaLottoBean.getTicketNumber()
							+ &quot;|TotalPurchaseAmt:&quot;
							+ tanzaniaLottoBean.getTotalPurchaseAmt()
							+ &quot;|TopAdMessageList:&quot;
							+ tanzaniaLottoBean.getTopAdMessageList()
							+ &quot;|BottomAdMessageList:&quot;
							+ tanzaniaLottoBean.getBottomAdMessageList();
<span class="nc bnc" id="L981" title="All 2 branches missed.">					for (int i = 0; i &lt; tanzaniaLottoBean.getPickedNumbers().length; i++) {</span>
<span class="nc" id="L982">						panelArr1.append(&quot;|Pick Numbers:&quot;</span>
								+ tanzaniaLottoBean.getPickedNumbers()[i]
								+ &quot;|QpStatus:&quot;
								+ tanzaniaLottoBean.getQpStatus()[i]);
					}
<span class="nc bnc" id="L987" title="All 2 branches missed.">					if (tanzaniaLottoBean.isRaffle()) {</span>
<span class="nc" id="L988">						raffleData.append(&quot;|isRaffle:&quot;</span>
								+ tanzaniaLottoBean.isRaffle()
								+ &quot;|RaffleTicketNumber:&quot;
								+ tanzaniaLottoBean.getRaffleData()
										.getTicketNumber());
					}
<span class="nc" id="L994">					logger.debug(resStr + finalResp + panelArr1 + raffleData);</span>
<span class="nc" id="L995">				} else {</span>
<span class="nc" id="L996">					logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
							+ tanzaniaLottoBean.getErrorCode());
				}
<span class="nc" id="L999">			} else {</span>

<span class="nc" id="L1001">				tanzaniaLottoBean.setSuccess(false);</span>
<span class="nc" id="L1002">				tanzaniaLottoBean.setErrorCode(&quot;102&quot;);// Invalid User</span>
<span class="nc" id="L1003">				logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
						+ tanzaniaLottoBean.getErrorCode());
			}

		} else {
<span class="nc" id="L1008">			tanzaniaLottoBean.setSuccess(false);</span>
<span class="nc" id="L1009">			tanzaniaLottoBean.setErrorCode(&quot;103&quot;);// Please call gameInfo first</span>
<span class="nc" id="L1010">			logger.debug(resStr + &quot;|ErrorCode:&quot;</span>
					+ tanzaniaLottoBean.getErrorCode());
<span class="nc" id="L1012">			return tanzaniaLottoBean;</span>
		}
<span class="nc" id="L1014">		return tanzaniaLottoBean;</span>
	}

	// this method need to be reviewed later ...
	public TicketHeaderInfoBean getTicketHeaderInfo(String userName,
			String password) {
<span class="nc" id="L1020">		String ip = XFireServletController.getRequest().getRemoteHost();</span>
<span class="nc" id="L1021">		logger.debug(&quot;TP REQUEST getTicketHeaderInfo=userName:&quot; + userName</span>
				+ &quot;|password:&quot; + password + &quot;|ip:&quot; + ip + &quot;|&quot;);
<span class="nc" id="L1023">		String resStr = &quot;TP RESPONSE getTicketHeaderInfo=|userName:&quot; + userName;</span>
<span class="nc" id="L1024">		TicketHeaderInfoBean returnBean = new TicketHeaderInfoBean();</span>
<span class="nc" id="L1025">		UserInfoBean userBean = DrawGameAPIHelper.getUserData(userName);</span>
<span class="nc bnc" id="L1026" title="All 2 branches missed.">		if (userBean != null) {</span>
<span class="nc bnc" id="L1027" title="All 2 branches missed.">			if (APIUtility.validateUser(userBean, ip, password)) {</span>
<span class="nc" id="L1028">				logger.debug(&quot;valid user ... getTicketHeaderInfo...&quot;);</span>
<span class="nc" id="L1029">				returnBean = DrawGameAPIHelper.getHeaderInfo();</span>
<span class="nc" id="L1030">				logger.debug(resStr + &quot;|CompanyName:&quot;</span>
						+ returnBean.getCompanyName() + &quot;|IsLogoDisplayOnTkt:&quot;
						+ returnBean.getIsLogoDisplayOnTkt() + &quot;|TicketType:&quot;
						+ returnBean.getTicketType() + &quot;|ErrorCode:&quot;
						+ returnBean.getErrorCode());
			} else {
<span class="nc" id="L1036">				returnBean.setSuccess(false);</span>
<span class="nc" id="L1037">				returnBean.setErrorCode(&quot;102&quot;);// Invalid User</span>
<span class="nc" id="L1038">				logger</span>
						.debug(resStr + &quot;|ErrorCode:&quot;
								+ returnBean.getErrorCode());
			}

		} else {
<span class="nc" id="L1044">			System.out.println(&quot;user bean is null...&quot;);</span>
			// System.out.println(&quot;Invalid user&quot;);
<span class="nc" id="L1046">			returnBean.setSuccess(false);</span>
<span class="nc" id="L1047">			returnBean.setErrorCode(&quot;103&quot;);// Please call gameInfo first</span>
<span class="nc" id="L1048">			logger.debug(resStr + &quot;|ErrorCode:&quot; + returnBean.getErrorCode());</span>
		}

<span class="nc" id="L1051">		return returnBean;</span>
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>