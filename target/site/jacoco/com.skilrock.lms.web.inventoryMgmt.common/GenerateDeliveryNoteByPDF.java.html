<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GenerateDeliveryNoteByPDF.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">lms</a> &gt; <a href="index.source.html" class="el_package">com.skilrock.lms.web.inventoryMgmt.common</a> &gt; <span class="el_source">GenerateDeliveryNoteByPDF.java</span></div><h1>GenerateDeliveryNoteByPDF.java</h1><pre class="source lang-java linenums">package com.skilrock.lms.web.inventoryMgmt.common;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.OutputStream;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;
import java.util.Set;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import org.apache.struts2.interceptor.ServletRequestAware;
import org.apache.struts2.interceptor.ServletResponseAware;

import com.lowagie.text.Document;
import com.lowagie.text.DocumentException;
import com.lowagie.text.Element;
import com.lowagie.text.Font;
import com.lowagie.text.PageSize;
import com.lowagie.text.Paragraph;
import com.lowagie.text.Phrase;
import com.lowagie.text.Rectangle;
import com.lowagie.text.pdf.PdfContentByte;
import com.lowagie.text.pdf.PdfPCell;
import com.lowagie.text.pdf.PdfPCellEvent;
import com.lowagie.text.pdf.PdfPTable;
import com.lowagie.text.pdf.PdfWriter;
import com.opensymphony.xwork2.ActionSupport;

<span class="nc" id="L33">public class GenerateDeliveryNoteByPDF extends ActionSupport implements</span>
		ServletRequestAware, PdfPCellEvent, ServletResponseAware {

	/**
	 * 
	 */
	private static final long serialVersionUID = 1L;

<span class="nc" id="L41">	final Font B_FONT = new Font(Font.HELVETICA, 10, Font.BOLD);</span>

<span class="nc" id="L43">	final Font H_FONT = new Font(Font.HELVETICA, 13, Font.BOLD);</span>
<span class="nc" id="L44">	final Font HN_FONT = new Font(Font.HELVETICA, 9, Font.BOLD);</span>
<span class="nc" id="L45">	final Font N_FONT = new Font(Font.HELVETICA, 9, Font.NORMAL);</span>
	private HttpServletRequest request;
	private HttpServletResponse response;
<span class="nc" id="L48">	final Font THN_FONT = new Font(Font.HELVETICA, 14, Font.BOLD);</span>
<span class="nc" id="L49">	final Font U_FONT = new Font(Font.HELVETICA, 11, Font.BOLD);</span>

	public void cellLayout(PdfPCell cell, Rectangle position,
			PdfContentByte[] canvases) {
<span class="nc" id="L53">		float x1 = position.getLeft() + 2;</span>
<span class="nc" id="L54">		float x2 = position.getRight() - 2;</span>
<span class="nc" id="L55">		float y1 = position.getTop() - 2;</span>
<span class="nc" id="L56">		float y2 = position.getBottom() + 2;</span>
<span class="nc" id="L57">		PdfContentByte canvas = canvases[PdfPTable.LINECANVAS];</span>
		// canvas.setRGBColorStroke(0xFF, 0x00, 0x00);
<span class="nc" id="L59">		canvas.rectangle(x1, y1, x2 - x1, y2 - y1);</span>
<span class="nc" id="L60">		canvas.stroke();</span>
<span class="nc" id="L61">		canvas.resetRGBColorStroke();</span>
<span class="nc" id="L62">	}</span>

	public String generatePDF() {
<span class="nc" id="L65">		byte[] arrayOutPut = new byte[0];</span>
		try {
			// setting some response headers
<span class="nc" id="L68">			response.setHeader(&quot;Expires&quot;, &quot;0&quot;);</span>
<span class="nc" id="L69">			response.setHeader(&quot;Cache-Control&quot;,</span>
					&quot;must-revalidate, post-check=0, pre-check=0&quot;);
<span class="nc" id="L71">			response.setHeader(&quot;Pragma&quot;, &quot;public&quot;);</span>

<span class="nc" id="L73">			response.setContentType(&quot;application/pdf&quot;);</span>
<span class="nc" id="L74">			OutputStream OutStrm = response.getOutputStream();</span>

			// this method return the byte of pdf output streams
<span class="nc" id="L77">			String type = (String) request.getSession().getAttribute(</span>
					&quot;deliveryChallanType&quot;);
			// if(&quot;DSRCHALLAN&quot;.equalsIgnoreCase(type.trim())) {
			// arrayOutPut=genrateSaleReturnPDFTable();
			// }
			// else
<span class="nc" id="L83">			arrayOutPut = genratePDFTable();</span>

<span class="nc" id="L85">			OutStrm.write(arrayOutPut);</span>
			// System.out.println(&quot;in the last ................ &quot;);
<span class="nc" id="L87">			OutStrm.flush();</span>
			// System.out.println(&quot;before out put stream closed&quot;);
<span class="nc" id="L89">			OutStrm.close();</span>
			// System.out.println(&quot;after out put stream closed&quot;);
<span class="nc" id="L91">		} catch (IOException e) {</span>
<span class="nc" id="L92">			System.out.println(&quot; exception occured in &quot;);</span>
<span class="nc" id="L93">		}</span>
<span class="nc bnc" id="L94" title="All 2 branches missed.">		if (arrayOutPut.length &gt; 0) {</span>
<span class="nc" id="L95">			return null;</span>
		} else {
<span class="nc" id="L97">			return SUCCESS;</span>
		}
	}

	private byte[] genratePDFTable() {

<span class="nc" id="L103">		System.out</span>
				.println(&quot;inside PDF ledger Report 111111 ........................&quot;);

<span class="nc" id="L106">		HttpSession session = request.getSession();</span>
<span class="nc" id="L107">		LinkedHashMap&lt;String,Map&lt;String,String&gt;&gt; reportBean = (LinkedHashMap&lt;String,Map&lt;String,String&gt;&gt;) session.getAttribute(&quot;detailsMap&quot;);</span>
<span class="nc" id="L108">		Map headerInfoMap = (Map) session.getAttribute(&quot;staticReportMap&quot;);</span>
<span class="nc" id="L109">		PdfWriter writer = null;</span>
<span class="nc" id="L110">		Document document = new Document(PageSize.A4, 22, 15, 30, 60);</span>
<span class="nc" id="L111">		ByteArrayOutputStream baos = new ByteArrayOutputStream();</span>

		try {
<span class="nc" id="L114">			writer = PdfWriter.getInstance(document, baos);</span>
<span class="nc" id="L115">			document.open();</span>

<span class="nc" id="L117">			PdfPTable reportTable = new PdfPTable(2);</span>
			// reportTable.setSplitRows(false);
<span class="nc" id="L119">			int headerwidths[] = new int[] { 85, 15 };</span>
<span class="nc" id="L120">			reportTable.setWidths(headerwidths);</span>
<span class="nc" id="L121">			reportTable.setSplitLate(false);</span>
<span class="nc" id="L122">			reportTable.setWidthPercentage(100);</span>
<span class="nc" id="L123">			PdfPCell cell = null;</span>

<span class="nc" id="L125">			int totalBookQty = 0;</span>
<span class="nc" id="L126">			boolean flag = true;</span>
			// static header added
<span class="nc" id="L128">			String type = (String) session.getAttribute(&quot;deliveryChallanType&quot;);</span>
		/*	if (&quot;DSRCHALLAN&quot;.equalsIgnoreCase(type.trim())) {
				cell = new PdfPCell(
						getStaticHeaderOfSaleRetReport(headerInfoMap));
				cell.setBorder(Rectangle.NO_BORDER);
				cell.setColspan(2);
				reportTable.addCell(cell);
				System.out.println(&quot;static header in if........... &quot;);

				System.out.println(&quot; bean of gmaes &quot; + reportBean);

				totalBookQty = 0;
				flag = true;

				Set&lt;Integer&gt; returnSet = reportBean.keySet();
				for (Integer returnkey : returnSet) {
					System.out.println(&quot;transaction id = &quot; + returnkey);
					Map KeysMap = (Map) reportBean.get(returnkey);
					Set&lt;String&gt; mapKey = (Set) KeysMap.keySet();
					for (String key : mapKey) {
						System.out.println(&quot; gmae ===== &quot; + key);
						InvoiceGameDetailBean bean = (InvoiceGameDetailBean) KeysMap
								.get(key);
						cell = new PdfPCell(new Phrase(&quot;Game Name : &quot;
								+ bean.getGameName()
								+ &quot;      Sale Commission Rate : &quot;
								+ bean.getSalCommVar(), U_FONT));
						cell.setBorder(Rectangle.NO_BORDER);
						cell.setColspan(1);
						reportTable.addCell(cell);

						if (flag) {
							cell = new PdfPCell(new Phrase(&quot;QTY OF BOOKS&quot;,
									B_FONT));
							cell.setBorder(Rectangle.NO_BORDER);
							cell.setHorizontalAlignment(Element.ALIGN_CENTER);
							reportTable.addCell(cell);
							System.out
									.println(&quot; inside qty of books ............&quot;);
							flag = false;
						} else {
							cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));
							cell.setBorder(Rectangle.NO_BORDER);
							cell.setHorizontalAlignment(Element.ALIGN_CENTER);
							System.out
									.println(&quot; not inside qty of books ............&quot;);
							reportTable.addCell(cell);
						}

						reportTable.addCell(getBlankCell(3));

						if (bean.getPackNbrList().size() &gt; 0) {
							// pack details header columns
							cell = new PdfPCell(new Phrase(&quot;Pack No.&quot;, B_FONT));
							cell.setBorder(Rectangle.NO_BORDER);
							cell.setColspan(2);
							reportTable.addCell(cell);

							// pack details columns

							cell = new PdfPCell(getPackDetails(bean
									.getPackNbrList()));
							cell.setBorder(Rectangle.NO_BORDER);
							reportTable.addCell(cell);
							cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));
							cell.setBorder(Rectangle.NO_BORDER);
							reportTable.addCell(cell);
							System.out.println(&quot; packs detail ............&quot;
									+ bean.getPackNbrList());

							int totalBooksPack = bean.getPackNbrList().size()
									* bean.getNbrBooks();
							totalBookQty = totalBookQty + totalBooksPack;

							cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));
							cell.setBorder(Rectangle.NO_BORDER);
							reportTable.addCell(cell);
							cell = new PdfPCell(new Phrase(
									&quot; &quot; + totalBooksPack, B_FONT));
							cell.setBorder(Rectangle.BOX);
							/*
							 * GenerateDeliveryChallenByPDF event =new
							 * GenerateDeliveryChallenByPDF();
							 * cell.setCellEvent(event);
							 */
							/*cell.setVerticalAlignment(Element.ALIGN_BOTTOM);
							cell.setHorizontalAlignment(Element.ALIGN_CENTER);
							reportTable.addCell(cell);

							// blank column
							cell = new PdfPCell(getBlankCell(3));
							cell.setBorder(Rectangle.NO_BORDER);
							cell.setColspan(2);
							reportTable.addCell(cell);

						}

						if (bean.getBookNbrList().size() &gt; 0) {
							cell = new PdfPCell(new Phrase(&quot;Book No.&quot;, B_FONT));
							cell.setBorder(Rectangle.NO_BORDER);
							cell.setColspan(2);
							reportTable.addCell(cell);

							cell = new PdfPCell(getBookDetails(bean
									.getBookNbrList()));
							cell.setBorder(Rectangle.NO_BORDER);
							reportTable.addCell(cell);
							cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));
							cell.setBorder(Rectangle.NO_BORDER);
							reportTable.addCell(cell);

							totalBookQty = totalBookQty
									+ bean.getBookNbrList().size();

							cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));
							cell.setBorder(Rectangle.NO_BORDER);
							reportTable.addCell(cell);
							cell = new PdfPCell(new Phrase(&quot; &quot;
									+ bean.getBookNbrList().size(), B_FONT));
							cell.setBorder(Rectangle.BOX);
							// cell.setCellEvent(event);
							cell.setHorizontalAlignment(Element.ALIGN_CENTER);
							cell.setVerticalAlignment(Element.ALIGN_CENTER);
							reportTable.addCell(cell);
							System.out.println(&quot; books detail ............&quot;
									+ bean.getBookNbrList().size());

							cell = new PdfPCell(getBlankCell(14));
							cell.setBorder(Rectangle.BOTTOM);
							cell.setColspan(2);
							reportTable.addCell(cell);
						}
					}

				}
			} */ 
<span class="nc" id="L264">				cell = new PdfPCell(getStaticHeaderOfReport(headerInfoMap));</span>
<span class="nc" id="L265">				cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L266">				cell.setColspan(2);</span>
<span class="nc" id="L267">				reportTable.addCell(cell);</span>
<span class="nc" id="L268">				System.out.println(&quot;static header in else........... &quot;);</span>

				// Iterable table header row
<span class="nc" id="L271">				System.out.println(&quot; details of con and non cons &quot; + reportBean);</span>
<span class="nc" id="L272">				Set&lt;String&gt; mapKey = reportBean.get(&quot;Non Consumable&quot;).keySet();</span>
<span class="nc" id="L273">				Set&lt;String&gt; conMapKey = reportBean.get(&quot;Consumable&quot;).keySet();</span>
				
				
				
				
				
				
				
				
				
				
				

<span class="nc bnc" id="L286" title="All 2 branches missed.">				for (String key : mapKey) {</span>
<span class="nc" id="L287">					System.out.println(&quot; gmae ===== &quot; + key);</span>
					//InvoiceGameDetailBean bean = (InvoiceGameDetailBean) reportBean
					//		.get(key);
<span class="nc" id="L290">					String []serialNo=reportBean.get(&quot;Non Consumable&quot;).get(key).split(&quot;,&quot;);</span>
<span class="nc" id="L291">					cell = new PdfPCell(</span>
							new Phrase(&quot;Non Consumable : &quot; + key, U_FONT));
<span class="nc" id="L293">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L294">					cell.setColspan(1);</span>
<span class="nc" id="L295">					reportTable.addCell(cell);</span>

<span class="nc bnc" id="L297" title="All 2 branches missed.">					if (flag) {</span>
<span class="nc" id="L298">						cell = new PdfPCell(new Phrase(&quot;Count&quot;, B_FONT));</span>
<span class="nc" id="L299">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L300">						cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L301">						reportTable.addCell(cell);</span>
<span class="nc" id="L302">						System.out.println(&quot; inside qty of items ............&quot;);</span>
<span class="nc" id="L303">						flag = false;</span>
					} else {
<span class="nc" id="L305">						cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L306">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L307">						cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L308">						System.out</span>
								.println(&quot; not inside qty of non consumable ............&quot;);
<span class="nc" id="L310">						reportTable.addCell(cell);</span>
					}

<span class="nc" id="L313">					reportTable.addCell(getBlankCell(3));</span>

					/*if (bean.getPackNbrList().size() &gt; 0) {
						// pack details header columns
						cell = new PdfPCell(new Phrase(&quot;Pack No.&quot;, B_FONT));
						cell.setBorder(Rectangle.NO_BORDER);
						cell.setColspan(2);
						reportTable.addCell(cell);

						// pack details columns
						cell = new PdfPCell(getPackDetails(bean
								.getPackNbrList()));
						cell.setBorder(Rectangle.NO_BORDER);
						reportTable.addCell(cell);
						cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));
						cell.setBorder(Rectangle.NO_BORDER);
						reportTable.addCell(cell);
						System.out.println(&quot; packs detail ............&quot;
								+ bean.getPackNbrList());
						int totalBooksPack = bean.getPackNbrList().size()
								* bean.getNbrBooks();
						totalBookQty = totalBookQty + totalBooksPack;

						cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));
						cell.setBorder(Rectangle.NO_BORDER);
						reportTable.addCell(cell);
						cell = new PdfPCell(new Phrase(&quot; &quot; + totalBooksPack,
								B_FONT));
						cell.setBorder(Rectangle.BOX);
						/*
						 * GenerateDeliveryChallenByPDF event =new
						 * GenerateDeliveryChallenByPDF();
						 * cell.setCellEvent(event);
						 */
						/*cell.setVerticalAlignment(Element.ALIGN_BOTTOM);
						cell.setHorizontalAlignment(Element.ALIGN_CENTER);
						reportTable.addCell(cell);

						// blank column
						cell = new PdfPCell(getBlankCell(3));
						cell.setBorder(Rectangle.NO_BORDER);
						cell.setColspan(2);
						reportTable.addCell(cell);
					}
*/
<span class="nc bnc" id="L358" title="All 2 branches missed.">					if (serialNo.length &gt; 0) {</span>
<span class="nc" id="L359">						cell = new PdfPCell(new Phrase(&quot;Serial No.&quot;, B_FONT));</span>
<span class="nc" id="L360">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L361">						cell.setColspan(2);</span>
<span class="nc" id="L362">						reportTable.addCell(cell);</span>

<span class="nc" id="L364">						cell = new PdfPCell(getBookDetails(serialNo));</span>
<span class="nc" id="L365">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L366">						reportTable.addCell(cell);</span>
<span class="nc" id="L367">						cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L368">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L369">						reportTable.addCell(cell);</span>

<span class="nc" id="L371">						totalBookQty = totalBookQty</span>
								+ serialNo.length;

<span class="nc" id="L374">						cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L375">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L376">						reportTable.addCell(cell);</span>
<span class="nc" id="L377">						cell = new PdfPCell(new Phrase(&quot; &quot;</span>
								+ serialNo.length, B_FONT));
<span class="nc" id="L379">						cell.setBorder(Rectangle.BOX);</span>
						// cell.setCellEvent(event);
<span class="nc" id="L381">						cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L382">						cell.setVerticalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L383">						reportTable.addCell(cell);</span>
<span class="nc" id="L384">						System.out.println(&quot; non consumable detail ............&quot;</span>
								+ serialNo.length);

<span class="nc" id="L387">						cell = new PdfPCell(getBlankCell(14));</span>
<span class="nc" id="L388">						cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L389">						cell.setColspan(2);</span>
<span class="nc" id="L390">						reportTable.addCell(cell);</span>
					}

<span class="nc" id="L393">				}</span>
<span class="nc" id="L394">				flag = true;</span>
<span class="nc bnc" id="L395" title="All 2 branches missed.">				for (String key : conMapKey) {</span>
<span class="nc" id="L396">					System.out.println(&quot; gmae ===== &quot; + key);</span>
					//InvoiceGameDetailBean bean = (InvoiceGameDetailBean) reportBean
					//		.get(key);
<span class="nc" id="L399">					String Quantity=reportBean.get(&quot;Consumable&quot;).get(key);</span>
<span class="nc" id="L400">					cell = new PdfPCell(</span>
							new Phrase(&quot;Consumable : &quot; + key, U_FONT));
<span class="nc" id="L402">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L403">					cell.setColspan(1);</span>
<span class="nc" id="L404">					reportTable.addCell(cell);</span>

<span class="nc bnc" id="L406" title="All 2 branches missed.">					if (flag) {</span>
<span class="nc" id="L407">						cell = new PdfPCell(new Phrase(&quot;Count&quot;, B_FONT));</span>
<span class="nc" id="L408">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L409">						cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L410">						reportTable.addCell(cell);</span>
<span class="nc" id="L411">						System.out.println(&quot; inside qty of books ............&quot;);</span>
<span class="nc" id="L412">						flag = false;</span>
					} else {
<span class="nc" id="L414">						cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L415">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L416">						cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L417">						System.out</span>
								.println(&quot; not inside qty of consumable ............&quot;);
<span class="nc" id="L419">						reportTable.addCell(cell);</span>
					}

<span class="nc" id="L422">					reportTable.addCell(getBlankCell(3));</span>

					
<span class="nc bnc" id="L425" title="All 2 branches missed.">					if (Integer.parseInt(Quantity) &gt; 0) {</span>
<span class="nc" id="L426">						cell = new PdfPCell(new Phrase(&quot;&quot;, B_FONT));</span>
<span class="nc" id="L427">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L428">						cell.setColspan(2);</span>
<span class="nc" id="L429">						reportTable.addCell(cell);</span>

<span class="nc" id="L431">						cell = new PdfPCell(getConsDetails(Quantity));</span>
<span class="nc" id="L432">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L433">						reportTable.addCell(cell);</span>
<span class="nc" id="L434">						cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L435">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L436">						reportTable.addCell(cell);</span>

<span class="nc" id="L438">						totalBookQty = totalBookQty</span>
								+ Integer.parseInt(Quantity);

<span class="nc" id="L441">						cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L442">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L443">						reportTable.addCell(cell);</span>
<span class="nc" id="L444">						cell = new PdfPCell(new Phrase(&quot; &quot;</span>
								+ Integer.parseInt(Quantity), B_FONT));
<span class="nc" id="L446">						cell.setBorder(Rectangle.BOX);</span>
						// cell.setCellEvent(event);
<span class="nc" id="L448">						cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L449">						cell.setVerticalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L450">						reportTable.addCell(cell);</span>
<span class="nc" id="L451">						System.out.println(&quot; books detail ............&quot;</span>
								+ Integer.parseInt(Quantity));

<span class="nc" id="L454">						cell = new PdfPCell(getBlankCell(14));</span>
<span class="nc" id="L455">						cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L456">						cell.setColspan(2);</span>
<span class="nc" id="L457">						reportTable.addCell(cell);</span>
					}

<span class="nc" id="L460">				}</span>
			// blank column
<span class="nc" id="L462">			cell = new PdfPCell(getBlankCell(3));</span>
<span class="nc" id="L463">			cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L464">			cell.setColspan(18);</span>
<span class="nc" id="L465">			reportTable.addCell(cell);</span>

<span class="nc" id="L467">			cell = new PdfPCell(new Phrase(&quot;Total Quantity &quot;,</span>
					THN_FONT));
<span class="nc" id="L469">			cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L470">			cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L471">			reportTable.addCell(cell);</span>
<span class="nc" id="L472">			System.out.println(&quot;total quantity of delivered items&quot;);</span>

<span class="nc" id="L474">			cell = new PdfPCell(new Phrase(&quot; &quot; + totalBookQty + &quot; &quot;, THN_FONT));</span>
<span class="nc" id="L475">			cell.setBorder(Rectangle.BOX);</span>
			/*
			 * GenerateDeliveryChallenByPDF event =new
			 * GenerateDeliveryChallenByPDF(); cell.setCellEvent(event);
			 */
<span class="nc" id="L480">			cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L481">			cell.setVerticalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L482">			reportTable.addCell(cell);</span>
<span class="nc" id="L483">			System.out.println(&quot;total quantity of delivered items&quot;);</span>

			// blank column
<span class="nc" id="L486">			cell = new PdfPCell(getBlankCell(30));</span>
<span class="nc" id="L487">			cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L488">			cell.setColspan(2);</span>
<span class="nc" id="L489">			reportTable.addCell(cell);</span>

<span class="nc" id="L491">			cell = new PdfPCell(getLastPageFooter());</span>
<span class="nc" id="L492">			cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L493">			cell.setColspan(2);</span>
<span class="nc" id="L494">			reportTable.addCell(cell);</span>
<span class="nc" id="L495">			System.out.println(&quot;footer&quot;);</span>
<span class="nc" id="L496">			cell = new PdfPCell(getBlankCell(10));</span>
<span class="nc" id="L497">			cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L498">			cell.setColspan(2);</span>
<span class="nc" id="L499">			reportTable.addCell(cell);</span>

<span class="nc" id="L501">			cell = new PdfPCell(getLastPageFooterAcknowladge());</span>
<span class="nc" id="L502">			cell.setBorder(Rectangle.BOX);</span>
<span class="nc" id="L503">			cell.setColspan(2);</span>
<span class="nc" id="L504">			reportTable.addCell(cell);</span>
<span class="nc" id="L505">			System.out.println(&quot;acknowledge&quot;);</span>

<span class="nc" id="L507">			document.add(reportTable);</span>

<span class="nc" id="L509">			document.close();</span>
<span class="nc" id="L510">		} catch (DocumentException e) {</span>
<span class="nc" id="L511">			e.printStackTrace();</span>
<span class="nc" id="L512">		}</span>

<span class="nc" id="L514">		byte[] arrayOutPut = ((ByteArrayOutputStream) baos).toByteArray();</span>

<span class="nc" id="L516">		return arrayOutPut;</span>

	}

	private PdfPCell getBlankCell(int height) {
<span class="nc" id="L521">		PdfPCell cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L522">		cell.setFixedHeight(height);</span>
<span class="nc" id="L523">		cell.setColspan(2);</span>
<span class="nc" id="L524">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setColspan(3);

<span class="nc" id="L527">		return cell;</span>
	}
	private PdfPTable getConsDetails(String Quantity) throws DocumentException {
<span class="nc" id="L530">		PdfPTable headerTable = new PdfPTable(10);</span>
<span class="nc" id="L531">		headerTable.setWidthPercentage(100);</span>
<span class="nc" id="L532">		int headerwidths[] = new int[] { 3, 17, 3, 17, 3, 17, 3, 17, 3, 17 };</span>
<span class="nc" id="L533">		headerTable.setWidths(headerwidths);</span>

<span class="nc" id="L535">		headerTable.getDefaultCell().setPadding(3f);</span>

		PdfPCell cell;
<span class="nc" id="L538">		System.out.println(&quot;hello ............................ &quot;);</span>
		// first row of header
<span class="nc" id="L540">		boolean flag = true;</span>
		
		
		
<span class="nc" id="L544">		GenerateDeliveryNoteByPDF event = new GenerateDeliveryNoteByPDF();</span>
<span class="nc" id="L545">		cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L546">		cell.setCellEvent(event);</span>
<span class="nc" id="L547">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L548">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L549">		headerTable.addCell(cell);</span>

<span class="nc" id="L551">		cell = new PdfPCell(</span>
				new Phrase((String) Quantity, N_FONT));
<span class="nc" id="L553">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L554">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L555">		headerTable.addCell(cell);</span>
		
		
<span class="nc" id="L558">		return headerTable;</span>
	}
	private PdfPTable getBookDetails(String[] serial) throws DocumentException {

<span class="nc" id="L562">		PdfPTable headerTable = new PdfPTable(10);</span>
<span class="nc" id="L563">		headerTable.setWidthPercentage(100);</span>
<span class="nc" id="L564">		int headerwidths[] = new int[] { 3, 17, 3, 17, 3, 17, 3, 17, 3, 17 };</span>
<span class="nc" id="L565">		headerTable.setWidths(headerwidths);</span>

<span class="nc" id="L567">		headerTable.getDefaultCell().setPadding(3f);</span>

		PdfPCell cell;
<span class="nc" id="L570">		System.out.println(&quot;hello ............................ &quot;);</span>
		// first row of header
<span class="nc" id="L572">		boolean flag = true;</span>
<span class="nc" id="L573">		int length = serial.length;</span>
<span class="nc bnc" id="L574" title="All 2 branches missed.">		for (int i = 0; i &lt; length;) {</span>
<span class="nc bnc" id="L575" title="All 2 branches missed.">			for (int j = 0; j &lt; 5; j++) {</span>
<span class="nc bnc" id="L576" title="All 2 branches missed.">				if (i &lt; length) {</span>

<span class="nc" id="L578">					GenerateDeliveryNoteByPDF event = new GenerateDeliveryNoteByPDF();</span>
<span class="nc" id="L579">					cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L580">					cell.setCellEvent(event);</span>
<span class="nc" id="L581">					cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L582">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L583">					headerTable.addCell(cell);</span>

<span class="nc" id="L585">					cell = new PdfPCell(</span>
							new Phrase((String) serial[i], N_FONT));
<span class="nc" id="L587">					cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L588">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L589">					headerTable.addCell(cell);</span>
<span class="nc" id="L590">				} else {</span>

<span class="nc" id="L592">					cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L593">					cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L594">					cell.setBorder(Rectangle.NO_BORDER);</span>
					// cell.setPaddingBottom(2);
<span class="nc" id="L596">					headerTable.addCell(cell);</span>

<span class="nc" id="L598">					cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L599">					cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L600">					cell.setBorder(Rectangle.NO_BORDER);</span>
					// cell.setPaddingBottom(2);
<span class="nc" id="L602">					headerTable.addCell(cell);</span>

				}
<span class="nc" id="L605">				i++;</span>
			}
		}

<span class="nc" id="L609">		return headerTable;</span>
	}

	private PdfPTable getBox(int totalBooks) {
<span class="nc" id="L613">		PdfPTable headerTable = new PdfPTable(1);</span>
		// int length=(&quot;&quot;+totalBooks).length();
<span class="nc" id="L615">		headerTable.setWidthPercentage(60);</span>
<span class="nc" id="L616">		int headerwidths[] = new int[] { 100 };</span>
		try {
<span class="nc" id="L618">			headerTable.setWidths(headerwidths);</span>
<span class="nc" id="L619">		} catch (DocumentException e) {</span>
<span class="nc" id="L620">			e.printStackTrace();</span>
<span class="nc" id="L621">		}</span>

		PdfPCell cell;
<span class="nc" id="L624">		cell = new PdfPCell(new Phrase(&quot; &quot; + totalBooks + &quot; &quot;, THN_FONT));</span>
<span class="nc" id="L625">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L626">		GenerateDeliveryNoteByPDF event = new GenerateDeliveryNoteByPDF();</span>
<span class="nc" id="L627">		cell.setCellEvent(event);</span>
<span class="nc" id="L628">		cell.setFixedHeight(5);</span>
<span class="nc" id="L629">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L630">		headerTable.addCell(cell);</span>

<span class="nc" id="L632">		return headerTable;</span>
	}

	private PdfPTable getLastPageFooter() throws DocumentException {

<span class="nc" id="L637">		PdfPTable headerTable = new PdfPTable(7);</span>
<span class="nc" id="L638">		headerTable.setWidthPercentage(100);</span>
<span class="nc" id="L639">		int headerwidths[] = new int[] { 27, 3, 22, 3, 22, 3, 20 };</span>
<span class="nc" id="L640">		headerTable.setWidths(headerwidths);</span>

		PdfPCell cell;

<span class="nc" id="L644">		cell = new PdfPCell(new Phrase(&quot; Checked By &quot;, B_FONT));</span>
<span class="nc" id="L645">		cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L646">		cell.setBorder(Rectangle.TOP);</span>
<span class="nc" id="L647">		cell.setColspan(2);</span>
<span class="nc" id="L648">		headerTable.addCell(cell);</span>

<span class="nc" id="L650">		cell = new PdfPCell(new Phrase(&quot;  &quot;, B_FONT));</span>
<span class="nc" id="L651">		cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L652">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L653">		cell.setColspan(3);</span>
<span class="nc" id="L654">		headerTable.addCell(cell);</span>

<span class="nc" id="L656">		cell = new PdfPCell(new Phrase(&quot; Prepared By &quot;, B_FONT));</span>
<span class="nc" id="L657">		cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L658">		cell.setBorder(Rectangle.TOP);</span>
<span class="nc" id="L659">		cell.setColspan(2);</span>
<span class="nc" id="L660">		headerTable.addCell(cell);</span>

<span class="nc" id="L662">		cell = new PdfPCell(new Phrase(&quot; Delivery Mode : &quot;, B_FONT));</span>
<span class="nc" id="L663">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L664">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L665">		headerTable.addCell(cell);</span>

<span class="nc" id="L667">		GenerateDeliveryNoteByPDF event = new GenerateDeliveryNoteByPDF();</span>

<span class="nc" id="L669">		cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L670">		cell.setCellEvent(event);</span>
<span class="nc" id="L671">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L672">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L673">		headerTable.addCell(cell);</span>

<span class="nc" id="L675">		cell = new PdfPCell(new Phrase(&quot; By Courier &quot;, B_FONT));</span>
<span class="nc" id="L676">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L677">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L678">		headerTable.addCell(cell);</span>

<span class="nc" id="L680">		cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L681">		cell.setCellEvent(event);</span>
<span class="nc" id="L682">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L683">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L684">		headerTable.addCell(cell);</span>

<span class="nc" id="L686">		cell = new PdfPCell(new Phrase(&quot; By Person &quot;, B_FONT));</span>
<span class="nc" id="L687">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L688">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L689">		headerTable.addCell(cell);</span>

<span class="nc" id="L691">		cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L692">		cell.setCellEvent(event);</span>
<span class="nc" id="L693">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L694">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L695">		headerTable.addCell(cell);</span>

<span class="nc" id="L697">		cell = new PdfPCell(new Phrase(&quot; By Self &quot;, B_FONT));</span>
<span class="nc" id="L698">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L699">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L700">		headerTable.addCell(cell);</span>

<span class="nc" id="L702">		return headerTable;</span>
	}

	private PdfPTable getLastPageFooterAcknowladge() throws DocumentException {
<span class="nc" id="L706">		PdfPTable headerTable = new PdfPTable(3);</span>
<span class="nc" id="L707">		headerTable.setWidthPercentage(100);</span>
<span class="nc" id="L708">		int headerwidths[] = new int[] { 25, 30, 45 };</span>
<span class="nc" id="L709">		headerTable.setWidths(headerwidths);</span>

		PdfPCell cell;
<span class="nc" id="L712">		cell = new PdfPCell(new Phrase(&quot; Acknowledgement &quot;, B_FONT));</span>
<span class="nc" id="L713">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L714">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L715">		cell.setColspan(3);</span>
<span class="nc" id="L716">		headerTable.addCell(cell);</span>

<span class="nc" id="L718">		System.out.println(&quot;upadted ------------------------ &quot;);</span>

<span class="nc" id="L720">		cell = new PdfPCell(new Phrase(&quot; Received By :  &quot;, B_FONT));</span>
<span class="nc" id="L721">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
		// cell.setColspan(3);
<span class="nc" id="L723">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L724">		headerTable.addCell(cell);</span>

<span class="nc" id="L726">		cell = new PdfPCell(new Phrase(&quot;  &quot;, B_FONT));</span>
<span class="nc" id="L727">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L728">		cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L729">		headerTable.addCell(cell);</span>

<span class="nc" id="L731">		cell = new PdfPCell(new Phrase(&quot;  &quot;, B_FONT));</span>
<span class="nc" id="L732">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L733">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L734">		headerTable.addCell(cell);</span>

<span class="nc" id="L736">		cell = new PdfPCell(new Phrase(&quot; Received On :  &quot;, B_FONT));</span>
<span class="nc" id="L737">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L738">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setColspan(3);
<span class="nc" id="L740">		headerTable.addCell(cell);</span>

<span class="nc" id="L742">		cell = new PdfPCell(new Phrase(&quot;  &quot;, B_FONT));</span>
<span class="nc" id="L743">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L744">		cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L745">		headerTable.addCell(cell);</span>

<span class="nc" id="L747">		cell = new PdfPCell(new Phrase(&quot; Signature / Stamp&quot;, B_FONT));</span>
<span class="nc" id="L748">		cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L749">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L750">		headerTable.addCell(cell);</span>
		//blank cell
<span class="nc" id="L752">		cell = new PdfPCell(getBlankCell(25));</span>
<span class="nc" id="L753">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L754">		cell.setColspan(18);</span>
<span class="nc" id="L755">		headerTable.addCell(cell);</span>
<span class="nc" id="L756">		return headerTable;</span>
	}

	private PdfPTable getPackDetails(List pack) throws DocumentException {

<span class="nc" id="L761">		PdfPTable headerTable = new PdfPTable(10);</span>
<span class="nc" id="L762">		headerTable.setWidthPercentage(100);</span>
<span class="nc" id="L763">		int headerwidths[] = new int[] { 3, 17, 3, 17, 3, 17, 3, 17, 3, 17 };</span>
<span class="nc" id="L764">		headerTable.setWidths(headerwidths);</span>
<span class="nc" id="L765">		headerTable.getDefaultCell().setPadding(3f);</span>

		PdfPCell cell;

		// first row of header
<span class="nc" id="L770">		boolean flag = true;</span>
<span class="nc" id="L771">		int length = pack.size();</span>

<span class="nc bnc" id="L773" title="All 2 branches missed.">		for (int i = 0; i &lt; length;) {</span>
<span class="nc bnc" id="L774" title="All 2 branches missed.">			for (int j = 0; j &lt; 5; j++) {</span>
<span class="nc bnc" id="L775" title="All 2 branches missed.">				if (i &lt; length) {</span>

<span class="nc" id="L777">					GenerateDeliveryNoteByPDF event = new GenerateDeliveryNoteByPDF();</span>
<span class="nc" id="L778">					cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L779">					cell.setCellEvent(event);</span>
<span class="nc" id="L780">					cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L781">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L782">					headerTable.addCell(cell);</span>

					// System.out.println(&quot; inside if .............&quot;);

<span class="nc" id="L786">					cell = new PdfPCell(</span>
							new Phrase((String) pack.get(i), N_FONT));
<span class="nc" id="L788">					cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L789">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L790">					headerTable.addCell(cell);</span>
<span class="nc" id="L791">				} else {</span>

<span class="nc" id="L793">					cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L794">					cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L795">					cell.setBorder(Rectangle.NO_BORDER);</span>
					// cell.setPaddingBottom(2);
<span class="nc" id="L797">					headerTable.addCell(cell);</span>

<span class="nc" id="L799">					cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L800">					cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L801">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L802">					headerTable.addCell(cell);</span>

				}
<span class="nc" id="L805">				i++;</span>
			}
		}

<span class="nc" id="L809">		return headerTable;</span>
	}

	private PdfPTable getStaticHeaderOfReport(Map staticMap)
			throws DocumentException {

<span class="nc" id="L815">		PdfPTable headerTable = new PdfPTable(4);</span>
<span class="nc" id="L816">		headerTable.setWidthPercentage(100);</span>
<span class="nc" id="L817">		int headerwidths[] = new int[] { 53, 12, 15, 20 };</span>
<span class="nc" id="L818">		headerTable.setWidths(headerwidths);</span>

<span class="nc" id="L820">		System.out.println(&quot;static header map : == &quot; + staticMap);</span>

		PdfPCell cell;
<span class="nc bnc" id="L823" title="All 2 branches missed.">		String headerName = &quot;SN&quot;.equalsIgnoreCase(((String) request.getSession().getAttribute(&quot;deliveryChallanType&quot;))) ? &quot;Surrender Note&quot; : &quot;Delivery Note&quot; ;</span>
<span class="nc" id="L824">		cell = new PdfPCell(new Phrase(headerName, H_FONT));</span>
<span class="nc" id="L825">		cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L826">		cell.setVerticalAlignment(Element.ALIGN_MIDDLE);</span>
<span class="nc" id="L827">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L828">		cell.setColspan(4);</span>
<span class="nc" id="L829">		headerTable.addCell(cell);</span>
<span class="nc" id="L830">		System.out.println(&quot;1&quot;);</span>

		// first row of header
<span class="nc" id="L833">		cell = new PdfPCell(new Phrase(&quot;Generation Time : &quot;, HN_FONT));</span>
<span class="nc" id="L834">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L835">		cell.setVerticalAlignment(Element.ALIGN_MIDDLE);</span>
<span class="nc" id="L836">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L837">		cell.setColspan(3);</span>
<span class="nc" id="L838">		headerTable.addCell(cell);</span>

<span class="nc" id="L840">		String time = (String) staticMap.get(&quot;dcGenerationTime&quot;);</span>
<span class="nc bnc" id="L841" title="All 2 branches missed.">		time = time != null ? time : &quot; &quot;;</span>
<span class="nc" id="L842">		cell = new PdfPCell(new Phrase(time, N_FONT));</span>
<span class="nc" id="L843">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L844">		cell.setVerticalAlignment(Element.ALIGN_MIDDLE);</span>
<span class="nc" id="L845">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L846">		cell.setColspan(1);</span>
<span class="nc" id="L847">		headerTable.addCell(cell);</span>

<span class="nc" id="L849">		System.out.println(&quot;3&quot;);</span>

		/*
		 * //Second row of header cell=new PdfPCell(new Phrase(&quot; &quot;, N_FONT));
		 * cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
		 * cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
		 * cell.setBorder(Rectangle.NO_BORDER); cell.setColspan(3);
		 * headerTable.addCell(cell);
		 */
<span class="nc" id="L858">		System.out.println(&quot;4&quot;);</span>
		// first row of header
<span class="nc" id="L860">		cell = new PdfPCell(new Phrase(&quot;Address :&quot;, HN_FONT));</span>
<span class="nc" id="L861">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
		
<span class="nc" id="L863">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L864">		cell.setColspan(2);</span>
<span class="nc" id="L865">		headerTable.addCell(cell);</span>

<span class="nc" id="L867">		String address = (String) staticMap.get(&quot;boOrgAdd&quot;);</span>
<span class="nc bnc" id="L868" title="All 2 branches missed.">		address = address != null ? address : &quot; &quot;;</span>
<span class="nc" id="L869">		cell = new PdfPCell(new Phrase(address, N_FONT));</span>
<span class="nc" id="L870">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L871">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L872">		cell.setColspan(2);</span>
<span class="nc" id="L873">		headerTable.addCell(cell);</span>
		// Third row of Header
<span class="nc" id="L875">		String companyName = (String) staticMap.get(&quot;boOrgName&quot;);</span>
<span class="nc bnc" id="L876" title="All 2 branches missed.">		companyName = companyName != null ? companyName : &quot; &quot;;</span>
<span class="nc" id="L877">		cell = new PdfPCell(new Paragraph(companyName, new Font(Font.HELVETICA,</span>
				27, Font.BOLD)));
<span class="nc" id="L879">		cell.setNoWrap(true);</span>
<span class="nc" id="L880">		cell.setColspan(4);</span>
<span class="nc" id="L881">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L882">		cell.setVerticalAlignment(Element.ALIGN_BOTTOM);</span>
<span class="nc" id="L883">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBorderWidth(1);
<span class="nc" id="L885">		headerTable.addCell(cell);</span>
/*
		cell = new PdfPCell(new Phrase(&quot;Address : &quot;, B_FONT));
		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
		cell.setBorder(Rectangle.NO_BORDER);
		// cell.setBorderWidth(1);
		headerTable.addCell(cell);
		System.out.println(&quot;6&quot;);

		String address = (String) staticMap.get(&quot;boOrgAdd&quot;);
		address = address != null ? address : &quot; &quot;;
		cell = new PdfPCell(new Phrase(address, N_FONT));
	
		cell.setHorizontalAlignment(Element.ALIGN_LEFT);
		cell.setBorder(Rectangle.NO_BORDER);
		// cell.setBorderWidth(2);
		cell.setColspan(2);
		headerTable.addCell(cell);
	*/
<span class="nc" id="L904">		System.out.println(&quot;7&quot;);</span>
		
/*
		String vatRef = (String) staticMap.get(&quot;vatRef&quot;);
		address = vatRef != null ? vatRef : &quot; &quot;;
		if (!&quot;&quot;.equals(vatRef.trim())) {
			cell = new PdfPCell(new Phrase(&quot;VAT Ref Number :  &quot; + vatRef,
					HN_FONT));
			cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			cell.setBorder(Rectangle.NO_BORDER);
			cell.setBorderWidth(1);
			cell.setColspan(4);
			headerTable.addCell(cell);
			System.out.println(&quot;8&quot;);
		}
*/
		// forth blank row (used to insert a line) of header
<span class="nc" id="L921">		cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L922">		cell.setFixedHeight(4);</span>
<span class="nc" id="L923">		cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L924">		cell.setBorderWidth(1);</span>
<span class="nc" id="L925">		cell.setColspan(4);</span>
<span class="nc" id="L926">		headerTable.addCell(cell);</span>
<span class="nc" id="L927">		System.out.println(&quot;9&quot;);</span>

		// fifth blank row (used to insert a gap) of header
<span class="nc" id="L930">		cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L931">		cell.setFixedHeight(4);</span>
<span class="nc" id="L932">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L933">		cell.setColspan(4);</span>
<span class="nc" id="L934">		headerTable.addCell(cell);</span>
<span class="nc" id="L935">		System.out.println(&quot;10&quot;);</span>

		/*
		 * //fifth blank row (used to insert a gap) of header cell=new
		 * PdfPCell(new Phrase(&quot;To &quot;, N_FONT)); //cell.setFixedHeight(4);
		 * cell.setBackgroundColor(Color.LIGHT_GRAY);
		 * cell.setBorder(Rectangle.NO_BORDER); cell.setColspan(4);
		 * headerTable.addCell(cell);
		 */

		// sixth row of header
<span class="nc" id="L946">		String customerName = (String) staticMap.get(&quot;customerName&quot;);</span>
<span class="nc bnc" id="L947" title="All 2 branches missed.">		customerName = customerName != null ? customerName : &quot; &quot;;</span>
<span class="nc" id="L948">		cell = new PdfPCell(new Phrase(customerName, H_FONT));</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L950">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L951">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L952">		cell.setColspan(2);</span>
<span class="nc" id="L953">		headerTable.addCell(cell);</span>
<span class="nc" id="L954">		System.out.println(&quot;11&quot;);</span>

<span class="nc" id="L956">		cell = new PdfPCell(new Phrase(&quot;Voucher Id : &quot;, B_FONT));</span>
<span class="nc" id="L957">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L959">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L960">		cell.setColspan(1);</span>
<span class="nc" id="L961">		headerTable.addCell(cell);</span>

<span class="nc" id="L963">		String dcNo = (String) staticMap.get(&quot;dcNo&quot;);</span>
<span class="nc bnc" id="L964" title="All 2 branches missed.">		dcNo = dcNo != null ? dcNo : &quot; &quot;;</span>
<span class="nc" id="L965">		cell = new PdfPCell(new Phrase(dcNo, N_FONT));</span>
<span class="nc" id="L966">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L968">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L969">		cell.setColspan(1);</span>
<span class="nc" id="L970">		headerTable.addCell(cell);</span>
<span class="nc" id="L971">		System.out.println(&quot;12&quot;);</span>

		// seventh row of header
<span class="nc" id="L974">		String customerAdd = (String) staticMap.get(&quot;customerAdd1&quot;) + &quot;, &quot;</span>
				+ (String) staticMap.get(&quot;customerAdd2&quot;);
<span class="nc bnc" id="L976" title="All 2 branches missed.">		customerAdd = customerAdd != null ? customerAdd : &quot; &quot;;</span>
<span class="nc" id="L977">		cell = new PdfPCell(new Phrase(customerAdd,H_FONT));</span>
<span class="nc" id="L978">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L980">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L981">		cell.setColspan(2);</span>
<span class="nc" id="L982">		headerTable.addCell(cell);</span>

<span class="nc" id="L984">		cell = new PdfPCell(new Phrase(&quot;Voucher Date : &quot;, B_FONT));</span>
<span class="nc" id="L985">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L987">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L988">		cell.setColspan(1);</span>
<span class="nc" id="L989">		headerTable.addCell(cell);</span>

<span class="nc" id="L991">		String dcDate = (String) staticMap.get(&quot;dcDate&quot;);</span>
<span class="nc bnc" id="L992" title="All 2 branches missed.">		dcDate = dcDate != null ? dcDate : &quot; &quot;;</span>
<span class="nc" id="L993">		cell = new PdfPCell(new Phrase(dcDate, N_FONT));</span>
<span class="nc" id="L994">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L996">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L997">		cell.setColspan(1);</span>
<span class="nc" id="L998">		headerTable.addCell(cell);</span>

		// Eight row of header
		/*
		 * cell=new PdfPCell(new Phrase(&quot; &quot;, B_FONT));
		 * cell.setBorder(Rectangle.NO_BORDER); cell.setFixedHeight(8);
		 * cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
		 * cell.setBackgroundColor(Color.LIGHT_GRAY); cell.setBorderWidth(1);
		 * cell.setColspan(3); headerTable.addCell(cell);
		 * System.out.println(&quot;13&quot;);
		 */

<span class="nc" id="L1010">		PdfPTable sheaderTable = new PdfPTable(5);</span>
<span class="nc" id="L1011">		sheaderTable.setWidthPercentage(100);</span>
<span class="nc" id="L1012">		int sheaderwidths[] = new int[] { 12, 41, 12, 15, 20 };</span>
<span class="nc" id="L1013">		sheaderTable.setWidths(sheaderwidths);</span>

		// seventh row of header
		/*cell = new PdfPCell(new Phrase(&quot;Invoice Id : &quot;, B_FONT));
		cell.setBorder(Rectangle.NO_BORDER);
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
		cell.setHorizontalAlignment(Element.ALIGN_LEFT);
		sheaderTable.addCell(cell);

		String invoiceNo = (String) staticMap.get(&quot;invoiceId&quot;);
		invoiceNo = invoiceNo != null ? invoiceNo : &quot; &quot;;
		cell = new PdfPCell(new Phrase(invoiceNo, N_FONT));
		cell.setBorder(Rectangle.NO_BORDER);
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
		cell.setColspan(2);
		cell.setHorizontalAlignment(Element.ALIGN_LEFT);
		sheaderTable.addCell(cell);
		System.out.println(&quot;14&quot;);

		cell = new PdfPCell(new Phrase(&quot;Invoice Date : &quot;, B_FONT));
		cell.setBorder(Rectangle.NO_BORDER);
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
		cell.setHorizontalAlignment(Element.ALIGN_LEFT);
		cell.setColspan(1);
		sheaderTable.addCell(cell);

		String invoiceDate = (String) staticMap.get(&quot;invoiceDate&quot;);
		invoiceDate = invoiceDate != null ? invoiceDate : &quot; &quot;;
		cell = new PdfPCell(new Phrase(invoiceDate, N_FONT));
		cell.setBorder(Rectangle.NO_BORDER);
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
		cell.setColspan(1);
		sheaderTable.addCell(cell);
		System.out.println(&quot;15&quot;);
*/
		// 8 row of header
/*
		cell = new PdfPCell(new Phrase(&quot;Order Id : &quot;, B_FONT));
		cell.setBorder(Rectangle.NO_BORDER);
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
		cell.setHorizontalAlignment(Element.ALIGN_LEFT);
		sheaderTable.addCell(cell);

		String orderNo = (String) staticMap.get(&quot;orderNo&quot;);
		orderNo = orderNo != null ? orderNo : &quot; &quot;;
		cell = new PdfPCell(new Phrase(orderNo, N_FONT));
		cell.setBorder(Rectangle.NO_BORDER);
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
		cell.setHorizontalAlignment(Element.ALIGN_LEFT);
		cell.setColspan(2);
		sheaderTable.addCell(cell);
		System.out.println(&quot;16&quot;);

		cell = new PdfPCell(new Phrase(&quot;Order Date : &quot;, B_FONT));
		cell.setBorder(Rectangle.NO_BORDER);
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
		cell.setHorizontalAlignment(Element.ALIGN_LEFT);
		cell.setColspan(1);
		sheaderTable.addCell(cell);

		String orderDate = (String) staticMap.get(&quot;orderDate&quot;);
		orderDate = orderDate != null ? orderDate : &quot; &quot;;
		cell = new PdfPCell(new Phrase(orderDate, N_FONT));
		cell.setBorder(Rectangle.NO_BORDER);
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
		cell.setColspan(1);
		sheaderTable.addCell(cell);
		System.out.println(&quot;17&quot;);

		// Eight row of header
		cell = new PdfPCell(sheaderTable);
		cell.setBorder(Rectangle.NO_BORDER);
		// cell.setFixedHeight(3);
		// cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
		cell.setBorderWidth(0);
		cell.setColspan(4);
		headerTable.addCell(cell);
*/
		// Eight row of header
<span class="nc" id="L1094">		cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L1095">		cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L1096">		cell.setFixedHeight(3);</span>
<span class="nc" id="L1097">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1098">		cell.setBorderWidth(1);</span>
<span class="nc" id="L1099">		cell.setColspan(4);</span>
<span class="nc" id="L1100">		headerTable.addCell(cell);</span>
<span class="nc" id="L1101">		System.out.println(&quot;18&quot;);</span>

<span class="nc" id="L1103">		return headerTable;</span>
	}

	private PdfPTable getStaticHeaderOfSaleRetReport(Map staticMap)
			throws DocumentException {

<span class="nc" id="L1109">		PdfPTable headerTable = new PdfPTable(4);</span>
<span class="nc" id="L1110">		headerTable.setWidthPercentage(100);</span>
<span class="nc" id="L1111">		int headerwidths[] = new int[] { 53, 12, 15, 20 };</span>
<span class="nc" id="L1112">		headerTable.setWidths(headerwidths);</span>

<span class="nc" id="L1114">		System.out.println(&quot;static header map : == &quot; + staticMap);</span>

		PdfPCell cell;

<span class="nc" id="L1118">		cell = new PdfPCell(new Phrase(&quot;Sales Return Note&quot;, H_FONT));</span>
<span class="nc" id="L1119">		cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L1120">		cell.setVerticalAlignment(Element.ALIGN_MIDDLE);</span>
<span class="nc" id="L1121">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1122">		cell.setColspan(4);</span>
<span class="nc" id="L1123">		headerTable.addCell(cell);</span>

<span class="nc" id="L1125">		System.out.println(&quot;1&quot;);</span>

		/*
		 * cell=new PdfPCell(new Phrase(&quot; &quot;, N_FONT)); cell.setFixedHeight(4);
		 * cell.setBorder(Rectangle.NO_BORDER); cell.setColspan(6);
		 * headerTable.addCell(cell); System.out.println(&quot;2&quot;);
		 */

		// first row of header
<span class="nc" id="L1134">		cell = new PdfPCell(new Phrase(&quot;Generation Time : &quot;, HN_FONT));</span>
<span class="nc" id="L1135">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1136">		cell.setVerticalAlignment(Element.ALIGN_MIDDLE);</span>
<span class="nc" id="L1137">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1138">		cell.setColspan(3);</span>
<span class="nc" id="L1139">		headerTable.addCell(cell);</span>

<span class="nc" id="L1141">		String time = (String) staticMap.get(&quot;dcGenerationTime&quot;);</span>
<span class="nc bnc" id="L1142" title="All 2 branches missed.">		time = time != null ? time : &quot; &quot;;</span>
<span class="nc" id="L1143">		cell = new PdfPCell(new Phrase(time, N_FONT));</span>
<span class="nc" id="L1144">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1145">		cell.setVerticalAlignment(Element.ALIGN_MIDDLE);</span>
<span class="nc" id="L1146">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1147">		cell.setColspan(1);</span>
<span class="nc" id="L1148">		headerTable.addCell(cell);</span>

<span class="nc" id="L1150">		System.out.println(&quot;3&quot;);</span>

		/*
		 * //Second row of header cell=new PdfPCell(new Phrase(&quot; &quot;, N_FONT));
		 * cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
		 * cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
		 * cell.setBorder(Rectangle.NO_BORDER); cell.setColspan(3);
		 * headerTable.addCell(cell);
		 */
<span class="nc" id="L1159">		System.out.println(&quot;4&quot;);</span>

		// Third row of Header
<span class="nc" id="L1162">		String companyName = (String) staticMap.get(&quot;boOrgName&quot;);</span>
<span class="nc bnc" id="L1163" title="All 2 branches missed.">		companyName = companyName != null ? companyName : &quot; &quot;;</span>
<span class="nc" id="L1164">		cell = new PdfPCell(new Paragraph(companyName, new Font(Font.HELVETICA,</span>
				27, Font.BOLD)));
<span class="nc" id="L1166">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1167">		cell.setVerticalAlignment(Element.ALIGN_BOTTOM);</span>
<span class="nc" id="L1168">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBorderWidth(1);
<span class="nc" id="L1170">		headerTable.addCell(cell);</span>

<span class="nc" id="L1172">		cell = new PdfPCell(new Phrase(&quot;Address : &quot;, B_FONT));</span>
<span class="nc" id="L1173">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1174">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBorderWidth(1);
<span class="nc" id="L1176">		headerTable.addCell(cell);</span>
<span class="nc" id="L1177">		System.out.println(&quot;6&quot;);</span>

<span class="nc" id="L1179">		String address = (String) staticMap.get(&quot;boOrgAdd&quot;);</span>
<span class="nc bnc" id="L1180" title="All 2 branches missed.">		address = address != null ? address : &quot; &quot;;</span>
<span class="nc" id="L1181">		cell = new PdfPCell(new Phrase(address, N_FONT));</span>
<span class="nc" id="L1182">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1183">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBorderWidth(2);
<span class="nc" id="L1185">		cell.setColspan(2);</span>
<span class="nc" id="L1186">		headerTable.addCell(cell);</span>
<span class="nc" id="L1187">		System.out.println(&quot;7&quot;);</span>
/*
		String vatRef = (String) staticMap.get(&quot;vatRef&quot;);
		address = vatRef != null ? vatRef : &quot; &quot;;
		if (!&quot;&quot;.equals(vatRef.trim())) {
			cell = new PdfPCell(new Phrase(&quot;VAT Ref Number :  &quot; + vatRef,
					HN_FONT));
			cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			cell.setBorder(Rectangle.NO_BORDER);
			cell.setBorderWidth(1);
			cell.setColspan(4);
			headerTable.addCell(cell);
		}*/
<span class="nc" id="L1200">		System.out.println(&quot;8&quot;);</span>

		// forth blank row (used to insert a line) of header
<span class="nc" id="L1203">		cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L1204">		cell.setFixedHeight(4);</span>
<span class="nc" id="L1205">		cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L1206">		cell.setBorderWidth(1);</span>
<span class="nc" id="L1207">		cell.setColspan(4);</span>
<span class="nc" id="L1208">		headerTable.addCell(cell);</span>
<span class="nc" id="L1209">		System.out.println(&quot;9&quot;);</span>

		// fifth blank row (used to insert a gap) of header
<span class="nc" id="L1212">		cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L1213">		cell.setFixedHeight(4);</span>
<span class="nc" id="L1214">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1215">		cell.setColspan(4);</span>
<span class="nc" id="L1216">		headerTable.addCell(cell);</span>
<span class="nc" id="L1217">		System.out.println(&quot;10&quot;);</span>

		/*
		 * //fifth blank row (used to insert a gap) of header cell=new
		 * PdfPCell(new Phrase(&quot;To &quot;, N_FONT)); //cell.setFixedHeight(4);
		 * cell.setBackgroundColor(Color.LIGHT_GRAY);
		 * cell.setBorder(Rectangle.NO_BORDER); cell.setColspan(4);
		 * headerTable.addCell(cell);
		 */

		// sixth row of header
		// sixth row of header
<span class="nc" id="L1229">		String customerName = (String) staticMap.get(&quot;customerName&quot;);</span>
<span class="nc bnc" id="L1230" title="All 2 branches missed.">		customerName = customerName != null ? customerName : &quot; &quot;;</span>
<span class="nc" id="L1231">		cell = new PdfPCell(new Phrase(customerName, N_FONT));</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1233">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1234">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1235">		cell.setColspan(2);</span>
<span class="nc" id="L1236">		headerTable.addCell(cell);</span>
<span class="nc" id="L1237">		System.out.println(&quot;11&quot;);</span>

<span class="nc" id="L1239">		cell = new PdfPCell(new Phrase(&quot;Voucher Id : &quot;, B_FONT));</span>
<span class="nc" id="L1240">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1242">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1243">		cell.setColspan(1);</span>
<span class="nc" id="L1244">		headerTable.addCell(cell);</span>

<span class="nc" id="L1246">		String srnNo = (String) staticMap.get(&quot;crNote&quot;);</span>
<span class="nc bnc" id="L1247" title="All 2 branches missed.">		srnNo = srnNo != null ? srnNo : &quot; &quot;;</span>
<span class="nc" id="L1248">		cell = new PdfPCell(new Phrase(srnNo, N_FONT));</span>
<span class="nc" id="L1249">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1251">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1252">		cell.setColspan(1);</span>
<span class="nc" id="L1253">		headerTable.addCell(cell);</span>
<span class="nc" id="L1254">		System.out.println(&quot;12&quot;);</span>

		// seventh row of header
<span class="nc" id="L1257">		String customerAdd = (String) staticMap.get(&quot;customerAdd1&quot;) + &quot;, &quot;</span>
				+ (String) staticMap.get(&quot;customerAdd2&quot;);
<span class="nc bnc" id="L1259" title="All 2 branches missed.">		customerAdd = customerAdd != null ? customerAdd : &quot; &quot;;</span>
<span class="nc" id="L1260">		cell = new PdfPCell(new Phrase(customerAdd, N_FONT));</span>
<span class="nc" id="L1261">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1263">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1264">		cell.setColspan(2);</span>
<span class="nc" id="L1265">		headerTable.addCell(cell);</span>

<span class="nc" id="L1267">		cell = new PdfPCell(new Phrase(&quot;Voucher Date : &quot;, B_FONT));</span>
<span class="nc" id="L1268">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1270">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1271">		cell.setColspan(1);</span>
<span class="nc" id="L1272">		headerTable.addCell(cell);</span>

<span class="nc" id="L1274">		String srnDate = (String) staticMap.get(&quot;srnDate&quot;);</span>
<span class="nc bnc" id="L1275" title="All 2 branches missed.">		srnDate = srnDate != null ? srnDate : &quot; &quot;;</span>
<span class="nc" id="L1276">		cell = new PdfPCell(new Phrase(srnDate, N_FONT));</span>
<span class="nc" id="L1277">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1279">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1280">		cell.setColspan(1);</span>
<span class="nc" id="L1281">		headerTable.addCell(cell);</span>

		/*
		 * //Eight row of header cell=new PdfPCell(new Phrase(&quot; &quot;, B_FONT));
		 * cell.setBorder(Rectangle.NO_BORDER); cell.setFixedHeight(8);
		 * cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
		 * cell.setBackgroundColor(Color.LIGHT_GRAY); cell.setBorderWidth(1);
		 * cell.setColspan(4); headerTable.addCell(cell);
		 * System.out.println(&quot;13&quot;);
		 */

		// seventh row of header
<span class="nc" id="L1293">		PdfPTable sheaderTable = new PdfPTable(5);</span>
<span class="nc" id="L1294">		sheaderTable.setWidthPercentage(100);</span>
<span class="nc" id="L1295">		int sheaderwidths[] = new int[] { 18, 35, 12, 17, 18 };</span>
<span class="nc" id="L1296">		sheaderTable.setWidths(sheaderwidths);</span>

		// seventh row of header
<span class="nc" id="L1299">		cell = new PdfPCell(new Phrase(&quot;Credit Note Id :&quot;, B_FONT));</span>
<span class="nc" id="L1300">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1302">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1303">		sheaderTable.addCell(cell);</span>

<span class="nc" id="L1305">		String crNote = (String) staticMap.get(&quot;srnNo&quot;);</span>
<span class="nc bnc" id="L1306" title="All 2 branches missed.">		crNote = crNote != null ? crNote : &quot; &quot;;</span>
<span class="nc" id="L1307">		cell = new PdfPCell(new Phrase(&quot; : &quot; + crNote, N_FONT));</span>
<span class="nc" id="L1308">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1310">		cell.setColspan(2);</span>
<span class="nc" id="L1311">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1312">		sheaderTable.addCell(cell);</span>
<span class="nc" id="L1313">		System.out.println(&quot;14&quot;);</span>

<span class="nc" id="L1315">		cell = new PdfPCell(new Phrase(&quot;Credit Note Date : &quot;, B_FONT));</span>
<span class="nc" id="L1316">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1318">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1319">		cell.setColspan(1);</span>
<span class="nc" id="L1320">		sheaderTable.addCell(cell);</span>

<span class="nc" id="L1322">		String crDate = (String) staticMap.get(&quot;crDate&quot;);</span>
<span class="nc bnc" id="L1323" title="All 2 branches missed.">		crDate = crDate != null ? crDate : &quot; &quot;;</span>
<span class="nc" id="L1324">		cell = new PdfPCell(new Phrase(crDate, N_FONT));</span>
<span class="nc" id="L1325">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1327">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1328">		cell.setColspan(1);</span>
<span class="nc" id="L1329">		sheaderTable.addCell(cell);</span>
<span class="nc" id="L1330">		System.out.println(&quot;17&quot;);</span>

		// Eight row of header
<span class="nc" id="L1333">		cell = new PdfPCell(sheaderTable);</span>
<span class="nc" id="L1334">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setFixedHeight(3);
		// cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
<span class="nc" id="L1337">		cell.setBorderWidth(0);</span>
<span class="nc" id="L1338">		cell.setColspan(4);</span>
<span class="nc" id="L1339">		headerTable.addCell(cell);</span>

<span class="nc" id="L1341">		cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L1342">		cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L1343">		cell.setFixedHeight(3);</span>
<span class="nc" id="L1344">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1345">		cell.setBorderWidth(1);</span>
<span class="nc" id="L1346">		cell.setColspan(4);</span>
<span class="nc" id="L1347">		headerTable.addCell(cell);</span>
<span class="nc" id="L1348">		System.out.println(&quot;18&quot;);</span>

<span class="nc" id="L1350">		return headerTable;</span>
	}

	public void setServletRequest(HttpServletRequest request) {
<span class="nc" id="L1354">		this.request = request;</span>
<span class="nc" id="L1355">	}</span>

	public void setServletResponse(HttpServletResponse response) {
<span class="nc" id="L1358">		this.response = response;</span>

<span class="nc" id="L1360">	}</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>