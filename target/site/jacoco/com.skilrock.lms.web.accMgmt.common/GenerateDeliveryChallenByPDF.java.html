<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GenerateDeliveryChallenByPDF.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">lms</a> &gt; <a href="index.source.html" class="el_package">com.skilrock.lms.web.accMgmt.common</a> &gt; <span class="el_source">GenerateDeliveryChallenByPDF.java</span></div><h1>GenerateDeliveryChallenByPDF.java</h1><pre class="source lang-java linenums">package com.skilrock.lms.web.accMgmt.common;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.OutputStream;
import java.util.List;
import java.util.Map;
import java.util.Set;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import org.apache.struts2.interceptor.ServletRequestAware;
import org.apache.struts2.interceptor.ServletResponseAware;

import com.lowagie.text.Document;
import com.lowagie.text.DocumentException;
import com.lowagie.text.Element;
import com.lowagie.text.Font;
import com.lowagie.text.PageSize;
import com.lowagie.text.Paragraph;
import com.lowagie.text.Phrase;
import com.lowagie.text.Rectangle;
import com.lowagie.text.pdf.PdfContentByte;
import com.lowagie.text.pdf.PdfPCell;
import com.lowagie.text.pdf.PdfPCellEvent;
import com.lowagie.text.pdf.PdfPTable;
import com.lowagie.text.pdf.PdfWriter;
import com.opensymphony.xwork2.ActionSupport;

<span class="nc" id="L32">public class GenerateDeliveryChallenByPDF extends ActionSupport implements</span>
		ServletRequestAware, PdfPCellEvent, ServletResponseAware {

	/**
	 * 
	 */
	private static final long serialVersionUID = 1L;

<span class="nc" id="L40">	final Font B_FONT = new Font(Font.HELVETICA, 10, Font.BOLD);</span>

<span class="nc" id="L42">	final Font H_FONT = new Font(Font.HELVETICA, 13, Font.BOLD);</span>
<span class="nc" id="L43">	final Font HN_FONT = new Font(Font.HELVETICA, 9, Font.BOLD);</span>
<span class="nc" id="L44">	final Font N_FONT = new Font(Font.HELVETICA, 9, Font.NORMAL);</span>
	private HttpServletRequest request;
	private HttpServletResponse response;
<span class="nc" id="L47">	final Font THN_FONT = new Font(Font.HELVETICA, 14, Font.BOLD);</span>
<span class="nc" id="L48">	final Font U_FONT = new Font(Font.HELVETICA, 11, Font.BOLD);</span>

	public void cellLayout(PdfPCell cell, Rectangle position,
			PdfContentByte[] canvases) {
<span class="nc" id="L52">		float x1 = position.getLeft() + 2;</span>
<span class="nc" id="L53">		float x2 = position.getRight() - 2;</span>
<span class="nc" id="L54">		float y1 = position.getTop() - 2;</span>
<span class="nc" id="L55">		float y2 = position.getBottom() + 2;</span>
<span class="nc" id="L56">		PdfContentByte canvas = canvases[PdfPTable.LINECANVAS];</span>
		// canvas.setRGBColorStroke(0xFF, 0x00, 0x00);
<span class="nc" id="L58">		canvas.rectangle(x1, y1, x2 - x1, y2 - y1);</span>
<span class="nc" id="L59">		canvas.stroke();</span>
<span class="nc" id="L60">		canvas.resetRGBColorStroke();</span>
<span class="nc" id="L61">	}</span>

	public String generatePDF() {
<span class="nc" id="L64">		byte[] arrayOutPut = new byte[0];</span>
		try {
			// setting some response headers
<span class="nc" id="L67">			response.setHeader(&quot;Expires&quot;, &quot;0&quot;);</span>
<span class="nc" id="L68">			response.setHeader(&quot;Cache-Control&quot;,</span>
					&quot;must-revalidate, post-check=0, pre-check=0&quot;);
<span class="nc" id="L70">			response.setHeader(&quot;Pragma&quot;, &quot;public&quot;);</span>

<span class="nc" id="L72">			response.setContentType(&quot;application/pdf&quot;);</span>
<span class="nc" id="L73">			OutputStream OutStrm = response.getOutputStream();</span>

			// this method return the byte of pdf output streams
<span class="nc" id="L76">			String type = (String) request.getSession().getAttribute(</span>
					&quot;deliveryChallanType&quot;);
			// if(&quot;DSRCHALLAN&quot;.equalsIgnoreCase(type.trim())) {
			// arrayOutPut=genrateSaleReturnPDFTable();
			// }
			// else
<span class="nc" id="L82">			arrayOutPut = genratePDFTable();</span>

<span class="nc" id="L84">			OutStrm.write(arrayOutPut);</span>
			// System.out.println(&quot;in the last ................ &quot;);
<span class="nc" id="L86">			OutStrm.flush();</span>
			// System.out.println(&quot;before out put stream closed&quot;);
<span class="nc" id="L88">			OutStrm.close();</span>
			// System.out.println(&quot;after out put stream closed&quot;);
<span class="nc" id="L90">		} catch (IOException e) {</span>
<span class="nc" id="L91">			System.out.println(&quot; exception occured in &quot;);</span>
<span class="nc" id="L92">		}</span>
<span class="nc bnc" id="L93" title="All 2 branches missed.">		if (arrayOutPut.length &gt; 0) {</span>
<span class="nc" id="L94">			return null;</span>
		} else {
<span class="nc" id="L96">			return SUCCESS;</span>
		}
	}

	public String generatePDFWarehouse() {
<span class="nc" id="L101">		byte[] arrayOutPut = new byte[0];</span>
		try {
<span class="nc" id="L103">			response.setHeader(&quot;Expires&quot;, &quot;0&quot;);</span>
<span class="nc" id="L104">			response.setHeader(&quot;Cache-Control&quot;, &quot;must-revalidate, post-check=0, pre-check=0&quot;);</span>
<span class="nc" id="L105">			response.setHeader(&quot;Pragma&quot;, &quot;public&quot;);</span>
<span class="nc" id="L106">			response.setContentType(&quot;application/pdf&quot;);</span>
<span class="nc" id="L107">			OutputStream OutStrm = response.getOutputStream();</span>
<span class="nc" id="L108">			String type = (String) request.getSession().getAttribute(&quot;deliveryChallanType&quot;);</span>
<span class="nc" id="L109">			arrayOutPut = genratePDFTableWarehouse();</span>
<span class="nc" id="L110">			OutStrm.write(arrayOutPut);</span>
<span class="nc" id="L111">			OutStrm.flush();</span>
<span class="nc" id="L112">			OutStrm.close();</span>
<span class="nc" id="L113">		} catch (IOException e) {</span>
<span class="nc" id="L114">			System.out.println(&quot; exception occured in &quot;);</span>
<span class="nc" id="L115">		}</span>

<span class="nc bnc" id="L117" title="All 2 branches missed.">		if (arrayOutPut.length &gt; 0) {</span>
<span class="nc" id="L118">			return null;</span>
		} else {
<span class="nc" id="L120">			return SUCCESS;</span>
		}
	}

	private byte[] genratePDFTable() {

<span class="nc" id="L126">		System.out</span>
				.println(&quot;inside PDF ledger Report 111111 ........................&quot;);

<span class="nc" id="L129">		HttpSession session = request.getSession();</span>
<span class="nc" id="L130">		Map reportBean = (Map) session.getAttribute(&quot;detailsMap&quot;);</span>
<span class="nc" id="L131">		Map headerInfoMap = (Map) session.getAttribute(&quot;staticReportMap&quot;);</span>
<span class="nc" id="L132">		PdfWriter writer = null;</span>
<span class="nc" id="L133">		Document document = new Document(PageSize.A4, 22, 15, 30, 60);</span>
<span class="nc" id="L134">		ByteArrayOutputStream baos = new ByteArrayOutputStream();</span>

		try {
<span class="nc" id="L137">			writer = PdfWriter.getInstance(document, baos);</span>
<span class="nc" id="L138">			document.open();</span>

<span class="nc" id="L140">			PdfPTable reportTable = new PdfPTable(2);</span>
			// reportTable.setSplitRows(false);
<span class="nc" id="L142">			int headerwidths[] = new int[] { 85, 15 };</span>
<span class="nc" id="L143">			reportTable.setWidths(headerwidths);</span>
<span class="nc" id="L144">			reportTable.setSplitLate(false);</span>
<span class="nc" id="L145">			reportTable.setWidthPercentage(100);</span>
<span class="nc" id="L146">			PdfPCell cell = null;</span>

<span class="nc" id="L148">			int totalBookQty = 0;</span>
<span class="nc" id="L149">			boolean flag = true;</span>
			// static header added
<span class="nc" id="L151">			String type = (String) session.getAttribute(&quot;deliveryChallanType&quot;);</span>
<span class="nc bnc" id="L152" title="All 2 branches missed.">			if (&quot;DSRCHALLAN&quot;.equalsIgnoreCase(type.trim())) {</span>
<span class="nc" id="L153">				cell = new PdfPCell(</span>
						getStaticHeaderOfSaleRetReport(headerInfoMap));
<span class="nc" id="L155">				cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L156">				cell.setColspan(2);</span>
<span class="nc" id="L157">				reportTable.addCell(cell);</span>
<span class="nc" id="L158">				System.out.println(&quot;static header in if........... &quot;);</span>

<span class="nc" id="L160">				System.out.println(&quot; bean of gmaes &quot; + reportBean);</span>

<span class="nc" id="L162">				totalBookQty = 0;</span>
<span class="nc" id="L163">				flag = true;</span>

<span class="nc" id="L165">				Set&lt;Integer&gt; returnSet = reportBean.keySet();</span>
<span class="nc bnc" id="L166" title="All 2 branches missed.">				for (Integer returnkey : returnSet) {</span>
<span class="nc" id="L167">					System.out.println(&quot;transaction id = &quot; + returnkey);</span>
<span class="nc" id="L168">					Map KeysMap = (Map) reportBean.get(returnkey);</span>
<span class="nc" id="L169">					Set&lt;String&gt; mapKey = (Set) KeysMap.keySet();</span>
<span class="nc bnc" id="L170" title="All 2 branches missed.">					for (String key : mapKey) {</span>
<span class="nc" id="L171">						System.out.println(&quot; gmae ===== &quot; + key);</span>
<span class="nc" id="L172">						InvoiceGameDetailBean bean = (InvoiceGameDetailBean) KeysMap</span>
								.get(key);
<span class="nc" id="L174">						cell = new PdfPCell(new Phrase(&quot;Game Name : &quot;</span>
								+ bean.getGameName()
								+ &quot;      Sale Commission Rate : &quot;
								+ bean.getSalCommVar(), U_FONT));
<span class="nc" id="L178">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L179">						cell.setColspan(1);</span>
<span class="nc" id="L180">						reportTable.addCell(cell);</span>

<span class="nc bnc" id="L182" title="All 2 branches missed.">						if (flag) {</span>
<span class="nc" id="L183">							cell = new PdfPCell(new Phrase(&quot;QTY OF BOOKS&quot;,</span>
									B_FONT));
<span class="nc" id="L185">							cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L186">							cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L187">							reportTable.addCell(cell);</span>
<span class="nc" id="L188">							System.out</span>
									.println(&quot; inside qty of books ............&quot;);
<span class="nc" id="L190">							flag = false;</span>
						} else {
<span class="nc" id="L192">							cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L193">							cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L194">							cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L195">							System.out</span>
									.println(&quot; not inside qty of books ............&quot;);
<span class="nc" id="L197">							reportTable.addCell(cell);</span>
						}

<span class="nc" id="L200">						reportTable.addCell(getBlankCell(3));</span>

<span class="nc bnc" id="L202" title="All 2 branches missed.">						if (bean.getPackNbrList().size() &gt; 0) {</span>
							// pack details header columns
<span class="nc" id="L204">							cell = new PdfPCell(new Phrase(&quot;Pack No.&quot;, B_FONT));</span>
<span class="nc" id="L205">							cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L206">							cell.setColspan(2);</span>
<span class="nc" id="L207">							reportTable.addCell(cell);</span>

							// pack details columns

<span class="nc" id="L211">							cell = new PdfPCell(getPackDetails(bean</span>
									.getPackNbrList()));
<span class="nc" id="L213">							cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L214">							reportTable.addCell(cell);</span>
<span class="nc" id="L215">							cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L216">							cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L217">							reportTable.addCell(cell);</span>
<span class="nc" id="L218">							System.out.println(&quot; packs detail ............&quot;</span>
									+ bean.getPackNbrList());

<span class="nc" id="L221">							int totalBooksPack = bean.getPackNbrList().size()</span>
									* bean.getNbrBooks();
<span class="nc" id="L223">							totalBookQty = totalBookQty + totalBooksPack;</span>

<span class="nc" id="L225">							cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L226">							cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L227">							reportTable.addCell(cell);</span>
<span class="nc" id="L228">							cell = new PdfPCell(new Phrase(</span>
									&quot; &quot; + totalBooksPack, B_FONT));
<span class="nc" id="L230">							cell.setBorder(Rectangle.BOX);</span>
							/*
							 * GenerateDeliveryChallenByPDF event =new
							 * GenerateDeliveryChallenByPDF();
							 * cell.setCellEvent(event);
							 */
<span class="nc" id="L236">							cell.setVerticalAlignment(Element.ALIGN_BOTTOM);</span>
<span class="nc" id="L237">							cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L238">							reportTable.addCell(cell);</span>

							// blank column
<span class="nc" id="L241">							cell = new PdfPCell(getBlankCell(3));</span>
<span class="nc" id="L242">							cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L243">							cell.setColspan(2);</span>
<span class="nc" id="L244">							reportTable.addCell(cell);</span>

						}

<span class="nc bnc" id="L248" title="All 2 branches missed.">						if (bean.getBookNbrList().size() &gt; 0) {</span>
<span class="nc" id="L249">							cell = new PdfPCell(new Phrase(&quot;Book No.&quot;, B_FONT));</span>
<span class="nc" id="L250">							cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L251">							cell.setColspan(2);</span>
<span class="nc" id="L252">							reportTable.addCell(cell);</span>

<span class="nc" id="L254">							cell = new PdfPCell(getBookDetails(bean</span>
									.getBookNbrList()));
<span class="nc" id="L256">							cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L257">							reportTable.addCell(cell);</span>
<span class="nc" id="L258">							cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L259">							cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L260">							reportTable.addCell(cell);</span>

<span class="nc" id="L262">							totalBookQty = totalBookQty</span>
									+ bean.getBookNbrList().size();

<span class="nc" id="L265">							cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L266">							cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L267">							reportTable.addCell(cell);</span>
<span class="nc" id="L268">							cell = new PdfPCell(new Phrase(&quot; &quot;</span>
									+ bean.getBookNbrList().size(), B_FONT));
<span class="nc" id="L270">							cell.setBorder(Rectangle.BOX);</span>
							// cell.setCellEvent(event);
<span class="nc" id="L272">							cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L273">							cell.setVerticalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L274">							reportTable.addCell(cell);</span>
<span class="nc" id="L275">							System.out.println(&quot; books detail ............&quot;</span>
									+ bean.getBookNbrList().size());

<span class="nc" id="L278">							cell = new PdfPCell(getBlankCell(14));</span>
<span class="nc" id="L279">							cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L280">							cell.setColspan(2);</span>
<span class="nc" id="L281">							reportTable.addCell(cell);</span>
						}
<span class="nc" id="L283">					}</span>

<span class="nc" id="L285">				}</span>
<span class="nc" id="L286">			} else {</span>
<span class="nc" id="L287">				cell = new PdfPCell(getStaticHeaderOfReport(headerInfoMap));</span>
<span class="nc" id="L288">				cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L289">				cell.setColspan(2);</span>
<span class="nc" id="L290">				reportTable.addCell(cell);</span>
<span class="nc" id="L291">				System.out.println(&quot;static header in else........... &quot;);</span>

				// Iterable table header row
<span class="nc" id="L294">				System.out.println(&quot; bean of gmaes &quot; + reportBean);</span>
<span class="nc" id="L295">				Set&lt;String&gt; mapKey = reportBean.keySet();</span>

<span class="nc" id="L297">				totalBookQty = 0;</span>
<span class="nc" id="L298">				flag = true;</span>

<span class="nc bnc" id="L300" title="All 2 branches missed.">				for (String key : mapKey) {</span>
<span class="nc" id="L301">					System.out.println(&quot; gmae ===== &quot; + key);</span>
<span class="nc" id="L302">					InvoiceGameDetailBean bean = (InvoiceGameDetailBean) reportBean</span>
							.get(key);
<span class="nc" id="L304">					cell = new PdfPCell(</span>
							new Phrase(&quot;Game Name : &quot; + key, U_FONT));
<span class="nc" id="L306">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L307">					cell.setColspan(1);</span>
<span class="nc" id="L308">					reportTable.addCell(cell);</span>

<span class="nc bnc" id="L310" title="All 2 branches missed.">					if (flag) {</span>
<span class="nc" id="L311">						cell = new PdfPCell(new Phrase(&quot;QTY OF BOOKS&quot;, B_FONT));</span>
<span class="nc" id="L312">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L313">						cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L314">						reportTable.addCell(cell);</span>
<span class="nc" id="L315">						System.out.println(&quot; inside qty of books ............&quot;);</span>
<span class="nc" id="L316">						flag = false;</span>
					} else {
<span class="nc" id="L318">						cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L319">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L320">						cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L321">						System.out</span>
								.println(&quot; not inside qty of books ............&quot;);
<span class="nc" id="L323">						reportTable.addCell(cell);</span>
					}

<span class="nc" id="L326">					reportTable.addCell(getBlankCell(3));</span>

<span class="nc bnc" id="L328" title="All 2 branches missed.">					if (bean.getPackNbrList().size() &gt; 0) {</span>
						// pack details header columns
<span class="nc" id="L330">						cell = new PdfPCell(new Phrase(&quot;Pack No.&quot;, B_FONT));</span>
<span class="nc" id="L331">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L332">						cell.setColspan(2);</span>
<span class="nc" id="L333">						reportTable.addCell(cell);</span>

						// pack details columns
<span class="nc" id="L336">						cell = new PdfPCell(getPackDetails(bean</span>
								.getPackNbrList()));
<span class="nc" id="L338">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L339">						reportTable.addCell(cell);</span>
<span class="nc" id="L340">						cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L341">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L342">						reportTable.addCell(cell);</span>
<span class="nc" id="L343">						System.out.println(&quot; packs detail ............&quot;</span>
								+ bean.getPackNbrList());
<span class="nc" id="L345">						int totalBooksPack = bean.getPackNbrList().size()</span>
								* bean.getNbrBooks();
<span class="nc" id="L347">						totalBookQty = totalBookQty + totalBooksPack;</span>

<span class="nc" id="L349">						cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L350">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L351">						reportTable.addCell(cell);</span>
<span class="nc" id="L352">						cell = new PdfPCell(new Phrase(&quot; &quot; + totalBooksPack,</span>
								B_FONT));
<span class="nc" id="L354">						cell.setBorder(Rectangle.BOX);</span>
						/*
						 * GenerateDeliveryChallenByPDF event =new
						 * GenerateDeliveryChallenByPDF();
						 * cell.setCellEvent(event);
						 */
<span class="nc" id="L360">						cell.setVerticalAlignment(Element.ALIGN_BOTTOM);</span>
<span class="nc" id="L361">						cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L362">						reportTable.addCell(cell);</span>

						// blank column
<span class="nc" id="L365">						cell = new PdfPCell(getBlankCell(3));</span>
<span class="nc" id="L366">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L367">						cell.setColspan(2);</span>
<span class="nc" id="L368">						reportTable.addCell(cell);</span>
					}

<span class="nc bnc" id="L371" title="All 2 branches missed.">					if (bean.getBookNbrList().size() &gt; 0) {</span>
<span class="nc" id="L372">						cell = new PdfPCell(new Phrase(&quot;Book No.&quot;, B_FONT));</span>
<span class="nc" id="L373">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L374">						cell.setColspan(2);</span>
<span class="nc" id="L375">						reportTable.addCell(cell);</span>

<span class="nc" id="L377">						cell = new PdfPCell(getBookDetails(bean</span>
								.getBookNbrList()));
<span class="nc" id="L379">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L380">						reportTable.addCell(cell);</span>
<span class="nc" id="L381">						cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L382">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L383">						reportTable.addCell(cell);</span>

<span class="nc" id="L385">						totalBookQty = totalBookQty</span>
								+ bean.getBookNbrList().size();

<span class="nc" id="L388">						cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L389">						cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L390">						reportTable.addCell(cell);</span>
<span class="nc" id="L391">						cell = new PdfPCell(new Phrase(&quot; &quot;</span>
								+ bean.getBookNbrList().size(), B_FONT));
<span class="nc" id="L393">						cell.setBorder(Rectangle.BOX);</span>
						// cell.setCellEvent(event);
<span class="nc" id="L395">						cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L396">						cell.setVerticalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L397">						reportTable.addCell(cell);</span>
<span class="nc" id="L398">						System.out.println(&quot; books detail ............&quot;</span>
								+ bean.getBookNbrList().size());

<span class="nc" id="L401">						cell = new PdfPCell(getBlankCell(14));</span>
<span class="nc" id="L402">						cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L403">						cell.setColspan(2);</span>
<span class="nc" id="L404">						reportTable.addCell(cell);</span>
					}

<span class="nc" id="L407">				}</span>

			}
			// blank column
<span class="nc" id="L411">			cell = new PdfPCell(getBlankCell(3));</span>
<span class="nc" id="L412">			cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L413">			cell.setColspan(18);</span>
<span class="nc" id="L414">			reportTable.addCell(cell);</span>

<span class="nc" id="L416">			cell = new PdfPCell(new Phrase(&quot;Total QTY OF Delivered Books &quot;,</span>
					THN_FONT));
<span class="nc" id="L418">			cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L419">			cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L420">			reportTable.addCell(cell);</span>
<span class="nc" id="L421">			System.out.println(&quot;total quantity of delivered books&quot;);</span>

<span class="nc" id="L423">			cell = new PdfPCell(new Phrase(&quot; &quot; + totalBookQty + &quot; &quot;, THN_FONT));</span>
<span class="nc" id="L424">			cell.setBorder(Rectangle.BOX);</span>
			/*
			 * GenerateDeliveryChallenByPDF event =new
			 * GenerateDeliveryChallenByPDF(); cell.setCellEvent(event);
			 */
<span class="nc" id="L429">			cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L430">			cell.setVerticalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L431">			reportTable.addCell(cell);</span>
<span class="nc" id="L432">			System.out.println(&quot;total quantity of delivered books&quot;);</span>

			// blank column
<span class="nc" id="L435">			cell = new PdfPCell(getBlankCell(30));</span>
<span class="nc" id="L436">			cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L437">			cell.setColspan(2);</span>
<span class="nc" id="L438">			reportTable.addCell(cell);</span>

<span class="nc" id="L440">			cell = new PdfPCell(getLastPageFooter());</span>
<span class="nc" id="L441">			cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L442">			cell.setColspan(2);</span>
<span class="nc" id="L443">			reportTable.addCell(cell);</span>
<span class="nc" id="L444">			System.out.println(&quot;footer&quot;);</span>
<span class="nc" id="L445">			cell = new PdfPCell(getBlankCell(10));</span>
<span class="nc" id="L446">			cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L447">			cell.setColspan(2);</span>
<span class="nc" id="L448">			reportTable.addCell(cell);</span>

<span class="nc" id="L450">			cell = new PdfPCell(getLastPageFooterAcknowladge());</span>
<span class="nc" id="L451">			cell.setBorder(Rectangle.BOX);</span>
<span class="nc" id="L452">			cell.setColspan(2);</span>
<span class="nc" id="L453">			reportTable.addCell(cell);</span>
<span class="nc" id="L454">			System.out.println(&quot;acknowledge&quot;);</span>

<span class="nc" id="L456">			document.add(reportTable);</span>

<span class="nc" id="L458">			document.close();</span>
<span class="nc" id="L459">		} catch (DocumentException e) {</span>
<span class="nc" id="L460">			e.printStackTrace();</span>
<span class="nc" id="L461">		}</span>

<span class="nc" id="L463">		byte[] arrayOutPut = ((ByteArrayOutputStream) baos).toByteArray();</span>

<span class="nc" id="L465">		return arrayOutPut;</span>

	}

	private byte[] genratePDFTableWarehouse() {
<span class="nc" id="L470">		HttpSession session = request.getSession();</span>
<span class="nc" id="L471">		Map reportBean = (Map) session.getAttribute(&quot;detailsMap&quot;);</span>
<span class="nc" id="L472">		Map headerInfoMap = (Map) session.getAttribute(&quot;staticReportMap&quot;);</span>
<span class="nc" id="L473">		PdfWriter writer = null;</span>
<span class="nc" id="L474">		Document document = new Document(PageSize.A4, 22, 15, 30, 60);</span>
<span class="nc" id="L475">		ByteArrayOutputStream baos = new ByteArrayOutputStream();</span>
		try {
<span class="nc" id="L477">			writer = PdfWriter.getInstance(document, baos);</span>
<span class="nc" id="L478">			document.open();</span>
<span class="nc" id="L479">			PdfPTable reportTable = new PdfPTable(2);</span>
<span class="nc" id="L480">			int headerwidths[] = new int[] { 85, 15 };</span>
<span class="nc" id="L481">			reportTable.setWidths(headerwidths);</span>
<span class="nc" id="L482">			reportTable.setSplitLate(false);</span>
<span class="nc" id="L483">			reportTable.setWidthPercentage(100);</span>
<span class="nc" id="L484">			PdfPCell cell = null;</span>
<span class="nc" id="L485">			int totalBookQty = 0;</span>
<span class="nc" id="L486">			boolean flag = true;</span>
<span class="nc" id="L487">			String type = (String) session.getAttribute(&quot;deliveryChallanType&quot;);</span>
<span class="nc" id="L488">			cell = new PdfPCell(getStaticHeaderOfReportWarehouse(headerInfoMap));</span>
<span class="nc" id="L489">			cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L490">			cell.setColspan(2);</span>
<span class="nc" id="L491">			reportTable.addCell(cell);</span>

<span class="nc" id="L493">			Set&lt;String&gt; mapKey = reportBean.keySet();</span>
<span class="nc" id="L494">			totalBookQty = 0;</span>
<span class="nc" id="L495">			flag = true;</span>
<span class="nc bnc" id="L496" title="All 2 branches missed.">			for (String key : mapKey) {</span>
<span class="nc" id="L497">				InvoiceGameDetailBean bean = (InvoiceGameDetailBean) reportBean.get(key);</span>
<span class="nc" id="L498">				cell = new PdfPCell(new Phrase(&quot;Game Name : &quot; + key, U_FONT));</span>
<span class="nc" id="L499">				cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L500">				cell.setColspan(1);</span>
<span class="nc" id="L501">				reportTable.addCell(cell);</span>
<span class="nc bnc" id="L502" title="All 2 branches missed.">				if (flag) {</span>
<span class="nc" id="L503">					cell = new PdfPCell(new Phrase(&quot;QTY OF BOOKS&quot;, B_FONT));</span>
<span class="nc" id="L504">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L505">					cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L506">					reportTable.addCell(cell);</span>
<span class="nc" id="L507">					System.out.println(&quot; inside qty of books ............&quot;);</span>
<span class="nc" id="L508">					flag = false;</span>
				} else {
<span class="nc" id="L510">					cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L511">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L512">					cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L513">					System.out</span>
							.println(&quot; not inside qty of books ............&quot;);
<span class="nc" id="L515">					reportTable.addCell(cell);</span>
				}

<span class="nc" id="L518">				reportTable.addCell(getBlankCell(3));</span>

<span class="nc bnc" id="L520" title="All 2 branches missed.">				if (bean.getPackNbrList().size() &gt; 0) {</span>
					// pack details header columns
<span class="nc" id="L522">					cell = new PdfPCell(new Phrase(&quot;Pack No.&quot;, B_FONT));</span>
<span class="nc" id="L523">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L524">					cell.setColspan(2);</span>
<span class="nc" id="L525">					reportTable.addCell(cell);</span>

					// pack details columns
<span class="nc" id="L528">					cell = new PdfPCell(getPackDetails(bean</span>
							.getPackNbrList()));
<span class="nc" id="L530">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L531">					reportTable.addCell(cell);</span>
<span class="nc" id="L532">					cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L533">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L534">					reportTable.addCell(cell);</span>
<span class="nc" id="L535">					System.out.println(&quot; packs detail ............&quot;</span>
							+ bean.getPackNbrList());
<span class="nc" id="L537">					int totalBooksPack = bean.getPackNbrList().size()</span>
							* bean.getNbrBooks();
<span class="nc" id="L539">					totalBookQty = totalBookQty + totalBooksPack;</span>

<span class="nc" id="L541">					cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L542">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L543">					reportTable.addCell(cell);</span>
<span class="nc" id="L544">					cell = new PdfPCell(new Phrase(&quot; &quot; + totalBooksPack,</span>
							B_FONT));
<span class="nc" id="L546">					cell.setBorder(Rectangle.BOX);</span>
					/*
					 * GenerateDeliveryChallenByPDF event =new
					 * GenerateDeliveryChallenByPDF();
					 * cell.setCellEvent(event);
					 */
<span class="nc" id="L552">					cell.setVerticalAlignment(Element.ALIGN_BOTTOM);</span>
<span class="nc" id="L553">					cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L554">					reportTable.addCell(cell);</span>

					// blank column
<span class="nc" id="L557">					cell = new PdfPCell(getBlankCell(3));</span>
<span class="nc" id="L558">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L559">					cell.setColspan(2);</span>
<span class="nc" id="L560">					reportTable.addCell(cell);</span>
				}

<span class="nc bnc" id="L563" title="All 2 branches missed.">				if (bean.getBookNbrList().size() &gt; 0) {</span>
<span class="nc" id="L564">					cell = new PdfPCell(new Phrase(&quot;Book No.&quot;, B_FONT));</span>
<span class="nc" id="L565">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L566">					cell.setColspan(2);</span>
<span class="nc" id="L567">					reportTable.addCell(cell);</span>

<span class="nc" id="L569">					cell = new PdfPCell(getBookDetails(bean</span>
							.getBookNbrList()));
<span class="nc" id="L571">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L572">					reportTable.addCell(cell);</span>
<span class="nc" id="L573">					cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L574">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L575">					reportTable.addCell(cell);</span>

<span class="nc" id="L577">					totalBookQty = totalBookQty</span>
							+ bean.getBookNbrList().size();

<span class="nc" id="L580">					cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L581">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L582">					reportTable.addCell(cell);</span>
<span class="nc" id="L583">					cell = new PdfPCell(new Phrase(&quot; &quot;</span>
							+ bean.getBookNbrList().size(), B_FONT));
<span class="nc" id="L585">					cell.setBorder(Rectangle.BOX);</span>
					// cell.setCellEvent(event);
<span class="nc" id="L587">					cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L588">					cell.setVerticalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L589">					reportTable.addCell(cell);</span>
<span class="nc" id="L590">					System.out.println(&quot; books detail ............&quot;</span>
							+ bean.getBookNbrList().size());

<span class="nc" id="L593">					cell = new PdfPCell(getBlankCell(14));</span>
<span class="nc" id="L594">					cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L595">					cell.setColspan(2);</span>
<span class="nc" id="L596">					reportTable.addCell(cell);</span>
				}

<span class="nc" id="L599">			}</span>

<span class="nc" id="L601">			cell = new PdfPCell(getBlankCell(3));</span>
<span class="nc" id="L602">			cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L603">			cell.setColspan(18);</span>
<span class="nc" id="L604">			reportTable.addCell(cell);</span>

<span class="nc" id="L606">			cell = new PdfPCell(new Phrase(&quot;Total QTY OF Delivered Books &quot;,</span>
					THN_FONT));
<span class="nc" id="L608">			cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L609">			cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L610">			reportTable.addCell(cell);</span>
<span class="nc" id="L611">			System.out.println(&quot;total quantity of delivered books&quot;);</span>

<span class="nc" id="L613">			cell = new PdfPCell(new Phrase(&quot; &quot; + totalBookQty + &quot; &quot;, THN_FONT));</span>
<span class="nc" id="L614">			cell.setBorder(Rectangle.BOX);</span>
<span class="nc" id="L615">			cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L616">			cell.setVerticalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L617">			reportTable.addCell(cell);</span>
<span class="nc" id="L618">			System.out.println(&quot;total quantity of delivered books&quot;);</span>

<span class="nc" id="L620">			cell = new PdfPCell(getBlankCell(30));</span>
<span class="nc" id="L621">			cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L622">			cell.setColspan(2);</span>
<span class="nc" id="L623">			reportTable.addCell(cell);</span>

<span class="nc" id="L625">			cell = new PdfPCell(getLastPageFooter());</span>
<span class="nc" id="L626">			cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L627">			cell.setColspan(2);</span>
<span class="nc" id="L628">			reportTable.addCell(cell);</span>
<span class="nc" id="L629">			System.out.println(&quot;footer&quot;);</span>
<span class="nc" id="L630">			cell = new PdfPCell(getBlankCell(10));</span>
<span class="nc" id="L631">			cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L632">			cell.setColspan(2);</span>
<span class="nc" id="L633">			reportTable.addCell(cell);</span>

<span class="nc" id="L635">			cell = new PdfPCell(getLastPageFooterAcknowladge());</span>
<span class="nc" id="L636">			cell.setBorder(Rectangle.BOX);</span>
<span class="nc" id="L637">			cell.setColspan(2);</span>
<span class="nc" id="L638">			reportTable.addCell(cell);</span>

<span class="nc" id="L640">			document.add(reportTable);</span>
<span class="nc" id="L641">			document.close();</span>
<span class="nc" id="L642">		} catch (DocumentException e) {</span>
<span class="nc" id="L643">			e.printStackTrace();</span>
<span class="nc" id="L644">		}</span>

<span class="nc" id="L646">		byte[] arrayOutPut = ((ByteArrayOutputStream) baos).toByteArray();</span>

<span class="nc" id="L648">		return arrayOutPut;</span>

	}

	private PdfPCell getBlankCell(int height) {
<span class="nc" id="L653">		PdfPCell cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L654">		cell.setFixedHeight(height);</span>
<span class="nc" id="L655">		cell.setColspan(2);</span>
<span class="nc" id="L656">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setColspan(3);

<span class="nc" id="L659">		return cell;</span>
	}

	private PdfPTable getBookDetails(List book) throws DocumentException {

<span class="nc" id="L664">		PdfPTable headerTable = new PdfPTable(10);</span>
<span class="nc" id="L665">		headerTable.setWidthPercentage(100);</span>
<span class="nc" id="L666">		int headerwidths[] = new int[] { 3, 17, 3, 17, 3, 17, 3, 17, 3, 17 };</span>
<span class="nc" id="L667">		headerTable.setWidths(headerwidths);</span>

<span class="nc" id="L669">		headerTable.getDefaultCell().setPadding(3f);</span>

		PdfPCell cell;
<span class="nc" id="L672">		System.out.println(&quot;hello ............................ &quot;);</span>
		// first row of header
<span class="nc" id="L674">		boolean flag = true;</span>
<span class="nc" id="L675">		int length = book.size();</span>
<span class="nc bnc" id="L676" title="All 2 branches missed.">		for (int i = 0; i &lt; length;) {</span>
<span class="nc bnc" id="L677" title="All 2 branches missed.">			for (int j = 0; j &lt; 5; j++) {</span>
<span class="nc bnc" id="L678" title="All 2 branches missed.">				if (i &lt; length) {</span>

<span class="nc" id="L680">					GenerateDeliveryChallenByPDF event = new GenerateDeliveryChallenByPDF();</span>
<span class="nc" id="L681">					cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L682">					cell.setCellEvent(event);</span>
<span class="nc" id="L683">					cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L684">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L685">					headerTable.addCell(cell);</span>

<span class="nc" id="L687">					cell = new PdfPCell(</span>
							new Phrase((String) book.get(i), N_FONT));
<span class="nc" id="L689">					cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L690">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L691">					headerTable.addCell(cell);</span>
<span class="nc" id="L692">				} else {</span>

<span class="nc" id="L694">					cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L695">					cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L696">					cell.setBorder(Rectangle.NO_BORDER);</span>
					// cell.setPaddingBottom(2);
<span class="nc" id="L698">					headerTable.addCell(cell);</span>

<span class="nc" id="L700">					cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L701">					cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L702">					cell.setBorder(Rectangle.NO_BORDER);</span>
					// cell.setPaddingBottom(2);
<span class="nc" id="L704">					headerTable.addCell(cell);</span>

				}
<span class="nc" id="L707">				i++;</span>
			}
		}

<span class="nc" id="L711">		return headerTable;</span>
	}

	private PdfPTable getBox(int totalBooks) {
<span class="nc" id="L715">		PdfPTable headerTable = new PdfPTable(1);</span>
		// int length=(&quot;&quot;+totalBooks).length();
<span class="nc" id="L717">		headerTable.setWidthPercentage(60);</span>
<span class="nc" id="L718">		int headerwidths[] = new int[] { 100 };</span>
		try {
<span class="nc" id="L720">			headerTable.setWidths(headerwidths);</span>
<span class="nc" id="L721">		} catch (DocumentException e) {</span>
<span class="nc" id="L722">			e.printStackTrace();</span>
<span class="nc" id="L723">		}</span>

		PdfPCell cell;
<span class="nc" id="L726">		cell = new PdfPCell(new Phrase(&quot; &quot; + totalBooks + &quot; &quot;, THN_FONT));</span>
<span class="nc" id="L727">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L728">		GenerateDeliveryChallenByPDF event = new GenerateDeliveryChallenByPDF();</span>
<span class="nc" id="L729">		cell.setCellEvent(event);</span>
<span class="nc" id="L730">		cell.setFixedHeight(5);</span>
<span class="nc" id="L731">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L732">		headerTable.addCell(cell);</span>

<span class="nc" id="L734">		return headerTable;</span>
	}

	private PdfPTable getLastPageFooter() throws DocumentException {

<span class="nc" id="L739">		PdfPTable headerTable = new PdfPTable(7);</span>
<span class="nc" id="L740">		headerTable.setWidthPercentage(100);</span>
<span class="nc" id="L741">		int headerwidths[] = new int[] { 27, 3, 22, 3, 22, 3, 20 };</span>
<span class="nc" id="L742">		headerTable.setWidths(headerwidths);</span>

		PdfPCell cell;

<span class="nc" id="L746">		cell = new PdfPCell(new Phrase(&quot; Checked By &quot;, B_FONT));</span>
<span class="nc" id="L747">		cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L748">		cell.setBorder(Rectangle.TOP);</span>
<span class="nc" id="L749">		cell.setColspan(2);</span>
<span class="nc" id="L750">		headerTable.addCell(cell);</span>

<span class="nc" id="L752">		cell = new PdfPCell(new Phrase(&quot;  &quot;, B_FONT));</span>
<span class="nc" id="L753">		cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L754">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L755">		cell.setColspan(3);</span>
<span class="nc" id="L756">		headerTable.addCell(cell);</span>

<span class="nc" id="L758">		cell = new PdfPCell(new Phrase(&quot; Prepared By &quot;, B_FONT));</span>
<span class="nc" id="L759">		cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L760">		cell.setBorder(Rectangle.TOP);</span>
<span class="nc" id="L761">		cell.setColspan(2);</span>
<span class="nc" id="L762">		headerTable.addCell(cell);</span>

<span class="nc" id="L764">		cell = new PdfPCell(new Phrase(&quot; Delivery Mode : &quot;, B_FONT));</span>
<span class="nc" id="L765">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L766">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L767">		headerTable.addCell(cell);</span>

<span class="nc" id="L769">		GenerateDeliveryChallenByPDF event = new GenerateDeliveryChallenByPDF();</span>

<span class="nc" id="L771">		cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L772">		cell.setCellEvent(event);</span>
<span class="nc" id="L773">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L774">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L775">		headerTable.addCell(cell);</span>

<span class="nc" id="L777">		cell = new PdfPCell(new Phrase(&quot; By Courier &quot;, B_FONT));</span>
<span class="nc" id="L778">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L779">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L780">		headerTable.addCell(cell);</span>

<span class="nc" id="L782">		cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L783">		cell.setCellEvent(event);</span>
<span class="nc" id="L784">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L785">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L786">		headerTable.addCell(cell);</span>

<span class="nc" id="L788">		cell = new PdfPCell(new Phrase(&quot; By Person &quot;, B_FONT));</span>
<span class="nc" id="L789">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L790">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L791">		headerTable.addCell(cell);</span>

<span class="nc" id="L793">		cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L794">		cell.setCellEvent(event);</span>
<span class="nc" id="L795">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L796">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L797">		headerTable.addCell(cell);</span>

<span class="nc" id="L799">		cell = new PdfPCell(new Phrase(&quot; By Self &quot;, B_FONT));</span>
<span class="nc" id="L800">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L801">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L802">		headerTable.addCell(cell);</span>

<span class="nc" id="L804">		return headerTable;</span>
	}

	private PdfPTable getLastPageFooterAcknowladge() throws DocumentException {
<span class="nc" id="L808">		PdfPTable headerTable = new PdfPTable(3);</span>
<span class="nc" id="L809">		headerTable.setWidthPercentage(100);</span>
<span class="nc" id="L810">		int headerwidths[] = new int[] { 25, 30, 45 };</span>
<span class="nc" id="L811">		headerTable.setWidths(headerwidths);</span>

		PdfPCell cell;
<span class="nc" id="L814">		cell = new PdfPCell(new Phrase(&quot; Acknowledgement &quot;, B_FONT));</span>
<span class="nc" id="L815">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L816">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L817">		cell.setColspan(3);</span>
<span class="nc" id="L818">		headerTable.addCell(cell);</span>

<span class="nc" id="L820">		System.out.println(&quot;upadted ------------------------ &quot;);</span>

<span class="nc" id="L822">		cell = new PdfPCell(new Phrase(&quot; Received By :  &quot;, B_FONT));</span>
<span class="nc" id="L823">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
		// cell.setColspan(3);
<span class="nc" id="L825">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L826">		headerTable.addCell(cell);</span>

<span class="nc" id="L828">		cell = new PdfPCell(new Phrase(&quot;  &quot;, B_FONT));</span>
<span class="nc" id="L829">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L830">		cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L831">		headerTable.addCell(cell);</span>

<span class="nc" id="L833">		cell = new PdfPCell(new Phrase(&quot;  &quot;, B_FONT));</span>
<span class="nc" id="L834">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L835">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L836">		headerTable.addCell(cell);</span>

<span class="nc" id="L838">		cell = new PdfPCell(new Phrase(&quot; Received On :  &quot;, B_FONT));</span>
<span class="nc" id="L839">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L840">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setColspan(3);
<span class="nc" id="L842">		headerTable.addCell(cell);</span>

<span class="nc" id="L844">		cell = new PdfPCell(new Phrase(&quot;  &quot;, B_FONT));</span>
<span class="nc" id="L845">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L846">		cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L847">		headerTable.addCell(cell);</span>

<span class="nc" id="L849">		cell = new PdfPCell(new Phrase(&quot; Distributor's Stamp &quot;, B_FONT));</span>
<span class="nc" id="L850">		cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L851">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L852">		headerTable.addCell(cell);</span>

<span class="nc" id="L854">		return headerTable;</span>
	}

	private PdfPTable getPackDetails(List pack) throws DocumentException {

<span class="nc" id="L859">		PdfPTable headerTable = new PdfPTable(10);</span>
<span class="nc" id="L860">		headerTable.setWidthPercentage(100);</span>
<span class="nc" id="L861">		int headerwidths[] = new int[] { 3, 17, 3, 17, 3, 17, 3, 17, 3, 17 };</span>
<span class="nc" id="L862">		headerTable.setWidths(headerwidths);</span>
<span class="nc" id="L863">		headerTable.getDefaultCell().setPadding(3f);</span>

		PdfPCell cell;

		// first row of header
<span class="nc" id="L868">		boolean flag = true;</span>
<span class="nc" id="L869">		int length = pack.size();</span>

<span class="nc bnc" id="L871" title="All 2 branches missed.">		for (int i = 0; i &lt; length;) {</span>
<span class="nc bnc" id="L872" title="All 2 branches missed.">			for (int j = 0; j &lt; 5; j++) {</span>
<span class="nc bnc" id="L873" title="All 2 branches missed.">				if (i &lt; length) {</span>

<span class="nc" id="L875">					GenerateDeliveryChallenByPDF event = new GenerateDeliveryChallenByPDF();</span>
<span class="nc" id="L876">					cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L877">					cell.setCellEvent(event);</span>
<span class="nc" id="L878">					cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L879">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L880">					headerTable.addCell(cell);</span>

					// System.out.println(&quot; inside if .............&quot;);

<span class="nc" id="L884">					cell = new PdfPCell(</span>
							new Phrase((String) pack.get(i), N_FONT));
<span class="nc" id="L886">					cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L887">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L888">					headerTable.addCell(cell);</span>
<span class="nc" id="L889">				} else {</span>

<span class="nc" id="L891">					cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L892">					cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L893">					cell.setBorder(Rectangle.NO_BORDER);</span>
					// cell.setPaddingBottom(2);
<span class="nc" id="L895">					headerTable.addCell(cell);</span>

<span class="nc" id="L897">					cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L898">					cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L899">					cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L900">					headerTable.addCell(cell);</span>

				}
<span class="nc" id="L903">				i++;</span>
			}
		}

<span class="nc" id="L907">		return headerTable;</span>
	}

	private PdfPTable getStaticHeaderOfReport(Map staticMap)
			throws DocumentException {

<span class="nc" id="L913">		PdfPTable headerTable = new PdfPTable(4);</span>
<span class="nc" id="L914">		headerTable.setWidthPercentage(100);</span>
<span class="nc" id="L915">		int headerwidths[] = new int[] { 53, 12, 15, 20 };</span>
<span class="nc" id="L916">		headerTable.setWidths(headerwidths);</span>

<span class="nc" id="L918">		System.out.println(&quot;static header map : == &quot; + staticMap);</span>

		PdfPCell cell;

<span class="nc" id="L922">		cell = new PdfPCell(new Phrase(&quot;Delivery Challan&quot;, H_FONT));</span>
<span class="nc" id="L923">		cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L924">		cell.setVerticalAlignment(Element.ALIGN_MIDDLE);</span>
<span class="nc" id="L925">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L926">		cell.setColspan(4);</span>
<span class="nc" id="L927">		headerTable.addCell(cell);</span>
<span class="nc" id="L928">		System.out.println(&quot;1&quot;);</span>

		// first row of header
<span class="nc" id="L931">		cell = new PdfPCell(new Phrase(&quot;Generation Time : &quot;, HN_FONT));</span>
<span class="nc" id="L932">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L933">		cell.setVerticalAlignment(Element.ALIGN_MIDDLE);</span>
<span class="nc" id="L934">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L935">		cell.setColspan(3);</span>
<span class="nc" id="L936">		headerTable.addCell(cell);</span>

<span class="nc" id="L938">		String time = (String) staticMap.get(&quot;dcGenerationTime&quot;);</span>
<span class="nc bnc" id="L939" title="All 2 branches missed.">		time = time != null ? time : &quot; &quot;;</span>
<span class="nc" id="L940">		cell = new PdfPCell(new Phrase(time, N_FONT));</span>
<span class="nc" id="L941">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L942">		cell.setVerticalAlignment(Element.ALIGN_MIDDLE);</span>
<span class="nc" id="L943">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L944">		cell.setColspan(1);</span>
<span class="nc" id="L945">		headerTable.addCell(cell);</span>

<span class="nc" id="L947">		System.out.println(&quot;3&quot;);</span>

		/*
		 * //Second row of header cell=new PdfPCell(new Phrase(&quot; &quot;, N_FONT));
		 * cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
		 * cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
		 * cell.setBorder(Rectangle.NO_BORDER); cell.setColspan(3);
		 * headerTable.addCell(cell);
		 */
<span class="nc" id="L956">		System.out.println(&quot;4&quot;);</span>

		// Third row of Header
<span class="nc" id="L959">		String companyName = (String) staticMap.get(&quot;boOrgName&quot;);</span>
<span class="nc bnc" id="L960" title="All 2 branches missed.">		companyName = companyName != null ? companyName : &quot; &quot;;</span>
<span class="nc" id="L961">		cell = new PdfPCell(new Paragraph(companyName, new Font(Font.HELVETICA,</span>
				27, Font.BOLD)));
<span class="nc" id="L963">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L964">		cell.setVerticalAlignment(Element.ALIGN_BOTTOM);</span>
<span class="nc" id="L965">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBorderWidth(1);
<span class="nc" id="L967">		headerTable.addCell(cell);</span>

<span class="nc" id="L969">		cell = new PdfPCell(new Phrase(&quot;Address : &quot;, B_FONT));</span>
<span class="nc" id="L970">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L971">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBorderWidth(1);
<span class="nc" id="L973">		headerTable.addCell(cell);</span>
<span class="nc" id="L974">		System.out.println(&quot;6&quot;);</span>

<span class="nc" id="L976">		String address = (String) staticMap.get(&quot;boOrgAdd&quot;);</span>
<span class="nc bnc" id="L977" title="All 2 branches missed.">		address = address != null ? address : &quot; &quot;;</span>
<span class="nc" id="L978">		cell = new PdfPCell(new Phrase(address, N_FONT));</span>
<span class="nc" id="L979">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L980">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBorderWidth(2);
<span class="nc" id="L982">		cell.setColspan(2);</span>
<span class="nc" id="L983">		headerTable.addCell(cell);</span>
<span class="nc" id="L984">		System.out.println(&quot;7&quot;);</span>

<span class="nc" id="L986">		String vatRef = (String) staticMap.get(&quot;vatRef&quot;);</span>
<span class="nc bnc" id="L987" title="All 2 branches missed.">		address = vatRef != null ? vatRef : &quot; &quot;;</span>
<span class="nc bnc" id="L988" title="All 2 branches missed.">		if (!&quot;&quot;.equals(vatRef.trim())) {</span>
<span class="nc" id="L989">			cell = new PdfPCell(new Phrase(&quot;VAT Ref Number :  &quot; + vatRef,</span>
					HN_FONT));
<span class="nc" id="L991">			cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L992">			cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L993">			cell.setBorderWidth(1);</span>
<span class="nc" id="L994">			cell.setColspan(4);</span>
<span class="nc" id="L995">			headerTable.addCell(cell);</span>
<span class="nc" id="L996">			System.out.println(&quot;8&quot;);</span>
		}

		// forth blank row (used to insert a line) of header
<span class="nc" id="L1000">		cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L1001">		cell.setFixedHeight(4);</span>
<span class="nc" id="L1002">		cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L1003">		cell.setBorderWidth(1);</span>
<span class="nc" id="L1004">		cell.setColspan(4);</span>
<span class="nc" id="L1005">		headerTable.addCell(cell);</span>
<span class="nc" id="L1006">		System.out.println(&quot;9&quot;);</span>

		// fifth blank row (used to insert a gap) of header
<span class="nc" id="L1009">		cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L1010">		cell.setFixedHeight(4);</span>
<span class="nc" id="L1011">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1012">		cell.setColspan(4);</span>
<span class="nc" id="L1013">		headerTable.addCell(cell);</span>
<span class="nc" id="L1014">		System.out.println(&quot;10&quot;);</span>

		/*
		 * //fifth blank row (used to insert a gap) of header cell=new
		 * PdfPCell(new Phrase(&quot;To &quot;, N_FONT)); //cell.setFixedHeight(4);
		 * cell.setBackgroundColor(Color.LIGHT_GRAY);
		 * cell.setBorder(Rectangle.NO_BORDER); cell.setColspan(4);
		 * headerTable.addCell(cell);
		 */

		// sixth row of header
<span class="nc" id="L1025">		String customerName = (String) staticMap.get(&quot;customerName&quot;);</span>
<span class="nc bnc" id="L1026" title="All 2 branches missed.">		customerName = customerName != null ? customerName : &quot; &quot;;</span>
<span class="nc" id="L1027">		cell = new PdfPCell(new Phrase(customerName, N_FONT));</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1029">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1030">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1031">		cell.setColspan(2);</span>
<span class="nc" id="L1032">		headerTable.addCell(cell);</span>
<span class="nc" id="L1033">		System.out.println(&quot;11&quot;);</span>

<span class="nc" id="L1035">		cell = new PdfPCell(new Phrase(&quot;Voucher Id : &quot;, B_FONT));</span>
<span class="nc" id="L1036">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1038">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1039">		cell.setColspan(1);</span>
<span class="nc" id="L1040">		headerTable.addCell(cell);</span>

<span class="nc" id="L1042">		String dcNo = (String) staticMap.get(&quot;dcNo&quot;);</span>
<span class="nc bnc" id="L1043" title="All 2 branches missed.">		dcNo = dcNo != null ? dcNo : &quot; &quot;;</span>
<span class="nc" id="L1044">		cell = new PdfPCell(new Phrase(dcNo, N_FONT));</span>
<span class="nc" id="L1045">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1047">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1048">		cell.setColspan(1);</span>
<span class="nc" id="L1049">		headerTable.addCell(cell);</span>
<span class="nc" id="L1050">		System.out.println(&quot;12&quot;);</span>

		// seventh row of header
<span class="nc" id="L1053">		String customerAdd = (String) staticMap.get(&quot;customerAdd1&quot;) + &quot;, &quot;</span>
				+ (String) staticMap.get(&quot;customerAdd2&quot;);
<span class="nc bnc" id="L1055" title="All 2 branches missed.">		customerAdd = customerAdd != null ? customerAdd : &quot; &quot;;</span>
<span class="nc" id="L1056">		cell = new PdfPCell(new Phrase(customerAdd, N_FONT));</span>
<span class="nc" id="L1057">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1059">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1060">		cell.setColspan(2);</span>
<span class="nc" id="L1061">		headerTable.addCell(cell);</span>

<span class="nc" id="L1063">		cell = new PdfPCell(new Phrase(&quot;Voucher Date : &quot;, B_FONT));</span>
<span class="nc" id="L1064">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1066">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1067">		cell.setColspan(1);</span>
<span class="nc" id="L1068">		headerTable.addCell(cell);</span>

<span class="nc" id="L1070">		String dcDate = (String) staticMap.get(&quot;dcDate&quot;);</span>
<span class="nc bnc" id="L1071" title="All 2 branches missed.">		dcDate = dcDate != null ? dcDate : &quot; &quot;;</span>
<span class="nc" id="L1072">		cell = new PdfPCell(new Phrase(dcDate, N_FONT));</span>
<span class="nc" id="L1073">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1075">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1076">		cell.setColspan(1);</span>
<span class="nc" id="L1077">		headerTable.addCell(cell);</span>

		// Eight row of header
		/*
		 * cell=new PdfPCell(new Phrase(&quot; &quot;, B_FONT));
		 * cell.setBorder(Rectangle.NO_BORDER); cell.setFixedHeight(8);
		 * cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
		 * cell.setBackgroundColor(Color.LIGHT_GRAY); cell.setBorderWidth(1);
		 * cell.setColspan(3); headerTable.addCell(cell);
		 * System.out.println(&quot;13&quot;);
		 */

<span class="nc" id="L1089">		PdfPTable sheaderTable = new PdfPTable(5);</span>
<span class="nc" id="L1090">		sheaderTable.setWidthPercentage(100);</span>
<span class="nc" id="L1091">		int sheaderwidths[] = new int[] { 12, 41, 12, 15, 20 };</span>
<span class="nc" id="L1092">		sheaderTable.setWidths(sheaderwidths);</span>

		// seventh row of header
<span class="nc" id="L1095">		cell = new PdfPCell(new Phrase(&quot;Invoice Id : &quot;, B_FONT));</span>
<span class="nc" id="L1096">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1098">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1099">		sheaderTable.addCell(cell);</span>

<span class="nc" id="L1101">		String invoiceNo = (String) staticMap.get(&quot;invoiceId&quot;);</span>
<span class="nc bnc" id="L1102" title="All 2 branches missed.">		invoiceNo = invoiceNo != null ? invoiceNo : &quot; &quot;;</span>
<span class="nc" id="L1103">		cell = new PdfPCell(new Phrase(invoiceNo, N_FONT));</span>
<span class="nc" id="L1104">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1106">		cell.setColspan(2);</span>
<span class="nc" id="L1107">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1108">		sheaderTable.addCell(cell);</span>
<span class="nc" id="L1109">		System.out.println(&quot;14&quot;);</span>

<span class="nc" id="L1111">		cell = new PdfPCell(new Phrase(&quot;Invoice Date : &quot;, B_FONT));</span>
<span class="nc" id="L1112">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1114">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1115">		cell.setColspan(1);</span>
<span class="nc" id="L1116">		sheaderTable.addCell(cell);</span>

<span class="nc" id="L1118">		String invoiceDate = (String) staticMap.get(&quot;invoiceDate&quot;);</span>
<span class="nc bnc" id="L1119" title="All 2 branches missed.">		invoiceDate = invoiceDate != null ? invoiceDate : &quot; &quot;;</span>
<span class="nc" id="L1120">		cell = new PdfPCell(new Phrase(invoiceDate, N_FONT));</span>
<span class="nc" id="L1121">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1123">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1124">		cell.setColspan(1);</span>
<span class="nc" id="L1125">		sheaderTable.addCell(cell);</span>
<span class="nc" id="L1126">		System.out.println(&quot;15&quot;);</span>

		// 8 row of header

<span class="nc" id="L1130">		cell = new PdfPCell(new Phrase(&quot;Order Id : &quot;, B_FONT));</span>
<span class="nc" id="L1131">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1133">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1134">		sheaderTable.addCell(cell);</span>

<span class="nc" id="L1136">		String orderNo = (String) staticMap.get(&quot;orderNo&quot;);</span>
<span class="nc bnc" id="L1137" title="All 2 branches missed.">		orderNo = orderNo != null ? orderNo : &quot; &quot;;</span>
<span class="nc" id="L1138">		cell = new PdfPCell(new Phrase(orderNo, N_FONT));</span>
<span class="nc" id="L1139">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1141">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1142">		cell.setColspan(2);</span>
<span class="nc" id="L1143">		sheaderTable.addCell(cell);</span>
<span class="nc" id="L1144">		System.out.println(&quot;16&quot;);</span>

<span class="nc" id="L1146">		cell = new PdfPCell(new Phrase(&quot;Order Date : &quot;, B_FONT));</span>
<span class="nc" id="L1147">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1149">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1150">		cell.setColspan(1);</span>
<span class="nc" id="L1151">		sheaderTable.addCell(cell);</span>

<span class="nc" id="L1153">		String orderDate = (String) staticMap.get(&quot;orderDate&quot;);</span>
<span class="nc bnc" id="L1154" title="All 2 branches missed.">		orderDate = orderDate != null ? orderDate : &quot; &quot;;</span>
<span class="nc" id="L1155">		cell = new PdfPCell(new Phrase(orderDate, N_FONT));</span>
<span class="nc" id="L1156">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1158">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1159">		cell.setColspan(1);</span>
<span class="nc" id="L1160">		sheaderTable.addCell(cell);</span>
<span class="nc" id="L1161">		System.out.println(&quot;17&quot;);</span>

		// Eight row of header
<span class="nc" id="L1164">		cell = new PdfPCell(sheaderTable);</span>
<span class="nc" id="L1165">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setFixedHeight(3);
		// cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
<span class="nc" id="L1168">		cell.setBorderWidth(0);</span>
<span class="nc" id="L1169">		cell.setColspan(4);</span>
<span class="nc" id="L1170">		headerTable.addCell(cell);</span>

		// Eight row of header
<span class="nc" id="L1173">		cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L1174">		cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L1175">		cell.setFixedHeight(3);</span>
<span class="nc" id="L1176">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1177">		cell.setBorderWidth(1);</span>
<span class="nc" id="L1178">		cell.setColspan(4);</span>
<span class="nc" id="L1179">		headerTable.addCell(cell);</span>
<span class="nc" id="L1180">		System.out.println(&quot;18&quot;);</span>

<span class="nc" id="L1182">		return headerTable;</span>
	}

	private PdfPTable getStaticHeaderOfReportWarehouse(Map staticMap) throws DocumentException {
<span class="nc" id="L1186">		PdfPTable headerTable = new PdfPTable(4);</span>
<span class="nc" id="L1187">		headerTable.setWidthPercentage(100);</span>
<span class="nc" id="L1188">		int headerwidths[] = new int[] { 53, 12, 15, 20 };</span>
<span class="nc" id="L1189">		headerTable.setWidths(headerwidths);</span>

		PdfPCell cell;
<span class="nc" id="L1192">		cell = new PdfPCell(new Phrase(&quot;Delivery Challan&quot;, H_FONT));</span>
<span class="nc" id="L1193">		cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L1194">		cell.setVerticalAlignment(Element.ALIGN_MIDDLE);</span>
<span class="nc" id="L1195">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1196">		cell.setColspan(4);</span>
<span class="nc" id="L1197">		headerTable.addCell(cell);</span>
<span class="nc" id="L1198">		System.out.println(&quot;1&quot;);</span>
		
		// first row of header
<span class="nc" id="L1201">		cell = new PdfPCell(new Phrase(&quot;Generation Time : &quot;, HN_FONT));</span>
<span class="nc" id="L1202">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1203">		cell.setVerticalAlignment(Element.ALIGN_MIDDLE);</span>
<span class="nc" id="L1204">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1205">		cell.setColspan(3);</span>
<span class="nc" id="L1206">		headerTable.addCell(cell);</span>

<span class="nc" id="L1208">		String time = (String) staticMap.get(&quot;dcGenerationTime&quot;);</span>
<span class="nc bnc" id="L1209" title="All 2 branches missed.">		time = time != null ? time : &quot; &quot;;</span>
<span class="nc" id="L1210">		cell = new PdfPCell(new Phrase(time, N_FONT));</span>
<span class="nc" id="L1211">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1212">		cell.setVerticalAlignment(Element.ALIGN_MIDDLE);</span>
<span class="nc" id="L1213">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1214">		cell.setColspan(1);</span>
<span class="nc" id="L1215">		headerTable.addCell(cell);</span>

<span class="nc" id="L1217">		String companyName = (String) staticMap.get(&quot;boOrgName&quot;);</span>
<span class="nc bnc" id="L1218" title="All 2 branches missed.">		companyName = companyName != null ? companyName : &quot; &quot;;</span>
<span class="nc" id="L1219">		cell = new PdfPCell(new Paragraph(companyName, new Font(Font.HELVETICA,</span>
				27, Font.BOLD)));
<span class="nc" id="L1221">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1222">		cell.setVerticalAlignment(Element.ALIGN_BOTTOM);</span>
<span class="nc" id="L1223">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBorderWidth(1);
<span class="nc" id="L1225">		headerTable.addCell(cell);</span>
		
<span class="nc" id="L1227">		cell = new PdfPCell(new Phrase(&quot;Address : &quot;, B_FONT));</span>
<span class="nc" id="L1228">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1229">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBorderWidth(1);
<span class="nc" id="L1231">		headerTable.addCell(cell);</span>
<span class="nc" id="L1232">		System.out.println(&quot;6&quot;);</span>
		
<span class="nc" id="L1234">		String address = (String) staticMap.get(&quot;boOrgAdd&quot;);</span>
<span class="nc bnc" id="L1235" title="All 2 branches missed.">		address = address != null ? address : &quot; &quot;;</span>
<span class="nc" id="L1236">		cell = new PdfPCell(new Phrase(address, N_FONT));</span>
<span class="nc" id="L1237">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1238">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBorderWidth(2);
<span class="nc" id="L1240">		cell.setColspan(2);</span>
<span class="nc" id="L1241">		headerTable.addCell(cell);</span>
<span class="nc" id="L1242">		System.out.println(&quot;7&quot;);</span>
		
<span class="nc" id="L1244">		String vatRef = (String) staticMap.get(&quot;vatRef&quot;);</span>
<span class="nc bnc" id="L1245" title="All 2 branches missed.">		address = vatRef != null ? vatRef : &quot; &quot;;</span>
<span class="nc bnc" id="L1246" title="All 2 branches missed.">		if (!&quot;&quot;.equals(vatRef.trim())) {</span>
			/*cell = new PdfPCell(new Phrase(&quot;VAT Ref Number :  &quot; + vatRef,
					HN_FONT));
			cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			cell.setBorder(Rectangle.NO_BORDER);
			cell.setBorderWidth(1);
			cell.setColspan(4);
			headerTable.addCell(cell);
			System.out.println(&quot;8&quot;);*/
		}

<span class="nc" id="L1257">		cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L1258">		cell.setFixedHeight(4);</span>
<span class="nc" id="L1259">		cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L1260">		cell.setBorderWidth(1);</span>
<span class="nc" id="L1261">		cell.setColspan(4);</span>
<span class="nc" id="L1262">		headerTable.addCell(cell);</span>

<span class="nc" id="L1264">		cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L1265">		cell.setFixedHeight(4);</span>
<span class="nc" id="L1266">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1267">		cell.setColspan(4);</span>
<span class="nc" id="L1268">		headerTable.addCell(cell);</span>
<span class="nc" id="L1269">		System.out.println(&quot;10&quot;);</span>

<span class="nc" id="L1271">		String fromWareHouse = (String) staticMap.get(&quot;fromWareHouseName&quot;);</span>
<span class="nc bnc" id="L1272" title="All 2 branches missed.">		fromWareHouse = fromWareHouse != null ? &quot;From - &quot;+fromWareHouse : &quot; &quot;;</span>
<span class="nc" id="L1273">		cell = new PdfPCell(new Phrase(fromWareHouse, B_FONT));</span>
<span class="nc" id="L1274">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1275">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1276">		cell.setColspan(2);</span>
<span class="nc" id="L1277">		headerTable.addCell(cell);</span>

<span class="nc" id="L1279">		cell = new PdfPCell(new Phrase(&quot;Voucher Id : &quot;, B_FONT));</span>
<span class="nc" id="L1280">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1281">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1282">		cell.setColspan(1);</span>
<span class="nc" id="L1283">		headerTable.addCell(cell);</span>
		
<span class="nc" id="L1285">		String dcNo = (String) staticMap.get(&quot;dcNo&quot;);</span>
<span class="nc bnc" id="L1286" title="All 2 branches missed.">		dcNo = dcNo != null ? dcNo : &quot; &quot;;</span>
<span class="nc" id="L1287">		cell = new PdfPCell(new Phrase(dcNo, N_FONT));</span>
<span class="nc" id="L1288">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1289">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1290">		cell.setColspan(1);</span>
<span class="nc" id="L1291">		headerTable.addCell(cell);</span>

<span class="nc" id="L1293">		String fromAddress = (String) staticMap.get(&quot;fromWareHouseAddress1&quot;) + &quot;, &quot; + (String) staticMap.get(&quot;fromWareHouseAddress2&quot;) + &quot;, &quot; + (String) staticMap.get(&quot;fromWareHouseCityStateCountry&quot;);</span>
<span class="nc bnc" id="L1294" title="All 2 branches missed.">		fromAddress = fromAddress != null ? fromAddress : &quot; &quot;;</span>
<span class="nc" id="L1295">		cell = new PdfPCell(new Phrase(fromAddress, N_FONT));</span>
<span class="nc" id="L1296">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1297">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1298">		cell.setColspan(2);</span>
<span class="nc" id="L1299">		headerTable.addCell(cell);</span>
		
<span class="nc" id="L1301">		cell = new PdfPCell(new Phrase(&quot;Voucher Date : &quot;, B_FONT));</span>
<span class="nc" id="L1302">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1303">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1304">		cell.setColspan(1);</span>
<span class="nc" id="L1305">		headerTable.addCell(cell);</span>
		
<span class="nc" id="L1307">		String dcDate = (String) staticMap.get(&quot;dcDate&quot;);</span>
<span class="nc bnc" id="L1308" title="All 2 branches missed.">		dcDate = dcDate != null ? dcDate : &quot; &quot;;</span>
<span class="nc" id="L1309">		cell = new PdfPCell(new Phrase(dcDate, N_FONT));</span>
<span class="nc" id="L1310">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1311">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1312">		cell.setColspan(1);</span>
<span class="nc" id="L1313">		headerTable.addCell(cell);</span>

<span class="nc" id="L1315">		PdfPTable sheaderTable = new PdfPTable(5);</span>
<span class="nc" id="L1316">		sheaderTable.setWidthPercentage(100);</span>
<span class="nc" id="L1317">		int sheaderwidths[] = new int[] { 12, 41, 12, 15, 20 };</span>
<span class="nc" id="L1318">		sheaderTable.setWidths(sheaderwidths);</span>

<span class="nc" id="L1320">		String toWareHouse = (String) staticMap.get(&quot;toWareHouseName&quot;);</span>
<span class="nc bnc" id="L1321" title="All 2 branches missed.">		toWareHouse = toWareHouse != null ? &quot;To - &quot;+toWareHouse : &quot; &quot;;</span>
<span class="nc" id="L1322">		cell = new PdfPCell(new Phrase(toWareHouse, B_FONT));</span>
<span class="nc" id="L1323">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1324">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1325">		cell.setColspan(2);</span>
<span class="nc" id="L1326">		headerTable.addCell(cell);</span>

<span class="nc" id="L1328">		cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L1329">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1330">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1331">		cell.setColspan(2);</span>
<span class="nc" id="L1332">		headerTable.addCell(cell);</span>

<span class="nc" id="L1334">		String toAddress = (String) staticMap.get(&quot;toWareHouseAddress1&quot;) + &quot;, &quot; + (String) staticMap.get(&quot;toWareHouseAddress2&quot;) + &quot;, &quot; + (String) staticMap.get(&quot;toWareHouseCityStateCountry&quot;);</span>
<span class="nc bnc" id="L1335" title="All 2 branches missed.">		toAddress = toAddress != null ? toAddress : &quot; &quot;;</span>
<span class="nc" id="L1336">		cell = new PdfPCell(new Phrase(toAddress, N_FONT));</span>
<span class="nc" id="L1337">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1338">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1339">		cell.setColspan(2);</span>
<span class="nc" id="L1340">		headerTable.addCell(cell);</span>

		/*cell = new PdfPCell(new Phrase(&quot;Invoice Id : &quot;, B_FONT));
		cell.setBorder(Rectangle.NO_BORDER);
		cell.setHorizontalAlignment(Element.ALIGN_LEFT);
		sheaderTable.addCell(cell);
		
		String invoiceNo = (String) staticMap.get(&quot;invoiceId&quot;);
		invoiceNo = invoiceNo != null ? invoiceNo : &quot; &quot;;
		cell = new PdfPCell(new Phrase(invoiceNo, N_FONT));
		cell.setBorder(Rectangle.NO_BORDER);
		cell.setColspan(2);
		cell.setHorizontalAlignment(Element.ALIGN_LEFT);
		sheaderTable.addCell(cell);

		cell = new PdfPCell(new Phrase(&quot;Invoice Date : &quot;, B_FONT));
		cell.setBorder(Rectangle.NO_BORDER);
		cell.setHorizontalAlignment(Element.ALIGN_LEFT);
		cell.setColspan(1);
		sheaderTable.addCell(cell);

		String invoiceDate = (String) staticMap.get(&quot;invoiceDate&quot;);
		invoiceDate = invoiceDate != null ? invoiceDate : &quot; &quot;;
		cell = new PdfPCell(new Phrase(invoiceDate, N_FONT));
		cell.setBorder(Rectangle.NO_BORDER);
		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
		cell.setColspan(1);
		sheaderTable.addCell(cell);

		cell = new PdfPCell(new Phrase(&quot;Order Id : &quot;, B_FONT));
		cell.setBorder(Rectangle.NO_BORDER);
		cell.setHorizontalAlignment(Element.ALIGN_LEFT);
		sheaderTable.addCell(cell);

		String orderNo = (String) staticMap.get(&quot;orderNo&quot;);
		orderNo = orderNo != null ? orderNo : &quot; &quot;;
		cell = new PdfPCell(new Phrase(orderNo, N_FONT));
		cell.setBorder(Rectangle.NO_BORDER);
		cell.setHorizontalAlignment(Element.ALIGN_LEFT);
		cell.setColspan(2);
		sheaderTable.addCell(cell);

		cell = new PdfPCell(new Phrase(&quot;Order Date : &quot;, B_FONT));
		cell.setBorder(Rectangle.NO_BORDER);
		cell.setHorizontalAlignment(Element.ALIGN_LEFT);
		cell.setColspan(1);
		sheaderTable.addCell(cell);

		String orderDate = (String) staticMap.get(&quot;orderDate&quot;);
		orderDate = orderDate != null ? orderDate : &quot; &quot;;
		cell = new PdfPCell(new Phrase(orderDate, N_FONT));
		cell.setBorder(Rectangle.NO_BORDER);
		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
		cell.setColspan(1);
		sheaderTable.addCell(cell);*/

<span class="nc" id="L1396">		cell = new PdfPCell(sheaderTable);</span>
<span class="nc" id="L1397">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1398">		cell.setBorderWidth(0);</span>
<span class="nc" id="L1399">		cell.setColspan(4);</span>
<span class="nc" id="L1400">		headerTable.addCell(cell);</span>

<span class="nc" id="L1402">		cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L1403">		cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L1404">		cell.setFixedHeight(3);</span>
<span class="nc" id="L1405">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1406">		cell.setBorderWidth(1);</span>
<span class="nc" id="L1407">		cell.setColspan(4);</span>
<span class="nc" id="L1408">		headerTable.addCell(cell);</span>

<span class="nc" id="L1410">		return headerTable;</span>
	}

	private PdfPTable getStaticHeaderOfSaleRetReport(Map staticMap)
			throws DocumentException {

<span class="nc" id="L1416">		PdfPTable headerTable = new PdfPTable(4);</span>
<span class="nc" id="L1417">		headerTable.setWidthPercentage(100);</span>
<span class="nc" id="L1418">		int headerwidths[] = new int[] { 53, 12, 15, 20 };</span>
<span class="nc" id="L1419">		headerTable.setWidths(headerwidths);</span>

<span class="nc" id="L1421">		System.out.println(&quot;static header map : == &quot; + staticMap);</span>

		PdfPCell cell;

<span class="nc" id="L1425">		cell = new PdfPCell(new Phrase(&quot;Sales Return Note&quot;, H_FONT));</span>
<span class="nc" id="L1426">		cell.setHorizontalAlignment(Element.ALIGN_CENTER);</span>
<span class="nc" id="L1427">		cell.setVerticalAlignment(Element.ALIGN_MIDDLE);</span>
<span class="nc" id="L1428">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1429">		cell.setColspan(4);</span>
<span class="nc" id="L1430">		headerTable.addCell(cell);</span>

<span class="nc" id="L1432">		System.out.println(&quot;1&quot;);</span>

		/*
		 * cell=new PdfPCell(new Phrase(&quot; &quot;, N_FONT)); cell.setFixedHeight(4);
		 * cell.setBorder(Rectangle.NO_BORDER); cell.setColspan(6);
		 * headerTable.addCell(cell); System.out.println(&quot;2&quot;);
		 */

		// first row of header
<span class="nc" id="L1441">		cell = new PdfPCell(new Phrase(&quot;Generation Time : &quot;, HN_FONT));</span>
<span class="nc" id="L1442">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1443">		cell.setVerticalAlignment(Element.ALIGN_MIDDLE);</span>
<span class="nc" id="L1444">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1445">		cell.setColspan(3);</span>
<span class="nc" id="L1446">		headerTable.addCell(cell);</span>

<span class="nc" id="L1448">		String time = (String) staticMap.get(&quot;dcGenerationTime&quot;);</span>
<span class="nc bnc" id="L1449" title="All 2 branches missed.">		time = time != null ? time : &quot; &quot;;</span>
<span class="nc" id="L1450">		cell = new PdfPCell(new Phrase(time, N_FONT));</span>
<span class="nc" id="L1451">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1452">		cell.setVerticalAlignment(Element.ALIGN_MIDDLE);</span>
<span class="nc" id="L1453">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1454">		cell.setColspan(1);</span>
<span class="nc" id="L1455">		headerTable.addCell(cell);</span>

<span class="nc" id="L1457">		System.out.println(&quot;3&quot;);</span>

		/*
		 * //Second row of header cell=new PdfPCell(new Phrase(&quot; &quot;, N_FONT));
		 * cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
		 * cell.setVerticalAlignment(Element.ALIGN_MIDDLE);
		 * cell.setBorder(Rectangle.NO_BORDER); cell.setColspan(3);
		 * headerTable.addCell(cell);
		 */
<span class="nc" id="L1466">		System.out.println(&quot;4&quot;);</span>

		// Third row of Header
<span class="nc" id="L1469">		String companyName = (String) staticMap.get(&quot;boOrgName&quot;);</span>
<span class="nc bnc" id="L1470" title="All 2 branches missed.">		companyName = companyName != null ? companyName : &quot; &quot;;</span>
<span class="nc" id="L1471">		cell = new PdfPCell(new Paragraph(companyName, new Font(Font.HELVETICA,</span>
				27, Font.BOLD)));
<span class="nc" id="L1473">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1474">		cell.setVerticalAlignment(Element.ALIGN_BOTTOM);</span>
<span class="nc" id="L1475">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBorderWidth(1);
<span class="nc" id="L1477">		headerTable.addCell(cell);</span>

<span class="nc" id="L1479">		cell = new PdfPCell(new Phrase(&quot;Address : &quot;, B_FONT));</span>
<span class="nc" id="L1480">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1481">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBorderWidth(1);
<span class="nc" id="L1483">		headerTable.addCell(cell);</span>
<span class="nc" id="L1484">		System.out.println(&quot;6&quot;);</span>

<span class="nc" id="L1486">		String address = (String) staticMap.get(&quot;boOrgAdd&quot;);</span>
<span class="nc bnc" id="L1487" title="All 2 branches missed.">		address = address != null ? address : &quot; &quot;;</span>
<span class="nc" id="L1488">		cell = new PdfPCell(new Phrase(address, N_FONT));</span>
<span class="nc" id="L1489">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1490">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBorderWidth(2);
<span class="nc" id="L1492">		cell.setColspan(2);</span>
<span class="nc" id="L1493">		headerTable.addCell(cell);</span>
<span class="nc" id="L1494">		System.out.println(&quot;7&quot;);</span>

<span class="nc" id="L1496">		String vatRef = (String) staticMap.get(&quot;vatRef&quot;);</span>
<span class="nc bnc" id="L1497" title="All 2 branches missed.">		address = vatRef != null ? vatRef : &quot; &quot;;</span>
<span class="nc bnc" id="L1498" title="All 2 branches missed.">		if (!&quot;&quot;.equals(vatRef.trim())) {</span>
<span class="nc" id="L1499">			cell = new PdfPCell(new Phrase(&quot;VAT Ref Number :  &quot; + vatRef,</span>
					HN_FONT));
<span class="nc" id="L1501">			cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1502">			cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1503">			cell.setBorderWidth(1);</span>
<span class="nc" id="L1504">			cell.setColspan(4);</span>
<span class="nc" id="L1505">			headerTable.addCell(cell);</span>
		}
<span class="nc" id="L1507">		System.out.println(&quot;8&quot;);</span>

		// forth blank row (used to insert a line) of header
<span class="nc" id="L1510">		cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L1511">		cell.setFixedHeight(4);</span>
<span class="nc" id="L1512">		cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L1513">		cell.setBorderWidth(1);</span>
<span class="nc" id="L1514">		cell.setColspan(4);</span>
<span class="nc" id="L1515">		headerTable.addCell(cell);</span>
<span class="nc" id="L1516">		System.out.println(&quot;9&quot;);</span>

		// fifth blank row (used to insert a gap) of header
<span class="nc" id="L1519">		cell = new PdfPCell(new Phrase(&quot; &quot;, N_FONT));</span>
<span class="nc" id="L1520">		cell.setFixedHeight(4);</span>
<span class="nc" id="L1521">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1522">		cell.setColspan(4);</span>
<span class="nc" id="L1523">		headerTable.addCell(cell);</span>
<span class="nc" id="L1524">		System.out.println(&quot;10&quot;);</span>

		/*
		 * //fifth blank row (used to insert a gap) of header cell=new
		 * PdfPCell(new Phrase(&quot;To &quot;, N_FONT)); //cell.setFixedHeight(4);
		 * cell.setBackgroundColor(Color.LIGHT_GRAY);
		 * cell.setBorder(Rectangle.NO_BORDER); cell.setColspan(4);
		 * headerTable.addCell(cell);
		 */

		// sixth row of header
		// sixth row of header
<span class="nc" id="L1536">		String customerName = (String) staticMap.get(&quot;customerName&quot;);</span>
<span class="nc bnc" id="L1537" title="All 2 branches missed.">		customerName = customerName != null ? customerName : &quot; &quot;;</span>
<span class="nc" id="L1538">		cell = new PdfPCell(new Phrase(customerName, N_FONT));</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1540">		cell.setBorder(Rectangle.NO_BORDER);</span>
<span class="nc" id="L1541">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1542">		cell.setColspan(2);</span>
<span class="nc" id="L1543">		headerTable.addCell(cell);</span>
<span class="nc" id="L1544">		System.out.println(&quot;11&quot;);</span>

<span class="nc" id="L1546">		cell = new PdfPCell(new Phrase(&quot;Voucher Id : &quot;, B_FONT));</span>
<span class="nc" id="L1547">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1549">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1550">		cell.setColspan(1);</span>
<span class="nc" id="L1551">		headerTable.addCell(cell);</span>

<span class="nc" id="L1553">		String srnNo = (String) staticMap.get(&quot;crNote&quot;);</span>
<span class="nc bnc" id="L1554" title="All 2 branches missed.">		srnNo = srnNo != null ? srnNo : &quot; &quot;;</span>
<span class="nc" id="L1555">		cell = new PdfPCell(new Phrase(srnNo, N_FONT));</span>
<span class="nc" id="L1556">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1558">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1559">		cell.setColspan(1);</span>
<span class="nc" id="L1560">		headerTable.addCell(cell);</span>
<span class="nc" id="L1561">		System.out.println(&quot;12&quot;);</span>

		// seventh row of header
<span class="nc" id="L1564">		String customerAdd = (String) staticMap.get(&quot;customerAdd1&quot;) + &quot;, &quot;</span>
				+ (String) staticMap.get(&quot;customerAdd2&quot;);
<span class="nc bnc" id="L1566" title="All 2 branches missed.">		customerAdd = customerAdd != null ? customerAdd : &quot; &quot;;</span>
<span class="nc" id="L1567">		cell = new PdfPCell(new Phrase(customerAdd, N_FONT));</span>
<span class="nc" id="L1568">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1570">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1571">		cell.setColspan(2);</span>
<span class="nc" id="L1572">		headerTable.addCell(cell);</span>

<span class="nc" id="L1574">		cell = new PdfPCell(new Phrase(&quot;Voucher Date : &quot;, B_FONT));</span>
<span class="nc" id="L1575">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1577">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1578">		cell.setColspan(1);</span>
<span class="nc" id="L1579">		headerTable.addCell(cell);</span>

<span class="nc" id="L1581">		String srnDate = (String) staticMap.get(&quot;srnDate&quot;);</span>
<span class="nc bnc" id="L1582" title="All 2 branches missed.">		srnDate = srnDate != null ? srnDate : &quot; &quot;;</span>
<span class="nc" id="L1583">		cell = new PdfPCell(new Phrase(srnDate, N_FONT));</span>
<span class="nc" id="L1584">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1586">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1587">		cell.setColspan(1);</span>
<span class="nc" id="L1588">		headerTable.addCell(cell);</span>

		/*
		 * //Eight row of header cell=new PdfPCell(new Phrase(&quot; &quot;, B_FONT));
		 * cell.setBorder(Rectangle.NO_BORDER); cell.setFixedHeight(8);
		 * cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
		 * cell.setBackgroundColor(Color.LIGHT_GRAY); cell.setBorderWidth(1);
		 * cell.setColspan(4); headerTable.addCell(cell);
		 * System.out.println(&quot;13&quot;);
		 */

		// seventh row of header
<span class="nc" id="L1600">		PdfPTable sheaderTable = new PdfPTable(5);</span>
<span class="nc" id="L1601">		sheaderTable.setWidthPercentage(100);</span>
<span class="nc" id="L1602">		int sheaderwidths[] = new int[] { 18, 35, 12, 17, 18 };</span>
<span class="nc" id="L1603">		sheaderTable.setWidths(sheaderwidths);</span>

		// seventh row of header
<span class="nc" id="L1606">		cell = new PdfPCell(new Phrase(&quot;Credit Note Id :&quot;, B_FONT));</span>
<span class="nc" id="L1607">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1609">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1610">		sheaderTable.addCell(cell);</span>

<span class="nc" id="L1612">		String crNote = (String) staticMap.get(&quot;srnNo&quot;);</span>
<span class="nc bnc" id="L1613" title="All 2 branches missed.">		crNote = crNote != null ? crNote : &quot; &quot;;</span>
<span class="nc" id="L1614">		cell = new PdfPCell(new Phrase(&quot; : &quot; + crNote, N_FONT));</span>
<span class="nc" id="L1615">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1617">		cell.setColspan(2);</span>
<span class="nc" id="L1618">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1619">		sheaderTable.addCell(cell);</span>
<span class="nc" id="L1620">		System.out.println(&quot;14&quot;);</span>

<span class="nc" id="L1622">		cell = new PdfPCell(new Phrase(&quot;Credit Note Date : &quot;, B_FONT));</span>
<span class="nc" id="L1623">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1625">		cell.setHorizontalAlignment(Element.ALIGN_LEFT);</span>
<span class="nc" id="L1626">		cell.setColspan(1);</span>
<span class="nc" id="L1627">		sheaderTable.addCell(cell);</span>

<span class="nc" id="L1629">		String crDate = (String) staticMap.get(&quot;crDate&quot;);</span>
<span class="nc bnc" id="L1630" title="All 2 branches missed.">		crDate = crDate != null ? crDate : &quot; &quot;;</span>
<span class="nc" id="L1631">		cell = new PdfPCell(new Phrase(crDate, N_FONT));</span>
<span class="nc" id="L1632">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setBackgroundColor(Color.LIGHT_GRAY);
<span class="nc" id="L1634">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1635">		cell.setColspan(1);</span>
<span class="nc" id="L1636">		sheaderTable.addCell(cell);</span>
<span class="nc" id="L1637">		System.out.println(&quot;17&quot;);</span>

		// Eight row of header
<span class="nc" id="L1640">		cell = new PdfPCell(sheaderTable);</span>
<span class="nc" id="L1641">		cell.setBorder(Rectangle.NO_BORDER);</span>
		// cell.setFixedHeight(3);
		// cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
<span class="nc" id="L1644">		cell.setBorderWidth(0);</span>
<span class="nc" id="L1645">		cell.setColspan(4);</span>
<span class="nc" id="L1646">		headerTable.addCell(cell);</span>

<span class="nc" id="L1648">		cell = new PdfPCell(new Phrase(&quot; &quot;, B_FONT));</span>
<span class="nc" id="L1649">		cell.setBorder(Rectangle.BOTTOM);</span>
<span class="nc" id="L1650">		cell.setFixedHeight(3);</span>
<span class="nc" id="L1651">		cell.setHorizontalAlignment(Element.ALIGN_RIGHT);</span>
<span class="nc" id="L1652">		cell.setBorderWidth(1);</span>
<span class="nc" id="L1653">		cell.setColspan(4);</span>
<span class="nc" id="L1654">		headerTable.addCell(cell);</span>
<span class="nc" id="L1655">		System.out.println(&quot;18&quot;);</span>

<span class="nc" id="L1657">		return headerTable;</span>
	}

	public void setServletRequest(HttpServletRequest request) {
<span class="nc" id="L1661">		this.request = request;</span>
<span class="nc" id="L1662">	}</span>

	public void setServletResponse(HttpServletResponse response) {
<span class="nc" id="L1665">		this.response = response;</span>

<span class="nc" id="L1667">	}</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>