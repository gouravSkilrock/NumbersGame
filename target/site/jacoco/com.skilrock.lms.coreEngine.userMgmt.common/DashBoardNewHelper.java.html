<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DashBoardNewHelper.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">lms</a> &gt; <a href="index.source.html" class="el_package">com.skilrock.lms.coreEngine.userMgmt.common</a> &gt; <span class="el_source">DashBoardNewHelper.java</span></div><h1>DashBoardNewHelper.java</h1><pre class="source lang-java linenums">package com.skilrock.lms.coreEngine.userMgmt.common;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Locale;
import java.util.Map;
import java.util.Map.Entry;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

import com.opensymphony.xwork2.util.LocalizedTextUtil;
import com.skilrock.lms.beans.DashBoardBean;
import com.skilrock.lms.beans.LimitDistributionBean;
import com.skilrock.lms.beans.OrganizationBean;
import com.skilrock.lms.beans.UserInfoBean;
import com.skilrock.lms.common.db.DBConnect;
import com.skilrock.lms.common.db.QueryManager;
import com.skilrock.lms.common.db.TableConstants;
import com.skilrock.lms.common.exception.LMSException;
import com.skilrock.lms.common.filter.LMSFilterDispatcher;
import com.skilrock.lms.web.drawGames.common.Util;

public class DashBoardNewHelper extends LocalizedTextUtil {

<span class="nc" id="L32">	static Log logger = LogFactory.getLog(DashBoardNewHelper.class);</span>
	
	private Locale locale;

<span class="nc" id="L36">	public DashBoardNewHelper() {</span>
<span class="nc" id="L37">		locale = Locale.getDefault();</span>
<span class="nc" id="L38">	}</span>

	public static void main(String[] args) throws LMSException {
<span class="nc" id="L41">		new DashBoardNewHelper().fetchMenuData();</span>
<span class="nc" id="L42">	}</span>

	public List&lt;Object&gt; fetchMenuData() throws LMSException {
<span class="nc" id="L45">		Connection con = null;</span>
<span class="nc" id="L46">		List&lt;Object&gt; dashBoardList = new ArrayList&lt;Object&gt;();</span>
<span class="nc" id="L47">		Map&lt;String, DashBoardBean&gt; map = new LinkedHashMap&lt;String, DashBoardBean&gt;();</span>
<span class="nc" id="L48">		con = DBConnect.getConnection();</span>
		// LimitDistributionBean limitBean = new LimitDistributionBean();
		// dashBoardList.add(limitBean);
<span class="nc" id="L51">		dashBoardList.add(map);</span>
<span class="nc" id="L52">		DashBoardBean tempBean = null;</span>
<span class="nc" id="L53">		String orgCodeQry = &quot; name orgCode &quot;;</span>

<span class="nc bnc" id="L55" title="All 2 branches missed.">		if ((LMSFilterDispatcher.orgFieldType).equalsIgnoreCase(&quot;CODE&quot;)) {</span>
<span class="nc" id="L56">			orgCodeQry = &quot;  org_code orgCode &quot;;</span>

<span class="nc bnc" id="L58" title="All 2 branches missed.">		} else if ((LMSFilterDispatcher.orgFieldType)</span>
				.equalsIgnoreCase(&quot;CODE_NAME&quot;)) {
<span class="nc" id="L60">			orgCodeQry = &quot; concat(org_code,'_',name)  orgCode &quot;;</span>

<span class="nc bnc" id="L62" title="All 2 branches missed.">		} else if ((LMSFilterDispatcher.orgFieldType)</span>
				.equalsIgnoreCase(&quot;NAME_CODE&quot;)) {
<span class="nc" id="L64">			orgCodeQry = &quot; concat(name,'_',org_code)  orgCode &quot;;</span>

		}
<span class="nc" id="L67">		String childDataQry = &quot;select organization_id,&quot;</span>
				+ orgCodeQry
				+ &quot;,city,organization_status,(available_credit-claimable_bal) as balance, extended_credit_limit, extends_credit_limit_upto from st_lms_organization_master where organization_type='AGENT' and organization_status &lt;&gt; 'TERMINATE' order by &quot;
				+ QueryManager.getAppendOrgOrder();
		try {
<span class="nc" id="L72">			PreparedStatement pstmt = con.prepareStatement(childDataQry);</span>

<span class="nc" id="L74">			ResultSet rs = pstmt.executeQuery();</span>
<span class="nc bnc" id="L75" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L76">				tempBean = new DashBoardBean();</span>
<span class="nc" id="L77">				tempBean.setOrgId(rs.getInt(&quot;organization_id&quot;));</span>
<span class="nc" id="L78">				tempBean.setOrgName(rs.getString(&quot;orgCode&quot;));</span>
<span class="nc" id="L79">				tempBean.setOrgStatus(rs.getString(&quot;organization_status&quot;));</span>
<span class="nc" id="L80">				tempBean.setLocation(rs.getString(&quot;city&quot;));</span>
<span class="nc" id="L81">				tempBean.setBalance(rs.getString(&quot;balance&quot;));</span>
<span class="nc" id="L82">				tempBean.setXclAmt(rs.getString(&quot;extended_credit_limit&quot;));</span>
				// String xclDays = rs.getString(&quot;extends_credit_limit_upto&quot;);
<span class="nc" id="L84">				int extendedCreditLimitUpto = calculateExtendsCreditLimitUpto(rs</span>
						.getDate(&quot;extends_credit_limit_upto&quot;));
<span class="nc" id="L86">				tempBean.setXclDays(extendedCreditLimitUpto + &quot;&quot;);</span>

<span class="nc" id="L88">				map.put(rs.getInt(&quot;organization_id&quot;) + &quot;&quot;, tempBean);</span>
<span class="nc" id="L89">			}</span>
			// fetchParentBalance(con, rs, pstmt, limitBean);
			/*
			 * String retloginStatusQry =
			 * &quot;select organization_id,offline_status,is_offline,terminal_id from st_lms_ret_offline_master where organization_id in (select organization_id from st_lms_organization_master where parent_id=&quot;
			 * + agentOrgId + &quot; )&quot;; pstmt =
			 * con.prepareStatement(retloginStatusQry); rs =
			 * pstmt.executeQuery();
			 * 
			 * while (rs.next()) { tempBean =
			 * map.get(rs.getString(&quot;organization_id&quot;));
			 * tempBean.setDeviceName(rs.getString(&quot;terminal_id&quot;));
			 * tempBean.setWebType(rs.getString(&quot;is_offline&quot;));
			 * tempBean.setOfflineStatus(rs.getString(&quot;offline_status&quot;)); }
			 */
<span class="nc" id="L104">		} catch (SQLException e) {</span>
<span class="nc" id="L105">			logger.error(&quot;Exception: &quot; + e);</span>
<span class="nc" id="L106">			e.printStackTrace();</span>
<span class="nc" id="L107">			throw new LMSException(e);</span>
		} finally {
<span class="nc" id="L109">			try {</span>
<span class="nc bnc" id="L110" title="All 8 branches missed.">				if (con != null &amp;&amp; !con.isClosed()) {</span>
<span class="nc" id="L111">					con.close();</span>
				}
<span class="nc" id="L113">			} catch (SQLException e) {</span>
<span class="nc" id="L114">				logger.error(&quot;Exception: &quot; + e);</span>
<span class="nc" id="L115">				e.printStackTrace();</span>
<span class="nc" id="L116">				throw new LMSException(e);</span>
<span class="nc" id="L117">			}</span>
		}
		// System.out.println(map);
<span class="nc" id="L120">		return dashBoardList;</span>
	}

	private void fetchParentBalance(Connection con, ResultSet rs,
			PreparedStatement pstmt, LimitDistributionBean limitBean)
			throws SQLException {
<span class="nc" id="L126">		String parentBalQry = &quot;select organization_id,name, credit_limit, extended_credit_limit, live_balance, distributed ,ifnull((live_balance - distributed),0) as distributable from (select organization_id, name, organization_type, credit_limit, extended_credit_limit,(available_credit-claimable_bal)as live_balance from st_lms_organization_master where organization_type='AGENT'&quot;;</span>

<span class="nc" id="L128">		pstmt = con.prepareStatement(parentBalQry);</span>
<span class="nc" id="L129">		rs = pstmt.executeQuery();</span>

<span class="nc bnc" id="L131" title="All 2 branches missed.">		while (rs.next()) {</span>
<span class="nc" id="L132">			limitBean.setOrgId(rs.getInt(&quot;organization_id&quot;));</span>
<span class="nc" id="L133">			limitBean.setName(rs.getString(&quot;name&quot;));</span>
<span class="nc" id="L134">			limitBean.setCrLimit(rs.getString(&quot;credit_limit&quot;));</span>
<span class="nc" id="L135">			limitBean.setXcrLimit(rs.getString(&quot;extended_credit_limit&quot;));</span>
<span class="nc" id="L136">			limitBean.setLiveBal(rs.getString(&quot;live_balance&quot;));</span>
<span class="nc" id="L137">			limitBean.setDistributedBal(rs.getString(&quot;distributed&quot;));</span>
<span class="nc" id="L138">			limitBean.setDistributableBal(rs.getString(&quot;distributable&quot;));</span>
		}
<span class="nc" id="L140">	}</span>

	public List&lt;Object&gt; updateAgentData(String[] retOrgId, String[] balance,
			String[] orgStatus, UserInfoBean userbean, String[] xclAmt,
			String[] xclDays) throws LMSException {
<span class="nc" id="L145">		Connection con = null;</span>
<span class="nc" id="L146">		List&lt;Object&gt; dashBoardList = null;</span>
<span class="nc" id="L147">		Map&lt;String, String&gt; map = new LinkedHashMap&lt;String, String&gt;();</span>
<span class="nc" id="L148">		con = DBConnect.getConnection();</span>
		// dashBoardList.add(map);

<span class="nc" id="L151">		PreparedStatement getOrgPstmt = null;</span>
<span class="nc" id="L152">		ResultSet getOrgRs = null;</span>
<span class="nc" id="L153">		OrganizationBean orgBean = null;</span>
<span class="nc" id="L154">		PreparedStatement updateOrgPstmt = null;</span>
<span class="nc" id="L155">		PreparedStatement insertHistoryPstmt = null;</span>

		try {

<span class="nc" id="L159">			AgentManagementHelper editOrgDetail = new AgentManagementHelper();</span>

<span class="nc bnc" id="L161" title="All 2 branches missed.">			for (int i = 0; i &lt; retOrgId.length; i++) {</span>
<span class="nc" id="L162">				con.setAutoCommit(false);</span>

<span class="nc" id="L164">				getOrgPstmt = con</span>
						.prepareStatement(&quot;select organization_id,parent_id,organization_type,name,available_credit,claimable_bal,unclaimable_bal,credit_limit,security_deposit,organization_status,extended_credit_limit,current_credit_amt,extends_credit_limit_upto from st_lms_organization_master where organization_id=?&quot;);
<span class="nc" id="L166">				getOrgPstmt.setInt(1, Integer.parseInt(retOrgId[i]));</span>
<span class="nc" id="L167">				getOrgRs = getOrgPstmt.executeQuery();</span>
<span class="nc bnc" id="L168" title="All 2 branches missed.">				if (getOrgRs.next()) {</span>
<span class="nc" id="L169">					orgBean = new OrganizationBean();</span>
<span class="nc" id="L170">					orgBean.setOrgId(getOrgRs.getInt(&quot;organization_id&quot;));</span>
<span class="nc" id="L171">					orgBean.setParentOrgId(getOrgRs.getInt(&quot;parent_id&quot;));</span>
<span class="nc" id="L172">					orgBean.setOrgName(getOrgRs</span>
							.getString(TableConstants.ORG_NAME));
<span class="nc" id="L174">					orgBean.setOrgType(getOrgRs</span>
							.getString(TableConstants.ORG_TYPE));
<span class="nc" id="L176">					orgBean.setSecDeposit(getOrgRs</span>
							.getDouble(&quot;security_deposit&quot;));
<span class="nc" id="L178">					orgBean.setOrgCreditLimit(getOrgRs</span>
							.getDouble(TableConstants.CREDIT_LIMIT));
<span class="nc" id="L180">					orgBean.setOrgStatus(getOrgRs</span>
							.getString(TableConstants.ORG_STATUS));
<span class="nc" id="L182">					orgBean.setCurrentCreditAmt(getOrgRs</span>
							.getDouble(TableConstants.SOM_CURR_CREDIT_AMT));
<span class="nc" id="L184">					orgBean.setExtendedCredit(getOrgRs</span>
							.getDouble(TableConstants.EXTENDED_CREDIT_LIMIT));
<span class="nc" id="L186">					orgBean.setAvailableCredit(getOrgRs</span>
							.getDouble(TableConstants.SOM_AVAILABLE_CREDIT));
<span class="nc" id="L188">					orgBean</span>
							.setClaimableBal(getOrgRs
									.getDouble(&quot;claimable_bal&quot;));
<span class="nc" id="L191">					int extendedCreditLimitUpto = calculateExtendsCreditLimitUpto(getOrgRs</span>
							.getDate(&quot;extends_credit_limit_upto&quot;));
<span class="nc" id="L193">					orgBean.setExtendsCreditLimitUpto(extendedCreditLimitUpto);</span>

				}

<span class="nc" id="L197">				getOrgPstmt = con</span>
						.prepareStatement(&quot;select login_status from st_lms_ret_offline_master where organization_id= ? and is_offline='YES'&quot;);
<span class="nc" id="L199">				getOrgPstmt.setInt(1, Integer.parseInt(retOrgId[i]));</span>
<span class="nc" id="L200">				getOrgRs = getOrgPstmt.executeQuery();</span>
<span class="nc bnc" id="L201" title="All 2 branches missed.">				if (getOrgRs.next()) {</span>

<span class="nc" id="L203">					map.put(retOrgId[i], findDefaultText(&quot;msg.offline.ret.login&quot;, locale));</span>
<span class="nc" id="L204">					continue;</span>
				} else {

<span class="nc bnc" id="L207" title="All 2 branches missed.">					if (!orgBean.getOrgStatus().equals(orgStatus[i])) {</span>

<span class="nc bnc" id="L209" title="All 2 branches missed.">						if (orgStatus[i].equalsIgnoreCase(&quot;ACTIVE&quot;)) {</span>
<span class="nc bnc" id="L210" title="All 2 branches missed.">							if ((orgBean.getAvailableCredit()</span>
									- orgBean.getClaimableBal() + Double
									.parseDouble(balance[i])) &lt; 0) {
<span class="nc" id="L213">								map</span>
										.put(
												retOrgId[i],
												findDefaultText(&quot;msg.status.cannot.be.active.on.neg.bal&quot;, locale));
<span class="nc" id="L217">								continue;</span>
							}
						}
<span class="nc" id="L220">						updateOrgPstmt = con</span>
								.prepareStatement(&quot;update st_lms_organization_master set organization_status=? where organization_id=?&quot;);
<span class="nc" id="L222">						updateOrgPstmt.setString(1, orgStatus[i]);</span>
<span class="nc" id="L223">						updateOrgPstmt.setInt(2, Integer.parseInt(retOrgId[i]));</span>
<span class="nc" id="L224">						updateOrgPstmt.executeUpdate();</span>

<span class="nc" id="L226">						insertHistoryPstmt = con</span>
								.prepareStatement(&quot;insert into st_lms_organization_master_history select ?,organization_id, addr_line1, addr_line2,division_code,area_code, city, pin_code, security_deposit, credit_limit,?,?,organization_status,?, pwt_scrap, recon_report_type  from st_lms_organization_master where organization_id =?&quot;);
<span class="nc" id="L228">						insertHistoryPstmt.setInt(1, userbean.getUserId());</span>
<span class="nc" id="L229">						insertHistoryPstmt.setString(2, orgStatus[i]</span>
								+ &quot;_MANUAL_&quot;
								+ userbean.getRoleName().split(&quot; &quot;)[0]);
<span class="nc" id="L232">						insertHistoryPstmt.setString(3, &quot;Organization made &quot;</span>
								+ orgStatus[i] + &quot; by &quot;
								+ userbean.getRoleName().split(&quot; &quot;)[0] + &quot;: &quot;
								+ userbean.getOrgName());
<span class="nc" id="L236">						insertHistoryPstmt.setTimestamp(4, Util</span>
								.getCurrentTimeStamp());
<span class="nc" id="L238">						insertHistoryPstmt.setInt(5, Integer</span>
								.parseInt(retOrgId[i]));
<span class="nc" id="L240">						insertHistoryPstmt.executeUpdate();</span>

					}

<span class="nc bnc" id="L244" title="All 2 branches missed.">					if (Double.parseDouble(balance[i]) != 0) {</span>

<span class="nc bnc" id="L246" title="All 2 branches missed.">						String agtBalDist = (orgBean.getOrgCreditLimit()</span>
								+ Double.parseDouble(balance[i]) &gt;= 0) ? &quot;TRUE&quot;
								: findDefaultText(&quot;msg.cannot.dec.more.than.agt.lmt&quot;, locale);

<span class="nc" id="L250">						System.out.println(agtBalDist + &quot;******&quot; + retOrgId[i]);</span>
<span class="nc bnc" id="L251" title="All 2 branches missed.">						if (&quot;TRUE&quot;.equals(agtBalDist)) {</span>
<span class="nc" id="L252">							editOrgDetail.editOrgCreditLimitDetails(orgBean,</span>
									Double.parseDouble(balance[i]), userbean,
									con);
<span class="nc" id="L255">							map.put(retOrgId[i], findDefaultText(&quot;msg.record.update.success&quot;, locale));</span>
						} else {
<span class="nc" id="L257">							map.put(retOrgId[i], agtBalDist);</span>
<span class="nc" id="L258">							continue;</span>
						}
					}
					// map.put(retOrgId[i], &quot;Record Updated Successfully.&quot;);
					// ------
					/*
					 * if(Double.parseDouble(xclAmt[i]) &gt;= 0 &amp;&amp;
					 * Integer.parseInt(xclDays[i]) &gt; 0 &amp;&amp;
					 * orgBean.getExtendedCredit()-
					 * Double.parseDouble(xclAmt[i])&gt;=0){
					 * 
					 * 
					 * String agtBalDist = &quot;TRUE&quot;;
					 * getOrgPstmt=con.prepareStatement(
					 * &quot;select organization_id,parent_id,organization_type,name,available_credit,claimable_bal,unclaimable_bal,credit_limit,security_deposit,organization_status,extended_credit_limit,current_credit_amt,extends_credit_limit_upto from st_lms_organization_master where organization_id=?&quot;
					 * ); getOrgPstmt.setInt(1, Integer .parseInt(retOrgId[i]));
					 * getOrgRs=getOrgPstmt.executeQuery(); if(getOrgRs.next()){
					 * orgBean = new OrganizationBean();
					 * orgBean.setOrgId(getOrgRs.getInt(&quot;organization_id&quot;));
					 * orgBean.setParentOrgId(getOrgRs.getInt(&quot;parent_id&quot;));
					 * orgBean
					 * .setOrgName(getOrgRs.getString(TableConstants.ORG_NAME));
					 * orgBean
					 * .setOrgType(getOrgRs.getString(TableConstants.ORG_TYPE));
					 * orgBean
					 * .setSecDeposit(getOrgRs.getDouble(&quot;security_deposit&quot;));
					 * orgBean.setOrgCreditLimit(getOrgRs
					 * .getDouble(TableConstants.CREDIT_LIMIT));
					 * orgBean.setOrgStatus
					 * (getOrgRs.getString(TableConstants.ORG_STATUS));
					 * orgBean.setCurrentCreditAmt(getOrgRs
					 * .getDouble(TableConstants.SOM_CURR_CREDIT_AMT));
					 * orgBean.setExtendedCredit(getOrgRs
					 * .getDouble(TableConstants.EXTENDED_CREDIT_LIMIT));
					 * orgBean.setAvailableCredit(getOrgRs
					 * .getDouble(TableConstants.SOM_AVAILABLE_CREDIT));
					 * orgBean.
					 * setClaimableBal(getOrgRs.getDouble(&quot;claimable_bal&quot;)); int
					 * extendedCreditLimitUpto =
					 * calculateExtendsCreditLimitUpto(getOrgRs
					 * .getDate(&quot;extends_credit_limit_upto&quot;));
					 * orgBean.setExtendsCreditLimitUpto
					 * (extendedCreditLimitUpto);
					 * 
					 * }
					 */
					/*
					 * agtBalDist = CommonMethods.changeCreditLimitRet(Integer
					 * .parseInt(retOrgId[i]), bean .getOrgCreditLimit() +
					 * Double.parseDouble(xclAmt[i]), &quot;XCL&quot;);
					 */
					/*
					 * System.out.println(agtBalDist + &quot;******&quot; + retOrgId[i]);
					 * 
					 * if (agtBalDist.equals(&quot;TRUE&quot;)) {
					 * editOrgDetail.editOrgDetails(
					 * Double.parseDouble(xclAmt[i]),
					 * Integer.parseInt(xclDays[i]), userbean,orgBean,con);
					 * 
					 * } else { map.put(retOrgId[i], agtBalDist); }
					 * 
					 * } else if((Double.parseDouble(xclAmt[i]) == 0 ||
					 * Double.parseDouble(xclAmt[i])&lt;0) &amp;&amp;
					 * Integer.parseInt(xclDays[i])&gt;0){ map.put(retOrgId[i],
					 * &quot;Please Select Valid XCL Amount&quot;);
					 * 
					 * } else if((Integer.parseInt(xclDays[i]) == 0 ||
					 * Integer.parseInt(xclDays[i])&lt;0) &amp;&amp;
					 * Double.parseDouble(xclAmt[i])&gt;0){ map.put(retOrgId[i],
					 * &quot;Please Select Valid XCL Days&quot;); }else
					 * if(Double.parseDouble(xclAmt[i]) &lt; 0 &amp;&amp;
					 * Integer.parseInt(xclDays[i]) &lt; 0){ map.put(retOrgId[i],
					 * &quot;Please Select Valid XCL Amount&quot;);
					 * 
					 * }
					 */

<span class="nc bnc" id="L335" title="All 4 branches missed.">					if ((orgBean.getExtendedCredit()</span>
							- Double.parseDouble(xclAmt[i]) != 0)
							|| orgBean.getExtendsCreditLimitUpto()
									- Integer.parseInt(xclDays[i]) != 0) {
<span class="nc bnc" id="L339" title="All 2 branches missed.">						if (orgBean.getExtendedCredit() &gt; 0) {</span>
<span class="nc bnc" id="L340" title="All 8 branches missed.">							if ((Double.parseDouble(xclAmt[i]) &gt; 0 &amp;&amp; Integer</span>
									.parseInt(xclDays[i]) &gt; 0)
									|| (Double.parseDouble(xclAmt[i]) == 0 &amp;&amp; Integer
											.parseInt(xclDays[i]) == 0)) {

<span class="nc" id="L345">								String agtBalDist = &quot;TRUE&quot;;</span>
<span class="nc" id="L346">								getOrgPstmt = con</span>
										.prepareStatement(&quot;select organization_id,parent_id,organization_type,name,available_credit,claimable_bal,unclaimable_bal,credit_limit,security_deposit,organization_status,extended_credit_limit,current_credit_amt,extends_credit_limit_upto from st_lms_organization_master where organization_id=?&quot;);
<span class="nc" id="L348">								getOrgPstmt.setInt(1, Integer</span>
										.parseInt(retOrgId[i]));
<span class="nc" id="L350">								getOrgRs = getOrgPstmt.executeQuery();</span>
<span class="nc bnc" id="L351" title="All 2 branches missed.">								if (getOrgRs.next()) {</span>
<span class="nc" id="L352">									orgBean = new OrganizationBean();</span>
<span class="nc" id="L353">									orgBean.setOrgId(getOrgRs</span>
											.getInt(&quot;organization_id&quot;));
<span class="nc" id="L355">									orgBean.setParentOrgId(getOrgRs</span>
											.getInt(&quot;parent_id&quot;));
<span class="nc" id="L357">									orgBean</span>
											.setOrgName(getOrgRs
													.getString(TableConstants.ORG_NAME));
<span class="nc" id="L360">									orgBean</span>
											.setOrgType(getOrgRs
													.getString(TableConstants.ORG_TYPE));
<span class="nc" id="L363">									orgBean.setSecDeposit(getOrgRs</span>
											.getDouble(&quot;security_deposit&quot;));
<span class="nc" id="L365">									orgBean</span>
											.setOrgCreditLimit(getOrgRs
													.getDouble(TableConstants.CREDIT_LIMIT));
<span class="nc" id="L368">									orgBean</span>
											.setOrgStatus(getOrgRs
													.getString(TableConstants.ORG_STATUS));
<span class="nc" id="L371">									orgBean</span>
											.setCurrentCreditAmt(getOrgRs
													.getDouble(TableConstants.SOM_CURR_CREDIT_AMT));
<span class="nc" id="L374">									orgBean</span>
											.setExtendedCredit(getOrgRs
													.getDouble(TableConstants.EXTENDED_CREDIT_LIMIT));
<span class="nc" id="L377">									orgBean</span>
											.setAvailableCredit(getOrgRs
													.getDouble(TableConstants.SOM_AVAILABLE_CREDIT));
<span class="nc" id="L380">									orgBean.setClaimableBal(getOrgRs</span>
											.getDouble(&quot;claimable_bal&quot;));
<span class="nc" id="L382">									int extendedCreditLimitUpto = calculateExtendsCreditLimitUpto(getOrgRs</span>
											.getDate(&quot;extends_credit_limit_upto&quot;));
<span class="nc" id="L384">									orgBean</span>
											.setExtendsCreditLimitUpto(extendedCreditLimitUpto);

								}
								/*
								 * agtBalDist =
								 * CommonMethods.changeCreditLimitRet(Integer
								 * .parseInt(retOrgId[i]), bean
								 * .getOrgCreditLimit() +
								 * Double.parseDouble(xclAmt[i]), &quot;XCL&quot;);
								 */
<span class="nc" id="L395">								System.out.println(agtBalDist + &quot;******&quot;</span>
										+ retOrgId[i]);

<span class="nc bnc" id="L398" title="All 2 branches missed.">								if (agtBalDist.equals(&quot;TRUE&quot;)) {</span>
<span class="nc" id="L399">									editOrgDetail.editOrgDetails(Double</span>
											.parseDouble(xclAmt[i]), Integer
											.parseInt(xclDays[i]), userbean,
											orgBean, con);
<span class="nc" id="L403">									map</span>
											.put(
													retOrgId[i],
													findDefaultText(&quot;msg.record.update.success&quot;, locale));
								} else {
<span class="nc" id="L408">									map.put(retOrgId[i], agtBalDist);</span>
								}
<span class="nc" id="L410">							} else {</span>
<span class="nc" id="L411">								map.put(retOrgId[i], findDefaultText(&quot;msg.select.valid.xcl.entry&quot;, locale));</span>

							}
						} else {
<span class="nc bnc" id="L415" title="All 4 branches missed.">							if (Double.parseDouble(xclAmt[i]) &gt; 0</span>
									&amp;&amp; Integer.parseInt(xclDays[i]) &gt; 0) {

<span class="nc" id="L418">								String agtBalDist = &quot;TRUE&quot;;</span>
<span class="nc" id="L419">								getOrgPstmt = con</span>
										.prepareStatement(&quot;select organization_id,parent_id,organization_type,name,available_credit,claimable_bal,unclaimable_bal,credit_limit,security_deposit,organization_status,extended_credit_limit,current_credit_amt,extends_credit_limit_upto from st_lms_organization_master where organization_id=?&quot;);
<span class="nc" id="L421">								getOrgPstmt.setInt(1, Integer</span>
										.parseInt(retOrgId[i]));
<span class="nc" id="L423">								getOrgRs = getOrgPstmt.executeQuery();</span>
<span class="nc bnc" id="L424" title="All 2 branches missed.">								if (getOrgRs.next()) {</span>
<span class="nc" id="L425">									orgBean = new OrganizationBean();</span>
<span class="nc" id="L426">									orgBean.setOrgId(getOrgRs</span>
											.getInt(&quot;organization_id&quot;));
<span class="nc" id="L428">									orgBean.setParentOrgId(getOrgRs</span>
											.getInt(&quot;parent_id&quot;));
<span class="nc" id="L430">									orgBean</span>
											.setOrgName(getOrgRs
													.getString(TableConstants.ORG_NAME));
<span class="nc" id="L433">									orgBean</span>
											.setOrgType(getOrgRs
													.getString(TableConstants.ORG_TYPE));
<span class="nc" id="L436">									orgBean.setSecDeposit(getOrgRs</span>
											.getDouble(&quot;security_deposit&quot;));
<span class="nc" id="L438">									orgBean</span>
											.setOrgCreditLimit(getOrgRs
													.getDouble(TableConstants.CREDIT_LIMIT));
<span class="nc" id="L441">									orgBean</span>
											.setOrgStatus(getOrgRs
													.getString(TableConstants.ORG_STATUS));
<span class="nc" id="L444">									orgBean</span>
											.setCurrentCreditAmt(getOrgRs
													.getDouble(TableConstants.SOM_CURR_CREDIT_AMT));
<span class="nc" id="L447">									orgBean</span>
											.setExtendedCredit(getOrgRs
													.getDouble(TableConstants.EXTENDED_CREDIT_LIMIT));
<span class="nc" id="L450">									orgBean</span>
											.setAvailableCredit(getOrgRs
													.getDouble(TableConstants.SOM_AVAILABLE_CREDIT));
<span class="nc" id="L453">									orgBean.setClaimableBal(getOrgRs</span>
											.getDouble(&quot;claimable_bal&quot;));
<span class="nc" id="L455">									int extendedCreditLimitUpto = calculateExtendsCreditLimitUpto(getOrgRs</span>
											.getDate(&quot;extends_credit_limit_upto&quot;));
<span class="nc" id="L457">									orgBean</span>
											.setExtendsCreditLimitUpto(extendedCreditLimitUpto);

								}
								/*
								 * agtBalDist =
								 * CommonMethods.changeCreditLimitRet(Integer
								 * .parseInt(retOrgId[i]), bean
								 * .getOrgCreditLimit() +
								 * Double.parseDouble(xclAmt[i]), &quot;XCL&quot;);
								 */
<span class="nc" id="L468">								System.out.println(agtBalDist + &quot;******&quot;</span>
										+ retOrgId[i]);

<span class="nc bnc" id="L471" title="All 2 branches missed.">								if (agtBalDist.equals(&quot;TRUE&quot;)) {</span>
<span class="nc" id="L472">									editOrgDetail.editOrgDetails(Double</span>
											.parseDouble(xclAmt[i]), Integer
											.parseInt(xclDays[i]), userbean,
											orgBean, con);
<span class="nc" id="L476">									map</span>
											.put(
													retOrgId[i],
													findDefaultText(&quot;msg.record.update.success&quot;, locale));
								} else {
<span class="nc" id="L481">									map.put(retOrgId[i], agtBalDist);</span>
								}
<span class="nc" id="L483">							} else {</span>
<span class="nc" id="L484">								map.put(retOrgId[i], findDefaultText(&quot;msg.select.valid.xcl.entry&quot;, locale));</span>
							}
						}
					}
					/*
					 * 
					 * updHistXCL = false; // Hard-Coding to be removed if
					 * (updHistXCL) { String msg = &quot;&quot;; if(updStatus){ msg =
					 * &quot;Organization made &quot;+orgStatus[i]+&quot; by &quot;+
					 * userbean.getRoleName().split(&quot; &quot;)[0]
					 * +&quot;: &quot;+userbean.getOrgName(); stmtHistory.addBatch(
					 * &quot;insert into st_lms_organization_master_history select &quot;
					 * + userbean.getUserId() +
					 * &quot;, organization_id, addr_line1, addr_line2, city, pin_code, security_deposit, credit_limit,'&quot;
					 * + orgStatus[i] +&quot;_MANUAL_&quot;+
					 * userbean.getRoleName().split(&quot; &quot;)[0] +&quot;','&quot;+ msg
					 * +&quot;', organization_status,'&quot;+ new java.sql.Timestamp(new
					 * java.util.Date().getTime()).toString()+
					 * &quot;',pwt_scrap,recon_report_type from st_lms_organization_master slom where organization_id=&quot;
					 * + retOrgId[i]);
					 * 
					 * System.out.println(
					 * &quot;insert into st_lms_organization_master_history select &quot;
					 * + userbean.getUserId() +
					 * &quot;, organization_id, addr_line1, addr_line2, city, pin_code, security_deposit, credit_limit,'&quot;
					 * + orgStatus[i] +&quot;_MANUAL_&quot;+
					 * userbean.getRoleName().split(&quot; &quot;)[0] +&quot;','&quot;+ msg
					 * +&quot;', organization_status,'&quot;+ new java.sql.Timestamp(new
					 * java.util.Date().getTime()).toString()+
					 * &quot;',pwt_scrap,recon_report_type from st_lms_organization_master slom where organization_id=&quot;
					 * + retOrgId[i]); } else{ msg = &quot;credit &quot;+ balance[i];
					 * stmtHistory.addBatch(
					 * &quot;insert into st_lms_organization_master_history select &quot;
					 * + userbean.getUserId() +
					 * &quot;, organization_id, addr_line1, addr_line2, city, pin_code, security_deposit, credit_limit,'CREDIT_CHANGED_&quot;
					 * + userbean.getRoleName().split(&quot; &quot;)[0] +&quot;','&quot;+ msg
					 * +&quot;', organization_status,'&quot;+ new java.sql.Timestamp(new
					 * java.util.Date().getTime()).toString()+
					 * &quot;',pwt_scrap,recon_report_type from st_lms_organization_master slom where organization_id=&quot;
					 * + retOrgId[i]);System.out.println(
					 * &quot;insert into st_lms_organization_master_history select &quot;
					 * + userbean.getUserId() +
					 * &quot;, organization_id, addr_line1, addr_line2, city, pin_code, security_deposit, credit_limit,'CREDIT_CHANGED_&quot;
					 * + userbean.getRoleName().split(&quot; &quot;)[0] +&quot;','&quot;+ msg
					 * +&quot;', organization_status,'&quot;+ new java.sql.Timestamp(new
					 * java.util.Date().getTime()).toString()+
					 * &quot;',pwt_scrap,recon_report_type from st_lms_organization_master slom where organization_id=&quot;
					 * + retOrgId[i]); }
					 * 
					 * }
					 */

				}

				/*
				 * AgentManagementHelper editOrgDetail = new
				 * AgentManagementHelper(); OrganizationBean bean =
				 * editOrgDetail.orgDetails(Integer .parseInt(retOrgId[i]));
				 * updHist = false; updStatus = false;
				 * 
				 * updHistXCL = false; if
				 * (!DrawGameOfflineHelper.fetchLoginStatus(Integer
				 * .parseInt(retOrgId[i]))) {
				 * 
				 * if (!bean.getOrgStatus().equals(orgStatus[i])) { updHist =
				 * true; updStatus = true;
				 * 
				 * updHistXCL = true; if
				 * (orgStatus[i].equalsIgnoreCase(&quot;ACTIVE&quot;)) { if
				 * ((bean.getAvailableCredit() - bean.getClaimableBal() + Double
				 * .parseDouble(balance[i])) &lt; 0) { updHist = false; updHistXCL
				 * = false; map .put(retOrgId[i],
				 * &quot;Status Can't be made ACTIVE on -ve balance&quot;); } } if
				 * (updStatus) { stmt.addBatch(
				 * &quot;update st_lms_organization_master set organization_status='&quot;
				 * + orgStatus[i] + &quot;' where organization_id=&quot; + retOrgId[i] +
				 * &quot;&quot;); } }
				 * 
				 * 
				 * if (Double.parseDouble(balance[i]) != 0) { updHist = true;
				 * updStatus = false; String
				 * agtBalDist=(bean.getOrgCreditLimit()
				 * +Double.parseDouble(balance
				 * [i])&gt;=0)?&quot;TRUE&quot;:&quot;Can't  Decrease More than AGENT's limit&quot;;
				 * //String agtBalDist = &quot;TRUE&quot;; String agtBalDist =
				 * CommonMethods.changeCreditLimitAgt(Integer
				 * .parseInt(retOrgId[i]), bean .getOrgCreditLimit() +
				 * Double.parseDouble(balance[i]), &quot;CL&quot;);
				 * System.out.println(agtBalDist + &quot;******&quot; + retOrgId[i]); if
				 * (agtBalDist.equals(&quot;TRUE&quot;)) {
				 * editOrgDetail.editOrgCreditLimitDetails(bean .getOrgId(),
				 * bean.getOrgCreditLimit() + Double.parseDouble(balance[i]),
				 * bean .getSecDeposit(), bean .getCurrentCreditAmt(), bean
				 * .getExtendedCredit(), userbean .getUserType(),
				 * userbean.getUserOrgId(), userbean.getUserId()); } else {
				 * map.put(retOrgId[i], agtBalDist); updHist=false; } }
				 * 
				 * //------ if(Double.parseDouble(xclAmt[i]) != 0 &amp;&amp;
				 * Integer.parseInt(xclDays[i]) != 0){ updHistXCL = true;
				 * updStatus = false;
				 * 
				 * String agtBalDist = &quot;TRUE&quot;; bean =
				 * editOrgDetail.orgDetails(Integer.parseInt(retOrgId[i]));
				 * agtBalDist = CommonMethods.changeCreditLimitRet(Integer
				 * .parseInt(retOrgId[i]), bean .getOrgCreditLimit() +
				 * Double.parseDouble(xclAmt[i]), &quot;XCL&quot;);
				 * System.out.println(agtBalDist + &quot;******&quot; + retOrgId[i]); if
				 * (agtBalDist.equals(&quot;TRUE&quot;)) {
				 * editOrgDetail.editOrgDetails(bean.getOrgId(),
				 * Double.parseDouble(xclAmt[i]), bean.getCurrentCreditAmt(),
				 * bean.getOrgCreditLimit(), Integer.parseInt(xclDays[i]),
				 * userbean.getUserType(), userbean .getUserOrgId(),
				 * userbean.getUserId());
				 * 
				 * } else { map.put(retOrgId[i], agtBalDist); updHistXCL=false;
				 * }
				 * 
				 * } else if(Double.parseDouble(xclAmt[i]) == 0 &amp;&amp;
				 * Integer.parseInt(xclDays[i]) == 0){
				 * 
				 * 
				 * } else if(Double.parseDouble(xclAmt[i]) == 0){
				 * map.put(retOrgId[i], &quot;Please Select Valid XCL Amount&quot;);
				 * updHistXCL=false; } else if(Double.parseDouble(xclDays[i]) ==
				 * 0){ map.put(retOrgId[i], &quot;Please Select Valid XCL Days&quot;);
				 * updHistXCL=false; }
				 * 
				 * //------
				 * 
				 * System.out.println(&quot;****updHist*****&quot;+updHist+&quot;***&quot;);
				 * System.out.println(&quot;****updStatus*****&quot;+updStatus+&quot;***&quot;);
				 * System.out.println(&quot;****updHistXCL*****&quot;+updHistXCL+&quot;***&quot;);
				 * 
				 * if (updHist) { String msg = &quot;&quot;; if(updStatus){ msg =
				 * &quot;Organization made &quot;+orgStatus[i]+&quot; by &quot;+
				 * userbean.getRoleName().split(&quot; &quot;)[0]
				 * +&quot;: &quot;+userbean.getOrgName(); stmtHistory.addBatch(
				 * &quot;insert into st_lms_organization_master_history select &quot; +
				 * userbean.getUserId() +
				 * &quot;, organization_id, addr_line1, addr_line2, city, pin_code, security_deposit, credit_limit,'&quot;
				 * + orgStatus[i] +&quot;_MANUAL_&quot;+
				 * userbean.getRoleName().split(&quot; &quot;)[0] +&quot;','&quot;+ msg
				 * +&quot;', organization_status,'&quot;+ new java.sql.Timestamp(new
				 * java.util.Date().getTime()).toString()+
				 * &quot;',pwt_scrap,recon_report_type from st_lms_organization_master slom where organization_id=&quot;
				 * + retOrgId[i]);
				 * 
				 * System.out.println(
				 * &quot;insert into st_lms_organization_master_history select &quot; +
				 * userbean.getUserId() +
				 * &quot;, organization_id, addr_line1, addr_line2, city, pin_code, security_deposit, credit_limit,'&quot;
				 * + orgStatus[i] +&quot;_MANUAL_&quot;+
				 * userbean.getRoleName().split(&quot; &quot;)[0] +&quot;','&quot;+ msg
				 * +&quot;', organization_status,'&quot;+ new java.sql.Timestamp(new
				 * java.util.Date().getTime()).toString()+
				 * &quot;',pwt_scrap,recon_report_type from st_lms_organization_master slom where organization_id=&quot;
				 * + retOrgId[i]); } else{ msg = &quot;credit &quot;+ balance[i];
				 * stmtHistory.addBatch(
				 * &quot;insert into st_lms_organization_master_history select &quot; +
				 * userbean.getUserId() +
				 * &quot;, organization_id, addr_line1, addr_line2, city, pin_code, security_deposit, credit_limit,'CREDIT_CHANGED_&quot;
				 * + userbean.getRoleName().split(&quot; &quot;)[0] +&quot;','&quot;+ msg
				 * +&quot;', organization_status,'&quot;+ new java.sql.Timestamp(new
				 * java.util.Date().getTime()).toString()+
				 * &quot;',pwt_scrap,recon_report_type from st_lms_organization_master slom where organization_id=&quot;
				 * + retOrgId[i]);System.out.println(
				 * &quot;insert into st_lms_organization_master_history select &quot; +
				 * userbean.getUserId() +
				 * &quot;, organization_id, addr_line1, addr_line2, city, pin_code, security_deposit, credit_limit,'CREDIT_CHANGED_&quot;
				 * + userbean.getRoleName().split(&quot; &quot;)[0] +&quot;','&quot;+ msg
				 * +&quot;', organization_status,'&quot;+ new java.sql.Timestamp(new
				 * java.util.Date().getTime()).toString()+
				 * &quot;',pwt_scrap,recon_report_type from st_lms_organization_master slom where organization_id=&quot;
				 * + retOrgId[i]); } }
				 * 
				 * updHistXCL = false; // Hard-Coding to be removed if
				 * (updHistXCL) { String msg = &quot;&quot;; if(updStatus){ msg =
				 * &quot;Organization made &quot;+orgStatus[i]+&quot; by &quot;+
				 * userbean.getRoleName().split(&quot; &quot;)[0]
				 * +&quot;: &quot;+userbean.getOrgName(); stmtHistory.addBatch(
				 * &quot;insert into st_lms_organization_master_history select &quot; +
				 * userbean.getUserId() +
				 * &quot;, organization_id, addr_line1, addr_line2, city, pin_code, security_deposit, credit_limit,'&quot;
				 * + orgStatus[i] +&quot;_MANUAL_&quot;+
				 * userbean.getRoleName().split(&quot; &quot;)[0] +&quot;','&quot;+ msg
				 * +&quot;', organization_status,'&quot;+ new java.sql.Timestamp(new
				 * java.util.Date().getTime()).toString()+
				 * &quot;',pwt_scrap,recon_report_type from st_lms_organization_master slom where organization_id=&quot;
				 * + retOrgId[i]);
				 * 
				 * System.out.println(
				 * &quot;insert into st_lms_organization_master_history select &quot; +
				 * userbean.getUserId() +
				 * &quot;, organization_id, addr_line1, addr_line2, city, pin_code, security_deposit, credit_limit,'&quot;
				 * + orgStatus[i] +&quot;_MANUAL_&quot;+
				 * userbean.getRoleName().split(&quot; &quot;)[0] +&quot;','&quot;+ msg
				 * +&quot;', organization_status,'&quot;+ new java.sql.Timestamp(new
				 * java.util.Date().getTime()).toString()+
				 * &quot;',pwt_scrap,recon_report_type from st_lms_organization_master slom where organization_id=&quot;
				 * + retOrgId[i]); } else{ msg = &quot;credit &quot;+ balance[i];
				 * stmtHistory.addBatch(
				 * &quot;insert into st_lms_organization_master_history select &quot; +
				 * userbean.getUserId() +
				 * &quot;, organization_id, addr_line1, addr_line2, city, pin_code, security_deposit, credit_limit,'CREDIT_CHANGED_&quot;
				 * + userbean.getRoleName().split(&quot; &quot;)[0] +&quot;','&quot;+ msg
				 * +&quot;', organization_status,'&quot;+ new java.sql.Timestamp(new
				 * java.util.Date().getTime()).toString()+
				 * &quot;',pwt_scrap,recon_report_type from st_lms_organization_master slom where organization_id=&quot;
				 * + retOrgId[i]);System.out.println(
				 * &quot;insert into st_lms_organization_master_history select &quot; +
				 * userbean.getUserId() +
				 * &quot;, organization_id, addr_line1, addr_line2, city, pin_code, security_deposit, credit_limit,'CREDIT_CHANGED_&quot;
				 * + userbean.getRoleName().split(&quot; &quot;)[0] +&quot;','&quot;+ msg
				 * +&quot;', organization_status,'&quot;+ new java.sql.Timestamp(new
				 * java.util.Date().getTime()).toString()+
				 * &quot;',pwt_scrap,recon_report_type from st_lms_organization_master slom where organization_id=&quot;
				 * + retOrgId[i]); }
				 * 
				 * }
				 * 
				 * } else { map.put(retOrgId[i],
				 * &quot;Offline Retailer is currently LoggedIn&quot;); } }
				 * stmt.executeBatch(); stmtHistory.executeBatch();
				 */
<span class="nc" id="L708">				con.commit();</span>
			}
<span class="nc" id="L710">			dashBoardList = fetchMenuData();</span>
<span class="nc" id="L711">			Map&lt;String, DashBoardBean&gt; newMap = (LinkedHashMap&lt;String, DashBoardBean&gt;) dashBoardList</span>
					.get(0);
<span class="nc" id="L713">			java.util.Iterator&lt;Entry&lt;String, String&gt;&gt; itr = map.entrySet()</span>
					.iterator();

<span class="nc bnc" id="L716" title="All 2 branches missed.">			while (itr.hasNext()) {</span>
<span class="nc" id="L717">				Map.Entry&lt;String, String&gt; pair = itr.next();</span>
<span class="nc" id="L718">				newMap.get(pair.getKey()).setErrorMsg(pair.getValue());</span>
<span class="nc" id="L719">			}</span>

<span class="nc" id="L721">			return dashBoardList;</span>
<span class="nc" id="L722">		} catch (SQLException e) {</span>
<span class="nc" id="L723">			logger.error(&quot;Exception: &quot; + e);</span>
<span class="nc" id="L724">			e.printStackTrace();</span>
<span class="nc" id="L725">			throw new LMSException(e);</span>
		} finally {
<span class="nc" id="L727">			try {</span>
<span class="nc bnc" id="L728" title="All 8 branches missed.">				if (con != null &amp;&amp; !con.isClosed()) {</span>
<span class="nc" id="L729">					con.close();</span>
				}
<span class="nc" id="L731">			} catch (SQLException e) {</span>
<span class="nc" id="L732">				logger.error(&quot;Exception: &quot; + e);</span>
<span class="nc" id="L733">				e.printStackTrace();</span>
<span class="nc" id="L734">				throw new LMSException(e);</span>
<span class="nc" id="L735">			}</span>
		}

	}

	private int calculateExtendsCreditLimitUpto(java.sql.Date date) {
<span class="nc bnc" id="L741" title="All 2 branches missed.">		if (date == null) {</span>
<span class="nc" id="L742">			return 0;</span>
		}
<span class="nc" id="L744">		long days = 0, hours = 0;</span>

<span class="nc" id="L746">		Calendar today = Calendar.getInstance();</span>
<span class="nc" id="L747">		today.set(today.get(Calendar.YEAR), today.get(Calendar.MONTH), today</span>
				.get(Calendar.DAY_OF_MONTH), 0, 0, 0);

<span class="nc" id="L750">		Calendar extendedDate = Calendar.getInstance();</span>
<span class="nc" id="L751">		extendedDate.setTimeInMillis(date.getTime());</span>
<span class="nc" id="L752">		extendedDate.set(extendedDate.get(Calendar.YEAR), extendedDate</span>
				.get(Calendar.MONTH), extendedDate.get(Calendar.DAY_OF_MONTH),
				0, 0, 1);

<span class="nc" id="L756">		long timeDiff = extendedDate.getTimeInMillis()</span>
				- today.getTimeInMillis();
<span class="nc bnc" id="L758" title="All 2 branches missed.">		if (timeDiff &gt; 0) {</span>
<span class="nc" id="L759">			days = timeDiff / (1000 * 60 * 60 * 24);</span>
<span class="nc" id="L760">			hours = timeDiff / (1000 * 60 * 60);</span>
		}
		// System.out.println(&quot; dd days : &quot;+days +&quot; hours = &quot;+hours);
		// System.out.println(date +&quot;, extendedDate = &quot;+extendedDate.getTime()
		// +&quot; ,today : &quot;+today.getTime());

<span class="nc" id="L766">		return (int) days;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>