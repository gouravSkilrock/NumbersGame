<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>WriteExcelForComplCollReport.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">lms</a> &gt; <a href="index.source.html" class="el_package">com.skilrock.lms.web.reportsMgmt.common</a> &gt; <span class="el_source">WriteExcelForComplCollReport.java</span></div><h1>WriteExcelForComplCollReport.java</h1><pre class="source lang-java linenums">package com.skilrock.lms.web.reportsMgmt.common;

import java.io.IOException;
import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.Iterator;
import java.util.List;
import java.util.Locale;
import java.util.Map;

import jxl.WorkbookSettings;
import jxl.format.Alignment;
import jxl.format.Border;
import jxl.format.BorderLineStyle;
import jxl.format.Colour;
import jxl.format.UnderlineStyle;
import jxl.write.DateFormats;
import jxl.write.Label;
import jxl.write.Number;
import jxl.write.NumberFormats;
import jxl.write.WritableCellFormat;
import jxl.write.WritableFont;
import jxl.write.WritableSheet;
import jxl.write.WritableWorkbook;
import jxl.write.WriteException;
import jxl.write.biff.RowsExceededException;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

import com.skilrock.lms.beans.CashChqReportBean;
import com.skilrock.lms.beans.CompleteCollectionBean;
import com.skilrock.lms.beans.DateBeans;
import com.skilrock.lms.common.MyTextProvider;
import com.skilrock.lms.common.utility.TextConfigurator;

public class WriteExcelForComplCollReport extends MyTextProvider {
	private WritableCellFormat dateFormat;
<span class="nc" id="L42">	private int mainReportLength = 3;</span>
	private WritableCellFormat headerDateFormat;
	private WritableCellFormat headerFormat;
	private WritableCellFormat headingLabel;
	private WritableCellFormat headingNumberFormat;
<span class="nc" id="L47">	Log logger = LogFactory.getLog(WriteExcelForComplCollReport.class);</span>
	private WritableCellFormat numberFormat;
	private String reportType;
	private java.util.Date startDate, endDate, reportday;
	private WritableCellFormat times;
	private WritableCellFormat timesBoldUnderline;
	
	private Locale locale;

	public WriteExcelForComplCollReport(DateBeans dateBeans)
<span class="nc" id="L57">			throws WriteException {</span>
		
<span class="nc" id="L59">		locale = Locale.getDefault();</span>

<span class="nc" id="L61">		this.reportType = dateBeans.getReportType();</span>
<span class="nc" id="L62">		this.startDate = dateBeans.getStartDate();</span>
<span class="nc" id="L63">		this.endDate = dateBeans.getEndDate();</span>
<span class="nc" id="L64">		this.reportday = dateBeans.getReportday();</span>

<span class="nc" id="L66">		numberFormat = new WritableCellFormat(NumberFormats.FORMAT3);</span>
<span class="nc" id="L67">		numberFormat.setFont(new WritableFont(WritableFont.TIMES, 12));</span>
<span class="nc" id="L68">		numberFormat.setBorder(Border.ALL, BorderLineStyle.THIN);</span>
<span class="nc" id="L69">		numberFormat.setWrap(false);</span>

<span class="nc" id="L71">		times = new WritableCellFormat(new WritableFont(WritableFont.TIMES, 12));</span>
<span class="nc" id="L72">		times.setWrap(false);</span>
<span class="nc" id="L73">		times.setBorder(Border.ALL, BorderLineStyle.THIN);</span>

<span class="nc" id="L75">		timesBoldUnderline = new WritableCellFormat(new WritableFont(</span>
				WritableFont.TIMES, 12, WritableFont.BOLD, false,
				UnderlineStyle.NO_UNDERLINE));
<span class="nc" id="L78">		timesBoldUnderline.setWrap(false);</span>
<span class="nc" id="L79">		timesBoldUnderline.setAlignment(Alignment.CENTRE);</span>
<span class="nc" id="L80">		timesBoldUnderline.setBorder(Border.ALL, BorderLineStyle.MEDIUM);</span>
<span class="nc" id="L81">		timesBoldUnderline.setBackground(Colour.GREY_25_PERCENT);</span>

<span class="nc" id="L83">		dateFormat = new WritableCellFormat(DateFormats.FORMAT2);</span>
<span class="nc" id="L84">		dateFormat.setFont(new WritableFont(WritableFont.TIMES, 12,</span>
				WritableFont.BOLD));
<span class="nc" id="L86">		dateFormat.setWrap(false);</span>
<span class="nc" id="L87">		dateFormat.setAlignment(Alignment.RIGHT);</span>

<span class="nc" id="L89">		headerFormat = new WritableCellFormat(new WritableFont(</span>
				WritableFont.TIMES, 15));
<span class="nc" id="L91">		headerFormat.setWrap(false);</span>
<span class="nc" id="L92">		headerFormat.setAlignment(Alignment.CENTRE);</span>

<span class="nc" id="L94">		headerDateFormat = new WritableCellFormat(DateFormats.FORMAT4);</span>
<span class="nc" id="L95">		headerDateFormat.setFont(new WritableFont(WritableFont.TIMES, 12,</span>
				WritableFont.BOLD));
<span class="nc" id="L97">		headerDateFormat.setWrap(false);</span>
<span class="nc" id="L98">		headerDateFormat.setAlignment(Alignment.CENTRE);</span>

<span class="nc" id="L100">		headingLabel = new WritableCellFormat(new WritableFont(</span>
				WritableFont.TIMES, 12));
<span class="nc" id="L102">		headingLabel.setWrap(false);</span>
<span class="nc" id="L103">		headingLabel.setBorder(Border.ALL, BorderLineStyle.MEDIUM);</span>
<span class="nc" id="L104">		headingLabel.setAlignment(Alignment.LEFT);</span>
<span class="nc" id="L105">		headingLabel.setBackground(Colour.GRAY_25);</span>

<span class="nc" id="L107">		headingNumberFormat = new WritableCellFormat(NumberFormats.FORMAT3);</span>
<span class="nc" id="L108">		headingNumberFormat.setFont(new WritableFont(WritableFont.TIMES, 12));</span>
<span class="nc" id="L109">		headingNumberFormat.setWrap(false);</span>
<span class="nc" id="L110">		headingNumberFormat.setBorder(Border.ALL, BorderLineStyle.MEDIUM);</span>
<span class="nc" id="L111">		headingNumberFormat.setBackground(Colour.GRAY_25);</span>
<span class="nc" id="L112">	}</span>

	/**
	 * It create the table header of excel sheet.
	 * 
	 * @param sheet
	 * @param column
	 * @param row
	 * @param s
	 * @throws RowsExceededException
	 * @throws WriteException
	 */
	private void addCaption(WritableSheet sheet, int column, int row, String s)
			throws RowsExceededException, WriteException {
		Label headingLabel;
<span class="nc" id="L127">		headingLabel = new Label(column, row, s, timesBoldUnderline);</span>
<span class="nc bnc" id="L128" title="All 2 branches missed.">		if (s.equalsIgnoreCase(&quot;Agent Name&quot;)) {</span>
<span class="nc" id="L129">			sheet.setColumnView(column, 30);</span>
		} else {
<span class="nc" id="L131">			sheet.setColumnView(column, 20);</span>
		}
<span class="nc" id="L133">		sheet.addCell(headingLabel);</span>
<span class="nc" id="L134">	}</span>

	private void addLabel(WritableSheet sheet, int column, int row, Object s)
			throws WriteException, RowsExceededException {
		Label headingLabel;
<span class="nc" id="L139">		headingLabel = new Label(column, row, s.toString(), times);</span>
<span class="nc" id="L140">		sheet.addCell(headingLabel);</span>
<span class="nc" id="L141">	}</span>

	/**
	 * It insert the Number (float,double,long &amp; int) inside the excel sheet.
	 * 
	 * @param sheet
	 * @param column
	 * @param row
	 * @param amt
	 * @throws WriteException
	 * @throws RowsExceededException
	 */
	private void addNumber(WritableSheet sheet, int column, int row, Double amt)
			throws WriteException, RowsExceededException {
		Number headingNumberFormat;
<span class="nc" id="L156">		headingNumberFormat = new Number(column, row, amt, numberFormat);</span>
<span class="nc" id="L157">		sheet.addCell(headingNumberFormat);</span>
<span class="nc" id="L158">	}</span>

	private void createContent(WritableSheet sheet,
			Map&lt;String, CompleteCollectionBean&gt; reportMap, String orgName,
			String orgAdd, boolean isSE, boolean isDG, boolean isCS,
			boolean isOLA, boolean isSLE, boolean isIW) throws WriteException,
			RowsExceededException, ParseException {
<span class="nc" id="L165">		sheet.addCell(new Label(2, 1, orgName, headerFormat));</span>
<span class="nc" id="L166">		sheet.mergeCells(2, 1, 10, 1);</span>

<span class="nc" id="L168">		sheet.addCell(new Label(2, 2, orgAdd, headerFormat));</span>
<span class="nc" id="L169">		sheet.mergeCells(2, 2, 10, 2);</span>
<span class="nc" id="L170">		createHeaderForComplCollReport(sheet);</span>

<span class="nc" id="L172">		double totalDrawSale = 0.0;</span>
<span class="nc" id="L173">		double totalDrawPwt = 0.0;</span>
<span class="nc" id="L174">		double totalScratchSale = 0.0;</span>
<span class="nc" id="L175">		double totalScratchPwt = 0.0;</span>
<span class="nc" id="L176">		double totalOLADeposit = 0.0;</span>
<span class="nc" id="L177">		double totalOLAWithdraw = 0.0;</span>
<span class="nc" id="L178">		double totalOLANetGaming = 0.0;</span>
<span class="nc" id="L179">		double totalCSSale = 0.0;</span>
<span class="nc" id="L180">		double totalCashInHand = 0.0;</span>

<span class="nc" id="L182">		double totalSleSale = 0.0;</span>
<span class="nc" id="L183">		double totalSlePwt = 0.0;</span>
		
<span class="nc" id="L185">		double totalIwSale = 0.0;</span>
<span class="nc" id="L186">		double totalIwPwt = 0.0;</span>

		// add caption
<span class="nc" id="L189">		addCaption(sheet, 1, 5, getText(&quot;label.party.name&quot;));</span>
<span class="nc" id="L190">		sheet.mergeCells(1, 5, 3, 7);</span>
<span class="nc" id="L191">		int length = reportMap.size();</span>
<span class="nc" id="L192">		int colIndex = 4;</span>
<span class="nc bnc" id="L193" title="All 2 branches missed.">		if (isDG) {</span>
<span class="nc" id="L194">			addCaption(sheet, colIndex, 6, getText(&quot;label.draw.game&quot;));</span>
<span class="nc" id="L195">			sheet.mergeCells(colIndex, 6, colIndex+1, 6);</span>
<span class="nc" id="L196">			addCaption(sheet, colIndex, 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L197">			addCaption(sheet, colIndex+1, 7, getText(&quot;label.pwt.amt&quot;));</span>
<span class="nc" id="L198">			colIndex += 2;</span>
		}
<span class="nc bnc" id="L200" title="All 2 branches missed.">		if (isSE) {</span>
<span class="nc" id="L201">			addCaption(sheet, colIndex, 6, getText(&quot;label.scratch.game&quot;));</span>
<span class="nc" id="L202">			sheet.mergeCells(colIndex, 6, colIndex+1, 6);</span>
<span class="nc" id="L203">			addCaption(sheet, colIndex, 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L204">			addCaption(sheet, colIndex+1, 7, getText(&quot;label.pwt.amt&quot;));</span>
<span class="nc" id="L205">			colIndex += 2;</span>
		}
<span class="nc bnc" id="L207" title="All 2 branches missed.">		if (isCS) {</span>
<span class="nc" id="L208">			addCaption(sheet, colIndex, 6, getText(&quot;label.com.srv&quot;));</span>
<span class="nc" id="L209">			sheet.mergeCells(colIndex, 6, colIndex, 6);</span>
<span class="nc" id="L210">			addCaption(sheet, colIndex, 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L211">			colIndex += 1;</span>
		}
<span class="nc bnc" id="L213" title="All 2 branches missed.">		if (isOLA) {</span>
<span class="nc" id="L214">			addCaption(sheet, colIndex, 6, getText(&quot;label.offline.aff&quot;));</span>
<span class="nc" id="L215">			sheet.mergeCells(colIndex, 6, colIndex+2, 6);</span>
<span class="nc" id="L216">			addCaption(sheet, colIndex, 7, getText(&quot;label.deposit&quot;));</span>
<span class="nc" id="L217">			addCaption(sheet, colIndex+1, 7, getText(&quot;label.wdl.amt&quot;));</span>
<span class="nc" id="L218">			addCaption(sheet, colIndex+2, 7, getText(&quot;label.net.gaming.amt&quot;));</span>
<span class="nc" id="L219">			colIndex += 3;</span>
		}
<span class="nc bnc" id="L221" title="All 2 branches missed.">		if(isSLE){ </span>
<span class="nc" id="L222">			addCaption(sheet, colIndex, 6, getText(&quot;label.sport.lot&quot;));</span>
<span class="nc" id="L223">			sheet.mergeCells(colIndex, 6, colIndex+1, 6);</span>
<span class="nc" id="L224">			addCaption(sheet, colIndex, 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L225">			addCaption(sheet, colIndex+1, 7, getText(&quot;label.pwt.amt&quot;));</span>
<span class="nc" id="L226">			colIndex += 2;</span>
		}
<span class="nc bnc" id="L228" title="All 2 branches missed.">		if(isIW){ </span>
<span class="nc" id="L229">			addCaption(sheet, colIndex, 6, getText(&quot;label.instant.win&quot;));</span>
<span class="nc" id="L230">			sheet.mergeCells(colIndex, 6, colIndex+1, 6);</span>
<span class="nc" id="L231">			addCaption(sheet, colIndex, 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L232">			addCaption(sheet, colIndex+1, 7, getText(&quot;label.pwt.amt&quot;));</span>
<span class="nc" id="L233">			colIndex += 2;</span>
		}
		
<span class="nc" id="L236">		addCaption(sheet, 4, 5, getText(&quot;label.srv.name&quot;));</span>
<span class="nc" id="L237">		sheet.mergeCells(4, 5, colIndex-1, 5);</span>
		
<span class="nc" id="L239">		addCaption(sheet, colIndex, 5, getText(&quot;label.net.amt&quot;));</span>
<span class="nc" id="L240">		sheet.mergeCells(colIndex, 5, colIndex, 7);</span>

<span class="nc" id="L242">		int i = 0;</span>
<span class="nc" id="L243">		Iterator&lt;Map.Entry&lt;String, CompleteCollectionBean&gt;&gt; it = reportMap</span>
				.entrySet().iterator();
<span class="nc bnc" id="L245" title="All 2 branches missed.">		while (it.hasNext()) {</span>
<span class="nc" id="L246">			Map.Entry&lt;String, CompleteCollectionBean&gt; pair = it.next();</span>
<span class="nc" id="L247">			CompleteCollectionBean bean = new CompleteCollectionBean();</span>
<span class="nc" id="L248">			bean = pair.getValue();</span>
<span class="nc" id="L249">			addLabel(sheet, 1, i + 8, bean.getOrgName());</span>
<span class="nc" id="L250">			sheet.mergeCells(1, i + 8, 3, i + 8);</span>
			
<span class="nc" id="L252">			int dataStartIndex = 4;</span>
<span class="nc bnc" id="L253" title="All 2 branches missed.">			if (isDG) {</span>
<span class="nc" id="L254">				addNumber(sheet, dataStartIndex, i + 8, bean.getDrawSale() - bean.getDrawCancel());</span>
<span class="nc" id="L255">				totalDrawSale += bean.getDrawSale() - bean.getDrawCancel();</span>
<span class="nc" id="L256">				addNumber(sheet, dataStartIndex+1, i + 8, bean.getDrawPwt() + bean.getDrawDirPlyPwt());</span>
<span class="nc" id="L257">				totalDrawPwt += bean.getDrawPwt() + bean.getDrawDirPlyPwt();</span>
				
<span class="nc" id="L259">				dataStartIndex += 2;</span>
			}
<span class="nc bnc" id="L261" title="All 2 branches missed.">			if (isSE) {</span>
<span class="nc" id="L262">				addNumber(sheet, dataStartIndex, i + 8, bean.getScratchSale());</span>
<span class="nc" id="L263">				totalScratchSale += bean.getScratchSale();</span>
<span class="nc" id="L264">				addNumber(sheet, dataStartIndex+1, i + 8, bean.getScratchPwt() + bean.getScratchDirPlyPwt());</span>
<span class="nc" id="L265">				totalScratchSale += bean.getScratchPwt() + bean.getScratchDirPlyPwt();</span>
				
<span class="nc" id="L267">				dataStartIndex += 2;</span>
			}
<span class="nc bnc" id="L269" title="All 2 branches missed.">			if (isCS) {</span>
<span class="nc" id="L270">				addNumber(sheet, dataStartIndex, i + 8, bean.getCSSale() - bean.getCSCancel());</span>
<span class="nc" id="L271">				totalCSSale += bean.getCSSale() - bean.getCSCancel();</span>
				
<span class="nc" id="L273">				dataStartIndex += 1;</span>
			}
<span class="nc bnc" id="L275" title="All 2 branches missed.">			if (isOLA) {</span>
<span class="nc" id="L276">				addNumber(sheet, dataStartIndex, i + 8, bean.getOlaDepositAmt() - bean.getOlaDepositCancelAmt());</span>
<span class="nc" id="L277">				totalOLADeposit += bean.getOlaDepositAmt() - bean.getOlaDepositCancelAmt();</span>
<span class="nc" id="L278">				addNumber(sheet, dataStartIndex+1, i + 8, bean.getOlaWithdrawalAmt());</span>
<span class="nc" id="L279">				totalOLAWithdraw += bean.getOlaWithdrawalAmt();</span>
<span class="nc" id="L280">				addNumber(sheet, dataStartIndex+2, i + 8, bean.getOlaNetGaming());</span>
<span class="nc" id="L281">				totalOLANetGaming += bean.getOlaNetGaming();</span>
				
<span class="nc" id="L283">				dataStartIndex += 3;</span>
			}
<span class="nc bnc" id="L285" title="All 2 branches missed.">			if (isSLE) { </span>
<span class="nc" id="L286">				addNumber(sheet, dataStartIndex, i + 8, bean.getSleSale() - bean.getSleCancel()); </span>
<span class="nc" id="L287">				totalSleSale += bean.getSleSale() - bean.getSleCancel(); </span>
<span class="nc" id="L288">				addNumber(sheet, dataStartIndex+1, i + 8, bean.getSlePwt() + bean.getSleDirPlyPwt()); </span>
<span class="nc" id="L289">				totalSlePwt += bean.getSlePwt() + bean.getSleDirPlyPwt();</span>
				
<span class="nc" id="L291">				dataStartIndex += 2;</span>
			}
<span class="nc bnc" id="L293" title="All 2 branches missed.">			if (isIW) { </span>
<span class="nc" id="L294">				addNumber(sheet, dataStartIndex, i + 8, bean.getIwSale() - bean.getIwCancel()); </span>
<span class="nc" id="L295">				totalIwSale += bean.getIwSale() - bean.getIwCancel(); </span>
<span class="nc" id="L296">				addNumber(sheet, dataStartIndex+1, i + 8, bean.getIwPwt() + bean.getIwDirPlyPwt()); </span>
<span class="nc" id="L297">				totalIwPwt += bean.getIwPwt() + bean.getIwDirPlyPwt();</span>
				
<span class="nc" id="L299">				dataStartIndex += 2;</span>
			}
			
<span class="nc" id="L302">			bean.setTotalCashInHand(bean.getDrawSale()</span>
					- bean.getDrawCancel() - bean.getDrawPwt()
					- bean.getDrawDirPlyPwt() 
					+ bean.getScratchSale() - bean.getScratchPwt()
					- bean.getScratchDirPlyPwt()
					+ bean.getCSSale() - bean.getCSCancel()
					+ bean.getOlaDepositAmt() - bean.getOlaDepositCancelAmt()
					- bean.getOlaWithdrawalAmt() - bean.getOlaNetGaming()
					+ bean.getSleSale()
					- bean.getSleCancel()
					- bean.getSlePwt() - bean.getSleDirPlyPwt()
					+ bean.getIwSale()
					- bean.getIwCancel()
					- bean.getIwPwt() - bean.getIwDirPlyPwt());
			
<span class="nc" id="L317">			addNumber(sheet, dataStartIndex, i + 8, bean.getTotalCashInHand());</span>
<span class="nc" id="L318">			totalCashInHand += bean.getTotalCashInHand();</span>
<span class="nc" id="L319">			sheet.mergeCells(dataStartIndex, i + 8, dataStartIndex, i + 8);</span>

<span class="nc" id="L321">			i++;</span>
<span class="nc" id="L322">		}</span>
<span class="nc" id="L323">		addCaption(sheet, 1, length + 8, getText(&quot;label.total&quot;));</span>
<span class="nc" id="L324">		sheet.mergeCells(1, length + 8, 3, length + 8);</span>
		
<span class="nc" id="L326">		colIndex = 4;</span>
<span class="nc bnc" id="L327" title="All 2 branches missed.">		if (isDG) {</span>
<span class="nc" id="L328">			sheet.addCell(new Number(colIndex, length + 8, totalDrawSale,</span>
					headingNumberFormat));
<span class="nc" id="L330">			sheet.addCell(new Number(colIndex+1, length + 8, totalDrawPwt,</span>
					headingNumberFormat));
<span class="nc" id="L332">			colIndex += 2;</span>
		}
<span class="nc bnc" id="L334" title="All 2 branches missed.">		if (isSE) {</span>
<span class="nc" id="L335">			sheet.addCell(new Number(colIndex, length + 8, totalScratchSale,</span>
					headingNumberFormat));
<span class="nc" id="L337">			sheet.addCell(new Number(colIndex+1, length + 8, totalScratchPwt,</span>
					headingNumberFormat));
<span class="nc" id="L339">			colIndex += 2;</span>
		}
<span class="nc bnc" id="L341" title="All 2 branches missed.">		if (isCS) {</span>
<span class="nc" id="L342">			sheet.addCell(new Number(colIndex, length + 8, totalCSSale,</span>
					headingNumberFormat));
<span class="nc" id="L344">			colIndex += 1;</span>
		}
<span class="nc bnc" id="L346" title="All 2 branches missed.">		if (isOLA) {</span>
<span class="nc" id="L347">			sheet.addCell(new Number(colIndex, length + 8, totalOLADeposit,</span>
					headingNumberFormat));
<span class="nc" id="L349">			sheet.addCell(new Number(colIndex+1, length + 8, totalOLAWithdraw,</span>
					headingNumberFormat));
<span class="nc" id="L351">			sheet.addCell(new Number(colIndex+2, length + 8, totalOLANetGaming,</span>
					headingNumberFormat));
<span class="nc" id="L353">			colIndex += 3;</span>
		}
<span class="nc bnc" id="L355" title="All 2 branches missed.">		if (isSLE) {</span>
<span class="nc" id="L356">			sheet.addCell(new Number(colIndex, length + 8, totalSleSale,</span>
					headingNumberFormat));
<span class="nc" id="L358">			sheet.addCell(new Number(colIndex+1, length + 8, totalSlePwt,</span>
					headingNumberFormat));
<span class="nc" id="L360">			colIndex += 2;</span>
		}
<span class="nc bnc" id="L362" title="All 2 branches missed.">		if (isIW) {</span>
<span class="nc" id="L363">			sheet.addCell(new Number(colIndex, length + 8, totalIwSale,</span>
					headingNumberFormat));
<span class="nc" id="L365">			sheet.addCell(new Number(colIndex+1, length + 8, totalIwPwt,</span>
					headingNumberFormat));
<span class="nc" id="L367">			colIndex += 2;</span>
		}
		
<span class="nc" id="L370">		sheet.addCell(new Number(colIndex, length + 8, totalCashInHand,</span>
				headingNumberFormat));
		
<span class="nc" id="L373">		mainReportLength = length + 6 + 2;</span>
<span class="nc" id="L374">	}</span>

	/**
	 * It creates Contents of excels sheet. It iterate the list &amp; put the data
	 * into rows.
	 * 
	 * @param sheet
	 * @param reportlist
	 * @param agentBoDetail
	 * @throws WriteException
	 * @throws RowsExceededException
	 * @throws ParseException
	 */
	private void createContentOfAgentSheet(WritableSheet sheet,
			List&lt;CashChqReportBean&gt; reportlist, CashChqReportBean agentBoDetail)
			throws WriteException, RowsExceededException, ParseException {

<span class="nc" id="L391">		createHeaderForComplCollReport(sheet);</span>
		// add caption

<span class="nc" id="L394">		addCaption(sheet, 0, 4, getText(&quot;label.cash.chq.rep.with.bo&quot;));</span>
<span class="nc" id="L395">		sheet.mergeCells(0, 4, 3, 4);</span>

<span class="nc" id="L397">		addCaption(sheet, 0, 5, getText(&quot;label.cash.depo&quot;));</span>
<span class="nc" id="L398">		addCaption(sheet, 1, 5, getText(&quot;label.chq.depo&quot;));</span>
<span class="nc" id="L399">		addCaption(sheet, 2, 5, getText(&quot;label.chq.bounce&quot;));</span>
<span class="nc" id="L400">		addCaption(sheet, 3, 5, getText(&quot;Credit_Note&quot;));</span>
<span class="nc" id="L401">		addCaption(sheet, 4, 5, getText(&quot;Debit_Note&quot;));</span>
<span class="nc" id="L402">		addCaption(sheet, 5, 5, getText(&quot;label.net.depo&quot;));</span>

<span class="nc bnc" id="L404" title="All 2 branches missed.">		if (agentBoDetail != null) {</span>
<span class="nc" id="L405">			addNumber(sheet, 0, 6, Double.parseDouble(agentBoDetail</span>
					.getTotalCash()));
<span class="nc" id="L407">			addNumber(sheet, 1, 6, Double.parseDouble(agentBoDetail</span>
					.getTotalChq()));
<span class="nc" id="L409">			addNumber(sheet, 2, 6, Double.parseDouble(agentBoDetail</span>
					.getCheqBounce()));
<span class="nc" id="L411">			addNumber(sheet, 3, 6, Double</span>
					.parseDouble(agentBoDetail.getCredit()));
<span class="nc" id="L413">			addNumber(sheet, 4, 6, Double.parseDouble(agentBoDetail.getDebit()));</span>
<span class="nc" id="L414">			addNumber(sheet, 5, 6, Double</span>
					.parseDouble(agentBoDetail.getNetAmt()));
		} else {
<span class="nc" id="L417">			addNumber(sheet, 0, 6, 0.0);</span>
<span class="nc" id="L418">			addNumber(sheet, 1, 6, 0.0);</span>
<span class="nc" id="L419">			addNumber(sheet, 2, 6, 0.0);</span>
<span class="nc" id="L420">			addNumber(sheet, 3, 6, 0.0);</span>
<span class="nc" id="L421">			addNumber(sheet, 4, 6, 0.0);</span>
<span class="nc" id="L422">			addNumber(sheet, 5, 6, 0.0);</span>
		}

<span class="nc" id="L425">		addCaption(sheet, 0, 8, getText(&quot;label.cash.chq&quot;) + &quot; &quot;</span>
				+ TextConfigurator.getText(&quot;Collection&quot;) + &quot; &quot;
				+ getText(&quot;label.from&quot;) + &quot; &quot;
				+ getText(&quot;Retailer&quot;));
<span class="nc" id="L429">		sheet.mergeCells(0, 8, 4, 8);</span>

<span class="nc" id="L431">		addCaption(sheet, 0, 9, getText(&quot;label.party.name&quot;));</span>
<span class="nc" id="L432">		addCaption(sheet, 1, 9, getText(&quot;label.cash.colln&quot;));</span>
<span class="nc" id="L433">		addCaption(sheet, 2, 9, getText(&quot;label.chq.colln&quot;));</span>
<span class="nc" id="L434">		addCaption(sheet, 3, 9, getText(&quot;label.chq.bounce&quot;));</span>
<span class="nc" id="L435">		addCaption(sheet, 4, 9, getText(&quot;Debit_Note&quot;));</span>
<span class="nc" id="L436">		addCaption(sheet, 5, 9, getText(&quot;label.net.coll&quot;));</span>

<span class="nc" id="L438">		double cashColl = 0.0;</span>
<span class="nc" id="L439">		double chqColl = 0.0;</span>
<span class="nc" id="L440">		double chqBounce = 0.0;</span>
<span class="nc" id="L441">		double netColl = 0.0;</span>
<span class="nc" id="L442">		double netDebit = 0.0;</span>

<span class="nc" id="L444">		int length = reportlist.size();</span>
<span class="nc" id="L445">		CashChqReportBean bean = null;</span>
		// sheet.insertRow(1);
<span class="nc bnc" id="L447" title="All 2 branches missed.">		for (int i = 0; i &lt; length; i++) {</span>
<span class="nc" id="L448">			bean = reportlist.get(i);</span>

<span class="nc" id="L450">			cashColl += Double.parseDouble(bean.getTotalCash());</span>
<span class="nc" id="L451">			chqColl += Double.parseDouble(bean.getTotalChq());</span>
<span class="nc" id="L452">			chqBounce += Double.parseDouble(bean.getCheqBounce());</span>
<span class="nc" id="L453">			netColl += Double.parseDouble(bean.getNetAmt());</span>
<span class="nc" id="L454">			netDebit += Double.parseDouble(bean.getDebit());</span>

<span class="nc" id="L456">			addLabel(sheet, 0, i + 10, bean.getName());</span>
<span class="nc" id="L457">			addNumber(sheet, 1, i + 10, Double.parseDouble(bean.getTotalCash()));</span>
<span class="nc" id="L458">			addNumber(sheet, 2, i + 10, Double.parseDouble(bean.getTotalChq()));</span>
<span class="nc" id="L459">			addNumber(sheet, 3, i + 10, Double</span>
					.parseDouble(bean.getCheqBounce()));
<span class="nc" id="L461">			addNumber(sheet, 4, i + 10, Double.parseDouble(bean.getDebit()));</span>
<span class="nc" id="L462">			addNumber(sheet, 5, i + 10, Double.parseDouble(bean.getNetAmt()));</span>

		}

<span class="nc" id="L466">		sheet.addCell(new Label(0, length + 10, getText(&quot;label.total&quot;), headingLabel));</span>
<span class="nc" id="L467">		sheet</span>
				.addCell(new Number(1, length + 10, cashColl,
						headingNumberFormat));
<span class="nc" id="L470">		sheet.addCell(new Number(2, length + 10, chqColl, headingNumberFormat));</span>
<span class="nc" id="L471">		sheet</span>
				.addCell(new Number(3, length + 10, chqBounce,
						headingNumberFormat));
<span class="nc" id="L474">		sheet</span>
				.addCell(new Number(4, length + 10, netDebit,
						headingNumberFormat));
<span class="nc" id="L477">		sheet.addCell(new Number(5, length + 10, netColl, headingNumberFormat));</span>

<span class="nc" id="L479">	}</span>

	private void createDetailContentForAgentWise(WritableSheet sheet,
			CompleteCollectionBean agtTotalBean,
			Map&lt;String, CompleteCollectionBean&gt; detailDataMap, String orgName,
			String orgAdd, Double drawDirPlrPwt, Double scratchDirPlrPwt,
			Double sleDirPlrPwt,
			Double iwDirPlrPwt, boolean isSE, boolean isDG, boolean isCS,
			boolean isOLA, boolean isSLE, boolean isIW) throws WriteException,
			RowsExceededException, ParseException {
<span class="nc" id="L489">		createHeaderForComplCollReport(sheet);</span>

<span class="nc" id="L491">		sheet.addCell(new Label(2, 1, orgName, headerFormat));</span>
<span class="nc" id="L492">		sheet.mergeCells(2, 1, 10, 1);</span>

<span class="nc" id="L494">		sheet.addCell(new Label(2, 2, orgAdd, headerFormat));</span>
<span class="nc" id="L495">		sheet.mergeCells(2, 2, 10, 2);</span>
<span class="nc" id="L496">		createHeaderForComplCollReport(sheet);</span>

<span class="nc" id="L498">		double totalDrawSale = 0.0;</span>
<span class="nc" id="L499">		double totalDrawPwt = 0.0;</span>
<span class="nc" id="L500">		double totalScratchSale = 0.0;</span>
<span class="nc" id="L501">		double totalScratchPwt = 0.0;</span>
<span class="nc" id="L502">		double totalCSSale = 0.0;</span>
<span class="nc" id="L503">		double totalCashInHand = 0.0;</span>
<span class="nc" id="L504">		double totalOLADeposit = 0.0;</span>
<span class="nc" id="L505">		double totalOLAWithdraw = 0.0;</span>
<span class="nc" id="L506">		double totalOLANetGaming = 0.0;</span>

<span class="nc" id="L508">		double totalSleSale = 0.0;</span>
<span class="nc" id="L509">		double totalSlePwt = 0.0;</span>
		
<span class="nc" id="L511">		double totalIwSale = 0.0;</span>
<span class="nc" id="L512">		double totalIwPwt = 0.0;</span>

		// add caption
<span class="nc" id="L515">		addCaption(sheet, 1, 5, getText(&quot;label.party.name&quot;));</span>
<span class="nc" id="L516">		sheet.mergeCells(1, 5, 3, 7);</span>
<span class="nc" id="L517">		int colIndex = 4;</span>
<span class="nc bnc" id="L518" title="All 2 branches missed.">		if (isDG) {</span>
<span class="nc" id="L519">			addCaption(sheet, colIndex, 6, getText(&quot;label.draw.game&quot;));</span>
<span class="nc" id="L520">			sheet.mergeCells(colIndex, 6, colIndex+1, 6);</span>
<span class="nc" id="L521">			addCaption(sheet, colIndex, 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L522">			addCaption(sheet, colIndex+1, 7, getText(&quot;label.pwt.amt&quot;));</span>
<span class="nc" id="L523">			colIndex += 2;</span>
		}
<span class="nc bnc" id="L525" title="All 2 branches missed.">		if (isSE) {</span>
<span class="nc" id="L526">			addCaption(sheet, colIndex, 6, getText(&quot;label.scratch.game&quot;));</span>
<span class="nc" id="L527">			sheet.mergeCells(colIndex, 6, colIndex+1, 6);</span>
<span class="nc" id="L528">			addCaption(sheet, colIndex, 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L529">			addCaption(sheet, colIndex+1, 7, getText(&quot;label.pwt.amt&quot;));</span>
<span class="nc" id="L530">			colIndex += 2;</span>
		}
<span class="nc bnc" id="L532" title="All 2 branches missed.">		if (isCS) {</span>
<span class="nc" id="L533">			addCaption(sheet, colIndex, 6, getText(&quot;label.com.srv&quot;));</span>
<span class="nc" id="L534">			sheet.mergeCells(colIndex, 6, colIndex, 6);</span>
<span class="nc" id="L535">			addCaption(sheet, colIndex, 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L536">			colIndex += 1;</span>
		}
<span class="nc bnc" id="L538" title="All 2 branches missed.">		if (isOLA) {</span>
<span class="nc" id="L539">			addCaption(sheet, colIndex, 6, getText(&quot;label.offline.aff&quot;));</span>
<span class="nc" id="L540">			sheet.mergeCells(colIndex, 6, colIndex+2, 6);</span>
<span class="nc" id="L541">			addCaption(sheet, colIndex, 7, getText(&quot;label.deposit&quot;));</span>
<span class="nc" id="L542">			addCaption(sheet, colIndex+1, 7, getText(&quot;label.wdl.amt&quot;));</span>
<span class="nc" id="L543">			addCaption(sheet, colIndex+2, 7, getText(&quot;label.net.gaming.amt&quot;));</span>
<span class="nc" id="L544">			colIndex += 3;</span>
		}
<span class="nc bnc" id="L546" title="All 2 branches missed.">		if(isSLE){ </span>
<span class="nc" id="L547">			addCaption(sheet, colIndex, 6, getText(&quot;label.sport.lot&quot;));</span>
<span class="nc" id="L548">			sheet.mergeCells(colIndex, 6, colIndex+1, 6);</span>
<span class="nc" id="L549">			addCaption(sheet, colIndex, 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L550">			addCaption(sheet, colIndex+1, 7, getText(&quot;label.pwt.amt&quot;));</span>
<span class="nc" id="L551">			colIndex += 2;</span>
		}
<span class="nc bnc" id="L553" title="All 2 branches missed.">		if(isIW){ </span>
<span class="nc" id="L554">			addCaption(sheet, colIndex, 6, getText(&quot;label.instant.win&quot;));</span>
<span class="nc" id="L555">			sheet.mergeCells(colIndex, 6, colIndex+1, 6);</span>
<span class="nc" id="L556">			addCaption(sheet, colIndex, 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L557">			addCaption(sheet, colIndex+1, 7, getText(&quot;label.pwt.amt&quot;));</span>
<span class="nc" id="L558">			colIndex += 2;</span>
		}
		
<span class="nc" id="L561">		addCaption(sheet, 4, 5, getText(&quot;label.srv.name&quot;));</span>
<span class="nc" id="L562">		sheet.mergeCells(4, 5, colIndex-1, 5);</span>
		
<span class="nc" id="L564">		addCaption(sheet, colIndex, 5, getText(&quot;label.net.amt&quot;));</span>
<span class="nc" id="L565">		sheet.mergeCells(colIndex, 5, colIndex, 7);</span>
		
<span class="nc bnc" id="L567" title="All 2 branches missed.">		if (isDG) {</span>
<span class="nc" id="L568">			sheet.mergeCells(4, 5, 5, 5);</span>
<span class="nc" id="L569">			addCaption(sheet, 4, 6, getText(&quot;label.draw.game&quot;));</span>
		}
<span class="nc bnc" id="L571" title="All 2 branches missed.">		if (isSE) {</span>
<span class="nc" id="L572">			sheet.mergeCells(4, 5, 5, 5);</span>
<span class="nc" id="L573">			addCaption(sheet, 4, 6, getText(&quot;label.scratch.game&quot;));</span>
		}
<span class="nc bnc" id="L575" title="All 2 branches missed.">		if (isCS) {</span>
<span class="nc" id="L576">			sheet.mergeCells(4, 5, 5, 5);</span>
<span class="nc" id="L577">			addCaption(sheet, 4, 6, getText(&quot;label.com.srv&quot;));</span>
		}
<span class="nc bnc" id="L579" title="All 2 branches missed.">		if (isOLA) {</span>
<span class="nc" id="L580">			sheet.mergeCells(4, 5, 6, 5);</span>
<span class="nc" id="L581">			addCaption(sheet, 4, 6, getText(&quot;label.offline.aff&quot;));</span>
		}
<span class="nc bnc" id="L583" title="All 2 branches missed.">		if (isSLE) {</span>
<span class="nc" id="L584">			sheet.mergeCells(4, 5, 5, 5);</span>
<span class="nc" id="L585">			addCaption(sheet, 4, 6, getText(&quot;label.sport.lot&quot;));</span>
		}
<span class="nc bnc" id="L587" title="All 2 branches missed.">		if (isIW) {</span>
<span class="nc" id="L588">			sheet.mergeCells(4, 5, 5, 5);</span>
<span class="nc" id="L589">			addCaption(sheet, 4, 6, getText(&quot;label.instant.win&quot;));</span>
		}

<span class="nc" id="L592">		int length = detailDataMap.size();</span>
<span class="nc" id="L593">		int i = 0;</span>
<span class="nc" id="L594">		Iterator&lt;Map.Entry&lt;String, CompleteCollectionBean&gt;&gt; it = detailDataMap</span>
				.entrySet().iterator();
<span class="nc bnc" id="L596" title="All 2 branches missed.">		while (it.hasNext()) {</span>
<span class="nc" id="L597">			Map.Entry&lt;String, CompleteCollectionBean&gt; pair = it.next();</span>
<span class="nc" id="L598">			CompleteCollectionBean bean = new CompleteCollectionBean();</span>
<span class="nc" id="L599">			bean = pair.getValue();</span>
<span class="nc" id="L600">			addLabel(sheet, 1, i + 8, bean.getOrgName());</span>
<span class="nc" id="L601">			sheet.mergeCells(1, i + 8, 3, i + 8);</span>
<span class="nc" id="L602">			int dataStartIndex = 4;</span>
<span class="nc bnc" id="L603" title="All 2 branches missed.">			if (isDG) {</span>
<span class="nc" id="L604">				addNumber(sheet, dataStartIndex, i + 8, bean.getDrawSale()</span>
						- bean.getDrawCancel());
<span class="nc" id="L606">				totalDrawSale += bean.getDrawSale() - bean.getDrawCancel();</span>
<span class="nc" id="L607">				addNumber(sheet, dataStartIndex+1, i + 8, bean.getDrawPwt()</span>
						+ bean.getDrawDirPlyPwt());
<span class="nc" id="L609">				totalDrawPwt += bean.getDrawPwt() + bean.getDrawDirPlyPwt();</span>
<span class="nc" id="L610">				dataStartIndex += 2;</span>
			}
<span class="nc bnc" id="L612" title="All 2 branches missed.">			if (isSE) {</span>
<span class="nc" id="L613">				addNumber(sheet, dataStartIndex, i + 8, bean.getScratchSale());</span>
<span class="nc" id="L614">				totalScratchSale += bean.getScratchSale();</span>
<span class="nc" id="L615">				addNumber(sheet, dataStartIndex+1, i + 8, bean.getScratchPwt()</span>
						+ bean.getScratchDirPlyPwt());
<span class="nc" id="L617">				dataStartIndex += 2;</span>
			}
<span class="nc bnc" id="L619" title="All 2 branches missed.">			if (isCS) {</span>
<span class="nc" id="L620">				addNumber(sheet, dataStartIndex, i + 8, bean.getCSSale()</span>
						- bean.getCSCancel());
<span class="nc" id="L622">				totalCSSale += bean.getCSSale() - bean.getCSCancel();</span>
<span class="nc" id="L623">				dataStartIndex += 1; </span>
			}
<span class="nc bnc" id="L625" title="All 2 branches missed.">			if (isOLA) {</span>
<span class="nc" id="L626">				addNumber(sheet, dataStartIndex, i + 8, bean.getOlaDepositAmt()</span>
						- bean.getOlaDepositCancelAmt());
<span class="nc" id="L628">				totalOLADeposit += bean.getOlaDepositAmt()</span>
						- bean.getOlaDepositCancelAmt();
<span class="nc" id="L630">				addNumber(sheet, dataStartIndex+1, i + 8, bean.getOlaWithdrawalAmt());</span>
<span class="nc" id="L631">				totalOLAWithdraw += bean.getOlaWithdrawalAmt();</span>
<span class="nc" id="L632">				addNumber(sheet, dataStartIndex+2, i + 8, bean.getOlaNetGaming());</span>
<span class="nc" id="L633">				totalOLANetGaming += bean.getOlaNetGaming();</span>
<span class="nc" id="L634">				dataStartIndex += 3; </span>
			}
<span class="nc bnc" id="L636" title="All 2 branches missed.">			if (isSLE) {</span>
<span class="nc" id="L637">				addNumber(sheet, dataStartIndex, i + 8, bean.getSleSale()</span>
						- bean.getSleCancel());
<span class="nc" id="L639">				totalSleSale += bean.getSleSale() - bean.getSleCancel();</span>
<span class="nc" id="L640">				addNumber(sheet, dataStartIndex+1, i + 8, bean.getSlePwt()</span>
						+ bean.getSleDirPlyPwt());
<span class="nc" id="L642">				totalSlePwt += bean.getSlePwt() + bean.getSleDirPlyPwt();</span>
<span class="nc" id="L643">				dataStartIndex += 2; </span>
			}
<span class="nc bnc" id="L645" title="All 2 branches missed.">			if (isIW) {</span>
<span class="nc" id="L646">				addNumber(sheet, dataStartIndex, i + 8, bean.getIwSale() - bean.getIwCancel());</span>
<span class="nc" id="L647">				totalIwSale += bean.getIwSale() - bean.getIwCancel();</span>
<span class="nc" id="L648">				addNumber(sheet, dataStartIndex+1, i + 8, bean.getIwPwt() + bean.getIwDirPlyPwt());</span>
<span class="nc" id="L649">				totalIwPwt += bean.getIwPwt() + bean.getIwDirPlyPwt();</span>
<span class="nc" id="L650">				dataStartIndex += 2; </span>
			}
<span class="nc" id="L652">			bean.setTotalCashInHand(bean.getDrawSale()</span>
					- bean.getDrawCancel() - bean.getDrawPwt()
					- bean.getDrawDirPlyPwt() 
					+ bean.getScratchSale() - bean.getScratchPwt()
					- bean.getScratchDirPlyPwt()
					+ bean.getCSSale() - bean.getCSCancel()
					+ bean.getOlaDepositAmt() - bean.getOlaDepositCancelAmt()
					- bean.getOlaWithdrawalAmt() - bean.getOlaNetGaming()
					+ bean.getSleSale()
					- bean.getSleCancel()
					- bean.getSlePwt() - bean.getSleDirPlyPwt()
					+ bean.getIwSale()
					- bean.getIwCancel()
					- bean.getIwPwt() - bean.getIwDirPlyPwt());
			
<span class="nc" id="L667">			addNumber(sheet, dataStartIndex, i + 8, bean.getTotalCashInHand());</span>
<span class="nc" id="L668">			totalCashInHand += bean.getTotalCashInHand();</span>
<span class="nc" id="L669">			sheet.mergeCells(dataStartIndex, i + 8, dataStartIndex, i + 8);</span>
<span class="nc" id="L670">			i++;</span>
<span class="nc" id="L671">		}</span>
<span class="nc" id="L672">		colIndex = 4;</span>
<span class="nc" id="L673">		addCaption(sheet, 1, length + 8, getText(&quot;label.total&quot;));</span>
<span class="nc" id="L674">		sheet.mergeCells(1, length + 8, 3, length + 8);</span>
<span class="nc" id="L675">		addCaption(sheet, 1, length + 9, getText(&quot;label.agt.total&quot;));</span>
<span class="nc" id="L676">		sheet.mergeCells(1, length + 9, 3, length + 9);</span>
<span class="nc bnc" id="L677" title="All 2 branches missed.">		if (isDG) {</span>
<span class="nc" id="L678">			sheet.addCell(new Number(colIndex, length + 8, totalDrawSale, headingNumberFormat));</span>
<span class="nc" id="L679">			sheet.addCell(new Number(colIndex+1, length + 8, totalDrawPwt, headingNumberFormat));</span>
			
<span class="nc" id="L681">			sheet.addCell(new Number(colIndex, length + 9, agtTotalBean.getDrawSale()</span>
					- agtTotalBean.getDrawCancel(), headingNumberFormat));
<span class="nc" id="L683">			sheet.addCell(new Number(colIndex+1, length + 9, agtTotalBean.getDrawPwt()</span>
					+ agtTotalBean.getDrawDirPlyPwt(), headingNumberFormat));
<span class="nc" id="L685">			colIndex += 2;</span>
		}
<span class="nc bnc" id="L687" title="All 2 branches missed.">		if (isSE) {</span>
<span class="nc" id="L688">			sheet.addCell(new Number(colIndex, length + 8, totalScratchSale, headingNumberFormat));</span>
<span class="nc" id="L689">			sheet.addCell(new Number(colIndex+1, length + 8, totalScratchPwt, headingNumberFormat));</span>
			
<span class="nc" id="L691">			sheet.addCell(new Number(colIndex, length + 9, agtTotalBean.getScratchSale(), headingNumberFormat));</span>
<span class="nc" id="L692">			sheet.addCell(new Number(colIndex+1, length + 9, agtTotalBean.getScratchPwt()</span>
					+ agtTotalBean.getScratchDirPlyPwt(), headingNumberFormat));
<span class="nc" id="L694">			colIndex += 2;</span>
		}
<span class="nc bnc" id="L696" title="All 2 branches missed.">		if (isCS) {</span>
<span class="nc" id="L697">			sheet.addCell(new Number(colIndex, length + 8, totalCSSale, headingNumberFormat));</span>
			
<span class="nc" id="L699">			sheet.addCell(new Number(colIndex, length + 9, agtTotalBean.getCSSale()</span>
					- agtTotalBean.getCSCancel(), headingNumberFormat));
<span class="nc" id="L701">			colIndex += 1;</span>
		}
<span class="nc bnc" id="L703" title="All 2 branches missed.">		if (isOLA) {</span>
<span class="nc" id="L704">			sheet.addCell(new Number(colIndex, length + 8, totalOLADeposit, headingNumberFormat));</span>
<span class="nc" id="L705">			sheet.addCell(new Number(colIndex+1, length + 8, totalOLAWithdraw, headingNumberFormat));</span>
<span class="nc" id="L706">			sheet.addCell(new Number(colIndex+2, length + 8, totalOLANetGaming, headingNumberFormat));</span>
			
<span class="nc" id="L708">			sheet.addCell(new Number(colIndex, length + 9, agtTotalBean.getOlaDepositAmt()</span>
					- agtTotalBean.getOlaDepositCancelAmt(),headingNumberFormat));
<span class="nc" id="L710">			sheet.addCell(new Number(colIndex+1, length + 9, agtTotalBean.getOlaWithdrawalAmt(), headingNumberFormat));</span>
<span class="nc" id="L711">			sheet.addCell(new Number(colIndex+2, length + 9, agtTotalBean.getOlaNetGaming(), headingNumberFormat));</span>
<span class="nc" id="L712">			colIndex += 3;</span>
		}
<span class="nc bnc" id="L714" title="All 2 branches missed.">		if (isSLE) {</span>
<span class="nc" id="L715">			sheet.addCell(new Number(colIndex, length + 8, totalSleSale, headingNumberFormat));</span>
<span class="nc" id="L716">			sheet.addCell(new Number(colIndex+1, length + 8, totalSlePwt, headingNumberFormat));</span>
			
<span class="nc" id="L718">			sheet.addCell(new Number(colIndex, length + 9, agtTotalBean.getSleSale()</span>
					- agtTotalBean.getSleCancel(), headingNumberFormat));
<span class="nc" id="L720">			sheet.addCell(new Number(colIndex+1, length + 9, agtTotalBean.getSlePwt()</span>
					+ agtTotalBean.getSleDirPlyPwt(), headingNumberFormat));
<span class="nc" id="L722">			colIndex += 2;</span>
		}
<span class="nc bnc" id="L724" title="All 2 branches missed.">		if (isIW) {</span>
<span class="nc" id="L725">			sheet.addCell(new Number(colIndex, length + 8, totalIwSale, headingNumberFormat));</span>
<span class="nc" id="L726">			sheet.addCell(new Number(colIndex+1, length + 8, totalIwPwt, headingNumberFormat));</span>
			
<span class="nc" id="L728">			sheet.addCell(new Number(colIndex, length + 9, agtTotalBean.getIwSale() - agtTotalBean.getIwCancel(), headingNumberFormat));</span>
<span class="nc" id="L729">			sheet.addCell(new Number(colIndex+1, length + 9, agtTotalBean.getIwPwt() + agtTotalBean.getIwDirPlyPwt(), headingNumberFormat));</span>
<span class="nc" id="L730">			colIndex += 2;</span>
		}
<span class="nc" id="L732">		sheet.addCell(new Number(colIndex, length + 8, totalCashInHand, headingNumberFormat));</span>
<span class="nc" id="L733">		sheet.addCell(new Number(colIndex, length + 9, agtTotalBean.getDrawSale()</span>
				- agtTotalBean.getDrawCancel() - agtTotalBean.getDrawPwt()
				- agtTotalBean.getDrawDirPlyPwt() 
				+ agtTotalBean.getScratchSale() - agtTotalBean.getScratchPwt()
				- agtTotalBean.getScratchDirPlyPwt()
				+ agtTotalBean.getCSSale() - agtTotalBean.getCSCancel()
				+ agtTotalBean.getOlaDepositAmt() - agtTotalBean.getOlaDepositCancelAmt()
				- agtTotalBean.getOlaWithdrawalAmt() - agtTotalBean.getOlaNetGaming()
				+ agtTotalBean.getSleSale() - agtTotalBean.getSleCancel()
				- agtTotalBean.getSlePwt() - agtTotalBean.getSleDirPlyPwt()
				+ agtTotalBean.getIwSale() - agtTotalBean.getIwCancel()
				- agtTotalBean.getIwPwt() - agtTotalBean.getIwDirPlyPwt(),
				headingNumberFormat));
		
<span class="nc" id="L747">		colIndex = 4;</span>
		
<span class="nc" id="L749">		sheet.addCell(new Label(colIndex, length + 11, </span>
				getText(&quot;label.rep.for.pwt.by.plr&quot;), headerFormat));
		
<span class="nc" id="L752">		addCaption(sheet, colIndex, length + 12, getText(&quot;label.org.name&quot;));</span>
<span class="nc" id="L753">		sheet.mergeCells(colIndex, length + 12, colIndex+1, length + 12);</span>
<span class="nc" id="L754">		addLabel(sheet, colIndex, length + 13, orgName);</span>
<span class="nc" id="L755">		sheet.mergeCells(colIndex, length + 13, colIndex+1, length + 12);</span>
<span class="nc" id="L756">		colIndex += 2;</span>
<span class="nc bnc" id="L757" title="All 2 branches missed.">		if (isDG) {</span>
<span class="nc" id="L758">			addCaption(sheet, colIndex, length + 12, getText(&quot;label.draw.game&quot;));</span>
<span class="nc" id="L759">			sheet.mergeCells(colIndex, length + 12, colIndex+1, length + 12);</span>
<span class="nc" id="L760">			addNumber(sheet, colIndex, length + 13, drawDirPlrPwt);</span>
<span class="nc" id="L761">			sheet.mergeCells(colIndex, length + 13, colIndex+1, length + 13);</span>
<span class="nc" id="L762">			colIndex += 2;</span>
		}
<span class="nc bnc" id="L764" title="All 2 branches missed.">		if (isSE) {</span>
<span class="nc" id="L765">			addCaption(sheet, colIndex, length + 12, getText(&quot;label.scratch.game&quot;));</span>
<span class="nc" id="L766">			sheet.mergeCells(colIndex, length + 12, colIndex+1, length + 12);</span>
<span class="nc" id="L767">			addNumber(sheet, colIndex, length + 13, scratchDirPlrPwt);</span>
<span class="nc" id="L768">			sheet.mergeCells(colIndex, length + 13, colIndex+1, length + 13);</span>
<span class="nc" id="L769">			colIndex += 2;</span>
		}
<span class="nc bnc" id="L771" title="All 2 branches missed.">		if (isSLE) {</span>
<span class="nc" id="L772">			addCaption(sheet,colIndex, length + 12, getText(&quot;label.sport.lot&quot;));</span>
<span class="nc" id="L773">			sheet.mergeCells(colIndex, length + 12, colIndex+1, length + 12);</span>
<span class="nc" id="L774">			addNumber(sheet, colIndex, length + 13, sleDirPlrPwt);</span>
<span class="nc" id="L775">			sheet.mergeCells(colIndex, length + 13, colIndex+1, length + 13);</span>
<span class="nc" id="L776">			colIndex += 2;</span>
		}
<span class="nc bnc" id="L778" title="All 2 branches missed.">		if (isIW) {</span>
<span class="nc" id="L779">			addCaption(sheet,colIndex, length + 12, getText(&quot;label.instant.win&quot;));</span>
<span class="nc" id="L780">			sheet.mergeCells(colIndex, length + 12, colIndex+1, length + 12);</span>
<span class="nc" id="L781">			addNumber(sheet, colIndex, length + 13, sleDirPlrPwt);</span>
<span class="nc" id="L782">			sheet.mergeCells(colIndex, length + 13, colIndex+1, length + 13);</span>
<span class="nc" id="L783">			colIndex += 2;</span>
		}
		//Merging columns for direct player heading! 
<span class="nc" id="L786">		sheet.mergeCells(4, length + 11, colIndex-1, length + 11);</span>
<span class="nc" id="L787">	}</span>

	private int createDetailContentForDayWise(WritableSheet sheet,
			Map&lt;String, CompleteCollectionBean&gt; dataMap, String orgName,
			String orgAdd, boolean isSE, boolean isDG, boolean isCS,
			boolean isOLA, boolean isSLE, boolean isIW, int length) throws WriteException,
			RowsExceededException, ParseException {
		// createHeaderForComplCollReport(sheet);

<span class="nc" id="L796">		sheet.addCell(new Label(2, length + 1, getText(&quot;label.sale&quot;)</span>
				+ &quot; &quot;
				+ TextConfigurator.getText(&quot;PWT&quot;)
				+ &quot; &quot;
				+ TextConfigurator.getText(&quot;Report&quot;)
				+ &quot; &quot;
				+ getText(&quot;label.day.wise&quot;)
				+ &quot; &quot;
				+ getText(&quot;label.for&quot;) + &quot; &quot; + orgName,
				headerFormat));
<span class="nc" id="L806">		sheet.mergeCells(2, length + 1, 6, length + 1);</span>

<span class="nc" id="L808">		double totalDrawSale = 0.0;</span>
<span class="nc" id="L809">		double totalDrawPwt = 0.0;</span>
<span class="nc" id="L810">		double totalScratchSale = 0.0;</span>
<span class="nc" id="L811">		double totalScratchPwt = 0.0;</span>
<span class="nc" id="L812">		double totalCSSale = 0.0;</span>
<span class="nc" id="L813">		double totalCashInHand = 0.0;</span>
<span class="nc" id="L814">		double totalOLADeposit = 0.0;</span>
<span class="nc" id="L815">		double totalOLAWithdraw = 0.0;</span>
<span class="nc" id="L816">		double totalOLANetGaming = 0.0;</span>

<span class="nc" id="L818">		double totalSleSale = 0.0;</span>
<span class="nc" id="L819">		double totalSlePwt = 0.0;</span>
		
<span class="nc" id="L821">		double totalIwSale = 0.0;</span>
<span class="nc" id="L822">		double totalIwPwt = 0.0;</span>

		// add caption
<span class="nc" id="L825">		addCaption(sheet, 1, length + 5, getText(&quot;label.party.name&quot;));</span>
<span class="nc" id="L826">		sheet.mergeCells(1, length + 5, 3, length + 7);</span>
<span class="nc" id="L827">		addCaption(sheet, 4, length + 5, getText(&quot;label.srv.name&quot;));</span>
<span class="nc" id="L828">		int len = dataMap.size();</span>
<span class="nc bnc" id="L829" title="All 6 branches missed.">		if (isSE &amp;&amp; isDG &amp;&amp; isCS) {</span>
<span class="nc" id="L830">			sheet.mergeCells(4, length + 5, 7, length + 5);</span>
<span class="nc" id="L831">			addCaption(sheet, 4, length + 6, getText(&quot;label.draw.game&quot;));</span>
<span class="nc" id="L832">			sheet.mergeCells(4, length + 6, 5, length + 6);</span>
<span class="nc" id="L833">			addCaption(sheet, 6, length + 6, getText(</span>
					&quot;label.scratch.game&quot;));
<span class="nc" id="L835">			sheet.mergeCells(6, length + 6, 7, length + 6);</span>
<span class="nc" id="L836">			addCaption(sheet, 7, length + 6, getText(&quot;label.com.srv&quot;));</span>
<span class="nc" id="L837">			sheet.mergeCells(7, length + 6, 7, length + 6);</span>

<span class="nc" id="L839">			addCaption(sheet, 8, length + 5, getText(&quot;label.net.amt&quot;));</span>
<span class="nc" id="L840">			sheet.mergeCells(8, length + 5, 9, length + 7);</span>

<span class="nc" id="L842">			addCaption(sheet, 4, length + 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L843">			addCaption(sheet, 5, length + 7, getText(&quot;label.pwt.amt&quot;));</span>
<span class="nc" id="L844">			addCaption(sheet, 6, length + 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L845">			addCaption(sheet, 7, length + 7, getText(&quot;label.pwt.amt&quot;));</span>
<span class="nc" id="L846">			addCaption(sheet, 8, length + 7, getText(&quot;label.sale.amt&quot;));</span>

<span class="nc bnc" id="L848" title="All 2 branches missed.">			if (len == 0) {</span>
<span class="nc" id="L849">				addLabel(sheet, 1, length + 6, getText(&quot;msg.no.record&quot;));</span>
<span class="nc" id="L850">				sheet.mergeCells(1, length + 6, 8, length + 6);</span>
			}
<span class="nc" id="L852">			int i = 0;</span>
<span class="nc" id="L853">			Iterator&lt;Map.Entry&lt;String, CompleteCollectionBean&gt;&gt; it = dataMap</span>
					.entrySet().iterator();
<span class="nc bnc" id="L855" title="All 2 branches missed.">			while (it.hasNext()) {</span>
<span class="nc" id="L856">				Map.Entry&lt;String, CompleteCollectionBean&gt; pair = it.next();</span>
<span class="nc" id="L857">				CompleteCollectionBean bean = new CompleteCollectionBean();</span>
<span class="nc" id="L858">				bean = pair.getValue();</span>
<span class="nc" id="L859">				addLabel(sheet, 1, i + length + 8, bean.getOrgName());</span>
<span class="nc" id="L860">				sheet.mergeCells(1, i + length + 8, 3, i + length + 8);</span>
<span class="nc" id="L861">				addNumber(sheet, 4, i + length + 8, bean.getDrawSale()</span>
						- bean.getDrawCancel());
<span class="nc" id="L863">				totalDrawSale += bean.getDrawSale() - bean.getDrawCancel();</span>
<span class="nc" id="L864">				addNumber(sheet, 5, i + length + 8, bean.getDrawPwt()</span>
						+ bean.getDrawDirPlyPwt());
<span class="nc" id="L866">				totalDrawPwt += bean.getDrawPwt() + bean.getDrawDirPlyPwt();</span>
<span class="nc" id="L867">				addNumber(sheet, 6, i + length + 8, bean.getScratchSale());</span>
<span class="nc" id="L868">				totalScratchSale += bean.getScratchSale();</span>
<span class="nc" id="L869">				addNumber(sheet, 7, i + length + 8, bean.getScratchPwt()</span>
						+ bean.getScratchDirPlyPwt());
<span class="nc" id="L871">				totalScratchPwt += bean.getScratchPwt()</span>
						+ bean.getScratchDirPlyPwt();
<span class="nc" id="L873">				addNumber(sheet, 8, i + length + 8, bean.getCSSale()</span>
						- bean.getCSCancel());
<span class="nc" id="L875">				totalCSSale += bean.getCSSale() - bean.getCSCancel();</span>
<span class="nc" id="L876">				bean.setTotalCashInHand(bean.getDrawSale()</span>
						- bean.getDrawCancel() - bean.getDrawPwt()
						- bean.getDrawDirPlyPwt() + bean.getScratchSale()
						- bean.getScratchPwt() - bean.getScratchDirPlyPwt()
						+ bean.getCSSale() - bean.getCSCancel());
<span class="nc" id="L881">				addNumber(sheet, 8, i + length + 8, bean.getTotalCashInHand());</span>
<span class="nc" id="L882">				totalCashInHand += bean.getTotalCashInHand();</span>
<span class="nc" id="L883">				sheet.mergeCells(8, i + length + 8, 9, i + length + 8);</span>
<span class="nc" id="L884">				i++;</span>
<span class="nc" id="L885">			}</span>
<span class="nc" id="L886">			addCaption(sheet, 1, len + length + 8, getText(</span>
					&quot;label.total&quot;));
<span class="nc" id="L888">			sheet.mergeCells(1, len + length + 8, 3, len + length + 8);</span>
<span class="nc" id="L889">			sheet.addCell(new Number(4, len + length + 8, totalDrawSale,</span>
					headingNumberFormat));
<span class="nc" id="L891">			sheet.addCell(new Number(5, len + length + 8, totalDrawPwt,</span>
					headingNumberFormat));
<span class="nc" id="L893">			sheet.addCell(new Number(6, len + length + 8, totalScratchSale,</span>
					headingNumberFormat));
<span class="nc" id="L895">			sheet.addCell(new Number(7, len + length + 8, totalScratchPwt,</span>
					headingNumberFormat));
<span class="nc" id="L897">			sheet.addCell(new Number(8, len + length + 8, totalCSSale,</span>
					headingNumberFormat));
<span class="nc" id="L899">			sheet.addCell(new Number(9, len + length + 8, totalCashInHand,</span>
					headingNumberFormat));
<span class="nc" id="L901">			sheet.mergeCells(9, len + length + 10, 9, len + length + 8);</span>
<span class="nc bnc" id="L902" title="All 6 branches missed.">		}  else if (isDG &amp;&amp; isSE &amp;&amp; isSLE) {</span>
<span class="nc" id="L903">			sheet.mergeCells(4, length + 5, 7, length + 5);</span>
<span class="nc" id="L904">			addCaption(sheet, 4, length + 6, getText(&quot;label.draw.game&quot;));</span>
<span class="nc" id="L905">			sheet.mergeCells(4, length + 6, 5, length + 6);</span>
<span class="nc" id="L906">			addCaption(sheet, 6, length + 6, getText(&quot;label.scratch.game&quot;));</span>
<span class="nc" id="L907">			sheet.mergeCells(6, length + 6, 7, length + 6);</span>
<span class="nc" id="L908">			addCaption(sheet, 8, length + 6, getText(&quot;label.sport.lot&quot;));</span>
<span class="nc" id="L909">			sheet.mergeCells(8, length + 6, 9, length + 6);</span>

<span class="nc" id="L911">			addCaption(sheet, 10, length + 5, getText(&quot;label.net.amt&quot;));</span>
<span class="nc" id="L912">			sheet.mergeCells(10, length + 5, 11, length + 7);</span>

<span class="nc" id="L914">			addCaption(sheet, 4, length + 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L915">			addCaption(sheet, 5, length + 7, getText(&quot;label.pwt.amt&quot;));</span>
<span class="nc" id="L916">			addCaption(sheet, 6, length + 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L917">			addCaption(sheet, 7, length + 7, getText(&quot;label.pwt.amt&quot;));</span>
<span class="nc" id="L918">			addCaption(sheet, 8, length + 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L919">			addCaption(sheet, 9, length + 7, getText(&quot;label.pwt.amt&quot;));</span>

<span class="nc bnc" id="L921" title="All 2 branches missed.">			if (len == 0) {</span>
<span class="nc" id="L922">				addLabel(sheet, 1, length + 6, getText(&quot;msg.no.record&quot;));</span>
<span class="nc" id="L923">				sheet.mergeCells(1, length + 6, 10, length + 6);</span>
			}
<span class="nc" id="L925">			int i = 0;</span>
<span class="nc" id="L926">			Iterator&lt;Map.Entry&lt;String, CompleteCollectionBean&gt;&gt; it = dataMap</span>
					.entrySet().iterator();
<span class="nc bnc" id="L928" title="All 2 branches missed.">			while (it.hasNext()) {</span>
<span class="nc" id="L929">				Map.Entry&lt;String, CompleteCollectionBean&gt; pair = it.next();</span>
<span class="nc" id="L930">				CompleteCollectionBean bean = new CompleteCollectionBean();</span>
<span class="nc" id="L931">				bean = pair.getValue();</span>
<span class="nc" id="L932">				addLabel(sheet, 1, i + length + 8, bean.getOrgName());</span>
<span class="nc" id="L933">				sheet.mergeCells(1, i + length + 8, 3, i + length + 8);</span>
<span class="nc" id="L934">				addNumber(sheet, 4, i + length + 8, bean.getDrawSale()</span>
						- bean.getDrawCancel());
<span class="nc" id="L936">				totalDrawSale += bean.getDrawSale() - bean.getDrawCancel();</span>
<span class="nc" id="L937">				addNumber(sheet, 5, i + length + 8, bean.getDrawPwt()</span>
						+ bean.getDrawDirPlyPwt());
<span class="nc" id="L939">				totalDrawPwt += bean.getDrawPwt() + bean.getDrawDirPlyPwt();</span>
<span class="nc" id="L940">				addNumber(sheet, 6, i + length + 8, bean.getScratchSale());</span>
<span class="nc" id="L941">				totalScratchSale += bean.getScratchSale();</span>
<span class="nc" id="L942">				addNumber(sheet, 7, i + length + 8, bean.getScratchPwt()</span>
						+ bean.getScratchDirPlyPwt());
<span class="nc" id="L944">				totalScratchPwt += bean.getScratchPwt()</span>
						+ bean.getScratchDirPlyPwt();
<span class="nc" id="L946">				addNumber(sheet, 8, i + length + 8, bean.getSleSale());</span>
<span class="nc" id="L947">				totalSleSale += bean.getSleSale();</span>
<span class="nc" id="L948">				addNumber(sheet, 9, i + length + 8, bean.getSlePwt()</span>
						+ bean.getSleDirPlyPwt());
<span class="nc" id="L950">				totalSlePwt += bean.getSlePwt() + bean.getSleDirPlyPwt();</span>
<span class="nc" id="L951">				bean.setTotalCashInHand(bean.getDrawSale()</span>
						- bean.getDrawCancel() - bean.getDrawPwt()
						- bean.getDrawDirPlyPwt() + bean.getScratchSale()
						- bean.getScratchPwt() - bean.getScratchDirPlyPwt()
						+ bean.getSleSale() - bean.getSleCancel()
						- bean.getSlePwt() - bean.getSleDirPlyPwt());
<span class="nc" id="L957">				addNumber(sheet, 10, i + length + 8, bean.getTotalCashInHand());</span>
<span class="nc" id="L958">				totalCashInHand += bean.getTotalCashInHand();</span>
<span class="nc" id="L959">				sheet.mergeCells(10, i + length + 8, 11, i + length + 8);</span>
<span class="nc" id="L960">				i++;</span>
<span class="nc" id="L961">			}</span>
<span class="nc" id="L962">			addCaption(sheet, 1, len + length + 8, getText(</span>
					&quot;label.total&quot;));
<span class="nc" id="L964">			sheet.mergeCells(1, len + length + 8, 3, len + length + 8);</span>
<span class="nc" id="L965">			sheet.addCell(new Number(4, len + length + 8, totalDrawSale,</span>
					headingNumberFormat));
<span class="nc" id="L967">			sheet.addCell(new Number(5, len + length + 8, totalDrawPwt,</span>
					headingNumberFormat));
<span class="nc" id="L969">			sheet.addCell(new Number(6, len + length + 8, totalScratchSale,</span>
					headingNumberFormat));
<span class="nc" id="L971">			sheet.addCell(new Number(7, len + length + 8, totalScratchPwt,</span>
					headingNumberFormat));
<span class="nc" id="L973">			sheet.addCell(new Number(8, len + length + 8, totalSleSale,</span>
					headingNumberFormat));
<span class="nc" id="L975">			sheet.addCell(new Number(9, len + length + 8, totalSlePwt,</span>
					headingNumberFormat));
<span class="nc" id="L977">			sheet.addCell(new Number(10, len + length + 8, totalCashInHand,</span>
					headingNumberFormat));
<span class="nc" id="L979">			sheet.mergeCells(10, len + length + 10, 11, len + length + 8);</span>
<span class="nc bnc" id="L980" title="All 6 branches missed.">		} else if (isDG &amp;&amp; isSE &amp;&amp; isIW) {</span>
<span class="nc" id="L981">			sheet.mergeCells(4, length + 5, 7, length + 5);</span>
<span class="nc" id="L982">			addCaption(sheet, 4, length + 6, getText(&quot;label.draw.game&quot;));</span>
<span class="nc" id="L983">			sheet.mergeCells(4, length + 6, 5, length + 6);</span>
<span class="nc" id="L984">			addCaption(sheet, 6, length + 6, getText(&quot;label.scratch.game&quot;));</span>
<span class="nc" id="L985">			sheet.mergeCells(6, length + 6, 7, length + 6);</span>
<span class="nc" id="L986">			addCaption(sheet, 8, length + 6, getText(&quot;label.instant.win&quot;));</span>
<span class="nc" id="L987">			sheet.mergeCells(8, length + 6, 9, length + 6);</span>

<span class="nc" id="L989">			addCaption(sheet, 10, length + 5, getText(&quot;label.net.amt&quot;));</span>
<span class="nc" id="L990">			sheet.mergeCells(10, length + 5, 11, length + 7);</span>

<span class="nc" id="L992">			addCaption(sheet, 4, length + 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L993">			addCaption(sheet, 5, length + 7, getText(&quot;label.pwt.amt&quot;));</span>
<span class="nc" id="L994">			addCaption(sheet, 6, length + 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L995">			addCaption(sheet, 7, length + 7, getText(&quot;label.pwt.amt&quot;));</span>
<span class="nc" id="L996">			addCaption(sheet, 8, length + 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L997">			addCaption(sheet, 9, length + 7, getText(&quot;label.pwt.amt&quot;));</span>

<span class="nc bnc" id="L999" title="All 2 branches missed.">			if (len == 0) {</span>
<span class="nc" id="L1000">				addLabel(sheet, 1, length + 6, getText(&quot;msg.no.record&quot;));</span>
<span class="nc" id="L1001">				sheet.mergeCells(1, length + 6, 10, length + 6);</span>
			}
<span class="nc" id="L1003">			int i = 0;</span>
<span class="nc" id="L1004">			Iterator&lt;Map.Entry&lt;String, CompleteCollectionBean&gt;&gt; it = dataMap</span>
					.entrySet().iterator();
<span class="nc bnc" id="L1006" title="All 2 branches missed.">			while (it.hasNext()) {</span>
<span class="nc" id="L1007">				Map.Entry&lt;String, CompleteCollectionBean&gt; pair = it.next();</span>
<span class="nc" id="L1008">				CompleteCollectionBean bean = new CompleteCollectionBean();</span>
<span class="nc" id="L1009">				bean = pair.getValue();</span>
<span class="nc" id="L1010">				addLabel(sheet, 1, i + length + 8, bean.getOrgName());</span>
<span class="nc" id="L1011">				sheet.mergeCells(1, i + length + 8, 3, i + length + 8);</span>
<span class="nc" id="L1012">				addNumber(sheet, 4, i + length + 8, bean.getDrawSale() - bean.getDrawCancel());</span>
<span class="nc" id="L1013">				totalDrawSale += bean.getDrawSale() - bean.getDrawCancel();</span>
<span class="nc" id="L1014">				addNumber(sheet, 5, i + length + 8, bean.getDrawPwt() + bean.getDrawDirPlyPwt());</span>
<span class="nc" id="L1015">				totalDrawPwt += bean.getDrawPwt() + bean.getDrawDirPlyPwt();</span>

<span class="nc" id="L1017">				addNumber(sheet, 6, i + length + 8, bean.getScratchSale());</span>
<span class="nc" id="L1018">				totalScratchSale += bean.getScratchSale();</span>
<span class="nc" id="L1019">				addNumber(sheet, 7, i + length + 8, bean.getScratchPwt() + bean.getScratchDirPlyPwt());</span>
<span class="nc" id="L1020">				totalScratchPwt += bean.getScratchPwt() + bean.getScratchDirPlyPwt();</span>

<span class="nc" id="L1022">				addNumber(sheet, 8, i + length + 8, bean.getIwSale());</span>
<span class="nc" id="L1023">				totalSleSale += bean.getIwSale();</span>
<span class="nc" id="L1024">				addNumber(sheet, 9, i + length + 8, bean.getIwPwt() + bean.getIwDirPlyPwt());</span>
<span class="nc" id="L1025">				totalSlePwt += bean.getIwPwt() + bean.getIwDirPlyPwt();</span>

<span class="nc" id="L1027">				bean.setTotalCashInHand(bean.getDrawSale()</span>
						- bean.getDrawCancel() - bean.getDrawPwt()
						- bean.getDrawDirPlyPwt() + bean.getScratchSale()
						- bean.getScratchPwt() - bean.getScratchDirPlyPwt()
						+ bean.getIwSale() - bean.getIwCancel()
						- bean.getIwPwt() - bean.getIwDirPlyPwt());
<span class="nc" id="L1033">				addNumber(sheet, 10, i + length + 8, bean.getTotalCashInHand());</span>
<span class="nc" id="L1034">				totalCashInHand += bean.getTotalCashInHand();</span>
<span class="nc" id="L1035">				sheet.mergeCells(10, i + length + 8, 11, i + length + 8);</span>
<span class="nc" id="L1036">				i++;</span>
<span class="nc" id="L1037">			}</span>
<span class="nc" id="L1038">			addCaption(sheet, 1, len + length + 8, getText(&quot;label.total&quot;));</span>
<span class="nc" id="L1039">			sheet.mergeCells(1, len + length + 8, 3, len + length + 8);</span>
<span class="nc" id="L1040">			sheet.addCell(new Number(4, len + length + 8, totalDrawSale,</span>
					headingNumberFormat));
<span class="nc" id="L1042">			sheet.addCell(new Number(5, len + length + 8, totalDrawPwt,</span>
					headingNumberFormat));
<span class="nc" id="L1044">			sheet.addCell(new Number(6, len + length + 8, totalScratchSale,</span>
					headingNumberFormat));
<span class="nc" id="L1046">			sheet.addCell(new Number(7, len + length + 8, totalScratchPwt,</span>
					headingNumberFormat));
<span class="nc" id="L1048">			sheet.addCell(new Number(8, len + length + 8, totalIwSale,</span>
					headingNumberFormat));
<span class="nc" id="L1050">			sheet.addCell(new Number(9, len + length + 8, totalIwPwt,</span>
					headingNumberFormat));
<span class="nc" id="L1052">			sheet.addCell(new Number(10, len + length + 8, totalCashInHand,</span>
					headingNumberFormat));
<span class="nc" id="L1054">			sheet.mergeCells(10, len + length + 10, 11, len + length + 8);</span>
<span class="nc bnc" id="L1055" title="All 4 branches missed.">		} else if (isDG &amp;&amp; isSLE) {</span>
<span class="nc" id="L1056">			sheet.mergeCells(4, length + 5, 7, length + 5);</span>
<span class="nc" id="L1057">			addCaption(sheet, 4, length + 6, getText(&quot;label.draw.game&quot;));</span>
<span class="nc" id="L1058">			sheet.mergeCells(4, length + 6, 5, length + 6);</span>
<span class="nc" id="L1059">			addCaption(sheet, 6, length + 6, getText(&quot;label.sport.lot&quot;));</span>
<span class="nc" id="L1060">			sheet.mergeCells(6, length + 6, 7, length + 6);</span>

<span class="nc" id="L1062">			addCaption(sheet, 8, length + 5, getText(&quot;label.net.amt&quot;));</span>
<span class="nc" id="L1063">			sheet.mergeCells(8, length + 5, 9, length + 7);</span>

<span class="nc" id="L1065">			addCaption(sheet, 4, length + 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L1066">			addCaption(sheet, 5, length + 7, getText(&quot;label.pwt.amt&quot;));</span>
<span class="nc" id="L1067">			addCaption(sheet, 6, length + 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L1068">			addCaption(sheet, 7, length + 7, getText(&quot;label.pwt.amt&quot;));</span>

<span class="nc bnc" id="L1070" title="All 2 branches missed.">			if (len == 0) {</span>
<span class="nc" id="L1071">				addLabel(sheet, 1, length + 6, getText(&quot;msg.no.record&quot;));</span>
<span class="nc" id="L1072">				sheet.mergeCells(1, length + 6, 7, length + 6);</span>
			}
<span class="nc" id="L1074">			int i = 0;</span>
<span class="nc" id="L1075">			Iterator&lt;Map.Entry&lt;String, CompleteCollectionBean&gt;&gt; it = dataMap</span>
					.entrySet().iterator();
<span class="nc bnc" id="L1077" title="All 2 branches missed.">			while (it.hasNext()) {</span>
<span class="nc" id="L1078">				Map.Entry&lt;String, CompleteCollectionBean&gt; pair = it.next();</span>
<span class="nc" id="L1079">				CompleteCollectionBean bean = new CompleteCollectionBean();</span>
<span class="nc" id="L1080">				bean = pair.getValue();</span>
<span class="nc" id="L1081">				addLabel(sheet, 1, i + length + 8, bean.getOrgName());</span>
<span class="nc" id="L1082">				sheet.mergeCells(1, i + length + 8, 3, i + length + 8);</span>
<span class="nc" id="L1083">				addNumber(sheet, 4, i + length + 8, bean.getDrawSale()</span>
						- bean.getDrawCancel());
<span class="nc" id="L1085">				totalDrawSale += bean.getDrawSale() - bean.getDrawCancel();</span>
<span class="nc" id="L1086">				addNumber(sheet, 5, i + length + 8, bean.getDrawPwt()</span>
						+ bean.getDrawDirPlyPwt());
<span class="nc" id="L1088">				totalDrawPwt += bean.getDrawPwt() + bean.getDrawDirPlyPwt();</span>
<span class="nc" id="L1089">				addNumber(sheet, 6, i + length + 8, bean.getSleSale());</span>
<span class="nc" id="L1090">				totalSleSale += bean.getSleSale();</span>
<span class="nc" id="L1091">				addNumber(sheet, 7, i + length + 8, bean.getSlePwt()</span>
						+ bean.getSleDirPlyPwt());
<span class="nc" id="L1093">				totalSlePwt += bean.getSlePwt() + bean.getSleDirPlyPwt();</span>
<span class="nc" id="L1094">				bean.setTotalCashInHand(bean.getDrawSale()</span>
						- bean.getDrawCancel() - bean.getDrawPwt()
						- bean.getDrawDirPlyPwt() + bean.getSleSale()
						- bean.getSleCancel() - bean.getSlePwt()
						- bean.getSleDirPlyPwt());
<span class="nc" id="L1099">				addNumber(sheet, 8, i + length + 8, bean.getTotalCashInHand());</span>
<span class="nc" id="L1100">				totalCashInHand += bean.getTotalCashInHand();</span>
<span class="nc" id="L1101">				sheet.mergeCells(8, i + length + 8, 9, i + length + 8);</span>
<span class="nc" id="L1102">				i++;</span>
<span class="nc" id="L1103">			}</span>
<span class="nc" id="L1104">			addCaption(sheet, 1, len + length + 8, getText(</span>
					&quot;label.total&quot;));
<span class="nc" id="L1106">			sheet.mergeCells(1, len + length + 8, 3, len + length + 8);</span>
<span class="nc" id="L1107">			sheet.addCell(new Number(4, len + length + 8, totalDrawSale,</span>
					headingNumberFormat));
<span class="nc" id="L1109">			sheet.addCell(new Number(5, len + length + 8, totalDrawPwt,</span>
					headingNumberFormat));
<span class="nc" id="L1111">			sheet.addCell(new Number(6, len + length + 8, totalSleSale,</span>
					headingNumberFormat));
<span class="nc" id="L1113">			sheet.addCell(new Number(7, len + length + 8, totalSlePwt,</span>
					headingNumberFormat));
<span class="nc" id="L1115">			sheet.addCell(new Number(8, len + length + 8, totalCashInHand,</span>
					headingNumberFormat));
<span class="nc" id="L1117">			sheet.mergeCells(8, len + length + 10, 9, len + length + 8);</span>
<span class="nc bnc" id="L1118" title="All 4 branches missed.">		} else if (isDG &amp;&amp; isIW) {</span>
<span class="nc" id="L1119">			sheet.mergeCells(4, length + 5, 7, length + 5);</span>
<span class="nc" id="L1120">			addCaption(sheet, 4, length + 6, getText(&quot;label.draw.game&quot;));</span>
<span class="nc" id="L1121">			sheet.mergeCells(4, length + 6, 5, length + 6);</span>
<span class="nc" id="L1122">			addCaption(sheet, 6, length + 6, getText(&quot;label.instant.win&quot;));</span>
<span class="nc" id="L1123">			sheet.mergeCells(6, length + 6, 7, length + 6);</span>

<span class="nc" id="L1125">			addCaption(sheet, 8, length + 5, getText(&quot;label.net.amt&quot;));</span>
<span class="nc" id="L1126">			sheet.mergeCells(8, length + 5, 9, length + 7);</span>

<span class="nc" id="L1128">			addCaption(sheet, 4, length + 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L1129">			addCaption(sheet, 5, length + 7, getText(&quot;label.pwt.amt&quot;));</span>
<span class="nc" id="L1130">			addCaption(sheet, 6, length + 7, getText(&quot;label.sale.amt&quot;));</span>
<span class="nc" id="L1131">			addCaption(sheet, 7, length + 7, getText(&quot;label.pwt.amt&quot;));</span>

<span class="nc bnc" id="L1133" title="All 2 branches missed.">			if (len == 0) {</span>
<span class="nc" id="L1134">				addLabel(sheet, 1, length + 6, getText(&quot;msg.no.record&quot;));</span>
<span class="nc" id="L1135">				sheet.mergeCells(1, length + 6, 7, length + 6);</span>
			}
<span class="nc" id="L1137">			int i = 0;</span>
<span class="nc" id="L1138">			Iterator&lt;Map.Entry&lt;String, CompleteCollectionBean&gt;&gt; it = dataMap</span>
					.entrySet().iterator();
<span class="nc bnc" id="L1140" title="All 2 branches missed.">			while (it.hasNext()) {</span>
<span class="nc" id="L1141">				Map.Entry&lt;String, CompleteCollectionBean&gt; pair = it.next();</span>
<span class="nc" id="L1142">				CompleteCollectionBean bean = new CompleteCollectionBean();</span>
<span class="nc" id="L1143">				bean = pair.getValue();</span>
<span class="nc" id="L1144">				addLabel(sheet, 1, i + length + 8, bean.getOrgName());</span>
<span class="nc" id="L1145">				sheet.mergeCells(1, i + length + 8, 3, i + length + 8);</span>
<span class="nc" id="L1146">				addNumber(sheet, 4, i + length + 8, bean.getDrawSale() - bean.getDrawCancel());</span>
<span class="nc" id="L1147">				totalDrawSale += bean.getDrawSale() - bean.getDrawCancel();</span>
<span class="nc" id="L1148">				addNumber(sheet, 5, i + length + 8, bean.getDrawPwt() + bean.getDrawDirPlyPwt());</span>
<span class="nc" id="L1149">				totalDrawPwt += bean.getDrawPwt() + bean.getDrawDirPlyPwt();</span>
<span class="nc" id="L1150">				addNumber(sheet, 6, i + length + 8, bean.getIwSale());</span>
<span class="nc" id="L1151">				totalIwSale += bean.getIwSale();</span>
<span class="nc" id="L1152">				addNumber(sheet, 7, i + length + 8, bean.getIwPwt() + bean.getIwDirPlyPwt());</span>
<span class="nc" id="L1153">				totalIwPwt += bean.getIwPwt() + bean.getIwDirPlyPwt();</span>
<span class="nc" id="L1154">				bean.setTotalCashInHand(bean.getDrawSale() - bean.getDrawCancel() - bean.getDrawPwt() - bean.getDrawDirPlyPwt() + bean.getIwSale() - bean.getIwCancel() - bean.getIwPwt() - bean.getIwDirPlyPwt());</span>
<span class="nc" id="L1155">				addNumber(sheet, 8, i + length + 8, bean.getTotalCashInHand());</span>
<span class="nc" id="L1156">				totalCashInHand += bean.getTotalCashInHand();</span>
<span class="nc" id="L1157">				sheet.mergeCells(8, i + length + 8, 9, i + length + 8);</span>
<span class="nc" id="L1158">				i++;</span>
<span class="nc" id="L1159">			}</span>
<span class="nc" id="L1160">			addCaption(sheet, 1, len + length + 8, getText(&quot;label.total&quot;));</span>
<span class="nc" id="L1161">			sheet.mergeCells(1, len + length + 8, 3, len + length + 8);</span>
<span class="nc" id="L1162">			sheet.addCell(new Number(4, len + length + 8, totalDrawSale, headingNumberFormat));</span>
<span class="nc" id="L1163">			sheet.addCell(new Number(5, len + length + 8, totalDrawPwt, headingNumberFormat));</span>
<span class="nc" id="L1164">			sheet.addCell(new Number(6, len + length + 8, totalIwSale, headingNumberFormat));</span>
<span class="nc" id="L1165">			sheet.addCell(new Number(7, len + length + 8, totalIwPwt, headingNumberFormat));</span>
<span class="nc" id="L1166">			sheet.addCell(new Number(8, len + length + 8, totalCashInHand, headingNumberFormat));</span>
<span class="nc" id="L1167">			sheet.mergeCells(8, len + length + 10, 9, len + length + 8);</span>
<span class="nc" id="L1168">		} else {</span>
<span class="nc bnc" id="L1169" title="All 2 branches missed.">			if (isDG) {</span>
<span class="nc" id="L1170">				sheet.mergeCells(4, length + 5, 5, length + 5);</span>
<span class="nc" id="L1171">				addCaption(sheet, 4, length + 6, getText(</span>
						&quot;label.draw.game&quot;));
			}
<span class="nc bnc" id="L1174" title="All 2 branches missed.">			if (isSE) {</span>
<span class="nc" id="L1175">				sheet.mergeCells(4, length + 5, 5, length + 5);</span>
<span class="nc" id="L1176">				addCaption(sheet, 4, length + 6, getText(</span>
						&quot;label.scratch.game&quot;));
			}
<span class="nc bnc" id="L1179" title="All 2 branches missed.">			if (isOLA) {</span>
<span class="nc" id="L1180">				sheet.mergeCells(4, length + 5, 6, length + 5);</span>
<span class="nc" id="L1181">				addCaption(sheet, 4, length + 6, getText(</span>
						&quot;label.offline.aff&quot;));
			}
			/*
			 * if (isSLE) { sheet.mergeCells(4, length+5, 5, length+5);
			 * addCaption(sheet, 4, length+6, getText(&quot;label.sport.lot&quot;,
			 * locale)); }
			 */

<span class="nc" id="L1190">			int i = 0;</span>
<span class="nc" id="L1191">			Iterator&lt;Map.Entry&lt;String, CompleteCollectionBean&gt;&gt; it = dataMap</span>
					.entrySet().iterator();
<span class="nc bnc" id="L1193" title="All 2 branches missed.">			while (it.hasNext()) {</span>
<span class="nc" id="L1194">				Map.Entry&lt;String, CompleteCollectionBean&gt; pair = it.next();</span>
<span class="nc" id="L1195">				CompleteCollectionBean bean = new CompleteCollectionBean();</span>
<span class="nc" id="L1196">				bean = pair.getValue();</span>
<span class="nc" id="L1197">				addLabel(sheet, 1, i + length + 8, bean.getOrgName());</span>
<span class="nc" id="L1198">				sheet.mergeCells(1, i + length + 8, 3, i + length + 8);</span>
<span class="nc bnc" id="L1199" title="All 2 branches missed.">				if (isDG) {</span>
<span class="nc" id="L1200">					sheet.mergeCells(4, length + 6, 5, length + 6);</span>
<span class="nc" id="L1201">					addCaption(sheet, 6, length + 5, getText(</span>
							&quot;label.net.amt&quot;));
<span class="nc" id="L1203">					sheet.mergeCells(6, length + 5, 7, length + 7);</span>

<span class="nc" id="L1205">					addCaption(sheet, 4, length + 7, getText(</span>
							&quot;label.sale.amt&quot;));
<span class="nc" id="L1207">					addCaption(sheet, 5, length + 7, getText(</span>
							&quot;label.pwt.amt&quot;));
<span class="nc" id="L1209">					addNumber(sheet, 4, i + length + 8, bean.getDrawSale()</span>
							- bean.getDrawCancel());
<span class="nc" id="L1211">					totalDrawSale += bean.getDrawSale() - bean.getDrawCancel();</span>
<span class="nc" id="L1212">					addNumber(sheet, 5, i + length + 8, bean.getDrawPwt()</span>
							+ bean.getDrawDirPlyPwt());
<span class="nc" id="L1214">					totalDrawPwt += bean.getDrawPwt() + bean.getDrawDirPlyPwt();</span>
<span class="nc" id="L1215">					bean.setTotalCashInHand(bean.getDrawSale()</span>
							- bean.getDrawCancel() - bean.getDrawPwt()
							- bean.getDrawDirPlyPwt());
<span class="nc" id="L1218">					addNumber(sheet, 6, i + length + 8, bean</span>
							.getTotalCashInHand());
<span class="nc" id="L1220">					sheet.mergeCells(6, i + length + 8, 7, i + length + 8);</span>
<span class="nc" id="L1221">					addCaption(sheet, 1, len + length + 8, getText(</span>
							&quot;label.total&quot;));
<span class="nc" id="L1223">					sheet.mergeCells(1, len + length + 8, 3, len + length + 8);</span>
				}
<span class="nc bnc" id="L1225" title="All 2 branches missed.">				if (isSE) {</span>
<span class="nc" id="L1226">					sheet.mergeCells(4, length + 6, 5, length + 6);</span>
<span class="nc" id="L1227">					addCaption(sheet, 6, length + 5, getText(</span>
							&quot;label.net.amt&quot;));
<span class="nc" id="L1229">					sheet.mergeCells(6, length + 5, 7, length + 7);</span>

<span class="nc" id="L1231">					addCaption(sheet, 4, length + 7, getText(</span>
							&quot;label.sale.amt&quot;));
<span class="nc" id="L1233">					addCaption(sheet, 5, length + 7, getText(</span>
							&quot;label.pwt.amt&quot;));
<span class="nc" id="L1235">					addNumber(sheet, 4, i + length + 8, bean.getScratchSale());</span>
<span class="nc" id="L1236">					totalScratchSale += bean.getScratchSale();</span>
<span class="nc" id="L1237">					addNumber(sheet, 5, i + length + 8, bean.getScratchPwt()</span>
							+ bean.getScratchDirPlyPwt());
<span class="nc" id="L1239">					bean</span>
							.setTotalCashInHand(bean.getScratchSale()
									- bean.getScratchPwt()
									- bean.getScratchDirPlyPwt());
<span class="nc" id="L1243">					addNumber(sheet, 6, i + length + 8, bean</span>
							.getTotalCashInHand());
<span class="nc" id="L1245">					sheet.mergeCells(6, i + length + 8, 7, i + length + 8);</span>
<span class="nc" id="L1246">					addCaption(sheet, 1, len + length + 8, getText(</span>
							&quot;label.total&quot;));
<span class="nc" id="L1248">					sheet.mergeCells(1, len + length + 8, 3, len + length + 8);</span>
				}
<span class="nc bnc" id="L1250" title="All 2 branches missed.">				if (isOLA) {</span>
<span class="nc" id="L1251">					sheet.mergeCells(4, length + 6, 5, length + 6);</span>
<span class="nc" id="L1252">					addCaption(sheet, 7, length + 5, getText(</span>
							&quot;label.net.amt&quot;));
<span class="nc" id="L1254">					sheet.mergeCells(7, length + 5, 8, length + 7);</span>

<span class="nc" id="L1256">					addCaption(sheet, 4, length + 7, getText(</span>
							&quot;label.deposit&quot;));
<span class="nc" id="L1258">					addCaption(sheet, 5, length + 7, getText(</span>
							&quot;label.wdl.amt&quot;));
<span class="nc" id="L1260">					addCaption(sheet, 6, length + 7, getText(</span>
							&quot;label.net.gaming.amt&quot;));
<span class="nc" id="L1262">					addNumber(sheet, 4, i + length + 8, bean.getOlaDepositAmt()</span>
							- bean.getOlaDepositCancelAmt());
<span class="nc" id="L1264">					totalOLADeposit += bean.getOlaDepositAmt()</span>
							- bean.getOlaDepositCancelAmt();
<span class="nc" id="L1266">					addNumber(sheet, 5, i + length + 8, bean</span>
							.getOlaWithdrawalAmt());
<span class="nc" id="L1268">					totalOLAWithdraw += bean.getOlaWithdrawalAmt();</span>
<span class="nc" id="L1269">					addNumber(sheet, 6, i + length + 8, bean.getOlaNetGaming());</span>
<span class="nc" id="L1270">					totalOLANetGaming += bean.getOlaNetGaming();</span>
<span class="nc" id="L1271">					bean.setTotalCashInHand(bean.getOlaDepositAmt()</span>
							- bean.getOlaDepositCancelAmt()
							- bean.getOlaWithdrawalAmt()
							- bean.getOlaNetGaming());
<span class="nc" id="L1275">					addNumber(sheet, 7, i + length + 8, bean</span>
							.getTotalCashInHand());
<span class="nc" id="L1277">					sheet.mergeCells(7, i + length + 8, 8, i + length + 8);</span>
<span class="nc" id="L1278">					addCaption(sheet, 1, len + length + 8, getText(</span>
							&quot;label.total&quot;));
<span class="nc" id="L1280">					sheet.mergeCells(1, len + length + 8, 3, len + length + 8);</span>

				}
				/*
				 * if (isSLE) { sheet.mergeCells(4, length+6, 5, length+6);
				 * addCaption(sheet, 6, length+5,
				 * getText(&quot;label.net.amt&quot;));
				 * sheet.mergeCells(6, length+5, 7, length+7);
				 * 
				 * addCaption(sheet, 4, length+7,
				 * getText(&quot;label.sale.amt&quot;)); addCaption(sheet,
				 * 5, length+7, getText(&quot;label.pwt.amt&quot;));
				 * addNumber(sheet, 4, i + length+8, bean.getSleSale() -
				 * bean.getSleCancel()); totalSleSale += bean.getSleSale() -
				 * bean.getSleCancel(); addNumber(sheet, 5, i + length+8,
				 * bean.getSlePwt() + bean.getSleDirPlyPwt()); totalSlePwt +=
				 * bean.getSlePwt() + bean.getSleDirPlyPwt();
				 * bean.setTotalCashInHand(bean.getSleSale() -
				 * bean.getSleCancel() - bean.getSlePwt() -
				 * bean.getSleDirPlyPwt()); addNumber(sheet, 6, i +length+ 8,
				 * bean.getTotalCashInHand()); sheet.mergeCells(6, i + length+8,
				 * 7, i + length+8); addCaption(sheet, 1, len+length + 8,
				 * getText(&quot;label.total&quot;)); sheet.mergeCells(1,
				 * len+length + 8, 3, len+length + 8); }
				 */

<span class="nc bnc" id="L1306" title="All 2 branches missed.">				if (isDG) {</span>
<span class="nc" id="L1307">					sheet.addCell(new Number(4, len + length + 8,</span>
							totalDrawSale, headingNumberFormat));
<span class="nc" id="L1309">					sheet.addCell(new Number(5, len + length + 8, totalDrawPwt,</span>
							headingNumberFormat));
<span class="nc" id="L1311">					sheet.addCell(new Number(6, len + length + 8,</span>
							totalCashInHand, headingNumberFormat));
<span class="nc" id="L1313">					sheet.mergeCells(6, len + length + 8, 7, len + length + 8);</span>
				}
<span class="nc bnc" id="L1315" title="All 2 branches missed.">				if (isSE) {</span>
<span class="nc" id="L1316">					sheet.addCell(new Number(4, len + length + 8,</span>
							totalScratchSale, headingNumberFormat));
<span class="nc" id="L1318">					sheet.addCell(new Number(5, len + length + 8,</span>
							totalScratchPwt, headingNumberFormat));
<span class="nc" id="L1320">					sheet.addCell(new Number(6, len + length + 8,</span>
							totalCashInHand, headingNumberFormat));
<span class="nc" id="L1322">					sheet.mergeCells(6, len + length + 8, 7, len + length + 8);</span>
				}
<span class="nc bnc" id="L1324" title="All 2 branches missed.">				if (isOLA) {</span>
<span class="nc" id="L1325">					sheet.addCell(new Number(4, len + length + 8,</span>
							totalOLADeposit, headingNumberFormat));
<span class="nc" id="L1327">					sheet.addCell(new Number(5, len + length + 8,</span>
							totalOLAWithdraw, headingNumberFormat));
<span class="nc" id="L1329">					sheet.addCell(new Number(6, len + length + 8,</span>
							totalOLANetGaming, headingNumberFormat));
<span class="nc" id="L1331">					sheet.addCell(new Number(7, len + length + 8,</span>
							totalCashInHand, headingNumberFormat));
<span class="nc" id="L1333">					sheet.mergeCells(7, len + length + 8, 8, len + length + 8);</span>
				}
				/*
				 * if (isSLE) { sheet.addCell(new Number(4, len+length + 8,
				 * totalSleSale, headingNumberFormat)); sheet.addCell(new
				 * Number(5, len+length + 8, totalSlePwt, headingNumberFormat));
				 * sheet.addCell(new Number(6, len+length + 8, totalCashInHand,
				 * headingNumberFormat)); sheet.mergeCells(6, len+length + 8, 7,
				 * len+length + 8); }
				 */

<span class="nc" id="L1344">				i++;</span>
<span class="nc" id="L1345">			}</span>
		}
<span class="nc" id="L1347">		length = len + 10;</span>
<span class="nc" id="L1348">		return length;</span>

	}

	private void createHeaderForComplCollReport(WritableSheet sheet)
			throws WriteException, ParseException {
<span class="nc" id="L1354">		DateFormat format = new SimpleDateFormat(&quot;dd-MMM-yy&quot;);</span>

<span class="nc" id="L1356">		sheet.addCell(new Label(10, 0, getText(&quot;label.date&quot;)</span>
				+ &quot;  :  &quot; + format.format(new Date()), dateFormat));
<span class="nc" id="L1358">		sheet.mergeCells(10, 0, 11, 0);</span>

<span class="nc" id="L1360">		sheet.mergeCells(4, 3, 8, 3);</span>
<span class="nc" id="L1361">		sheet.mergeCells(9, 3, 11, 3);</span>
<span class="nc" id="L1362">		setHeadingForComplCollReport(sheet);</span>

<span class="nc" id="L1364">	}</span>

	// -------------------------- Agent sale &amp; Pwt detail method

	private void setHeadingForComplCollReport(WritableSheet sheet)
			throws RowsExceededException, WriteException {
<span class="nc" id="L1370">		DateFormat format = new SimpleDateFormat(&quot;dd-MMM-yy&quot;);</span>
<span class="nc bnc" id="L1371" title="All 2 branches missed.">		if (this.endDate == null) {</span>

<span class="nc" id="L1373">			logger.debug(&quot; inside date if condition -kgkgjdkjkjkfj---- ----user Type : &quot;</span>
							+ this.reportType + &quot; date : &quot; + startDate);
<span class="nc" id="L1375">			sheet.addCell(new Label(4, 3, getText(&quot;label.from.date&quot;)</span>
					+ &quot; &quot; + getText(&quot;label.of&quot;) + reportType,
					headerFormat));
<span class="nc bnc" id="L1378" title="All 2 branches missed.">			if (reportday == null) {</span>
<span class="nc" id="L1379">				sheet.addCell(new Label(9, 3, &quot; ( &quot;</span>
						+ new SimpleDateFormat(&quot;MMM-yyyy&quot;).format(startDate)
						+ &quot; ) &quot;, headerDateFormat));
			} else {
<span class="nc" id="L1383">				sheet.addCell(new Label(9, 3, &quot; ( &quot;</span>
						+ new SimpleDateFormat(&quot;dd-MMM-yyyy&quot;).format(reportday)
						+ &quot; ) &quot;, headerDateFormat));
			}
		} else {
<span class="nc" id="L1388">			logger.debug(&quot; inside date else condition ----- ----user Type : &quot;</span>
					+ reportType + &quot; date : &quot; + startDate + &quot; end date : &quot;
					+ endDate);
<span class="nc" id="L1391">			sheet.addCell(new Label(4, 3, getText(</span>
					&quot;label.sale.pwt.colln.rep&quot;)
					+ &quot; &quot; + getText(&quot;label.from.date&quot;) + &quot;&quot;,
					headerFormat));
<span class="nc" id="L1395">			sheet.addCell(new Label(9, 3, &quot; ( &quot; + format.format(startDate)</span>
					+ &quot;   -   &quot; + format.format(endDate) + &quot; ) &quot;,
					headerDateFormat));
		}
<span class="nc" id="L1399">	}</span>

	public void write(Map&lt;String, CompleteCollectionBean&gt; reportbean,
			WritableWorkbook workbk, String orgName, String orgAdd,
			boolean isSE, boolean isDG, boolean isCS, boolean isOLA,
			boolean isSLE, boolean isIW) throws IOException, WriteException, ParseException {
<span class="nc" id="L1405">		WorkbookSettings wbSettings = new WorkbookSettings();</span>
<span class="nc" id="L1406">		wbSettings.setLocale(new Locale(&quot;en&quot;, &quot;EN&quot;));</span>
		// WritableWorkbook workbook = Workbook.createWorkbook(file,
		// wbSettings);
<span class="nc" id="L1409">		WritableWorkbook workbook = workbk;</span>
<span class="nc" id="L1410">		workbook.createSheet(getText(&quot;Report&quot;), 0);</span>
<span class="nc" id="L1411">		WritableSheet excelSheet = workbook.getSheet(0);</span>

<span class="nc" id="L1413">		createContent(excelSheet, reportbean, orgName, orgAdd, isSE, isDG,</span>
				isCS, isOLA, isSLE, isIW);

<span class="nc" id="L1416">		workbook.write();</span>
<span class="nc" id="L1417">		workbook.close();</span>
<span class="nc" id="L1418">	}</span>

	/**
	 * It create excel sheet for agent that contain retailer wise detail of sale
	 * &amp; pwt transactions.
	 */
	public void writeAgent(ArrayList&lt;CashChqReportBean&gt; data,
			CashChqReportBean agentBoDetail, WritableWorkbook workbk)
			throws WriteException, IOException {
<span class="nc" id="L1427">		WorkbookSettings wbSettings = new WorkbookSettings();</span>
<span class="nc" id="L1428">		wbSettings.setLocale(new Locale(&quot;en&quot;, &quot;EN&quot;));</span>
		// WritableWorkbook workbook = Workbook.createWorkbook(file,
		// wbSettings);
<span class="nc" id="L1431">		WritableWorkbook workbook = workbk;</span>
<span class="nc" id="L1432">		workbook.createSheet(getText(&quot;Report&quot;), 0);</span>
<span class="nc" id="L1433">		WritableSheet excelSheet = workbook.getSheet(0);</span>
		try {
<span class="nc" id="L1435">			createContentOfAgentSheet(excelSheet, data, agentBoDetail);</span>
<span class="nc" id="L1436">		} catch (RowsExceededException e) {</span>
<span class="nc" id="L1437">			e.printStackTrace();</span>
<span class="nc" id="L1438">		} catch (WriteException e) {</span>
<span class="nc" id="L1439">			e.printStackTrace();</span>
<span class="nc" id="L1440">		} catch (ParseException e) {</span>
<span class="nc" id="L1441">			e.printStackTrace();</span>
<span class="nc" id="L1442">		}</span>

<span class="nc" id="L1444">		workbook.write();</span>
<span class="nc" id="L1445">		workbook.close();</span>

<span class="nc" id="L1447">	}</span>

	public void writeFullDetailDateWise(
			Map&lt;String, CompleteCollectionBean&gt; reportMap,
			Map&lt;Integer, Map&lt;String, CompleteCollectionBean&gt;&gt; detailMapList,
			WritableWorkbook workbk, String orgName, String orgAdd,
			Map&lt;Integer, String&gt; orgAddMap, Map&lt;Integer, Double&gt; drawDPPMap,
			Map&lt;Integer, Double&gt; scratchDPPMap, Map&lt;Integer, Double&gt; sleDPPMap, 
			Map&lt;Integer, Double&gt; iwDPPMap,
			boolean isSE, boolean isDG, boolean isCS, boolean isOLA,
			boolean isSLE, boolean isIW) throws IOException, WriteException, ParseException {
<span class="nc" id="L1458">		WorkbookSettings wbSettings = new WorkbookSettings();</span>
<span class="nc" id="L1459">		wbSettings.setLocale(new Locale(&quot;en&quot;, &quot;EN&quot;));</span>
<span class="nc" id="L1460">		WritableWorkbook workbook = workbk;</span>
<span class="nc" id="L1461">		workbook.createSheet(getText(&quot;Report&quot;), 0);</span>
<span class="nc" id="L1462">		WritableSheet excelSheet = workbook.getSheet(0);</span>
<span class="nc" id="L1463">		createContent(excelSheet, reportMap, orgName, orgAdd, isSE, isDG, isCS,</span>
				isOLA, isSLE, isIW);
<span class="nc" id="L1465">		Iterator&lt;Map.Entry&lt;Integer, Map&lt;String, CompleteCollectionBean&gt;&gt;&gt; it = detailMapList</span>
				.entrySet().iterator();
<span class="nc" id="L1467">		int i = 1;</span>
<span class="nc bnc" id="L1468" title="All 2 branches missed.">		while (it.hasNext()) {</span>
<span class="nc" id="L1469">			Map.Entry&lt;Integer, Map&lt;String, CompleteCollectionBean&gt;&gt; pair = it</span>
					.next();
<span class="nc" id="L1471">			workbook.createSheet(</span>
					reportMap.get(pair.getKey() + &quot;&quot;).getOrgName(), i);
<span class="nc" id="L1473">			excelSheet = workbook.getSheet(i);</span>
<span class="nc" id="L1474">			createDetailContentForAgentWise(excelSheet, reportMap.get(pair</span>
					.getKey()
					+ &quot;&quot;), pair.getValue(), reportMap.get(pair.getKey() + &quot;&quot;)
					.getOrgName(), orgAddMap.get(pair.getKey()), drawDPPMap
					.get(pair.getKey()), scratchDPPMap.get(pair.getKey()),
					sleDPPMap.get(pair.getKey()), iwDPPMap.get(pair.getKey()), isSE, isDG, isCS, isOLA,
					isSLE, isIW);
<span class="nc" id="L1481">			i++;</span>
<span class="nc" id="L1482">		}</span>
<span class="nc" id="L1483">		workbook.write();</span>
<span class="nc" id="L1484">		workbook.close();</span>
<span class="nc" id="L1485">	}</span>

	public void WriteFullDetailRetailerWise(
			Map&lt;String, CompleteCollectionBean&gt; reportMap,
			WritableWorkbook workbk, String orgName, String orgAdd,
			Double drawDPPMap, Double scratchDPPMap, Double sleDPPMap,
			boolean isSE, boolean isDG, boolean isCS, boolean isOLA,
			boolean isSLE, boolean isIW) throws IOException, WriteException, ParseException {
<span class="nc" id="L1493">		WorkbookSettings wbSettings = new WorkbookSettings();</span>
<span class="nc" id="L1494">		wbSettings.setLocale(new Locale(&quot;en&quot;, &quot;EN&quot;));</span>
<span class="nc" id="L1495">		WritableWorkbook workbook = workbk;</span>
<span class="nc" id="L1496">		workbook.createSheet(getText(&quot;Report&quot;), 0);</span>
<span class="nc" id="L1497">		WritableSheet excelSheet = workbook.getSheet(0);</span>
<span class="nc" id="L1498">		createContent(excelSheet, reportMap, orgName, orgAdd, isSE, isDG, isCS,</span>
				isOLA, isSLE, isIW);
<span class="nc" id="L1500">		workbook.write();</span>
<span class="nc" id="L1501">		workbook.close();</span>
<span class="nc" id="L1502">	}</span>

	public void writeFullDetailDayWise(
			Map&lt;String, CompleteCollectionBean&gt; mainSummaryData,
			Map&lt;String, Map&lt;String, CompleteCollectionBean&gt;&gt; detailDataMap,
			WritableWorkbook workbk, String orgName, String orgAdd,
			boolean isSE, boolean isDG, boolean isCS, boolean isOLA,
			boolean isSLE, boolean isIW) throws IOException, WriteException, ParseException {
<span class="nc" id="L1510">		WorkbookSettings wbSettings = new WorkbookSettings();</span>
<span class="nc" id="L1511">		wbSettings.setLocale(new Locale(&quot;en&quot;, &quot;EN&quot;));</span>
<span class="nc" id="L1512">		WritableWorkbook workbook = workbk;</span>
<span class="nc" id="L1513">		workbook.createSheet(getText(&quot;Report&quot;), 0);</span>
<span class="nc" id="L1514">		WritableSheet excelSheet = workbook.getSheet(0);</span>
<span class="nc" id="L1515">		createContent(excelSheet, mainSummaryData, orgName, orgAdd, isSE, isDG,</span>
				isCS, isOLA, isSLE, isIW);

<span class="nc" id="L1518">		int i = 1;</span>
<span class="nc" id="L1519">		int length = mainReportLength;</span>
<span class="nc" id="L1520">		Iterator&lt;Map.Entry&lt;String, Map&lt;String, CompleteCollectionBean&gt;&gt;&gt; it = detailDataMap</span>
				.entrySet().iterator();
<span class="nc bnc" id="L1522" title="All 2 branches missed.">		while (it.hasNext()) {</span>
<span class="nc" id="L1523">			Map.Entry&lt;String, Map&lt;String, CompleteCollectionBean&gt;&gt; pair = it</span>
					.next();
<span class="nc" id="L1525">			System.out.println(&quot;dataMap size  is  &quot; + detailDataMap.size());</span>
<span class="nc" id="L1526">			length += createDetailContentForDayWise(excelSheet,</span>
					pair.getValue(), pair.getKey(), &quot;&quot;, isSE, isDG, isCS,
					isOLA, isSLE, isIW, length);
<span class="nc" id="L1529">			i++;</span>
<span class="nc" id="L1530">		}</span>
		/*
		 * this code is for creating separate sheets for each agent in case of
		 * day wise filter Iterator&lt;Map.Entry&lt;String, List&lt;CashChqReportBean&gt;&gt;&gt;
		 * it = dataMap.entrySet().iterator(); int i=1; while(it.hasNext()){
		 * Map.Entry&lt;String, List&lt;CashChqReportBean&gt;&gt; pair = it.next();
		 * workbook.createSheet(mainSummaryData.get(i).getName(), i); excelSheet
		 * = workbook.getSheet(i); createDetailContentForDayWise(excelSheet,
		 * pair.getValue()); i++; }
		 */
<span class="nc" id="L1540">		workbook.write();</span>
<span class="nc" id="L1541">		workbook.close();</span>
<span class="nc" id="L1542">	}</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>