<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TrackPwtBOHelper.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">lms</a> &gt; <a href="index.source.html" class="el_package">com.skilrock.lms.coreEngine.scratchService.pwtMgmt.common</a> &gt; <span class="el_source">TrackPwtBOHelper.java</span></div><h1>TrackPwtBOHelper.java</h1><pre class="source lang-java linenums">package com.skilrock.lms.coreEngine.scratchService.pwtMgmt.common;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.sql.Timestamp;
import java.util.ArrayList;
import java.util.List;

import com.skilrock.lms.beans.TrackTicketBean;
import com.skilrock.lms.beans.TrackVirnBean;
import com.skilrock.lms.common.db.DBConnect;
import com.skilrock.lms.common.db.QueryManager;
import com.skilrock.lms.common.exception.LMSException;
import com.skilrock.lms.common.utility.CommonMethods;
import com.skilrock.lms.common.utility.MD5Encoder;

<span class="nc" id="L20">public class TrackPwtBOHelper {</span>
	private TrackTicketBean checkTicketStatus(String gameNbr, String bookNbr,
			String ticketNbrDigit, int gameId, Connection connection,
			TrackTicketBean trackTicketBean) throws LMSException {
		// TicketBean bean=new TicketBean();
		// TrackTicketBean trackTicketBean = new TrackTicketBean();
		// bean.setTicketNumber(bookNbr+&quot;-&quot;+ticketNbrDigit);
		// System.out.println(&quot;Book No is: &quot;+bookNbr+&quot; actual ticket number is &quot;
		// + ticketNbrDigit);

		PreparedStatement pstmt;
		ResultSet result;
		try {
<span class="nc" id="L33">			String query1 = QueryManager</span>
					.getST4CurrentOwnerDetailsUsingGameBookNbr();
<span class="nc" id="L35">			pstmt = connection.prepareStatement(query1);</span>
<span class="nc" id="L36">			pstmt.setInt(1, gameId);</span>
<span class="nc" id="L37">			pstmt.setString(2, bookNbr);</span>
<span class="nc" id="L38">			result = pstmt.executeQuery();</span>
<span class="nc" id="L39">			System.out.println(&quot;pstmt == &quot; + pstmt);</span>
<span class="nc bnc" id="L40" title="All 2 branches missed.">			if (result.next()) {</span>

<span class="nc" id="L42">				String query2 = QueryManager</span>
						.getST4PwtTicketDetailsUsingGameNbr();
<span class="nc" id="L44">				PreparedStatement pstmt2 = connection.prepareStatement(query2);</span>
<span class="nc" id="L45">				pstmt2.setInt(1, Integer.parseInt(gameNbr));</span>
<span class="nc" id="L46">				pstmt2.setString(2, bookNbr + &quot;-&quot; + ticketNbrDigit);</span>
<span class="nc" id="L47">				ResultSet resultSet2 = pstmt2.executeQuery();</span>

				// required to be reviewed
<span class="nc bnc" id="L50" title="All 2 branches missed.">				if (resultSet2.next()) {</span>
<span class="nc" id="L51">					String ticketStatus = resultSet2.getString(&quot;status&quot;);</span>

<span class="nc bnc" id="L53" title="All 2 branches missed.">					if (ticketStatus.equalsIgnoreCase(&quot;MISSING&quot;)) {</span>
<span class="nc" id="L54">						trackTicketBean.setClaimed_by(&quot;NONE&quot;);</span>
<span class="nc" id="L55">						trackTicketBean.setStatus(&quot;MISSING&quot;);</span>
<span class="nc" id="L56">						trackTicketBean.setRemarks(&quot;Ticket is MISSING &quot;);</span>
<span class="nc bnc" id="L57" title="All 2 branches missed.">					} else if (ticketStatus.equalsIgnoreCase(&quot;CLAIM_RET&quot;)) {</span>
<span class="nc" id="L58">						trackTicketBean.setClaimed_by(&quot;RETAILER&quot;);</span>
<span class="nc" id="L59">						trackTicketBean.setStatus(&quot;CLAIMED&quot;);</span>
<span class="nc bnc" id="L60" title="All 2 branches missed.">					} else if (ticketStatus.equalsIgnoreCase(&quot;RETURN&quot;)) {</span>
<span class="nc" id="L61">						trackTicketBean.setStatus(&quot;UNCLAIMED&quot;);</span>
<span class="nc" id="L62">						trackTicketBean</span>
								.setRemarks(&quot;Ticket once Verified and Return to Player for Verification as Direct Player PWT&quot;);
<span class="nc bnc" id="L64" title="All 2 branches missed.">					} else if (ticketStatus.equalsIgnoreCase(&quot;CLAIM_AGT&quot;)) {</span>
<span class="nc" id="L65">						trackTicketBean.setClaimed_by(&quot;AGENT&quot;);</span>
<span class="nc" id="L66">						trackTicketBean.setClaimed_at(&quot;BO&quot;);</span>
<span class="nc" id="L67">						trackTicketBean.setStatus(&quot;CLAIMED&quot;);</span>
<span class="nc bnc" id="L68" title="All 2 branches missed.">					} else if (ticketStatus.equalsIgnoreCase(&quot;CLAIM_AGT_TEMP&quot;)) {</span>
<span class="nc" id="L69">						trackTicketBean.setClaimed_by(&quot;AGENT&quot;);</span>
<span class="nc" id="L70">						trackTicketBean.setClaimed_at(&quot;BO as Bulk&quot;);</span>
<span class="nc" id="L71">						trackTicketBean.setStatus(&quot;UNCLAIMED&quot;);</span>
<span class="nc" id="L72">						trackTicketBean</span>
								.setRemarks(&quot;Already Verified in Bulk Receipt at BO&quot;);
<span class="nc bnc" id="L74" title="All 2 branches missed.">					} else if (ticketStatus.equalsIgnoreCase(&quot;CLAIM_PLR&quot;)) {</span>
<span class="nc" id="L75">						trackTicketBean.setStatus(&quot;CLAIMED To Player&quot;);</span>
<span class="nc bnc" id="L76" title="All 2 branches missed.">					} else if (ticketStatus</span>
							.equalsIgnoreCase(&quot;CLAIM_PLR_RET_UNCLM&quot;)) {
<span class="nc" id="L78">						trackTicketBean.setClaimed_by(&quot;PLAYER&quot;);</span>
<span class="nc" id="L79">						trackTicketBean.setClaimed_at(&quot;RETAILER as Unclaimed&quot;);</span>
<span class="nc" id="L80">						trackTicketBean.setStatus(&quot;CLAIMED&quot;);</span>
<span class="nc bnc" id="L81" title="All 2 branches missed.">					} else if (ticketStatus</span>
							.equalsIgnoreCase(&quot;CLAIM_PLR_AGT_UNCLM_DIR&quot;)) {
<span class="nc" id="L83">						trackTicketBean.setClaimed_by(&quot;PLAYER&quot;);</span>
<span class="nc" id="L84">						trackTicketBean.setClaimed_at(&quot;AGENT as Unclaimed&quot;);</span>
<span class="nc" id="L85">						trackTicketBean.setStatus(&quot;CLAIMED&quot;);</span>
<span class="nc bnc" id="L86" title="All 2 branches missed.">					} else if (ticketStatus</span>
							.equalsIgnoreCase(&quot;CLAIM_PLR_AGT_CLM_DIR&quot;)) {
<span class="nc" id="L88">						trackTicketBean.setClaimed_by(&quot;PLAYER&quot;);</span>
<span class="nc" id="L89">						trackTicketBean.setClaimed_at(&quot;AGENT&quot;);</span>
<span class="nc" id="L90">						trackTicketBean.setStatus(&quot;CLAIMED&quot;);</span>
<span class="nc bnc" id="L91" title="All 2 branches missed.">					} else if (ticketStatus</span>
							.equalsIgnoreCase(&quot;CLAIM_PLR_RET_CLM&quot;)) {
<span class="nc" id="L93">						trackTicketBean.setClaimed_by(&quot;PLAYER&quot;);</span>
<span class="nc" id="L94">						trackTicketBean.setClaimed_at(&quot;RETAILER&quot;);</span>
<span class="nc" id="L95">						trackTicketBean.setStatus(&quot;CLAIMED&quot;);</span>
<span class="nc bnc" id="L96" title="All 2 branches missed.">					} else if (ticketStatus</span>
							.equalsIgnoreCase(&quot;CLAIM_PLR_RET_CLM_DIR&quot;)) {
<span class="nc" id="L98">						trackTicketBean.setClaimed_by(&quot;PLAYER&quot;);</span>
<span class="nc" id="L99">						trackTicketBean.setClaimed_at(&quot;RETAILER&quot;);</span>
<span class="nc" id="L100">						trackTicketBean.setStatus(&quot;CLAIMED&quot;);</span>
					}

<span class="nc bnc" id="L103" title="All 2 branches missed.">					else if (ticketStatus</span>
							.equalsIgnoreCase(&quot;CLAIM_PLR_RET_UNCLM_DIR&quot;)) {
<span class="nc" id="L105">						trackTicketBean.setClaimed_by(&quot;PLAYER&quot;);</span>
<span class="nc" id="L106">						trackTicketBean.setClaimed_at(&quot;RETAILER As Unclimed&quot;);</span>
<span class="nc" id="L107">						trackTicketBean.setStatus(&quot;CLAIMED&quot;);</span>
					}

					else {
<span class="nc" id="L111">						System.out</span>
								.println(&quot;Ticket found in ticket table but Undefined Status of Ticket::  &quot;
										+ ticketStatus);
<span class="nc" id="L114">						trackTicketBean</span>
								.setRemarks(&quot;Ticket found in ticket table but Undefined Status of Ticket::  &quot;
										+ ticketStatus);
					}

<span class="nc" id="L119">				} else {</span>
<span class="nc" id="L120">					System.out.println(&quot;Ticket Not Found in Ticket Table &quot;);</span>
<span class="nc" id="L121">					trackTicketBean.setRemarks(&quot;UNDISCLOSED&quot;);</span>
				}
<span class="nc" id="L123">			} else {</span>
<span class="nc" id="L124">				System.out.println(&quot;Ticket Is not of the company.&quot;);</span>
<span class="nc" id="L125">				trackTicketBean.setRemarks(&quot;UNDISCLOSED&quot;);</span>
			}
<span class="nc" id="L127">			return trackTicketBean;</span>
<span class="nc" id="L128">		} catch (SQLException e) {</span>
<span class="nc" id="L129">			e.printStackTrace();</span>
<span class="nc" id="L130">			throw new LMSException(e);</span>
		}

	}

	/*
	 * private int gatGameIdFromGameNbr(int gameNbr) throws LMSException{
	 * Connection connection = null; DBConnect dbConnect = new DBConnect();
	 * connection = dbConnect.getConnection(); PreparedStatement pstmt;
	 * ResultSet result; int game_id=0; try{ pstmt =
	 * connection.prepareStatement(&quot;select game_id from st_se_game_master where
	 * game_nbr=?&quot;); pstmt.setInt(1, gameNbr); result = pstmt.executeQuery();
	 * if(result.next()) game_id= result.getInt(&quot;game_id&quot;); return game_id;
	 * }catch(SQLException e){ e.printStackTrace(); throw new LMSException(); } }
	 */

	/**
	 * It is used to validate the format of ticket enter by user. This is common
	 * method for all('BO', 'AGENT', 'RETAILER')
	 * 
	 * @param ticketNbrDigit
	 * @param gameId
	 * @param connection
	 * @return TicketBean, return bean if format is not valid otherwise 'NULL'.
	 * @throws SQLException
	 */
	private TrackTicketBean isTicketFormatValid(
			TrackTicketBean trackTicketBean, int gameId, Connection connection)
			throws LMSException {

<span class="nc" id="L160">		String ticketNbr = trackTicketBean.getTicket_nbr();</span>
<span class="nc" id="L161">		String getTicketFormatQuery = QueryManager</span>
				.getST4GameTicketDetailsUsingGameId();
		PreparedStatement pstmt;
		ResultSet result;
		try {
<span class="nc" id="L166">			pstmt = connection.prepareStatement(getTicketFormatQuery);</span>
<span class="nc" id="L167">			pstmt.setInt(1, gameId);</span>
<span class="nc" id="L168">			result = pstmt.executeQuery();</span>
<span class="nc" id="L169">			System.out.println(&quot;getTicketFormatQuery = &quot; + pstmt);</span>
<span class="nc bnc" id="L170" title="All 2 branches missed.">			if (result.next()) {</span>
<span class="nc" id="L171">				int noOfTktPerBook = result.getInt(&quot;nbr_of_tickets_per_book&quot;);</span>
<span class="nc" id="L172">				int tktNoDigit = result.getInt(&quot;ticket_nbr_digits&quot;);</span>
<span class="nc" id="L173">				int gameNbrDigits = result.getInt(&quot;game_nbr_digits&quot;);</span>
<span class="nc" id="L174">				int packNbrDigits = result.getInt(&quot;pack_nbr_digits&quot;);</span>
<span class="nc" id="L175">				int bookNbrDigits = result.getInt(&quot;book_nbr_digits&quot;);</span>

<span class="nc bnc" id="L177" title="All 4 branches missed.">				if (ticketNbr.indexOf(&quot;-&quot;) == -1</span>
						&amp;&amp; ticketNbr.length() == gameNbrDigits + packNbrDigits
								+ bookNbrDigits + tktNoDigit) {
<span class="nc" id="L180">					ticketNbr = ticketNbr.substring(0, gameNbrDigits) + &quot;-&quot;</span>
							+ ticketNbr.substring(gameNbrDigits);
<span class="nc" id="L182">					ticketNbr = ticketNbr.substring(0, gameNbrDigits</span>
							+ packNbrDigits + bookNbrDigits + 1)
							+ &quot;-&quot;
							+ ticketNbr.substring(gameNbrDigits + packNbrDigits
									+ bookNbrDigits + 1);
<span class="nc" id="L187">					trackTicketBean.setTicket_nbr(ticketNbr);</span>
<span class="nc bnc" id="L188" title="All 2 branches missed.">				} else if (ticketNbr.split(&quot;-&quot;).length &lt; 3) {</span>
<span class="nc" id="L189">					trackTicketBean.setIsTicketFormatValid(&quot;false&quot;);</span>
<span class="nc" id="L190">					return trackTicketBean;</span>
				}

<span class="nc" id="L193">				String tktArr[] = ticketNbr.split(&quot;-&quot;);</span>
<span class="nc bnc" id="L194" title="All 6 branches missed.">				if (noOfTktPerBook &lt; Integer.parseInt(tktArr[2])</span>
						|| Integer.parseInt(tktArr[2]) == 0
						|| tktNoDigit != tktArr[2].length()) {
<span class="nc" id="L197">					trackTicketBean.setIsTicketFormatValid(&quot;false&quot;);</span>
<span class="nc" id="L198">					return trackTicketBean;</span>
				}
<span class="nc" id="L200">				trackTicketBean.setIsTicketFormatValid(&quot;true&quot;);</span>
<span class="nc" id="L201">				return trackTicketBean;</span>

			} else {
<span class="nc" id="L204">				trackTicketBean.setIsTicketFormatValid(&quot;false&quot;);</span>
<span class="nc" id="L205">				return trackTicketBean;</span>
			}
<span class="nc" id="L207">		} catch (SQLException e) {</span>
<span class="nc" id="L208">			e.printStackTrace();</span>
<span class="nc" id="L209">			throw new LMSException(e);</span>
		}

	}

	private TrackTicketBean trackTicket(int gameNbr, int game_id,
			TrackTicketBean trackTicketBean) throws LMSException {
		// check the format of these tickets

<span class="nc" id="L218">		Connection connection = null;</span>
<span class="nc" id="L219">		DBConnect dbConnect = new DBConnect();</span>
<span class="nc" id="L220">		connection = dbConnect.getConnection();</span>
		// TrackTicketBean trackTicketBean = new TrackTicketBean();
<span class="nc" id="L222">		trackTicketBean = isTicketFormatValid(trackTicketBean, game_id,</span>
				connection);

<span class="nc" id="L225">		String tktNbrArr[] = null;</span>
<span class="nc bnc" id="L226" title="All 2 branches missed.">		if (&quot;true&quot;.equalsIgnoreCase(trackTicketBean.getIsTicketFormatValid())) {</span>
<span class="nc" id="L227">			tktNbrArr = trackTicketBean.getTicket_nbr().split(&quot;-&quot;);</span>
<span class="nc" id="L228">			trackTicketBean.setBook_nbr(tktNbrArr[0] + &quot;-&quot; + tktNbrArr[1]);</span>
			// trackTicketBean.setIsTicketFormatValid(&quot;true&quot;);
<span class="nc" id="L230">			trackTicketBean.setGame_id(game_id);</span>
<span class="nc" id="L231">			trackTicketBean = checkTicketStatus(gameNbr + &quot;&quot;, tktNbrArr[0]</span>
					+ &quot;-&quot; + tktNbrArr[1], tktNbrArr[2], game_id, connection,
					trackTicketBean);

		} else {
<span class="nc" id="L236">			trackTicketBean.setRemarks(&quot;Ticket Format Error&quot;);</span>
		}
<span class="nc" id="L238">		return trackTicketBean;</span>
	}

	public List trackTicketNVirn(String ticketNumber, String virnNumber,
			int gameNbr, int game_id, String gameName, String orgName)
			throws LMSException {

<span class="nc" id="L245">		List ticketNVirnBeanList = new ArrayList();</span>
		// int game_id = gatGameIdFromGameNbr(gameNbr);
<span class="nc" id="L247">		TrackTicketBean trackTicketBean = new TrackTicketBean();</span>
<span class="nc" id="L248">		TrackVirnBean trackVirnBean = new TrackVirnBean();</span>

<span class="nc" id="L250">		trackTicketBean.setTicket_nbr(ticketNumber);</span>
<span class="nc" id="L251">		trackTicketBean.setGame_name(gameName);</span>

<span class="nc" id="L253">		trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L254">		trackVirnBean.setGame_name(gameName);</span>

<span class="nc bnc" id="L256" title="All 4 branches missed.">		if (!&quot;&quot;.equalsIgnoreCase(ticketNumber) &amp;&amp; ticketNumber != null) {</span>
<span class="nc" id="L257">			trackTicketBean = trackTicket(gameNbr, game_id, trackTicketBean);</span>
		}

<span class="nc" id="L260">		System.out.println(trackTicketBean.getTicket_nbr());</span>

<span class="nc bnc" id="L262" title="All 8 branches missed.">		if (!&quot;&quot;.equalsIgnoreCase(virnNumber) &amp;&amp; virnNumber != null &amp;&amp; !&quot;&quot;.equalsIgnoreCase(ticketNumber) &amp;&amp; ticketNumber != null) {</span>
<span class="nc" id="L263">			trackVirnBean = trackVirn(virnNumber, gameNbr, game_id,</span>
					trackVirnBean, orgName,trackTicketBean.getTicket_nbr());
		}
<span class="nc" id="L266">		ticketNVirnBeanList.add(trackTicketBean);</span>
<span class="nc" id="L267">		ticketNVirnBeanList.add(trackVirnBean);</span>
<span class="nc" id="L268">		System.out.println(ticketNVirnBeanList.size());</span>
<span class="nc" id="L269">		return ticketNVirnBeanList;</span>
	}

	private TrackVirnBean trackVirn(String virnNumber, int gameNbr,
			int game_id, TrackVirnBean trackVirnBean, String orgnazationName,String tktNumber)
			throws LMSException {

<span class="nc" id="L276">		Connection connection = null;</span>
<span class="nc" id="L277">		PreparedStatement pstmt = null;</span>

<span class="nc" id="L279">		Statement statement = null;</span>
<span class="nc" id="L280">		ResultSet resultSet = null;</span>
<span class="nc" id="L281">		ResultSet resDetails = null;</span>
		// TrackVirnBean trackVirnBean = new TrackVirnBean();
		try {
<span class="nc" id="L284">			String encodedVirn = MD5Encoder.encode(virnNumber);</span>
<span class="nc" id="L285">			String encodedTktNbr = MD5Encoder.encode(tktNumber);</span>
<span class="nc" id="L286">			DBConnect dbConnect = new DBConnect();</span>
<span class="nc" id="L287">			connection = dbConnect.getConnection();</span>
<span class="nc" id="L288">			String queryGetVirnDetails = &quot;select a.virn_code,a.status,a.pwt_amt from st_se_pwt_inv_? a where a.game_id=? and a.virn_code=? and a.id1=?&quot;;</span>
<span class="nc" id="L289">			pstmt = connection.prepareStatement(queryGetVirnDetails);</span>
<span class="nc" id="L290">			pstmt.setInt(1, gameNbr);</span>
<span class="nc" id="L291">			pstmt.setInt(2, game_id);</span>
<span class="nc" id="L292">			pstmt.setString(3, encodedVirn);</span>
<span class="nc" id="L293">			pstmt.setString(4, encodedTktNbr);</span>
<span class="nc" id="L294">			resultSet = pstmt.executeQuery();</span>
<span class="nc" id="L295">			String prizeStatus = null;</span>

<span class="nc bnc" id="L297" title="All 2 branches missed.">			if (resultSet.next()) {</span>
				// trackVirnBean.setGame_name(resultSet.getString(&quot;game_name&quot;));
				// trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));
<span class="nc" id="L300">				prizeStatus = resultSet.getString(&quot;status&quot;);</span>
<span class="nc bnc" id="L301" title="All 2 branches missed.">				if (prizeStatus.equalsIgnoreCase(&quot;CLAIM_RET_UNCLM&quot;)) {</span>
<span class="nc" id="L302">					String orgname = null;</span>
<span class="nc" id="L303">					String receiptNumber = null;</span>
<span class="nc" id="L304">					String receiptTime = null;</span>

<span class="nc" id="L306">					statement = connection.createStatement();</span>
<span class="nc" id="L307">					String retDetailsQuery = &quot;select a.name,c.generated_id,c.receipt_id,e.transaction_date from st_lms_organization_master a,st_se_agent_pwt b,st_lms_agent_receipts c,st_lms_agent_transaction_master e where b.virn_code='&quot;</span>
							+ encodedVirn
							+ &quot;' and b.game_id=&quot;
							+ game_id
							+ &quot; and a.organization_id=b.retailer_org_id and b.transaction_id=e.transaction_id and c.receipt_id=(select receipt_id from st_lms_agent_receipts_trn_mapping where transaction_id=b.transaction_id)&quot;;
<span class="nc" id="L312">					System.out.println(&quot;query for get org name &quot;</span>
							+ retDetailsQuery);
<span class="nc" id="L314">					resDetails = statement.executeQuery(retDetailsQuery);</span>
<span class="nc bnc" id="L315" title="All 2 branches missed.">					while (resDetails.next()) {</span>
<span class="nc" id="L316">						orgname = resDetails.getString(&quot;name&quot;);</span>
<span class="nc" id="L317">						receiptNumber = resDetails.getString(&quot;generated_id&quot;);</span>
<span class="nc" id="L318">						receiptTime = resDetails.getString(&quot;transaction_date&quot;);</span>

					}
<span class="nc" id="L321">					trackVirnBean.setClaimed_at(&quot;AGENT&quot;);</span>
<span class="nc" id="L322">					trackVirnBean.setClaimed_by(&quot;RETAILER: &quot; + orgname);</span>
<span class="nc" id="L323">					trackVirnBean.setClaimed_on_date(receiptTime);</span>
<span class="nc" id="L324">					trackVirnBean.setStatus(&quot;CLAIMED&quot;);</span>
<span class="nc" id="L325">					trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));</span>
<span class="nc" id="L326">					trackVirnBean.setVirn_code(virnNumber);</span>

					// trackVirnBean.setRemarks(receiptNumber);
<span class="nc" id="L329">					trackVirnBean.setRemarks(&quot;Already Paid to Retailer: &quot;</span>
							+ orgname + &quot; By Agent on Voucher Number:  &quot;
							+ receiptNumber + &quot; at &quot; + receiptTime);
					// pwtBean.setMessage(&quot;Already Paid to Retailer: &quot; +
					// orgname+&quot; on Voucher Number: &quot;+receiptNumber+&quot; at
					// &quot;+receiptTime);

<span class="nc bnc" id="L336" title="All 2 branches missed.">				} else if (prizeStatus</span>
						.equalsIgnoreCase(&quot;CLAIM_PLR_AGT_UNCLM_DIR&quot;)) {
<span class="nc" id="L338">					String agtOrgNAme = null;</span>
<span class="nc" id="L339">					String playerFirstName = null;</span>
<span class="nc" id="L340">					String playerLastName = null;</span>
<span class="nc" id="L341">					String playercity = null;</span>
<span class="nc" id="L342">					String receiptNumber = null;</span>
<span class="nc" id="L343">					String receiptTime = null;</span>

<span class="nc" id="L345">					statement = connection.createStatement();</span>
					// String plrDetailsQuery=&quot;select first_name,last_name,city
					// from st_lms_player_master where player_id in (select
					// player_id from st_se_direct_player_pwt where
					// virn_code='&quot;+enVirnCode+&quot;' and game_id=&quot;+gameId+&quot;)&quot;;
					// String plrDetailsQuery=&quot;select
					// b.first_name,b.last_name,b.city,a.transaction_date,c.generated_id
					// from st_se_direct_player_pwt a,st_lms_player_master
					// b,st_lms_bo_receipts c where a.virn_code='&quot;+enVirnCode+&quot;'
					// and a.game_id=&quot;+gameId+&quot; and a.player_id=b.player_id and
					// c.receipt_id=(select receipt_id from
					// st_lms_bo_receipts_trn_mapping where
					// transaction_id=a.transaction_id)&quot;;
<span class="nc" id="L358">					String plrDetailsQuery = &quot;select b.first_name,b.last_name,b.city,a.transaction_date,c.generated_id,c.receipt_id,d.name from st_se_agt_direct_player_pwt a,st_lms_player_master b,st_lms_agent_receipts c,st_lms_organization_master d where a.virn_code='&quot;</span>
							+ encodedVirn
							+ &quot;' and a.game_id=&quot;
							+ game_id
							+ &quot; and a.player_id=b.player_id and c.receipt_id=(select receipt_id from st_lms_agent_receipts_trn_mapping where transaction_id=a.transaction_id) and d.organization_id=a.agent_org_id&quot;;
<span class="nc" id="L363">					System.out.println(&quot;query for get player name &quot;</span>
							+ plrDetailsQuery);
<span class="nc" id="L365">					resDetails = statement.executeQuery(plrDetailsQuery);</span>
<span class="nc bnc" id="L366" title="All 2 branches missed.">					while (resultSet.next()) {</span>
<span class="nc" id="L367">						playerFirstName = resDetails.getString(&quot;first_name&quot;);</span>
<span class="nc" id="L368">						playerLastName = resDetails.getString(&quot;last_name&quot;);</span>
<span class="nc" id="L369">						playercity = resDetails.getString(&quot;city&quot;);</span>
<span class="nc" id="L370">						receiptNumber = resDetails.getString(&quot;generated_id&quot;);</span>
<span class="nc" id="L371">						receiptTime = resDetails.getString(&quot;transaction_date&quot;);</span>
<span class="nc" id="L372">						agtOrgNAme = resDetails.getString(&quot;name&quot;);</span>

					}
<span class="nc" id="L375">					trackVirnBean.setClaimed_at(&quot;AGENT: &quot; + agtOrgNAme);</span>
<span class="nc" id="L376">					trackVirnBean.setClaimed_by(&quot;PLAYER: &quot; + playerFirstName</span>
							+ &quot; &quot; + playerLastName + &quot; &quot; + playercity);
<span class="nc" id="L378">					trackVirnBean.setClaimed_on_date(receiptTime);</span>
<span class="nc" id="L379">					trackVirnBean.setStatus(&quot;CLAIMED&quot;);</span>
<span class="nc" id="L380">					trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));</span>
<span class="nc" id="L381">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L382">					trackVirnBean.setRemarks(receiptNumber);</span>

<span class="nc" id="L384">					trackVirnBean.setRemarks(&quot;Already Paid to Player: &quot;</span>
							+ playerFirstName + &quot; &quot; + playerLastName + &quot; &quot;
							+ playercity + &quot; By Agent: &quot; + agtOrgNAme
							+ &quot; &lt;/br&gt; on Voucher Number: &quot; + receiptNumber
							+ &quot; &lt;/br&gt;at &quot; + receiptTime);

					// pwtBean.setMessage(&quot;Already Paid to Retailer: &quot; +
					// orgname+&quot; on Voucher Number: &quot;+receiptNumber+&quot; at
					// &quot;+receiptTime);

<span class="nc bnc" id="L394" title="All 2 branches missed.">				} else if (prizeStatus.equalsIgnoreCase(&quot;CLAIM_AGT_TEMP&quot;)) {</span>
<span class="nc" id="L395">					String orgname = null;</span>
<span class="nc" id="L396">					String receiptNumber = null;</span>
<span class="nc" id="L397">					String receiptTime = null;</span>
<span class="nc" id="L398">					statement = connection.createStatement();</span>
					// String agtDetailsQuery=&quot;select name from
					// st_lms_organization_master where organization_id in
					// (select agent_org_id from st_se_bo_pwt where
					// virn_code='&quot;+enVirnCode+&quot;' and game_id=&quot;+gameId+&quot;)&quot;;

<span class="nc" id="L404">					String partyDetailsQuery = &quot;select a.receipt_id,a.date_entered ,b.name from st_se_tmp_pwt_inv a,st_lms_organization_master b  where virn_code='&quot;</span>
							+ encodedVirn
							+ &quot;' and game_id=&quot;
							+ game_id
							+ &quot; and organization_id=(select organization_id from st_lms_user_master where user_id=a.user_id)&quot;;

<span class="nc" id="L410">					System.out.println(&quot;query for get org name &quot;</span>
							+ partyDetailsQuery);
<span class="nc" id="L412">					resDetails = statement.executeQuery(partyDetailsQuery);</span>
<span class="nc bnc" id="L413" title="All 2 branches missed.">					while (resDetails.next()) {</span>
<span class="nc" id="L414">						orgname = resDetails.getString(&quot;name&quot;);</span>
<span class="nc" id="L415">						receiptNumber = resDetails.getString(&quot;receipt_id&quot;);</span>
<span class="nc" id="L416">						receiptTime = resDetails.getString(&quot;date_entered&quot;);</span>
					}

<span class="nc" id="L419">					trackVirnBean</span>
							.setClaimed_at(&quot;BO in Bulk, Final Payment Pending&quot;);
<span class="nc" id="L421">					trackVirnBean.setClaimed_by(&quot;AGENT: &quot; + orgname);</span>
<span class="nc" id="L422">					trackVirnBean.setClaimed_on_date(receiptTime);</span>
<span class="nc" id="L423">					trackVirnBean.setStatus(&quot;CLAIMED As Bulk&quot;);</span>
<span class="nc" id="L424">					trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));</span>
<span class="nc" id="L425">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L426">					trackVirnBean.setRemarks(receiptNumber);</span>
<span class="nc" id="L427">					trackVirnBean</span>
							.setRemarks(&quot;Already Verified in Bulk Receipt at BO for agent: &quot;
									+ orgname
									+ &quot;&lt;/br&gt; on Bulk Receipt Number: &quot;
									+ receiptNumber
									+ &quot;&lt;/br&gt; at &quot;
									+ receiptTime
									+ &quot;,&lt;/br&gt; Final Payment Pending&quot;);
					// pwtBean.setMessage(&quot;Already Verified in Bulk Receipt at
					// BO for agent: &quot;+orgname+&quot; on Bulk Receipt Number:
					// &quot;+receiptNumber+&quot; at &quot;+receiptTime+&quot;, Final Payment
					// Pending&quot;);

<span class="nc" id="L440">				} /*</span>
					 * else if
					 * (prizeStatus.equalsIgnoreCase(&quot;CLAIM_RET_AGT_TEMP&quot;)) { }
<span class="nc bnc" id="L443" title="All 2 branches missed.">					 */else if (prizeStatus.equalsIgnoreCase(&quot;CLAIM_AGT&quot;)) {</span>
<span class="nc" id="L444">					String orgname = null;</span>
<span class="nc" id="L445">					String receiptNumber = null;</span>
<span class="nc" id="L446">					String receiptTime = null;</span>

<span class="nc" id="L448">					statement = connection.createStatement();</span>
					// String agtDetailsQuery=&quot;select name from
					// st_lms_organization_master where organization_id in
					// (select agent_org_id from st_se_bo_pwt where
					// virn_code='&quot;+enVirnCode+&quot;' and game_id=&quot;+gameId+&quot;)&quot;;

<span class="nc" id="L454">					String agtDetailsQuery = &quot;select a.name,c.generated_id,c.receipt_id,e.transaction_date from st_lms_organization_master a,st_se_bo_pwt b,st_lms_bo_receipts c,st_lms_bo_transaction_master e where b.virn_code='&quot;</span>
							+ encodedVirn
							+ &quot;' and b.game_id=&quot;
							+ game_id
							+ &quot; and a.organization_id=b.agent_org_id and b.transaction_id=e.transaction_id and c.receipt_id=(select receipt_id from st_lms_bo_receipts_trn_mapping where transaction_id=b.transaction_id)&quot;;

<span class="nc" id="L460">					System.out.println(&quot;query for get org name &quot;</span>
							+ agtDetailsQuery);
<span class="nc" id="L462">					resDetails = statement.executeQuery(agtDetailsQuery);</span>
<span class="nc bnc" id="L463" title="All 2 branches missed.">					while (resDetails.next()) {</span>
<span class="nc" id="L464">						orgname = resDetails.getString(&quot;name&quot;);</span>
<span class="nc" id="L465">						receiptNumber = resDetails.getString(&quot;generated_id&quot;);</span>
<span class="nc" id="L466">						receiptTime = resDetails.getString(&quot;transaction_date&quot;);</span>

					}
<span class="nc" id="L469">					trackVirnBean.setClaimed_at(&quot;BO&quot;);</span>
<span class="nc" id="L470">					trackVirnBean.setClaimed_by(&quot;AGENT: &quot; + orgname);</span>
<span class="nc" id="L471">					trackVirnBean.setClaimed_on_date(receiptTime);</span>
<span class="nc" id="L472">					trackVirnBean.setStatus(&quot;CLAIMED&quot;);</span>
<span class="nc" id="L473">					trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));</span>
<span class="nc" id="L474">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L475">					trackVirnBean.setRemarks(receiptNumber);</span>

<span class="nc" id="L477">					trackVirnBean.setRemarks(&quot;Already Paid to Agent: &quot;</span>
							+ orgname + &quot; By BO &lt;/br&gt;on Voucher Number: &quot;
							+ receiptNumber + &quot; &lt;/br&gt;at &quot; + receiptTime);
					// pwtBean.setMessage(&quot;Already Paid to Agent: &quot; + orgname+&quot;
					// on Voucher Number: &quot;+receiptNumber+&quot; at &quot;+receiptTime);

<span class="nc bnc" id="L483" title="All 2 branches missed.">				} else if (prizeStatus.equalsIgnoreCase(&quot;CLAIM_AGT_AUTO&quot;)) {</span>
<span class="nc" id="L484">					String orgname = null;</span>
<span class="nc" id="L485">					String receiptNumber = null;</span>
<span class="nc" id="L486">					String receiptTime = null;</span>

<span class="nc" id="L488">					statement = connection.createStatement();</span>
					// String agtDetailsQuery=&quot;select name from
					// st_lms_organization_master where organization_id in
					// (select agent_org_id from st_se_bo_pwt where
					// virn_code='&quot;+enVirnCode+&quot;' and game_id=&quot;+gameId+&quot;)&quot;;

<span class="nc" id="L494">					String agtDetailsQuery = &quot;select a.name,c.generated_id,c.receipt_id,e.transaction_date from st_lms_organization_master a,st_se_bo_pwt b,st_lms_bo_receipts c,st_lms_bo_transaction_master e where b.virn_code='&quot;</span>
							+ encodedVirn
							+ &quot;' and b.game_id=&quot;
							+ game_id
							+ &quot; and a.organization_id=b.agent_org_id and b.transaction_id=e.transaction_id and c.receipt_id=(select receipt_id from st_lms_bo_receipts_trn_mapping where transaction_id=b.transaction_id)&quot;;

<span class="nc" id="L500">					System.out.println(&quot;query for get org name &quot;</span>
							+ agtDetailsQuery);
<span class="nc" id="L502">					resDetails = statement.executeQuery(agtDetailsQuery);</span>
<span class="nc bnc" id="L503" title="All 2 branches missed.">					while (resDetails.next()) {</span>
<span class="nc" id="L504">						orgname = resDetails.getString(&quot;name&quot;);</span>
<span class="nc" id="L505">						receiptNumber = resDetails.getString(&quot;generated_id&quot;);</span>
<span class="nc" id="L506">						receiptTime = resDetails.getString(&quot;transaction_date&quot;);</span>

					}
<span class="nc" id="L509">					trackVirnBean.setClaimed_at(&quot;BO&quot;);</span>
<span class="nc" id="L510">					trackVirnBean.setClaimed_by(&quot;AGENT: &quot; + orgname);</span>
<span class="nc" id="L511">					trackVirnBean.setClaimed_on_date(receiptTime);</span>
<span class="nc" id="L512">					trackVirnBean.setStatus(&quot;CLAIMED as Uto Scrap&quot;);</span>
<span class="nc" id="L513">					trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));</span>
<span class="nc" id="L514">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L515">					trackVirnBean.setRemarks(receiptNumber);</span>

<span class="nc" id="L517">					trackVirnBean</span>
							.setRemarks(&quot;Already Paid as Auto Scrap to Agent: &quot;
									+ orgname
									+ &quot; By BO &lt;/br&gt;on Voucher Number: &quot;
									+ receiptNumber + &quot; &lt;/br&gt;at &quot; + receiptTime);

					// pwtBean.setMessage(&quot;Already Paid to Agent: &quot; + orgname+&quot;
					// on Voucher Number: &quot;+receiptNumber+&quot; at &quot;+receiptTime);

<span class="nc" id="L526">				}/*</span>
					 * else if (prizeStatus
					 * .equalsIgnoreCase(&quot;CLAIM_PLR_TEMP&quot;)){ String
					 * playerFirstName=null; String playerLastName=null; String
					 * playercity=null; String receiptNumber=null; Timestamp
					 * receiptTime=null; statement=connection.createStatement();
					 * //String plrDetailsQuery=&quot;select
					 * first_name,last_name,city from st_lms_player_master where
					 * player_id in (select player_id from
					 * st_se_direct_player_pwt where virn_code='&quot;+enVirnCode+&quot;'
					 * and game_id=&quot;+gameId+&quot;)&quot;; String plrDetailsQuery=&quot;select
					 * a.pwt_receipt_id,a.transaction_date,b.first_name,b.last_name,b.city
					 * from st_se_direct_player_pwt_temp_receipt
					 * a,st_lms_player_master b where
					 * a.virn_code='&quot;+encodedVirn+&quot;' and a.game_id=&quot;+game_id+&quot;
					 * and b.player_id=a.player_id&quot;; System.out.println(&quot;query
					 * for get player name &quot; + plrDetailsQuery);
					 * resOrgDetails=statement.executeQuery(plrDetailsQuery);
					 * while(resOrgDetails.next()){ playerFirstName=
					 * resOrgDetails.getString(&quot;first_name&quot;); playerLastName=
					 * resOrgDetails.getString(&quot;last_name&quot;); playercity=
					 * resOrgDetails.getString(&quot;city&quot;);
					 * receiptNumber=resOrgDetails.getString(&quot;pwt_receipt_id&quot;);
					 * receiptTime=resOrgDetails.getTimestamp(&quot;transaction_date&quot;); }
					 * //pwtBean.setMessage(&quot;Already in Process for Direct
					 * Player PWT for Player: &quot;+playerFirstName+&quot;
					 * &quot;+playerLastName+&quot;,&quot;+playercity+&quot; on Temporary Receipt
					 * Number: &quot;+receiptNumber+&quot; issued on
					 * &quot;+receiptTime+&quot;,Payment/Approval Pending&quot;);
					 * 
					 * }else if(prizeStatus .equalsIgnoreCase(&quot;CLAIM_PLR&quot;)){
					 * String playerFirstName=null; String playerLastName=null;
					 * String playercity=null; String receiptNumber=null;
					 * Timestamp receiptTime=null;
					 * statement=connection.createStatement(); //String
					 * plrDetailsQuery=&quot;select first_name,last_name,city from
					 * st_lms_player_master where player_id in (select player_id
					 * from st_se_direct_player_pwt where
					 * virn_code='&quot;+enVirnCode+&quot;' and game_id=&quot;+gameId+&quot;)&quot;;
					 * String plrDetailsQuery=&quot;select
					 * b.first_name,b.last_name,b.city,a.transaction_date,c.generated_id
					 * from st_se_direct_player_pwt a,st_lms_player_master
					 * b,st_lms_bo_receipts c where
					 * a.virn_code='&quot;+encodedVirn+&quot;' and a.game_id=&quot;+game_id+&quot;
					 * and a.player_id=b.player_id and c.receipt_id=(select
					 * receipt_id from st_lms_bo_receipts_trn_mapping where
					 * transaction_id=a.transaction_id)&quot;;
					 * System.out.println(&quot;query for get player name &quot; +
					 * plrDetailsQuery);
					 * resOrgDetails=statement.executeQuery(plrDetailsQuery);
					 * while(resOrgDetails.next()){ playerFirstName=
					 * resOrgDetails.getString(&quot;first_name&quot;); playerLastName=
					 * resOrgDetails.getString(&quot;last_name&quot;); playercity=
					 * resOrgDetails.getString(&quot;city&quot;);
					 * receiptNumber=resOrgDetails.getString(&quot;generated_id&quot;);
					 * receiptTime=resOrgDetails.getTimestamp(&quot;transaction_date&quot;); }
					 * //pwtBean.setMessage(&quot;Already Paid as Direct Player PWT
					 * to Player: &quot;+playerFirstName+&quot; &quot;+playerLastName+ &quot;,&quot;
					 * +playercity+&quot; on Voucher Number &quot;+receiptNumber+&quot; at
					 * &quot;+receiptTime); }
<span class="nc bnc" id="L586" title="All 2 branches missed.">					 */else if (prizeStatus</span>
						.equalsIgnoreCase(&quot;CLAIM_PLR_AGT_CLM_DIR&quot;)) {
					// show the agent details and player details

<span class="nc" id="L590">					String agtOrgNAme = null;</span>
<span class="nc" id="L591">					String playerFirstName = null;</span>
<span class="nc" id="L592">					String playerLastName = null;</span>
<span class="nc" id="L593">					String playercity = null;</span>
<span class="nc" id="L594">					String receiptNumber = null;</span>
<span class="nc" id="L595">					String receiptTime = null;</span>

<span class="nc" id="L597">					statement = connection.createStatement();</span>
					// String plrDetailsQuery=&quot;select first_name,last_name,city
					// from st_lms_player_master where player_id in (select
					// player_id from st_se_direct_player_pwt where
					// virn_code='&quot;+enVirnCode+&quot;' and game_id=&quot;+gameId+&quot;)&quot;;
					// String plrDetailsQuery=&quot;select
					// b.first_name,b.last_name,b.city,a.transaction_date,c.generated_id
					// from st_se_direct_player_pwt a,st_lms_player_master
					// b,st_lms_bo_receipts c where a.virn_code='&quot;+enVirnCode+&quot;'
					// and a.game_id=&quot;+gameId+&quot; and a.player_id=b.player_id and
					// c.receipt_id=(select receipt_id from
					// st_lms_bo_receipts_trn_mapping where
					// transaction_id=a.transaction_id)&quot;;
<span class="nc" id="L610">					String plrDetailsQuery = &quot;select b.first_name,b.last_name,b.city,a.transaction_date,c.generated_id,c.receipt_id,d.name from st_se_agt_direct_player_pwt a,st_lms_player_master b,st_lms_agent_receipts c,st_lms_organization_master d where a.virn_code='&quot;</span>
							+ encodedVirn
							+ &quot;' and a.game_id=&quot;
							+ game_id
							+ &quot; and a.player_id=b.player_id and c.receipt_id=(select receipt_id from st_lms_agent_receipts_trn_mapping where transaction_id=a.transaction_id) and d.organization_id=a.agent_org_id&quot;;
<span class="nc" id="L615">					System.out.println(&quot;query for get player name &quot;</span>
							+ plrDetailsQuery);
<span class="nc" id="L617">					resDetails = statement.executeQuery(plrDetailsQuery);</span>
<span class="nc bnc" id="L618" title="All 2 branches missed.">					while (resDetails.next()) {</span>
<span class="nc" id="L619">						playerFirstName = resDetails.getString(&quot;first_name&quot;);</span>
<span class="nc" id="L620">						playerLastName = resDetails.getString(&quot;last_name&quot;);</span>
<span class="nc" id="L621">						playercity = resDetails.getString(&quot;city&quot;);</span>
<span class="nc" id="L622">						receiptNumber = resDetails.getString(&quot;generated_id&quot;);</span>
<span class="nc" id="L623">						receiptTime = resDetails.getString(&quot;transaction_date&quot;);</span>
<span class="nc" id="L624">						agtOrgNAme = resDetails.getString(&quot;name&quot;);</span>

					}
<span class="nc" id="L627">					trackVirnBean.setClaimed_at(&quot;AGENT: &quot; + agtOrgNAme);</span>
<span class="nc" id="L628">					trackVirnBean.setClaimed_by(&quot;PLAYER: &quot; + playerFirstName</span>
							+ &quot; &quot; + playerLastName + &quot; &quot; + playercity);
<span class="nc" id="L630">					trackVirnBean.setClaimed_on_date(receiptTime);</span>
<span class="nc" id="L631">					trackVirnBean.setStatus(&quot;CLAIMED&quot;);</span>
<span class="nc" id="L632">					trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));</span>
<span class="nc" id="L633">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L634">					trackVirnBean.setRemarks(receiptNumber);</span>

<span class="nc" id="L636">					trackVirnBean.setRemarks(&quot;Already Paid to Player: &quot;</span>
							+ playerFirstName + &quot; &quot; + playerLastName + &quot; &quot;
							+ playercity + &quot; By Agent: &quot; + agtOrgNAme
							+ &quot; &lt;/br&gt; on Voucher Number: &quot; + receiptNumber
							+ &quot; &lt;/br&gt;at &quot; + receiptTime);

<span class="nc bnc" id="L642" title="All 2 branches missed.">				} else if (prizeStatus.equalsIgnoreCase(&quot;CLAIM_PLR_AGT_TEMP&quot;)) {</span>

<span class="nc" id="L644">					String orgname = null;</span>
<span class="nc" id="L645">					String receiptNumber = null;</span>
<span class="nc" id="L646">					String receiptTime = null;</span>
<span class="nc" id="L647">					statement = connection.createStatement();</span>
					// String agtDetailsQuery=&quot;select name from
					// st_lms_organization_master where organization_id in
					// (select agent_org_id from st_se_bo_pwt where
					// virn_code='&quot;+enVirnCode+&quot;' and game_id=&quot;+gameId+&quot;)&quot;;

<span class="nc" id="L653">					String partyDetailsQuery = &quot;select a.receipt_id,a.date_entered ,b.name from st_se_tmp_pwt_inv a,st_lms_organization_master b  where virn_code='&quot;</span>
							+ encodedVirn
							+ &quot;' and game_id=&quot;
							+ game_id
							+ &quot; and organization_id=(select organization_id from st_lms_user_master where user_id=a.user_id)&quot;;

<span class="nc" id="L659">					System.out.println(&quot;query for get org name &quot;</span>
							+ partyDetailsQuery);
<span class="nc" id="L661">					resDetails = statement.executeQuery(partyDetailsQuery);</span>
<span class="nc bnc" id="L662" title="All 2 branches missed.">					while (resDetails.next()) {</span>
<span class="nc" id="L663">						orgname = resDetails.getString(&quot;name&quot;);</span>
<span class="nc" id="L664">						receiptNumber = resDetails.getString(&quot;receipt_id&quot;);</span>
<span class="nc" id="L665">						receiptTime = resDetails.getString(&quot;date_entered&quot;);</span>
					}

<span class="nc" id="L668">					trackVirnBean.setClaimed_at(&quot;BO&quot;);</span>
<span class="nc" id="L669">					trackVirnBean.setClaimed_by(&quot;AGENT: &quot; + orgname);</span>
<span class="nc" id="L670">					trackVirnBean.setStatus(&quot;CLAIMED as Bulk&quot;);</span>
<span class="nc" id="L671">					trackVirnBean.setClaimed_on_date(receiptTime);</span>
<span class="nc" id="L672">					trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));</span>
<span class="nc" id="L673">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L674">					trackVirnBean.setRemarks(receiptNumber);</span>
<span class="nc" id="L675">					trackVirnBean</span>
							.setRemarks(&quot;Already Verified in Bulk By BO For Agent: &quot;
									+ orgname
									+ &quot; &lt;/br&gt; on Voucher Number: &quot;
									+ receiptNumber + &quot; &lt;/br&gt;at &quot; + receiptTime);

<span class="nc bnc" id="L681" title="All 2 branches missed.">				} else if (prizeStatus.equalsIgnoreCase(&quot;CLAIM_RET_AGT_TEMP&quot;)) {</span>

<span class="nc" id="L683">					String orgname = null;</span>
<span class="nc" id="L684">					String receiptNumber = null;</span>
<span class="nc" id="L685">					String receiptTime = null;</span>
<span class="nc" id="L686">					statement = connection.createStatement();</span>
					// String agtDetailsQuery=&quot;select name from
					// st_lms_organization_master where organization_id in
					// (select agent_org_id from st_se_bo_pwt where
					// virn_code='&quot;+enVirnCode+&quot;' and game_id=&quot;+gameId+&quot;)&quot;;

<span class="nc" id="L692">					String partyDetailsQuery = &quot;select a.receipt_id,a.date_entered ,b.name from st_se_tmp_pwt_inv a,st_lms_organization_master b  where virn_code='&quot;</span>
							+ encodedVirn
							+ &quot;' and game_id=&quot;
							+ game_id
							+ &quot; and organization_id=(select organization_id from st_lms_user_master where user_id=a.user_id)&quot;;

<span class="nc" id="L698">					System.out.println(&quot;query for get org name &quot;</span>
							+ partyDetailsQuery);
<span class="nc" id="L700">					resDetails = statement.executeQuery(partyDetailsQuery);</span>
<span class="nc bnc" id="L701" title="All 2 branches missed.">					while (resDetails.next()) {</span>
<span class="nc" id="L702">						orgname = resDetails.getString(&quot;name&quot;);</span>
<span class="nc" id="L703">						receiptNumber = resDetails.getString(&quot;receipt_id&quot;);</span>
<span class="nc" id="L704">						receiptTime = resDetails.getString(&quot;date_entered&quot;);</span>
					}

<span class="nc" id="L707">					trackVirnBean.setClaimed_at(&quot;BO&quot;);</span>
<span class="nc" id="L708">					trackVirnBean.setClaimed_by(&quot;AGENT: &quot; + orgname);</span>
<span class="nc" id="L709">					trackVirnBean.setStatus(&quot;CLAIMED as Bulk&quot;);</span>
<span class="nc" id="L710">					trackVirnBean.setClaimed_on_date(receiptTime);</span>
<span class="nc" id="L711">					trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));</span>
<span class="nc" id="L712">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L713">					trackVirnBean.setRemarks(receiptNumber);</span>
<span class="nc" id="L714">					trackVirnBean</span>
							.setRemarks(&quot;Already Verified in Bulk By BO For Agent: &quot;
									+ orgname
									+ &quot; &lt;/br&gt; on Voucher Number: &quot;
									+ receiptNumber + &quot; &lt;/br&gt;at &quot; + receiptTime);

<span class="nc bnc" id="L720" title="All 2 branches missed.">				} else if (prizeStatus.equalsIgnoreCase(&quot;CLAIM_PLR_BO&quot;)) {</span>
<span class="nc" id="L721">					String playerFirstName = null;</span>
<span class="nc" id="L722">					String playerLastName = null;</span>
<span class="nc" id="L723">					String playercity = null;</span>
<span class="nc" id="L724">					String receiptNumber = null;</span>
<span class="nc" id="L725">					String receiptTime = null;</span>

<span class="nc" id="L727">					statement = connection.createStatement();</span>
					// String plrDetailsQuery=&quot;select first_name,last_name,city
					// from st_lms_player_master where player_id in (select
					// player_id from st_se_direct_player_pwt where
					// virn_code='&quot;+enVirnCode+&quot;' and game_id=&quot;+gameId+&quot;)&quot;;
<span class="nc" id="L732">					String plrDetailsQuery = &quot;select b.first_name,b.last_name,b.city,a.transaction_date,c.generated_id,c.receipt_id from st_se_direct_player_pwt a,st_lms_player_master b,st_lms_bo_receipts c where a.virn_code='&quot;</span>
							+ encodedVirn
							+ &quot;' and a.game_id=&quot;
							+ game_id
							+ &quot; and a.player_id=b.player_id and c.receipt_id=(select receipt_id from st_lms_bo_receipts_trn_mapping where transaction_id=a.transaction_id)&quot;;
<span class="nc" id="L737">					System.out.println(&quot;query for get player name &quot;</span>
							+ plrDetailsQuery);
<span class="nc" id="L739">					resDetails = statement.executeQuery(plrDetailsQuery);</span>
<span class="nc bnc" id="L740" title="All 2 branches missed.">					while (resDetails.next()) {</span>
<span class="nc" id="L741">						playerFirstName = resDetails.getString(&quot;first_name&quot;);</span>
<span class="nc" id="L742">						playerLastName = resDetails.getString(&quot;last_name&quot;);</span>
<span class="nc" id="L743">						playercity = resDetails.getString(&quot;city&quot;);</span>
<span class="nc" id="L744">						receiptNumber = resDetails.getString(&quot;generated_id&quot;);</span>
<span class="nc" id="L745">						receiptTime = resDetails.getString(&quot;transaction_date&quot;);</span>

					}
<span class="nc" id="L748">					trackVirnBean.setClaimed_at(&quot;BO&quot;);</span>
<span class="nc" id="L749">					trackVirnBean.setClaimed_by(&quot;PLAYER&quot; + playerFirstName</span>
							+ &quot; &quot; + playerLastName + &quot; &quot; + playercity);
<span class="nc" id="L751">					trackVirnBean.setClaimed_on_date(receiptTime);</span>
<span class="nc" id="L752">					trackVirnBean.setStatus(&quot;CLAIMED&quot;);</span>
<span class="nc" id="L753">					trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));</span>
<span class="nc" id="L754">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L755">					trackVirnBean.setRemarks(receiptNumber);</span>

<span class="nc" id="L757">					trackVirnBean.setRemarks(&quot;Already Paid to Player: &quot;</span>
							+ playerFirstName + &quot; &quot; + playerLastName + &quot; &quot;
							+ playercity + &quot; By BO &lt;/br&gt; on Voucher Number: &quot;
							+ receiptNumber + &quot; &lt;/br&gt;at &quot; + receiptTime);

<span class="nc bnc" id="L762" title="All 2 branches missed.">				} else if (prizeStatus.equalsIgnoreCase(&quot;CLAIM_PLR_RET_UNCLM&quot;)) {</span>
					// show info of retailer if available from at retailer PWT

<span class="nc" id="L765">					String orgname = null;</span>
<span class="nc" id="L766">					String receiptTime = null;</span>
<span class="nc" id="L767">					statement = connection.createStatement();</span>
					// String agtDetailsQuery=&quot;select name from
					// st_lms_organization_master where organization_id in
					// (select agent_org_id from st_se_bo_pwt where
					// virn_code='&quot;+enVirnCode+&quot;' and game_id=&quot;+gameId+&quot;)&quot;;

					// String agtDetailsQuery=&quot;select
					// a.name,c.generated_id,e.transaction_date from
					// st_lms_organization_master a,st_se_bo_pwt
					// b,st_lms_bo_receipts c,st_lms_bo_transaction_master e
					// where b.virn_code='&quot;+enVirnCode+&quot;' and
					// b.game_id=&quot;+gameId+&quot; and a.organization_id=b.agent_org_id
					// and b.transaction_id=e.transaction_id and
					// c.receipt_id=(select receipt_id from
					// st_lms_bo_receipts_trn_mapping where
					// transaction_id=e.transaction_id)&quot;;
<span class="nc" id="L783">					String retDetailsQuery = &quot;select a.name,e.transaction_date from st_lms_organization_master a,st_se_retailer_pwt b,st_lms_retailer_transaction_master e where b.virn_code='&quot;</span>
							+ encodedVirn
							+ &quot;' and b.game_id=&quot;
							+ game_id
							+ &quot; and a.organization_id=b.retailer_org_id and b.transaction_id=e.transaction_id&quot;;

<span class="nc" id="L789">					System.out.println(&quot;query for get org name &quot;</span>
							+ retDetailsQuery);
<span class="nc" id="L791">					resDetails = statement.executeQuery(retDetailsQuery);</span>
<span class="nc bnc" id="L792" title="All 2 branches missed.">					while (resDetails.next()) {</span>
<span class="nc" id="L793">						orgname = resDetails.getString(&quot;name&quot;);</span>
<span class="nc" id="L794">						receiptTime = resDetails.getString(&quot;transaction_date&quot;);</span>
					}

<span class="nc" id="L797">					trackVirnBean.setClaimed_at(&quot;RETAILER: &quot; + orgname);</span>
<span class="nc" id="L798">					trackVirnBean.setClaimed_by(&quot;PLAYER&quot;);</span>
<span class="nc" id="L799">					trackVirnBean.setClaimed_on_date(receiptTime);</span>
<span class="nc" id="L800">					trackVirnBean.setStatus(&quot;CLAIMED&quot;);</span>
<span class="nc" id="L801">					trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));</span>
<span class="nc" id="L802">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L803">					trackVirnBean.setRemarks(&quot;CLAIMED as unclaimmable&quot;);</span>
<span class="nc" id="L804">					trackVirnBean</span>
							.setRemarks(&quot;Already Paid to Player:  By Retailer &lt;/br&gt; on Voucher Number:  &lt;/br&gt;at &quot;
									+ receiptTime);
					// pwtBean.setMessage(&quot;This VIRN No. has been paid to Player
					// by retailer but not claimed by retailer to agent &quot;);

<span class="nc bnc" id="L810" title="All 2 branches missed.">				} else if (prizeStatus.equalsIgnoreCase(&quot;CLAIM_PLR_RET_CLM&quot;)) {</span>
<span class="nc" id="L811">					String orgname = null;</span>
<span class="nc" id="L812">					String receiptTime = null;</span>
<span class="nc" id="L813">					statement = connection.createStatement();</span>
					// String agtDetailsQuery=&quot;select name from
					// st_lms_organization_master where organization_id in
					// (select agent_org_id from st_se_bo_pwt where
					// virn_code='&quot;+enVirnCode+&quot;' and game_id=&quot;+gameId+&quot;)&quot;;

					// String agtDetailsQuery=&quot;select
					// a.name,c.generated_id,e.transaction_date from
					// st_lms_organization_master a,st_se_bo_pwt
					// b,st_lms_bo_receipts c,st_lms_bo_transaction_master e
					// where b.virn_code='&quot;+enVirnCode+&quot;' and
					// b.game_id=&quot;+gameId+&quot; and a.organization_id=b.agent_org_id
					// and b.transaction_id=e.transaction_id and
					// c.receipt_id=(select receipt_id from
					// st_lms_bo_receipts_trn_mapping where
					// transaction_id=e.transaction_id)&quot;;
<span class="nc" id="L829">					String retDetailsQuery = &quot;select a.name,e.transaction_date from st_lms_organization_master a,st_se_retailer_pwt b,st_lms_retailer_transaction_master e where b.virn_code='&quot;</span>
							+ encodedVirn
							+ &quot;' and b.game_id=&quot;
							+ game_id
							+ &quot; and a.organization_id=b.retailer_org_id and b.transaction_id=e.transaction_id&quot;;

<span class="nc" id="L835">					System.out.println(&quot;query for get org name &quot;</span>
							+ retDetailsQuery);
<span class="nc" id="L837">					resDetails = statement.executeQuery(retDetailsQuery);</span>
<span class="nc bnc" id="L838" title="All 2 branches missed.">					while (resDetails.next()) {</span>
<span class="nc" id="L839">						orgname = resDetails.getString(&quot;name&quot;);</span>
<span class="nc" id="L840">						receiptTime = resDetails.getString(&quot;transaction_date&quot;);</span>
					}

<span class="nc" id="L843">					trackVirnBean.setClaimed_at(&quot;RETAILER: &quot; + orgname);</span>
<span class="nc" id="L844">					trackVirnBean.setClaimed_by(&quot;PLAYER&quot;);</span>
<span class="nc" id="L845">					trackVirnBean.setClaimed_on_date(receiptTime);</span>
<span class="nc" id="L846">					trackVirnBean.setStatus(&quot;CLAIMED&quot;);</span>
<span class="nc" id="L847">					trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));</span>
<span class="nc" id="L848">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L849">					trackVirnBean.setRemarks(&quot;CLAIMED As Claimmable&quot;);</span>
<span class="nc" id="L850">					trackVirnBean</span>
							.setRemarks(&quot;Already Paid to Player by Retailer: &quot;
									+ orgname + &quot; as Clammable&quot;);

<span class="nc bnc" id="L854" title="All 2 branches missed.">				} else if (prizeStatus</span>
						.equalsIgnoreCase(&quot;CLAIM_PLR_RET_UNCLM_DIR&quot;)) {
					// show info of retailer if available from at retailer
					// direct player
<span class="nc" id="L858">					trackVirnBean.setClaimed_at(&quot;RETAILER&quot;);</span>
<span class="nc" id="L859">					trackVirnBean.setClaimed_by(&quot;PLAYER&quot;);</span>
<span class="nc" id="L860">					trackVirnBean.setStatus(&quot;CLAIMED&quot;);</span>
<span class="nc" id="L861">					trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));</span>
<span class="nc" id="L862">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L863">					trackVirnBean.setRemarks(&quot;CLAIM_PLR_RET_UNCLM_DIR&quot;);</span>
					// pwtBean.setMessage(&quot;This VIRN No. has been paid to Player
					// by retailer but not claimed by retailer to agent &quot;);

<span class="nc bnc" id="L867" title="All 2 branches missed.">				} else if (prizeStatus</span>
						.equalsIgnoreCase(&quot;CLAIM_PLR_RET_CLM_DIR&quot;)) {
					// show info of retailer if available from at retailer
					// derect palyer PWT
<span class="nc" id="L871">					trackVirnBean.setClaimed_at(&quot;RETAILER&quot;);</span>
<span class="nc" id="L872">					trackVirnBean.setClaimed_by(&quot;PLAYER&quot;);</span>
<span class="nc" id="L873">					trackVirnBean.setStatus(&quot;CLAIMED&quot;);</span>
<span class="nc" id="L874">					trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));</span>
<span class="nc" id="L875">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L876">					trackVirnBean.setRemarks(&quot;CLAIM_PLR_RET_CLM_DIR&quot;);</span>
					// pwtBean.setMessage(&quot;This VIRN No. has been paid to Player
					// by retailer As Claimmable &quot;);

<span class="nc bnc" id="L880" title="All 2 branches missed.">				} else if (prizeStatus.equalsIgnoreCase(&quot;CLAIM_RET_CLM&quot;)) {</span>
<span class="nc" id="L881">					String agtOrgname = null;</span>
<span class="nc" id="L882">					String retOrgName = null;</span>
<span class="nc" id="L883">					String receiptNumber = null;</span>
<span class="nc" id="L884">					String receiptTime = null;</span>

<span class="nc" id="L886">					statement = connection.createStatement();</span>
<span class="nc" id="L887">					String agtDetailsQuery = &quot;select  b.transaction_date,c.generated_id,c.receipt_id,(select name from st_lms_organization_master where organization_id=a.retailer_org_id) 'agt_name' ,(select name from st_lms_organization_master where organization_id=a.retailer_org_id) 'ret_name'  from st_se_agent_pwt a,st_lms_agent_transaction_master b,st_lms_agent_receipts c where a.virn_code='&quot;</span>
							+ encodedVirn
							+ &quot;' and a.game_id=&quot;
							+ game_id
							+ &quot; and a.transaction_id=b.transaction_id  and c.receipt_id=(select receipt_id from st_lms_agent_receipts_trn_mapping where transaction_id=b.transaction_id)&quot;;

<span class="nc" id="L893">					System.out.println(&quot;query for get org name &quot;</span>
							+ agtDetailsQuery);
<span class="nc" id="L895">					resDetails = statement.executeQuery(agtDetailsQuery);</span>
<span class="nc bnc" id="L896" title="All 2 branches missed.">					while (resDetails.next()) {</span>
<span class="nc" id="L897">						agtOrgname = resDetails.getString(&quot;agt_name&quot;);</span>
<span class="nc" id="L898">						retOrgName = resDetails.getString(&quot;ret_name&quot;);</span>
<span class="nc" id="L899">						receiptNumber = resDetails.getString(&quot;generated_id&quot;);</span>
<span class="nc" id="L900">						receiptTime = resDetails.getString(&quot;transaction_date&quot;);</span>

					}
<span class="nc" id="L903">					trackVirnBean.setClaimed_at(&quot;AGENT: &quot; + agtOrgname);</span>
<span class="nc" id="L904">					trackVirnBean.setClaimed_by(&quot;RETAILER: &quot; + retOrgName);</span>
<span class="nc" id="L905">					trackVirnBean.setStatus(&quot;CLAIMED As Clammiable&quot;);</span>
<span class="nc" id="L906">					trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));</span>
<span class="nc" id="L907">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L908">					trackVirnBean.setRemarks(receiptNumber);</span>

<span class="nc" id="L910">					trackVirnBean.setRemarks(&quot;Paid to retailer: &quot; + retOrgName</span>
							+ &quot; By Agent: &quot; + agtOrgname + &quot;&lt;br&gt; on vocher &quot;
							+ receiptNumber + &quot; on date &quot; + receiptTime);
					// pwtBean.setMessage(&quot;Paid to retailer By Agent and pending
					// to claim at bo by agent as uato sarap&quot;);

<span class="nc bnc" id="L916" title="All 2 branches missed.">				} else if (prizeStatus.equalsIgnoreCase(&quot;CLAIM_RET_CLM_AUTO&quot;)) {</span>
<span class="nc" id="L917">					String agtOrgname = null;</span>
<span class="nc" id="L918">					String retOrgName = null;</span>
<span class="nc" id="L919">					String receiptNumber = null;</span>
<span class="nc" id="L920">					String receiptTime = null;</span>

<span class="nc" id="L922">					statement = connection.createStatement();</span>
<span class="nc" id="L923">					String agtDetailsQuery = &quot;select  b.transaction_date,c.generated_id,c.receipt_id,(select name from st_lms_organization_master where organization_id=a.retailer_org_id) 'agt_name' ,(select name from st_lms_organization_master where organization_id=a.retailer_org_id) 'ret_name'  from st_se_agent_pwt a,st_lms_agent_transaction_master b,st_lms_agent_receipts c where a.virn_code='&quot;</span>
							+ encodedVirn
							+ &quot;' and a.game_id=&quot;
							+ game_id
							+ &quot; and a.transaction_id=b.transaction_id  and c.receipt_id=(select receipt_id from st_lms_agent_receipts_trn_mapping where transaction_id=b.transaction_id)&quot;;

<span class="nc" id="L929">					System.out.println(&quot;query for get org name &quot;</span>
							+ agtDetailsQuery);
<span class="nc" id="L931">					resDetails = statement.executeQuery(agtDetailsQuery);</span>
<span class="nc bnc" id="L932" title="All 2 branches missed.">					while (resDetails.next()) {</span>
<span class="nc" id="L933">						agtOrgname = resDetails.getString(&quot;agt_name&quot;);</span>
<span class="nc" id="L934">						retOrgName = resDetails.getString(&quot;ret_name&quot;);</span>
<span class="nc" id="L935">						receiptNumber = resDetails.getString(&quot;generated_id&quot;);</span>
<span class="nc" id="L936">						receiptTime = resDetails.getString(&quot;transaction_date&quot;);</span>

					}
<span class="nc" id="L939">					trackVirnBean.setClaimed_at(&quot;AGENT: &quot; + agtOrgname);</span>
<span class="nc" id="L940">					trackVirnBean.setClaimed_by(&quot;RETAILER: &quot; + retOrgName);</span>
<span class="nc" id="L941">					trackVirnBean.setStatus(&quot;CLAIMED As Auto Scrap&quot;);</span>
<span class="nc" id="L942">					trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));</span>
<span class="nc" id="L943">					trackVirnBean.setVirn_code(virnNumber);</span>

<span class="nc" id="L945">					trackVirnBean.setRemarks(receiptNumber);</span>
<span class="nc" id="L946">					trackVirnBean.setRemarks(&quot;Claimed  to retailer: &quot;</span>
							+ retOrgName + &quot; by agent: &quot; + agtOrgname
							+ &quot; with receipt: &quot; + receiptNumber + &quot; on &quot;
							+ receiptTime);

<span class="nc bnc" id="L951" title="All 2 branches missed.">				} else if (prizeStatus.equalsIgnoreCase(&quot;REQUESTED&quot;)) {</span>
<span class="nc" id="L952">					String reqByOrgName = null;</span>
<span class="nc" id="L953">					String reqToOrgName = null;</span>
<span class="nc" id="L954">					String reqByType = null;</span>
<span class="nc" id="L955">					String reqToType = null;</span>
<span class="nc" id="L956">					String receiptNumber = null;</span>
<span class="nc" id="L957">					Timestamp receiptTime = null;</span>
<span class="nc" id="L958">					statement = connection.createStatement();</span>
<span class="nc" id="L959">					String reqDetailsQuery = &quot;select a.requester_type,a.requested_to_type,a.request_id,a.request_date,(select name from st_lms_organization_master where organization_id=a.requested_by_org_id) as reqByName,(select name from st_lms_organization_master where organization_id=a.requested_to_org_id) as reqToName from st_se_pwt_approval_request_master a where a.virn_code='&quot;</span>
							+ encodedVirn
							+ &quot;' and a.game_id=&quot;
							+ game_id
							+ &quot; and a.req_status='REQUESTED'&quot;;

<span class="nc" id="L965">					System.out.println(&quot;query for get org name &quot;</span>
							+ reqDetailsQuery);
<span class="nc" id="L967">					resDetails = statement.executeQuery(reqDetailsQuery);</span>
<span class="nc bnc" id="L968" title="All 2 branches missed.">					while (resDetails.next()) {</span>
<span class="nc" id="L969">						reqByOrgName = resDetails.getString(&quot;reqByName&quot;);</span>
<span class="nc" id="L970">						reqToOrgName = resDetails.getString(&quot;reqToName&quot;);</span>
<span class="nc" id="L971">						reqByType = resDetails.getString(&quot;requester_type&quot;);</span>
<span class="nc" id="L972">						reqToType = resDetails.getString(&quot;requested_to_type&quot;);</span>
<span class="nc" id="L973">						receiptNumber = resDetails.getString(&quot;request_id&quot;);</span>
<span class="nc" id="L974">						receiptTime = resDetails.getTimestamp(&quot;request_date&quot;);</span>
					}
<span class="nc" id="L976">					trackVirnBean.setStatus(&quot;REQUESTED&quot;);</span>
<span class="nc" id="L977">					trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));</span>
<span class="nc" id="L978">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L979">					trackVirnBean.setRemarks(&quot;REQUESTED&quot;);</span>

<span class="nc" id="L981">					trackVirnBean.setRemarks(&quot;This VIRN is requested by &quot;</span>
							+ reqByType + &quot;: &quot; + reqByOrgName + &quot;To &quot;
							+ reqToType + &quot;: &quot; + reqToOrgName
							+ &quot; for Approval &lt;br&gt; Voucher id: &quot; + receiptNumber
							+ &quot; on &quot; + receiptTime);

<span class="nc bnc" id="L987" title="All 2 branches missed.">				} else if (prizeStatus.equalsIgnoreCase(&quot;PND_MAS&quot;)) {</span>
					// details of by and to and date and voucher

<span class="nc" id="L990">					String reqByOrgName = null;</span>
<span class="nc" id="L991">					String reqToOrgName = null;</span>
<span class="nc" id="L992">					String reqByType = null;</span>
<span class="nc" id="L993">					String reqToType = null;</span>
<span class="nc" id="L994">					String receiptNumber = null;</span>
<span class="nc" id="L995">					Timestamp receiptTime = null;</span>
<span class="nc" id="L996">					statement = connection.createStatement();</span>
<span class="nc" id="L997">					String reqDetailsQuery = &quot;select a.requester_type,a.requested_to_type,a.request_id,a.request_date,(select name from st_lms_organization_master where organization_id=a.requested_by_org_id) as reqByName,(select name from st_lms_organization_master where organization_id=a.requested_to_org_id) as reqToName from st_se_pwt_approval_request_master a where a.virn_code='&quot;</span>
							+ encodedVirn
							+ &quot;' and a.game_id=&quot;
							+ game_id
							+ &quot; and a.req_status='PND_MAS'&quot;;

<span class="nc" id="L1003">					System.out.println(&quot;query for get org name &quot;</span>
							+ reqDetailsQuery);
<span class="nc" id="L1005">					resDetails = statement.executeQuery(reqDetailsQuery);</span>
<span class="nc bnc" id="L1006" title="All 2 branches missed.">					while (resDetails.next()) {</span>
<span class="nc" id="L1007">						reqByOrgName = resDetails.getString(&quot;reqByName&quot;);</span>
<span class="nc" id="L1008">						reqToOrgName = resDetails.getString(&quot;reqToName&quot;);</span>
<span class="nc" id="L1009">						reqByType = resDetails.getString(&quot;requester_type&quot;);</span>
<span class="nc" id="L1010">						reqToType = resDetails.getString(&quot;requested_to_type&quot;);</span>
<span class="nc" id="L1011">						receiptNumber = resDetails.getString(&quot;request_id&quot;);</span>
<span class="nc" id="L1012">						receiptTime = resDetails.getTimestamp(&quot;request_date&quot;);</span>
					}
<span class="nc" id="L1014">					trackVirnBean.setStatus(&quot;PND_MAS&quot;);</span>
<span class="nc" id="L1015">					trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));</span>
<span class="nc" id="L1016">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L1017">					trackVirnBean.setRemarks(&quot;PND_MAS&quot;);</span>
<span class="nc" id="L1018">					trackVirnBean.setRemarks(&quot;This VIRN is requested by &quot;</span>
							+ reqByType + &quot;: &quot; + reqByOrgName + &quot;To &quot;
							+ reqToType + &quot;: &quot; + reqToOrgName
							+ &quot; for master Approval &lt;br&gt; Voucher id: &quot;
							+ receiptNumber + &quot; on &quot; + receiptTime);
					// pwtBean.setMessage(&quot;This VIRN has Beean requested for BO
					// Master Approval&quot;);
<span class="nc bnc" id="L1025" title="All 2 branches missed.">				} else if (prizeStatus.equalsIgnoreCase(&quot;PND_PAY&quot;)) {</span>
<span class="nc" id="L1026">					String reqToOrgName = null;</span>
<span class="nc" id="L1027">					String reqToType = null;</span>
<span class="nc" id="L1028">					String receiptNumber = null;</span>
<span class="nc" id="L1029">					statement = connection.createStatement();</span>
<span class="nc" id="L1030">					String reqDetailsQuery = &quot;select a.request_id,a.pay_req_for_org_type,(select name from st_lms_organization_master where organization_id=a.pay_request_for_org_id) as payByName from st_se_pwt_approval_request_master a where a.virn_code='&quot;</span>
							+ encodedVirn
							+ &quot;' and a.game_id=&quot;
							+ game_id
							+ &quot; and a.req_status='PND_PAY'&quot;;

<span class="nc" id="L1036">					System.out.println(&quot;query for get org name &quot;</span>
							+ reqDetailsQuery);
<span class="nc" id="L1038">					resDetails = statement.executeQuery(reqDetailsQuery);</span>
<span class="nc bnc" id="L1039" title="All 2 branches missed.">					while (resDetails.next()) {</span>

<span class="nc" id="L1041">						reqToOrgName = resDetails.getString(&quot;payByName&quot;);</span>
<span class="nc" id="L1042">						reqToType = resDetails</span>
								.getString(&quot;pay_req_for_org_type&quot;);
<span class="nc" id="L1044">						receiptNumber = resDetails.getString(&quot;request_id&quot;);</span>
					}
<span class="nc" id="L1046">					trackVirnBean.setStatus(&quot;PND_PAY&quot;);</span>
<span class="nc" id="L1047">					trackVirnBean.setPwt_amt(resultSet.getString(&quot;pwt_amt&quot;));</span>
<span class="nc" id="L1048">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L1049">					trackVirnBean.setRemarks(&quot;PND_PAY&quot;);</span>
<span class="nc" id="L1050">					trackVirnBean.setRemarks(&quot;This VIRN is requested To &quot;</span>
							+ reqToType + &quot;: &quot; + reqToOrgName
							+ &quot; for payment &lt;br&gt; Voucher id: &quot; + receiptNumber);
					// pwtBean.setMessage(&quot;This VIRN has Beean Approved And
					// Pending to Payment&quot;);
<span class="nc bnc" id="L1055" title="All 2 branches missed.">				} else if (prizeStatus.equalsIgnoreCase(&quot;UNCLM_PWT&quot;)) {</span>
<span class="nc" id="L1056">					trackVirnBean.setClaimed_at(&quot;NA&quot;);</span>
<span class="nc" id="L1057">					trackVirnBean.setClaimed_by(&quot;NA&quot;);</span>
<span class="nc" id="L1058">					trackVirnBean.setClaimed_on_date(&quot;NA&quot;);</span>
<span class="nc" id="L1059">					trackVirnBean.setStatus(&quot;NA&quot;);</span>
<span class="nc" id="L1060">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L1061">					trackVirnBean.setRemarks(&quot;UNDISCLOSED&quot;);</span>

<span class="nc bnc" id="L1063" title="All 2 branches missed.">				} else if (prizeStatus.equalsIgnoreCase(&quot;UNCLM_CANCELLED&quot;)) {</span>
<span class="nc" id="L1064">					trackVirnBean.setClaimed_at(&quot;NA&quot;);</span>
<span class="nc" id="L1065">					trackVirnBean.setClaimed_by(&quot;NA&quot;);</span>
<span class="nc" id="L1066">					trackVirnBean.setClaimed_on_date(&quot;NA&quot;);</span>
<span class="nc" id="L1067">					trackVirnBean.setStatus(&quot;NA&quot;);</span>
<span class="nc" id="L1068">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L1069">					trackVirnBean.setRemarks(&quot;UNDISCLOSED&quot;);</span>
<span class="nc bnc" id="L1070" title="All 2 branches missed.">				} else if (prizeStatus.equalsIgnoreCase(&quot;CANCELLED_PERMANENT&quot;)) {</span>
<span class="nc" id="L1071">					trackVirnBean.setClaimed_at(&quot;NA&quot;);</span>
<span class="nc" id="L1072">					trackVirnBean.setClaimed_by(&quot;NA&quot;);</span>
<span class="nc" id="L1073">					trackVirnBean.setClaimed_on_date(&quot;NA&quot;);</span>
<span class="nc" id="L1074">					trackVirnBean.setStatus(&quot;UNCLAIMED&quot;);</span>
<span class="nc" id="L1075">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L1076">					trackVirnBean</span>
							.setRemarks(&quot;This VIRN is cancelled Permanently&quot;);

<span class="nc bnc" id="L1079" title="All 2 branches missed.">				}else if (prizeStatus.equalsIgnoreCase(&quot;NO_PRIZE_PWT&quot;)) {</span>
<span class="nc" id="L1080">					trackVirnBean.setClaimed_at(&quot;NA&quot;);</span>
<span class="nc" id="L1081">					trackVirnBean.setClaimed_by(&quot;NA&quot;);</span>
<span class="nc" id="L1082">					trackVirnBean.setClaimed_on_date(&quot;NA&quot;);</span>
<span class="nc" id="L1083">					trackVirnBean.setStatus(&quot;NO_PRIZE_PWT&quot;);</span>
<span class="nc" id="L1084">					trackVirnBean.setVirn_code(virnNumber);</span>
<span class="nc" id="L1085">					trackVirnBean</span>
							.setRemarks(&quot;NON WINNING&quot;);

				} else {
<span class="nc" id="L1089">					System.out.println(&quot;UNdefined status for PWT&quot;);</span>
<span class="nc" id="L1090">					trackVirnBean.setStatus(&quot;UNDefined Status For PWT&quot;</span>
							+ prizeStatus);
<span class="nc" id="L1092">					CommonMethods</span>
							.sendMail(&quot;ERROR :: status not matched in pwt inv table  virn =  &quot;
									+ encodedVirn);
				}
			} else {
<span class="nc" id="L1097">				trackVirnBean.setRemarks(&quot; UNDISCLOSED&quot;);</span>
			}
<span class="nc" id="L1099">			return trackVirnBean;</span>

<span class="nc" id="L1101">		} catch (SQLException e) {</span>
<span class="nc" id="L1102">			e.printStackTrace();</span>
<span class="nc" id="L1103">			throw new LMSException(e);</span>
		} finally {

<span class="nc" id="L1106">			try {</span>
<span class="nc bnc" id="L1107" title="All 4 branches missed.">				if (connection != null) {</span>
<span class="nc" id="L1108">					connection.close();</span>
				}
<span class="nc" id="L1110">			} catch (SQLException se) {</span>
<span class="nc" id="L1111">				se.printStackTrace();</span>
<span class="nc" id="L1112">			}</span>
		}

	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>