<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GraphReportHelper.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">lms</a> &gt; <a href="index.source.html" class="el_package">com.skilrock.lms.coreEngine.reportsMgmt.common</a> &gt; <span class="el_source">GraphReportHelper.java</span></div><h1>GraphReportHelper.java</h1><pre class="source lang-java linenums">
package com.skilrock.lms.coreEngine.reportsMgmt.common;

import java.io.File;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.sql.Timestamp;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.HashMap;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;
import java.util.TreeMap;

import net.sf.jasperreports.engine.JRException;
import net.sf.jasperreports.engine.JRResultSetDataSource;
import net.sf.jasperreports.engine.JasperExportManager;
import net.sf.jasperreports.engine.JasperFillManager;
import net.sf.jasperreports.engine.JasperPrint;
import net.sf.jasperreports.engine.JasperReport;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.apache.struts2.ServletActionContext;

import com.skilrock.lms.beans.AgtLedAccDetailsBean;
import com.skilrock.lms.beans.RetLedAccDetailsBean;
import com.skilrock.lms.common.db.DBConnect;
import com.skilrock.lms.common.db.QueryManager;
import com.skilrock.lms.web.reportsMgmt.common.GraphReportAction;
import com.skilrock.lms.web.reportsMgmt.common.LedgerAction;

/**
 * This Helper class is for Generating the Reports in Pdf format using Jasper
 * Reports
 * 
 * @author Skilrock Technologies
 * 
 */

<span class="nc" id="L48">public class GraphReportHelper {</span>
<span class="nc" id="L49">	private static Log logger = LogFactory.getLog(GraphReportHelper.class);</span>

	public static void main(String[] args) {
<span class="nc" id="L52">		Calendar from = Calendar.getInstance();</span>
<span class="nc" id="L53">		Calendar to = Calendar.getInstance();</span>
<span class="nc" id="L54">		Timestamp fromDate = new Timestamp(new Date().getTime());</span>
<span class="nc" id="L55">		from.setTimeInMillis(fromDate.getTime());</span>
<span class="nc" id="L56">		SimpleDateFormat formatDB = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span>

<span class="nc" id="L58">		System.out.println(&quot;frTimeList &quot; + formatDB.format(from.getTime()));</span>
<span class="nc" id="L59">	}</span>

<span class="nc" id="L61">	byte bytes[] = null;</span>
<span class="nc" id="L62">	Connection connection = null;</span>
<span class="nc" id="L63">	String EXPORT_LOCATION = null;</span>
	JasperPrint jasperPrint;
	JasperReport jasperReport;
<span class="nc" id="L66">	String newfile = null;</span>
<span class="nc" id="L67">	PreparedStatement Pstmt = null;</span>
<span class="nc" id="L68">	ResultSet resultSet = null;</span>
<span class="nc" id="L69">	ResultSet resultSet1 = null;</span>
<span class="nc" id="L70">	ResultSet resultSet2 = null;</span>
<span class="nc" id="L71">	Statement statement = null;</span>
<span class="nc" id="L72">	PreparedStatement statement2 = null;</span>

<span class="nc" id="L74">	String str = null;</span>

	public void createTempChqReceipt(String receipt_id, String boOrgName,
			int userOrgID, String root_path) {
<span class="nc" id="L78">		String query = null;</span>
<span class="nc" id="L79">		String file = null;</span>

<span class="nc" id="L81">		HashMap parameterMap = new HashMap();</span>

<span class="nc" id="L83">		System.out</span>
				.println(&quot;======================= reciept_id : &quot; + receipt_id);
<span class="nc" id="L85">		System.setProperty(&quot;java.awt.headless&quot;, &quot;true&quot;);</span>
<span class="nc" id="L86">		String orgAdd = null;</span>
<span class="nc" id="L87">		String addQuery = null;</span>
<span class="nc" id="L88">		String vatNum = null;</span>
<span class="nc" id="L89">		LedgerHelper ledger = new LedgerHelper();</span>
<span class="nc" id="L90">		String timeFormat = null;</span>
<span class="nc" id="L91">		String currencySymbol = null;</span>
<span class="nc" id="L92">		String decimalFormat = null;</span>
<span class="nc" id="L93">		String dateFormat = null;</span>
<span class="nc" id="L94">		String textForTax = null;</span>

		try {
<span class="nc" id="L97">			timeFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TIME_FORMAT&quot;);
<span class="nc" id="L99">			currencySymbol = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;CURRENCY_SYMBOL&quot;);
<span class="nc" id="L101">			decimalFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;DECIMAL_FORMAT&quot;);
<span class="nc" id="L103">			dateFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;date_format&quot;);
<span class="nc" id="L105">			textForTax = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TEXT_FOR_TAX&quot;);
<span class="nc" id="L107">			parameterMap.put(&quot;decimal_format&quot;, decimalFormat);</span>
<span class="nc" id="L108">			parameterMap.put(&quot;timeFormat&quot;, timeFormat);</span>
<span class="nc" id="L109">			parameterMap.put(&quot;currency_symbol&quot;, currencySymbol);</span>
<span class="nc" id="L110">			parameterMap.put(&quot;dateFormat&quot;, dateFormat);</span>
<span class="nc" id="L111">			parameterMap.put(&quot;textForTax&quot;, textForTax);</span>

<span class="nc" id="L113">			addQuery = QueryManager.getST6AddressQuery();</span>
<span class="nc" id="L114">			orgAdd = ledger.getAddress(addQuery, &quot;&quot; + userOrgID, null);</span>
<span class="nc" id="L115">			parameterMap.put(&quot;orgAdd&quot;, orgAdd);</span>
<span class="nc" id="L116">			parameterMap.put(&quot;header&quot;, boOrgName);</span>

<span class="nc" id="L118">			vatNum = ledger.getVatNumber(&quot;&quot; + userOrgID);</span>
<span class="nc" id="L119">		} catch (Exception e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L121">			System.out.println(&quot;inside helper vat number&quot;);</span>
<span class="nc" id="L122">			e.printStackTrace();</span>
<span class="nc" id="L123">		}</span>
<span class="nc" id="L124">		parameterMap.put(&quot;vatNum&quot;, vatNum);</span>
<span class="nc" id="L125">		parameterMap.put(&quot;receipt_id&quot;, receipt_id);</span>
		// query = &quot;select receipt_type,id from st_lms_bo_receipts where id
		// ='&quot;+receipt_id+&quot;'&quot;;

<span class="nc" id="L129">		System.out</span>
				.println(&quot;================== inside reciept =================&quot;);
		// query=&quot;select
		// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,net_amount
		// ,comm_amount from st_lms_organization_master som ,(select 'cash'
		// t_type,cash_agent as agent,cash_amount as amount ,cash_amount as
		// net_amount ,0.00 comm_amount ,cash_trans_id as trans_id, 'cash'
		// issuing_party_name,'cash' cheque_nbr,'cash' cheque_date, 'cash'
		// drawee_bank,cash_id as id from ( select id as
		// cash_id,sbct.agent_org_id as cash_agent,sbct.amount as cash_amount
		// ,sbct.transaction_id as cash_trans_id from st_lms_bo_cash_transaction
		// sbct, (select id,transaction_id from st_lms_bo_receipts_trn_mapping
		// where id= '&quot;+receipt_id+&quot;') innermost where
		// sbct.transaction_id=innermost.transaction_id) cash union select 'pwt'
		// t_type,pwt_agent as agent,pwt_amount as amount,net_amount
		// ,comm_amount ,pwt_trans_id as trans_id,'pwt' issuing_party_name,'pwt'
		// cheque_nbr, 'pwt' cheque_date, 'pwt' drawee_bank , pwt_id as id from
		// (select id as pwt_id,sbp.agent_org_id as pwt_agent,sum(sbp.pwt_amt)
		// as pwt_amount,sum(sbp.net_amt)as net_amount ,sum(sbp.comm_amt)as
		// comm_amount,sbp.transaction_id as pwt_trans_id from st_se_bo_pwt sbp,
		// (select id,transaction_id from st_lms_bo_receipts_trn_mapping where
		// id= '&quot;+receipt_id+&quot;') innermost where
		// sbp.transaction_id=innermost.transaction_id group by
		// sbp.transaction_id) pwt union select 'cheque' t_type,cheque_agent as
		// agent,cheque_amt as amount,cheque_amt as net_amount ,0.00
		// comm_amount,cheque_id as
		// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id
		// from ( select id ,agent_org_id as
		// cheque_agent,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
		// as cheque_id from st_lms_bo_sale_chq sbsc, (select id,transaction_id
		// from st_lms_bo_receipts_trn_mapping where id= '&quot;+receipt_id+&quot;')
		// innermost where sbsc.transaction_id=innermost.transaction_id) cheque)
		// result where result.agent = som.organization_id&quot;;
<span class="nc" id="L162">		query = &quot;select  name,addr_line1,addr_line2,city,cheque_nbr,cheque_date,cheque_receiving_date,issuing_party_name,drawee_bank,cheque_amt from st_lms_bo_cheque_temp_receipt sbctr, st_lms_organization_master som  where temp_receipt_id='&quot;</span>
				+ receipt_id
				+ &quot;' and (sbctr.agent_org_id = som.organization_id)&quot;;
<span class="nc" id="L165">		System.out.println(&quot; RECEIPT queryyyyyyyyyyyyyyyy BOOOOO &quot; + query);</span>
<span class="nc" id="L166">		file = root_path</span>
				+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/TempReceipt.jasper&quot;;
<span class="nc" id="L168">		generateReport(query, file, parameterMap, null, null, null, null);</span>

<span class="nc" id="L170">		System.out.println(&quot;Query -- &quot; + query);</span>

<span class="nc" id="L172">	}</span>

	/**
	 * This method checks which type of Receipt is to be Generated at Agent End
	 * and send the data to Graph Report Method for generation of Pdf Receipts
	 * 
	 * @param receipt_id
	 *            as Integer
	 * @param root_path
	 *            as String
	 * @param agent_name
	 *            as String
	 */
	public void createTextReportAgent(int receipt_id, String root_path,
			int userOrgID, String agent_name) {
<span class="nc" id="L187">		String receipt_type = null;</span>

<span class="nc" id="L189">		connection = DBConnect.getConnection();</span>
<span class="nc" id="L190">		Statement stmt = null;</span>
<span class="nc" id="L191">		ResultSet rs = null;</span>
<span class="nc" id="L192">		String query = null;</span>
<span class="nc" id="L193">		String file = null;</span>
<span class="nc" id="L194">		HashMap parameterMap = new HashMap();</span>
<span class="nc" id="L195">		String orgAdd = null;</span>
<span class="nc" id="L196">		String addQuery = null;</span>
<span class="nc" id="L197">		String vatQuery = null;</span>
<span class="nc" id="L198">		String vatNum = null;</span>
<span class="nc" id="L199">		String receipt_no = null;</span>
<span class="nc" id="L200">		String trnType = null;</span>
<span class="nc" id="L201">		String fileName = null;</span>
<span class="nc" id="L202">		String isVatApplicable = null;</span>
<span class="nc" id="L203">		String isCommApplicable = null;</span>
<span class="nc" id="L204">		LedgerHelper ledger = new LedgerHelper();</span>
<span class="nc" id="L205">		addQuery = QueryManager.getST6AddressQuery();</span>
<span class="nc" id="L206">		String timeFormat = null;</span>
<span class="nc" id="L207">		String currencySymbol = null;</span>
<span class="nc" id="L208">		String dateFormat = null;</span>
<span class="nc" id="L209">		String decimalFormat = null;</span>
<span class="nc" id="L210">		String tdsPartyName = null;</span>
<span class="nc" id="L211">		String vatPartyName = null;</span>
<span class="nc" id="L212">		String govComPartyName = null;</span>
<span class="nc" id="L213">		String textForTax = null;</span>
<span class="nc" id="L214">		Timestamp voucher_date = null;</span>
		try {
<span class="nc" id="L216">			timeFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TIME_FORMAT&quot;);
<span class="nc" id="L218">			currencySymbol = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;CURRENCY_SYMBOL&quot;);
<span class="nc" id="L220">			decimalFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;DECIMAL_FORMAT&quot;);
<span class="nc" id="L222">			dateFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;date_format&quot;);
<span class="nc" id="L224">			textForTax = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TEXT_FOR_TAX&quot;);
<span class="nc" id="L226">			parameterMap.put(&quot;decimal_format&quot;, decimalFormat);</span>
<span class="nc" id="L227">			parameterMap.put(&quot;timeFormat&quot;, timeFormat);</span>
<span class="nc" id="L228">			parameterMap.put(&quot;currency_symbol&quot;, currencySymbol);</span>
<span class="nc" id="L229">			parameterMap.put(&quot;dateFormat&quot;, dateFormat);</span>
<span class="nc" id="L230">			parameterMap.put(&quot;textForTax&quot;, textForTax);</span>

<span class="nc" id="L232">			orgAdd = ledger.getAddress(addQuery, &quot;&quot; + userOrgID, null);</span>

<span class="nc" id="L234">			parameterMap.put(&quot;orgAdd&quot;, orgAdd);</span>

<span class="nc" id="L236">			System.out.println(&quot;createTextReportAgent  ))))))))))))&quot;);</span>
<span class="nc" id="L237">			System.setProperty(&quot;java.awt.headless&quot;, &quot;true&quot;);</span>
<span class="nc" id="L238">			parameterMap.put(&quot;header&quot;, agent_name);</span>

<span class="nc" id="L240">			vatNum = ledger.getVatNumber(&quot;&quot; + userOrgID);</span>
<span class="nc" id="L241">			parameterMap.put(&quot;vatNum&quot;, vatNum);</span>
<span class="nc" id="L242">			stmt = connection.createStatement();</span>
			// query = &quot;select receipt_type,id from st_lms_agent_receipts where
			// id ='&quot;+receipt_id+&quot;'&quot;;
			// query = &quot;select receipt_type,id,generated_id from
			// st_lms_agent_receipts_gen_mapping where id='&quot;+receipt_id+&quot;'&quot;;
			// query=&quot;select
			// sbtm.transaction_id,transaction_type,sbrgm.receipt_type,sbrgm.generated_id
			// from st_lms_agent_receipts_trn_mapping
			// sbrtm,st_lms_agent_transaction_master
			// sbtm,st_lms_agent_receipts_gen_mapping sbrgm where
			// sbrgm.id='&quot;+receipt_id+&quot;' and
			// sbrtm.transaction_id=sbtm.transaction_id and sbrgm.id=sbrtm.id&quot;;
<span class="nc" id="L254">			query = &quot;select sbtm.transaction_id,transaction_type,sbr.voucher_date,sbr.receipt_type,sbr.generated_id from st_lms_agent_receipts_trn_mapping sbrtm,st_lms_agent_transaction_master sbtm,st_lms_agent_receipts sbr where sbr.receipt_id='&quot;</span>
					+ receipt_id
					+ &quot;' and  sbrtm.transaction_id=sbtm.transaction_id and sbr.receipt_id=sbrtm.receipt_id&quot;;
<span class="nc" id="L257">			rs = stmt.executeQuery(query);</span>
<span class="nc" id="L258">			System.out.println(rs.getFetchSize() + &quot;:::: &quot; + query);</span>
<span class="nc bnc" id="L259" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L260">				System.out.println(&quot;inside whileeeeeeeeeeeee&quot;</span>
						+ rs.getString(&quot;receipt_type&quot;));
<span class="nc" id="L262">				receipt_type = rs.getString(&quot;receipt_type&quot;);</span>
<span class="nc" id="L263">				receipt_no = rs.getString(&quot;generated_id&quot;);</span>
<span class="nc" id="L264">				trnType = rs.getString(&quot;transaction_type&quot;);</span>
<span class="nc" id="L265">				voucher_date = rs.getTimestamp(&quot;voucher_date&quot;);</span>
			}
<span class="nc" id="L267">			System.out.println(&quot;receipt type is  &quot; + receipt_type);</span>
<span class="nc" id="L268">			root_path = root_path.replace(&quot;\\&quot;, &quot;/&quot;);</span>
<span class="nc" id="L269">			parameterMap.put(&quot;receipt_no&quot;, receipt_no);</span>
<span class="nc" id="L270">			parameterMap.put(&quot;voucher_date&quot;, voucher_date);</span>
<span class="nc" id="L271">			isVatApplicable = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;VAT_APPLICABLE&quot;);
<span class="nc" id="L273">			isCommApplicable = (String) ServletActionContext</span>
					.getServletContext().getAttribute(&quot;COMM_APPLICABLE&quot;);
<span class="nc bnc" id="L275" title="All 2 branches missed.">			if (receipt_type.equalsIgnoreCase(&quot;DG_INVOICE&quot;)) {</span>
<span class="nc" id="L276">				query = &quot;select id,game_name,transaction_date,voucher_date,mrp_amt as sale, net_amt,comm_amt,vat,taxable_sale,name,addr_line1,addr_line2,city,sale.transaction_id as transaction_id from st_dg_game_master sdgm ,st_lms_organization_master som ,(select voucher_date,retailer_id,id,game_id ,retailer_comm as comm_amt, mrp_amt, net_amt, vat_amt as vat, taxable_sale,sbs.transaction_id, btm.transaction_date from st_dg_agt_sale sbs, st_lms_agent_transaction_master btm, (select slbr.voucher_date, slbr.party_id as retailer_id, slbr.receipt_id as id, transaction_id from st_lms_agent_receipts_trn_mapping slbrtm, st_lms_agent_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;</span>
						+ receipt_id
						+ &quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id)sale where sale.game_id = sdgm.game_id and som.organization_id = sale.retailer_id order by transaction_date&quot;;
<span class="nc" id="L279">				System.out.println(&quot;DG_INVOICE Query****: &quot; + query);</span>
<span class="nc bnc" id="L280" title="All 2 branches missed.">				if (&quot;DG_SALE&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc bnc" id="L281" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L283">						fileName = &quot;DGSaleInvcComVat.jasper&quot;;</span>
<span class="nc bnc" id="L284" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L286">						fileName = &quot;DGSaleInvcComNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L287" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L289">						fileName = &quot;DGSaleInvcRdpNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L290" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L292">						fileName = &quot;DGSaleInvcRdpVat.jasper&quot;;</span>
					}
				}
<span class="nc" id="L295">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
						+ fileName;
<span class="nc" id="L298">				generateReport(query, file, parameterMap, null, null, null,</span>
						null);
			}
<span class="nc bnc" id="L301" title="All 2 branches missed.">			if (receipt_type.equalsIgnoreCase(&quot;SLE_INVOICE&quot;)) {</span>
<span class="nc" id="L302">				query = &quot;select id,game_disp_name game_name,transaction_date,voucher_date,mrp_amt as sale, net_amt,comm_amt,vat,taxable_sale,name,addr_line1,addr_line2,city,sale.transaction_id as transaction_id from st_sle_game_master sdgm ,st_lms_organization_master som ,(select voucher_date,retailer_id,id,game_id ,retailer_comm as comm_amt, mrp_amt, net_amt, vat_amt as vat, taxable_sale,sbs.transaction_id, btm.transaction_date from st_sle_agt_sale sbs, st_lms_agent_transaction_master btm, (select slbr.voucher_date, slbr.party_id as retailer_id, slbr.receipt_id as id, transaction_id from st_lms_agent_receipts_trn_mapping slbrtm, st_lms_agent_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;</span>
						+ receipt_id
						+ &quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id)sale where sale.game_id = sdgm.game_id and som.organization_id = sale.retailer_id order by transaction_date&quot;;
<span class="nc" id="L305">				System.out.println(&quot;SLE_INVOICE Query****: &quot; + query);</span>
<span class="nc bnc" id="L306" title="All 2 branches missed.">				if (&quot;SLE_SALE&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc bnc" id="L307" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L309">						fileName = &quot;SLESaleInvcComVat.jasper&quot;;</span>
<span class="nc bnc" id="L310" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L312">						fileName = &quot;SLESaleInvcComNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L313" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L315">						fileName = &quot;SLESaleInvcRdpNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L316" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L318">						fileName = &quot;SLESaleInvcRdpVat.jasper&quot;;</span>
					}
				}
<span class="nc" id="L321">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
						+ fileName;
<span class="nc" id="L324">				generateReport(query, file, parameterMap, null, null, null,</span>
						null);
			}
<span class="nc bnc" id="L327" title="All 2 branches missed.">			if(receipt_type.equalsIgnoreCase(&quot;CS_INVOICE&quot;)){</span>
<span class="nc bnc" id="L328" title="All 2 branches missed.">			if (&quot;CS_SALE&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc" id="L329">				query = &quot;select id,product_code,description,transaction_date,voucher_date,mrp_amt as sale, net_amt, comm_amt,vat,name,addr_line1,addr_line2,city,sale.transaction_id as transaction_id from st_cs_product_master scpm ,st_lms_organization_master som ,(select retailer_id,voucher_date,id,product_id ,(mrp_amt*retailer_comm/100) as comm_amt, mrp_amt, net_amt, vat_amt as vat, sbs.transaction_id, btm.transaction_date from st_cs_agt_sale sbs, st_lms_agent_transaction_master btm, (select slbr.voucher_date as voucher_date,slbr.party_id as retailer_id, slbr.receipt_id as id, transaction_id from st_lms_agent_receipts_trn_mapping slbrtm, st_lms_agent_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+</span>
				+ receipt_id
				+ &quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id)sale where sale.product_id = scpm.product_id and scpm.product_id and som.organization_id = sale.retailer_id order by transaction_date&quot;;
<span class="nc" id="L332">				System.out</span>
						.println(&quot; CS_INVOICE queryyyyyyyyyyyyyyyy AGTTTTTTTTTT &quot;
								+ query);
<span class="nc bnc" id="L335" title="All 4 branches missed.">				if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
						&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L337">					fileName = &quot;CSSaleInvcComVat.jasper&quot;; // changes</span>
					// .jasper to
					// jrxml
<span class="nc bnc" id="L340" title="All 4 branches missed.">				} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
						&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L342">					fileName = &quot;CSSaleInvcComNoVat.jasper&quot;; // changes</span>
					// .jasper to
					// jrxml
<span class="nc bnc" id="L345" title="All 4 branches missed.">				} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
						&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L347">					fileName = &quot;CSSaleInvcRdpNoVat.jasper&quot;;// changes</span>
					// .jasper to
					// jrxml
<span class="nc bnc" id="L350" title="All 4 branches missed.">				} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
						&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L352">					fileName = &quot;CSSaleInvcRdpVat.jasper&quot;;//</span>
				}
			}
<span class="nc" id="L355">			file = root_path</span>
					+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
					+ fileName;
<span class="nc" id="L358">			generateReport(query, file, parameterMap, null, null, null,</span>
					null);
		}
<span class="nc bnc" id="L361" title="All 2 branches missed.">			if (receipt_type.equalsIgnoreCase(&quot;OLA_INVOICE&quot;)) {</span>
<span class="nc bnc" id="L362" title="All 2 branches missed.">				if (&quot;OLA_DEPOSIT&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc" id="L363">				query = &quot;select id,wallet_name,transaction_date,voucher_date,deposit_amt as deposit, net_amt,(deposit_amt-net_amt) as comm_amt,name,addr_line1,addr_line2,city,deposit.transaction_id as transaction_id from st_ola_wallet_master sdgm ,st_lms_organization_master som ,(select retailer_org_id,voucher_date,id,wallet_id ,retailer_comm as comm_amt, deposit_amt, net_amt,sbs.transaction_id, btm.transaction_date from st_ola_agt_deposit sbs, st_lms_agent_transaction_master btm, (select slbr.party_id as retailer_id,slbr.voucher_date as voucher_date,slbr.receipt_id as id, transaction_id from st_lms_agent_receipts_trn_mapping slbrtm, st_lms_agent_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+receipt_id+&quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id)deposit where deposit.wallet_id = sdgm.wallet_id and som.organization_id = deposit.retailer_org_id&quot;;</span>
<span class="nc" id="L364">				System.out.println(&quot;OLA_INVOICE Query****: &quot; + query);</span>
				
<span class="nc" id="L366">				fileName = &quot;OLADepositInvcRdpNoVat.jasper&quot;;</span>
					
				}
<span class="nc" id="L369">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
						+ fileName;
<span class="nc" id="L372">				generateReport(query, file, parameterMap, null, null, null,</span>
						null);
			}
<span class="nc bnc" id="L375" title="All 2 branches missed.">			if (receipt_type.equalsIgnoreCase(&quot;OLA_RECEIPT&quot;)) {</span>
<span class="nc bnc" id="L376" title="All 2 branches missed.">				if (&quot;OLA_WITHDRAWL&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc" id="L377">				query = &quot;select id,wallet_name,transaction_date,voucher_date,withdrawl_amt as withdrawal, net_amt,(withdrawl_amt-net_amt) as comm_amt,name,addr_line1,addr_line2,city,deposit.transaction_id as transaction_id from st_ola_wallet_master sdgm ,st_lms_organization_master som ,(select retailer_org_id,voucher_date,id,wallet_id ,retailer_comm as comm_amt, withdrawl_amt, net_amt,sbs.transaction_id, btm.transaction_date from st_ola_agt_withdrawl sbs, st_lms_agent_transaction_master btm, (select slbr.party_id as retailer_id,slbr.voucher_date as voucher_date,slbr.receipt_id as id, transaction_id from st_lms_agent_receipts_trn_mapping slbrtm, st_lms_agent_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+receipt_id+&quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id)deposit where deposit.wallet_id = sdgm.wallet_id and som.organization_id = deposit.retailer_org_id&quot;;</span>
<span class="nc" id="L378">				System.out.println(&quot;OLA_RECEIPT Query****: &quot; + query);</span>
				
<span class="nc" id="L380">				fileName = &quot;OLAWithdrawalInvcRdpNoVat.jasper&quot;;</span>
					
<span class="nc bnc" id="L382" title="All 2 branches missed.">				}else if(&quot;OLA_COMMISSION&quot;.equalsIgnoreCase(trnType)){</span>
<span class="nc" id="L383">					query = &quot;select id,wallet_name,transaction_date,voucher_date,comm_amt,name,addr_line1,addr_line2,city,netgame.transaction_id as transaction_id ,netgame.tds_comm_rate,net_comm_amt from st_ola_wallet_master sdgm ,st_lms_organization_master som ,(select retailer_org_id,voucher_date,id,wallet_id ,ret_claim_comm as net_comm_amt, sbs.transaction_id, btm.transaction_date,sbs.tds_comm_rate ,ret_mrp_comm comm_amt from st_ola_agt_comm sbs, st_lms_agent_transaction_master btm, (select slbr.party_id as retailer_id,slbr.voucher_date as voucher_date,slbr.receipt_id as id, transaction_id from st_lms_agent_receipts_trn_mapping slbrtm, st_lms_agent_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id ='&quot;+receipt_id+&quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id)netgame where netgame.wallet_id = sdgm.wallet_id and som.organization_id = netgame.retailer_org_id&quot;;</span>
<span class="nc" id="L384">					System.out.println(&quot;OLA_RECEIPT Query****: &quot; + query);</span>
<span class="nc" id="L385">					fileName = &quot;OLANetGameInvcRdpNoVat.jasper&quot;;</span>
				}
					
<span class="nc" id="L388">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
						+ fileName;
<span class="nc" id="L391">				generateReport(query, file, parameterMap, null, null, null,</span>
						null);
			}
<span class="nc bnc" id="L394" title="All 2 branches missed.">			if (receipt_type.equalsIgnoreCase(&quot;INVOICE&quot;)) {</span>
<span class="nc bnc" id="L395" title="All 2 branches missed.">				if (&quot;SALE&quot;.equalsIgnoreCase(trnType)) {</span>
					// query=&quot;select
					// distinct(transaction_id),retailer_sale_comm_rate,name,addr_line1,addr_line2,city,retailer_org_id,id,game_name
					// , ticket_price, nbr_of_tickets_per_book ,
					// nbr_of_books,taxable_sale,vat_amt,comm_amt, sale,
					// (nbr_of_tickets_per_book*nbr_of_books)as
					// total_tickets,transaction_date,order_id,order_date from
					// st_lms_organization_master som ,(select
					// retailer_sale_comm_rate,id,sale.retailer_org_id,game_name
					// , ticket_price, nbr_of_tickets_per_book ,
					// sale.nbr_of_books, (net_amt) as
					// sale,taxable_sale,vat_amt,comm_amt,transaction_date,sale.order_id,order_date,transaction_id
					// from st_se_game_master ,st_se_agent_order sao,(select
					// sbat.retailer_org_id,id,sbat.game_id ,
					// nbr_of_books,vat_amt,comm_amt,taxable_sale,net_amt,sbat.transaction_id,transaction_date,order_id
					// from st_se_agent_retailer_transaction sbat
					// ,st_se_agent_order_invoices saoi,(select receipt_id as
					// id,transaction_id from st_lms_agent_receipts_trn_mapping
					// where receipt_id = '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_date,transaction_id from
					// st_lms_agent_transaction_master )satm where
					// sbat.transaction_id = innermost.transaction_id and
					// innermost.transaction_id=satm.transaction_id and
					// saoi.invoice_id=innermost.id ) sale where sale.game_id =
					// st_se_game_master.game_id and sao.order_id=sale.order_id
					// )result1 where
					// som.organization_id=result1.retailer_org_id&quot;;
//					query = &quot;select distinct(transaction_id),retailer_sale_comm_rate,name,addr_line1,addr_line2,city,retailer_org_id,id,game_name , ticket_price, nbr_of_tickets_per_book , nbr_of_books,taxable_sale,vat_amt,comm_amt,  sale, (nbr_of_tickets_per_book*nbr_of_books)as total_tickets,transaction_date,order_id,order_date from  st_lms_organization_master som ,(select retailer_sale_comm_rate,id,sale.retailer_org_id,game_name , ticket_price, nbr_of_tickets_per_book , sale.nbr_of_books, (net_amt) as sale,taxable_sale,sale.vat_amt,comm_amt,transaction_date,sale.order_id,order_date,transaction_id from st_se_game_master ,st_se_agent_order sao,(select sbat.retailer_org_id,id,sbat.game_id , nbr_of_books,vat_amt,comm_amt,taxable_sale,net_amt,sbat.transaction_id,transaction_date,order_id from st_se_agent_retailer_transaction sbat ,st_se_agent_order_invoices saoi,(select receipt_id as id,transaction_id from st_lms_agent_receipts_trn_mapping where receipt_id = '&quot;
//							+ receipt_id
//							+ &quot;') innermost,(select transaction_date,transaction_id from st_lms_agent_transaction_master )satm where sbat.transaction_id = innermost.transaction_id and  innermost.transaction_id=satm.transaction_id  and saoi.invoice_id=innermost.id ) sale where sale.game_id = st_se_game_master.game_id  and sao.order_id=sale.order_id )result1 where som.organization_id=result1.retailer_org_id order by transaction_date&quot;;
					
<span class="nc" id="L426">					query = &quot;select distinct(transaction_id),retailer_sale_comm_rate,name,addr_line1,addr_line2,city,retailer_org_id,id,game_name , ticket_price, nbr_of_tickets_per_book , nbr_of_books,taxable_sale,vat_amt,comm_amt,  sale, (nbr_of_tickets_per_book*nbr_of_books)as total_tickets,transaction_date, 'NA' order_id, 'NA' order_date from  st_lms_organization_master som ,(select retailer_sale_comm_rate,id,sale.retailer_org_id,game_name , ticket_price, nbr_of_tickets_per_book , sale.nbr_of_books, (net_amt) as sale,taxable_sale,sale.vat_amt,comm_amt,transaction_date,transaction_id from st_se_game_master,(select sbat.retailer_org_id,id,sbat.game_id , nbr_of_books,vat_amt,comm_amt, taxable_sale, net_amt, sbat.transaction_id, transaction_date from st_se_agent_retailer_transaction sbat,(select receipt_id as id,transaction_id from st_lms_agent_receipts_trn_mapping where receipt_id = '&quot;</span>
							+ receipt_id
							+ &quot;') innermost,(select transaction_date,transaction_id from st_lms_agent_transaction_master)satm where sbat.transaction_id = innermost.transaction_id and  innermost.transaction_id=satm.transaction_id) sale where sale.game_id = st_se_game_master.game_id)result1 where som.organization_id=result1.retailer_org_id order by transaction_date&quot;;
<span class="nc" id="L429">					System.out.println(&quot; INVOICE QUERYYYY&quot; + query);</span>

<span class="nc" id="L431">					String addressInvoice = getAddress(query);</span>
<span class="nc" id="L432">					parameterMap.put(&quot;address&quot;, addressInvoice);</span>
					// file=root_path+&quot;com/skilrock/lms/web/reportsMgmt/compiledReports/InvoiceRet.jasper&quot;;
<span class="nc bnc" id="L434" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L436">						fileName = &quot;InvcComVat.jasper&quot;;</span>
<span class="nc bnc" id="L437" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L439">						fileName = &quot;InvcComNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L440" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L442">						fileName = &quot;InvcRdpNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L443" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L445">						fileName = &quot;InvcRdpVat.jasper&quot;;</span>
					}
<span class="nc bnc" id="L447" title="All 2 branches missed.">				}  else if (&quot;LOOSE_SALE&quot;.equalsIgnoreCase(trnType)) {</span>
					
<span class="nc" id="L449">					query = &quot;select id,game_name,organization_id,transaction_date,nbr_of_tickets nbrOfTickets, net_amt sale, retailer_sale_comm_rate agent_sale_comm_rate,name,addr_line1,addr_line2,city,sale.transaction_id as transaction_id,vat_amt,taxable_sale,ticket_price,comm_amt,retComm agtSaleCommRate from st_lms_organization_master som ,(select retailer_org_id,id,game_name ,retailer_sale_comm_rate,sbs.nbr_of_tickets, ticket_price,taxable_sale,sbs.vat_amt ,net_amt,sbs.transaction_id, btm.transaction_date,comm_amt,retComm from st_se_agent_ret_loose_book_transaction sbs,st_se_game_master game, st_lms_agent_transaction_master btm,(select slbr.party_id as agent_id, slbr.receipt_id as id, transaction_id from st_lms_agent_receipts_trn_mapping slbrtm, st_lms_agent_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+ receipt_id+ &quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id and sbs.game_id=game.game_id)sale where som.organization_id = sale.retailer_org_id&quot;;</span>
<span class="nc" id="L450">					System.out.println(&quot; INVOICE QUERYYYY&quot; + query);</span>

<span class="nc" id="L452">					String addressInvoice = getAddress(query);</span>
<span class="nc" id="L453">					parameterMap.put(&quot;address&quot;, addressInvoice);</span>
<span class="nc bnc" id="L454" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L456">						fileName = &quot;looseSaleInvcComVat.jasper&quot;;</span>
<span class="nc bnc" id="L457" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L459">						fileName = &quot;looseSaleInvcComNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L460" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L462">						fileName = &quot;looseSaleInvcRdpNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L463" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L465">						fileName = &quot;looseSaleInvcRdpVat.jasper&quot;;</span>
					}
<span class="nc" id="L467">				}</span>
				
				else {
					// query=&quot; select id,game_name as name,taxable_sale,
					// vat,net_amt as sale,comm_amt,transaction_id from
					// st_dg_game_master sdgm ,(select id,game_id
					// ,retailer_org_id, agent_comm as comm_amt, mrp_amt,
					// vat_amt as vat,taxable_sale,net_amt,sbat.transaction_id
					// from st_dg_agt_sale sbat,(select receipt_id as
					// id,transaction_id from st_lms_agent_receipts_trn_mapping
					// where receipt_id = '&quot;+receipt_id+&quot;' ) innermost where
					// sbat.transaction_id = innermost.transaction_id )sale
					// where sale.game_id = sdgm.game_id&quot;;
<span class="nc" id="L480">					query = &quot;select name,addr_line1,addr_line2,city,game_name,taxable_sale,vat,sale,comm_amt from(select id,retailer_org_id,game_name,taxable_sale, vat,net_amt as sale,comm_amt,transaction_id from st_dg_game_master sdgm ,(select id,game_id ,retailer_org_id, agent_comm as comm_amt, mrp_amt, vat_amt as vat,taxable_sale,net_amt,sbat.transaction_id from  st_dg_agt_sale sbat,(select receipt_id as id,transaction_id from st_lms_agent_receipts_trn_mapping where receipt_id = '&quot;</span>
							+ receipt_id
							+ &quot;' ) innermost where  sbat.transaction_id = innermost.transaction_id )sale where sale.game_id = sdgm.game_id)tab1 , st_lms_organization_master as som where tab1.retailer_org_id = som.organization_id&quot;;
<span class="nc" id="L483">					System.out.println(&quot; INVOICE queryyyyyyyyyyyyyyyy BOOOOO &quot;</span>
							+ query);

<span class="nc bnc" id="L486" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L488">						fileName = &quot;DGInvcComVat.jasper&quot;;</span>
<span class="nc bnc" id="L489" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L491">						fileName = &quot;DGInvcComNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L492" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L494">						fileName = &quot;DGInvcRdpNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L495" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L497">						fileName = &quot;DGInvcRdpVat.jasper&quot;;</span>
					}
				}

<span class="nc" id="L501">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
						+ fileName;
<span class="nc" id="L504">				generateReport(query, file, parameterMap, null, null, null,</span>
						null);

<span class="nc bnc" id="L507" title="All 2 branches missed.">			} else if (receipt_type.equalsIgnoreCase(&quot;DG_RECEIPT&quot;)) {</span>
<span class="nc" id="L508">				query = &quot;select id,game_nbr,game_name,t_type,transaction_date,pwt_amt as amount, net_amt as net_amount,comm_amt as comm_amount,name,addr_line1,addr_line2,city,sale.transaction_id as trans_id from st_dg_game_master sdgm ,st_lms_organization_master som ,(select 'pwt' t_type, retailer_id,id,game_id ,comm_amt, pwt_amt, net_amt,sbat.transaction_id,btm.transaction_date from  st_dg_agt_pwt sbat,st_lms_agent_transaction_master btm,(select slbr.party_id as retailer_id, slbr.receipt_id as id,transaction_id from st_lms_agent_receipts_trn_mapping slbrtm, st_lms_agent_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;</span>
						+ receipt_id
						+ &quot;' ) innermost where  sbat.transaction_id = innermost.transaction_id and innermost.transaction_id = btm.transaction_id)sale where sale.game_id = sdgm.game_id and som.organization_id=sale.retailer_id order by transaction_date&quot;;
<span class="nc" id="L511">				System.out</span>
						.println(&quot;DG RECEIPT PWT queryyyyyyyyyyyyyyyy BOOOOO &quot;
								+ query);
<span class="nc" id="L514">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/DGNewPWTReceipt.jasper&quot;;
<span class="nc" id="L516">				generateReport(query, file, parameterMap, null, null);</span>
			} 
<span class="nc bnc" id="L518" title="All 2 branches missed.">			else if (receipt_type.equalsIgnoreCase(&quot;SLE_RECEIPT&quot;)) {</span>
<span class="nc" id="L519">				query = &quot;select id,game_no game_nbr,game_disp_name game_name,t_type,transaction_date,pwt_amt as amount, net_amt as net_amount,comm_amt as comm_amount,name,addr_line1,addr_line2,city,sale.transaction_id as trans_id from st_sle_game_master sdgm ,st_lms_organization_master som ,(select 'pwt' t_type, retailer_id,id,game_id ,comm_amt, pwt_amt, net_amt,sbat.transaction_id,btm.transaction_date from  st_sle_agt_pwt sbat,st_lms_agent_transaction_master btm,(select slbr.party_id as retailer_id, slbr.receipt_id as id,transaction_id from st_lms_agent_receipts_trn_mapping slbrtm, st_lms_agent_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;</span>
						+ receipt_id
						+ &quot;' ) innermost where  sbat.transaction_id = innermost.transaction_id and innermost.transaction_id = btm.transaction_id)sale where sale.game_id = sdgm.game_id and som.organization_id=sale.retailer_id order by transaction_date&quot;;
<span class="nc" id="L522">				System.out</span>
						.println(&quot;SLE RECEIPT PWT queryyyyyyyyyyyyyyyy BOOOOO &quot;
								+ query);
<span class="nc" id="L525">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/SLENewPWTReceipt.jasper&quot;;
<span class="nc" id="L527">				generateReport(query, file, parameterMap, null, null);</span>
			} 
<span class="nc bnc" id="L529" title="All 4 branches missed.">			else if(receipt_type.equalsIgnoreCase(&quot;RECEIPT&quot;) &amp;&amp; trnType.equalsIgnoreCase(&quot;OLA_COMMISSION&quot;))</span>
			{
<span class="nc" id="L531">				query = &quot;select id,wallet_name,transaction_date,commission_calculated as commission_calculated,name,addr_line1,addr_line2,city,netGaming.transaction_id as transaction_id from st_ola_wallet_master sdgm ,st_lms_organization_master som ,(select ret_org_id,id,wallet_id ,commission_calculated,sbs.transaction_id, btm.transaction_date from st_ola_agt_ret_commission sbs, st_lms_agent_transaction_master btm, (select slbr.party_id as retailer_id, slbr.receipt_id as id, transaction_id from st_lms_agent_receipts_trn_mapping slbrtm, st_lms_agent_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+receipt_id+&quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id)netGaming where netGaming.wallet_id = sdgm.wallet_id and som.organization_id = netGaming.ret_org_id&quot;;</span>
<span class="nc" id="L532">				System.out</span>
						.println(&quot; RECEIPT OLA COMMISSION queryyyyyyyyyyyyyyyy BOOOOO &quot;
								+ query);
<span class="nc" id="L535">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/OLAReceipt.jasper&quot;;
<span class="nc" id="L537">				generateReport(query, file, parameterMap, null, null, null,</span>
						null);
			}
<span class="nc bnc" id="L540" title="All 2 branches missed.">			else if (receipt_type.equalsIgnoreCase(&quot;RECEIPT&quot;)) {</span>
<span class="nc" id="L541">				System.out.println(&quot;***************&quot;);</span>
<span class="nc bnc" id="L542" title="All 4 branches missed.">				if (trnType.equalsIgnoreCase(&quot;PWT&quot;)</span>
						|| trnType.equalsIgnoreCase(&quot;PWT_AUTO&quot;)) {
					// query=&quot;select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,amount,net_amount
					// ,comm_amount,transaction_date,game_nbr,game_name from
					// st_lms_organization_master som ,(select 'pwt'
					// t_type,pwt_agent as agent,pwt_amount as amount,net_amount
					// ,comm_amount ,pwt_trans_id as trans_id, pwt_id as
					// id,transaction_date,game_nbr,game_name from (select id as
					// pwt_id,sbp.retailer_org_id as pwt_agent,sum(sbp.pwt_amt)
					// as pwt_amount,sum(sbp.net_amt)as net_amount
					// ,sum(sbp.comm_amt)as comm_amount,sbp.transaction_id as
					// pwt_trans_id,transaction_date,sbp.game_id,game_nbr,game_name
					// from st_se_agent_pwt sbp,(select
					// game_nbr,game_id,game_name from st_se_game_master
					// )sgm,(select id,transaction_id from
					// st_lms_agent_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_agent_transaction_master )sbtm where
					// sbp.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id and
					// sbp.game_id=sgm.game_id group by sbp.transaction_id )
					// pwt)result where result.agent = som.organization_id&quot;;
<span class="nc" id="L566">					query = &quot;select name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,amount,net_amount ,comm_amount,transaction_date,game_nbr,game_name from st_lms_organization_master som ,(select 'pwt' t_type,pwt_agent  as agent,pwt_amount as amount,net_amount ,comm_amount ,pwt_trans_id as trans_id, pwt_id as id,transaction_date,game_nbr,game_name from (select id as pwt_id,sbp.retailer_org_id as pwt_agent,sum(sbp.pwt_amt) as pwt_amount,sum(sbp.net_amt)as net_amount   ,sum(sbp.comm_amt)as comm_amount,sbp.transaction_id as pwt_trans_id,transaction_date,sbp.game_id,game_nbr,game_name from   st_se_agent_pwt sbp,(select game_nbr,game_id,game_name from st_se_game_master )sgm,(select receipt_id as id,transaction_id from st_lms_agent_receipts_trn_mapping where receipt_id= '&quot;</span>
							+ receipt_id
							+ &quot;') innermost,(select transaction_id,transaction_date from st_lms_agent_transaction_master )sbtm where sbp.transaction_id=innermost.transaction_id and sbtm.transaction_id=innermost.transaction_id and sbp.game_id=sgm.game_id group by sbp.transaction_id ) pwt)result where result.agent = som.organization_id order by transaction_date&quot;;
					// &quot;select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,net_amount
					// ,comm_amount,transaction_date,game_nbr from
					// st_lms_organization_master som , (select 'cash'
					// t_type,cash_agent as agent,cash_amount as amount
					// ,cash_amount as net_amount ,0.00 comm_amount
					// ,cash_trans_id as trans_id,'cash'
					// issuing_party_name,'cash' cheque_nbr,'cash' cheque_date,
					// 'cash' drawee_bank,cash_id as id,transaction_date,'cash'
					// game_nbr from ( select id as cash_id,sbct.agent_org_id as
					// cash_agent,sbct.amount as cash_amount ,
					// sbct.transaction_id as cash_trans_id,transaction_date
					// from st_lms_bo_cash_transaction sbct, (select
					// id,transaction_id from st_lms_bo_receipts_trn_mapping
					// where id= '&quot;+receipt_id+&quot;') innermost, (select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master)sbtm where
					// sbct.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id ) cash union
					// select 'pwt' t_type,pwt_agent as agent,pwt_amount as
					// amount,net_amount ,comm_amount ,pwt_trans_id as
					// trans_id,'pwt' issuing_party_name,'pwt' cheque_nbr,'pwt'
					// cheque_date, 'pwt' drawee_bank , pwt_id as
					// id,transaction_date,game_nbr from (select id as
					// pwt_id,sbp.agent_org_id as pwt_agent,sum(sbp.pwt_amt) as
					// pwt_amount,sum(sbp.net_amt)as net_amount
					// ,sum(sbp.comm_amt)as comm_amount,sbp.transaction_id as
					// pwt_trans_id,transaction_date,sbp.game_id,game_nbr from
					// st_se_bo_pwt sbp,(select game_nbr,game_id from
					// st_se_game_master )sgm, (select id,transaction_id from
					// st_lms_bo_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master)sbtm where
					// sbp.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id and
					// sbp.game_id=sgm.game_id group by sbp.transaction_id) pwt
					// union select 'cheque' t_type,cheque_agent as
					// agent,cheque_amt as amount,cheque_amt as net_amount,0.00
					// comm_amount,cheque_id as
					// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id,transaction_date
					// , 'cheque' game_nbr from (select id ,agent_org_id as
					// cheque_agent,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
					// as cheque_id,transaction_date from st_lms_bo_sale_chq
					// sbsc, (select id,transaction_id from
					// st_lms_bo_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master)sbtm where
					// sbsc.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id) cheque)
					// result where result.agent = som.organization_id&quot;;
<span class="nc" id="L621">					System.out</span>
							.println(&quot; RECEIPT PWT queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L624">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/PWTReceipt.jasper&quot;;
<span class="nc bnc" id="L626" title="All 4 branches missed.">				} else if (trnType.equalsIgnoreCase(&quot;DG_PWT&quot;)</span>
						|| trnType.equalsIgnoreCase(&quot;DG_PWT_AUTO&quot;)) {
					// query=&quot;select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,amount,net_amount
					// ,comm_amount,transaction_date,game_nbr,game_name from
					// st_lms_organization_master som ,(select 'pwt'
					// t_type,pwt_agent as agent,pwt_amount as amount,net_amount
					// ,comm_amount ,pwt_trans_id as trans_id, pwt_id as
					// id,transaction_date,game_nbr,game_name from (select id as
					// pwt_id,sbp.agent_org_id as pwt_agent,sum(sbp.pwt_amt) as
					// pwt_amount,sum(sbp.net_amt)as net_amount
					// ,sum(sbp.comm_amt)as comm_amount,sbp.transaction_id as
					// pwt_trans_id,transaction_date,sbp.game_id,game_nbr,game_name
					// from st_se_bo_pwt sbp,(select game_nbr,game_id,game_name
					// from st_se_game_master )sgm,(select id,transaction_id
					// from st_lms_bo_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master )sbtm where
					// sbp.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id and
					// sbp.game_id=sgm.game_id group by sbp.transaction_id )
					// pwt)result where result.agent = som.organization_id&quot;;
					// &quot;select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,net_amount
					// ,comm_amount,transaction_date,game_nbr from
					// st_lms_organization_master som , (select 'cash'
					// t_type,cash_agent as agent,cash_amount as amount
					// ,cash_amount as net_amount ,0.00 comm_amount
					// ,cash_trans_id as trans_id,'cash'
					// issuing_party_name,'cash' cheque_nbr,'cash' cheque_date,
					// 'cash' drawee_bank,cash_id as id,transaction_date,'cash'
					// game_nbr from ( select id as cash_id,sbct.agent_org_id as
					// cash_agent,sbct.amount as cash_amount ,
					// sbct.transaction_id as cash_trans_id,transaction_date
					// from st_lms_bo_cash_transaction sbct, (select
					// id,transaction_id from st_lms_bo_receipts_trn_mapping
					// where id= '&quot;+receipt_id+&quot;') innermost, (select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master)sbtm where
					// sbct.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id ) cash union
					// select 'pwt' t_type,pwt_agent as agent,pwt_amount as
					// amount,net_amount ,comm_amount ,pwt_trans_id as
					// trans_id,'pwt' issuing_party_name,'pwt' cheque_nbr,'pwt'
					// cheque_date, 'pwt' drawee_bank , pwt_id as
					// id,transaction_date,game_nbr from (select id as
					// pwt_id,sbp.agent_org_id as pwt_agent,sum(sbp.pwt_amt) as
					// pwt_amount,sum(sbp.net_amt)as net_amount
					// ,sum(sbp.comm_amt)as comm_amount,sbp.transaction_id as
					// pwt_trans_id,transaction_date,sbp.game_id,game_nbr from
					// st_se_bo_pwt sbp,(select game_nbr,game_id from
					// st_se_game_master )sgm, (select id,transaction_id from
					// st_lms_bo_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master)sbtm where
					// sbp.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id and
					// sbp.game_id=sgm.game_id group by sbp.transaction_id) pwt
					// union select 'cheque' t_type,cheque_agent as
					// agent,cheque_amt as amount,cheque_amt as net_amount,0.00
					// comm_amount,cheque_id as
					// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id,transaction_date
					// , 'cheque' game_nbr from (select id ,agent_org_id as
					// cheque_agent,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
					// as cheque_id,transaction_date from st_lms_bo_sale_chq
					// sbsc, (select id,transaction_id from
					// st_lms_bo_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master)sbtm where
					// sbsc.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id) cheque)
					// result where result.agent = som.organization_id&quot;;
<span class="nc" id="L701">					query = &quot;select name,addr_line1,addr_line2,city,t_type,trans_id,receipt_id as id,amount,net_amount ,comm_amt,game_nbr,game_name,ret_orgId from st_lms_organization_master som ,(select 'pwt' t_type,pwt_amount as amount,ret_orgId,net_amount ,comm_amt , receipt_id,game_nbr,game_name from (select receipt_id,sbp.retailer_org_id as ret_orgId,sbp.pwt_amt as pwt_amount, sbp.net_amt as net_amount ,sbp.comm_amt as comm_amt,sbp.transaction_id as pwt_trans_id, sbp.game_id,game_nbr,game_name from st_dg_agt_pwt sbp,(select game_nbr,game_id,game_name from st_se_game_master  )sgm,(select receipt_id,transaction_id from st_lms_agent_receipts_trn_mapping where receipt_id= '&quot;</span>
							+ receipt_id
							+ &quot;') innermost,(select transaction_id from st_lms_agent_transaction_master)sbtm where sbp.transaction_id=innermost.transaction_id and  sbtm.transaction_id=innermost.transaction_id and sbp.game_id=sgm.game_id and retailer_org_id='') pwt )result where result.ret_orgId = som.organization_id&quot;;
<span class="nc" id="L704">					System.out</span>
							.println(&quot; RECEIPT PWT queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L707">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/DGPWTReceipt.jasper&quot;;
				}

<span class="nc bnc" id="L711" title="All 2 branches missed.">				else if (trnType.equalsIgnoreCase(&quot;cheque&quot;)) {</span>
					// query=&quot; select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,transaction_date,temp_receipt_id
					// from st_lms_organization_master som ,(select 'cheque'
					// t_type,cheque_agent as agent,cheque_amt as
					// amount,cheque_amt as net_amount,cheque_id as
					// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id,transaction_date,temp_receipt_id
					// from (select id ,sbsc.agent_org_id as
					// cheque_agent,sbsc.issuing_party_name,sbsc.cheque_nbr,sbsc.cheque_date,sbsc.drawee_bank,sbsc.cheque_amt,sbsc.transaction_id
					// as cheque_id,transaction_date,temp_receipt_id from
					// st_lms_bo_sale_chq sbsc,st_lms_bo_cheque_temp_receipt
					// sbctr,(select id,transaction_id from
					// st_lms_bo_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master )sbtm where
					// sbsc.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id and
					// sbctr.cheque_nbr=sbsc.cheque_nbr ) cheque ) result where
					// result.agent = som.organization_id&quot;;
					// query=&quot;select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,transaction_date
					// from st_lms_organization_master som ,(select 'cheque'
					// t_type,cheque_agent as agent,cheque_amt as
					// amount,cheque_amt as net_amount,cheque_id as
					// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id,transaction_date
					// from (select id ,sbsc.retailer_org_id as
					// cheque_agent,sbsc.issuing_party_name,sbsc.cheque_nbr,sbsc.cheque_date,sbsc.drawee_bank,sbsc.cheque_amt,sbsc.transaction_id
					// as cheque_id,transaction_date from st_lms_agent_sale_chq
					// sbsc,(select id,transaction_id from
					// st_lms_agent_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_agent_transaction_master )sbtm where
					// sbsc.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id ) cheque )
					// result where result.agent = som.organization_id&quot;;
<span class="nc" id="L748">					query = &quot;select name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,user_name,cheque_nbr as cheque_nbr,cheque_date,drawee_bank,amount,transaction_date from  st_lms_organization_master som ,(select 'cheque' t_type,cheque_agent as agent,cheque_amt as amount,user_name,cheque_amt as net_amount,cheque_id as trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id,transaction_date  from (select id ,slum.user_name,sbsc.retailer_org_id as cheque_agent,sbsc.issuing_party_name,sbsc.cheque_nbr,sbsc.cheque_date,sbsc.drawee_bank,sbsc.cheque_amt,sbsc.transaction_id as cheque_id,transaction_date from st_lms_agent_sale_chq sbsc,(select receipt_id as id,transaction_id from st_lms_agent_receipts_trn_mapping where receipt_id= &quot;</span>
							+receipt_id+
							&quot;) innermost,(select user_id,transaction_id,transaction_date from st_lms_agent_transaction_master )sbtm, (select user_id, user_name from st_lms_user_master)slum where sbsc.transaction_id=innermost.transaction_id and sbtm.transaction_id=innermost.transaction_id and slum.user_id=sbtm.user_id  ) cheque ) result where result.agent = som.organization_id order by transaction_date&quot;;
<span class="nc" id="L751">					System.out</span>
							.println(&quot; RECEIPT CASH queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L754">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/ChequeReceipt.jasper&quot;;
<span class="nc bnc" id="L756" title="All 2 branches missed.">				} else if (trnType.equalsIgnoreCase(&quot;CASH&quot;)) {</span>
					// query=&quot;select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,amount,transaction_date
					// from st_lms_organization_master som ,(select 'cash'
					// t_type,cash_agent as agent,cash_amount as amount
					// ,cash_trans_id as trans_id,cash_id as id,transaction_date
					// from ( select id as cash_id,sbct.retailer_org_id as
					// cash_agent,sbct.amount as cash_amount
					// ,sbct.transaction_id as cash_trans_id,transaction_date
					// from st_lms_agent_cash_transaction sbct,(select
					// id,transaction_id from st_lms_agent_receipts_trn_mapping
					// where id= '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_agent_transaction_master )sbtm where
					// sbct.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id )
					// cash)result where result.agent = som.organization_id&quot;;
<span class="nc" id="L773">					query = &quot;select name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,user_name,amount,transaction_date from st_lms_organization_master som ,(select 'cash' t_type,cash_agent  as agent,cash_amount as amount ,user_name,cash_trans_id as trans_id,cash_id as id,transaction_date from  ( select id as cash_id,sbct.retailer_org_id as cash_agent,sbct.amount as cash_amount ,sbct.transaction_id as cash_trans_id,slum.user_name,transaction_date from  st_lms_agent_cash_transaction sbct,(select receipt_id as id,transaction_id from st_lms_agent_receipts_trn_mapping where receipt_id= &quot;</span>
							+receipt_id+
							&quot;) innermost,(select user_id,transaction_id,transaction_date from st_lms_agent_transaction_master )sbtm, (select user_id, user_name from st_lms_user_master)slum  where sbct.transaction_id=innermost.transaction_id and  sbtm.transaction_id=innermost.transaction_id and slum.user_id = sbtm.user_id) cash)result where result.agent = som.organization_id order by transaction_date&quot;;
<span class="nc" id="L776">					System.out</span>
							.println(&quot; RECEIPT CASH queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L779">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/CashReceipt.jasper&quot;;
<span class="nc bnc" id="L781" title="All 2 branches missed.">				}else if (trnType.equalsIgnoreCase(&quot;bank_deposit&quot;)) {</span>
<span class="nc" id="L782">					query = &quot;select name,addr_line1,addr_line2,city,t_type,agent,trans_id,receipt_id as id,user_name,amount,transaction_date from  st_lms_organization_master som ,(select 'cash' t_type,cash_agent  as agent,user_name,cash_amount as amount ,trans_id,receipt_id,transaction_date from ( select receipt_id,sbct.retailer_org_id as cash_agent,sbct.amount as cash_amount ,sbct.transaction_id as trans_id,slum.user_name,transaction_date from  st_lms_agent_bank_deposit_transaction sbct,( select receipt_id,transaction_id from st_lms_agent_receipts_trn_mapping where receipt_id= '&quot;</span>
						+ receipt_id
						+ &quot;' ) innermost, (select  user_id,transaction_id,transaction_date from st_lms_agent_transaction_master )sbtm, (select user_id, user_name from st_lms_user_master)slum  where sbct.transaction_id=innermost.transaction_id and  sbtm.transaction_id=innermost.transaction_id and slum.user_id = sbtm.user_id  ) cash )result where result.agent = som.organization_id order by transaction_date&quot;;
<span class="nc" id="L785">					System.out</span>
							.println(&quot; RECEIPT BANK DEPOSIT queryyyyyyyyyyyyyyyy BOOOOO &quot;
								+ query);
<span class="nc" id="L788">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/CashReceipt.jasper&quot;;
			     }

<span class="nc" id="L792">				generateReport(query, file, parameterMap, null, null);</span>

<span class="nc bnc" id="L794" title="All 2 branches missed.">			} else if (receipt_type.equalsIgnoreCase(&quot;DR_NOTE&quot;)) {</span>
				// query=&quot;select
				// name,addr_line1,addr_line2,city,retailer_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,transaction_id
				// from st_lms_organization_master som ,(select
				// retailer_org_id,id,issuing_party_name,chq_nbr as
				// cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
				// from st_lms_agent_sale_chq sbsc, (select id,transaction_id
				// from st_lms_agent_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;') innermost where
				// sbsc.transaction_id=innermost.transaction_id)result1 where
				// som.organization_id=result1.retailer_org_id&quot;;
				// query=&quot;select
				// name,addr_line1,addr_line2,city,retailer_org_id,id,issuing_party_name,cheque_nbr,amount,transaction_type,remarks,cheque_date,drawee_bank,cheque_amt,transaction_id
				// from st_lms_organization_master som , (select
				// retailer_org_id,id,issuing_party_name,chq_nbr as
				// cheque_nbr,cheque_date,drawee_bank,amount,
				// sbdn.transaction_type,remarks ,cheque_amt,sbsc.transaction_id
				// from st_lms_agent_sale_chq sbsc,(select
				// amount,transaction_type,remarks,transaction_id from
				// st_lms_agent_debit_note) sbdn, (select id,transaction_id from
				// st_lms_agent_receipts_trn_mapping where id= '&quot;+receipt_id+&quot;')
				// innermost where sbsc.transaction_id=innermost.transaction_id
				// and sbdn.transaction_id =innermost.transaction_id )result1
				// where som.organization_id=result1.retailer_org_id&quot;;
				// query=&quot;select
				// name,addr_line1,addr_line2,city,retailer_org_id,id,issuing_party_name,chq_nbr
				// as cheque_nbr
				// ,cheque_date,drawee_bank,amount,transaction_type,remarks,transaction_id
				// from st_lms_organization_master som ,(select
				// retailer_org_id,id,issuing_party_name, chq_nbr, cheque_date,
				// drawee_bank, cheque_amt as amount,transaction_id,
				// transaction_type,remarks from (select 0.00
				// amount,id,transaction_type,'Cheque
				// Bounce'remarks,sbsc.transaction_id,retailer_org_id,
				// issuing_party_name, chq_nbr, cheque_date,drawee_bank,
				// cheque_amt from st_lms_agent_sale_chq sbsc,(select
				// id,transaction_id from st_lms_agent_receipts_trn_mapping
				// where id= '&quot;+receipt_id+&quot;')innermost where
				// innermost.transaction_id=sbsc.transaction_id )cheque union
				// select retailer_org_id,id,'N.A.'issuing_party_name,'N.A.'
				// chq_nbr,'N.A.' cheque_date,'N.A.' drawee_bank,
				// amount,transaction_id,transaction_type,remarks from (select
				// amount,id,transaction_type,remarks,sbdn.transaction_id,retailer_org_id
				// from st_lms_agent_debit_note sbdn,(select id,transaction_id
				// from st_lms_agent_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;')innermost where
				// innermost.transaction_id=sbdn.transaction_id )bounce) result1
				// where som.organization_id=result1.retailer_org_id &quot;;
				// query=&quot;select
				// name,addr_line1,addr_line2,city,retailer_org_id,id,issuing_party_name,chq_nbr
				// as cheque_nbr
				// ,cheque_date,drawee_bank,amount,transaction_type,remarks,transaction_id,transaction_date
				// from st_lms_organization_master som ,(select
				// retailer_org_id,id,issuing_party_name, chq_nbr, cheque_date,
				// drawee_bank, cheque_amt as amount,transaction_id,
				// transaction_type,remarks,transaction_date from (select 0.00
				// amount,id,transaction_type,'Cheque
				// Bounce'remarks,sbsc.transaction_id,retailer_org_id,
				// issuing_party_name, chq_nbr, cheque_date,drawee_bank,
				// cheque_amt,transaction_date from st_lms_agent_sale_chq
				// sbsc,(select id,transaction_id from
				// st_lms_agent_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;')innermost,(select
				// transaction_id,transaction_date from
				// st_lms_agent_transaction_master)satm where
				// innermost.transaction_id=sbsc.transaction_id and
				// satm.transaction_id=innermost.transaction_id)cheque union
				// select retailer_org_id,id,'N.A.'issuing_party_name,'N.A.'
				// chq_nbr,'N.A.' cheque_date,'N.A.' drawee_bank,
				// amount,transaction_id,transaction_type,remarks,transaction_date
				// from (select
				// amount,id,transaction_type,remarks,sbdn.transaction_id,retailer_org_id,transaction_date
				// from st_lms_agent_debit_note sbdn,(select id,transaction_id
				// from st_lms_agent_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;')innermost,(select
				// transaction_id,transaction_date from
				// st_lms_agent_transaction_master)satm where
				// innermost.transaction_id=sbdn.transaction_id and
				// satm.transaction_id=innermost.transaction_id )bounce) result1
				// where som.organization_id=result1.retailer_org_id &quot;;
<span class="nc" id="L874">				query = &quot;select name,addr_line1,addr_line2,city,retailer_org_id,id,issuing_party_name,cheque_nbr as cheque_nbr ,cheque_date,drawee_bank,amount,transaction_type,remarks,transaction_id,transaction_date from st_lms_organization_master som ,(select retailer_org_id,id,issuing_party_name, cheque_nbr, cheque_date, drawee_bank, cheque_amt as amount,transaction_id, transaction_type,remarks,transaction_date from (select 0.00 amount,id,transaction_type,'Cheque Bounce'remarks,sbsc.transaction_id,retailer_org_id, issuing_party_name, cheque_nbr, cheque_date,drawee_bank, cheque_amt,transaction_date from st_lms_agent_sale_chq  sbsc,(select receipt_id as id,transaction_id from st_lms_agent_receipts_trn_mapping where receipt_id= '&quot;</span>
						+ receipt_id
						+ &quot;')innermost,(select transaction_id,transaction_date from st_lms_agent_transaction_master)satm  where innermost.transaction_id=sbsc.transaction_id and satm.transaction_id=innermost.transaction_id)cheque union select retailer_org_id,id,'N.A.'issuing_party_name,'N.A.' cheque_nbr,'N.A.' cheque_date,'N.A.' drawee_bank, amount,transaction_id,transaction_type,remarks,transaction_date from (select  amount,id,transaction_type,remarks,sbdn.transaction_id,retailer_org_id,transaction_date from st_lms_agent_debit_note  sbdn,(select receipt_id as id,transaction_id from st_lms_agent_receipts_trn_mapping where receipt_id= '&quot;
						+ receipt_id
						+ &quot;')innermost,(select transaction_id,transaction_date from st_lms_agent_transaction_master)satm  where innermost.transaction_id=sbdn.transaction_id and satm.transaction_id=innermost.transaction_id  )bounce) result1 where som.organization_id=result1.retailer_org_id order by transaction_date&quot;;
<span class="nc" id="L879">				System.out.println(&quot; DR_NOTE queryyyyyyyyyyyyyyyyyyy&quot; + query);</span>
<span class="nc" id="L880">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/Debit_Note.jasper&quot;;
<span class="nc" id="L882">				generateReport(query, file, parameterMap, null, null);</span>

<span class="nc bnc" id="L884" title="All 2 branches missed.">			} else if (receipt_type.equalsIgnoreCase(&quot;DR_NOTE_CASH&quot;)) {</span>
<span class="nc" id="L885">				System.out</span>
						.println(&quot;================== inside note =================&quot;);
				// query=&quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,transaction_id
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
				// from st_lms_bo_sale_chq sbsc, (select id,transaction_id from
				// st_lms_bo_receipts_trn_mapping where id= '&quot;+receipt_id+&quot;')
				// innermost where
				// sbsc.transaction_id=innermost.transaction_id)result1 where
				// som.organization_id=result1.agent_org_id&quot;;
				// query=&quot;select
				// name,addr_line1,addr_line2,city,retailer_org_id,id,amount,transaction_type,remarks,transaction_id
				// from st_lms_organization_master som ,(select
				// retailer_org_id,id,amount,sbdn.transaction_type,remarks,sbdn.transaction_id
				// from (select
				// amount,transaction_type,remarks,transaction_id,retailer_org_id
				// from st_lms_agent_debit_note) sbdn,(select id,transaction_id
				// from st_lms_agent_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;') innermost where sbdn.transaction_id
				// =innermost.transaction_id )result1 where
				// som.organization_id=result1.retailer_org_id&quot;;
				// query=&quot;select
				// name,addr_line1,addr_line2,city,retailer_org_id,id,amount,transaction_type,remarks,transaction_id,transaction_date
				// from st_lms_organization_master som ,(select
				// retailer_org_id,id,amount,sbdn.transaction_type,remarks,sbdn.transaction_id,transaction_date
				// from (select
				// amount,transaction_type,remarks,transaction_id,retailer_org_id
				// from st_lms_agent_debit_note) sbdn,(select id,transaction_id
				// from st_lms_agent_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;') innermost,(select
				// transaction_id,transaction_date from
				// st_lms_agent_transaction_master)satm where
				// sbdn.transaction_id =innermost.transaction_id and
				// satm.transaction_id =innermost.transaction_id)result1 where
				// som.organization_id=result1.retailer_org_id&quot;;
<span class="nc" id="L921">				query = &quot;select name,addr_line1,addr_line2,city,retailer_org_id,innermost.receipt_id as id,amount,sbdn.transaction_type,remarks, user_name,sbdn.transaction_id,transaction_date from st_lms_organization_master som INNER Join   st_lms_agent_debit_note  sbdn on som.organization_id=sbdn.retailer_org_id inner join  st_lms_agent_receipts_trn_mapping innermost on sbdn.transaction_id =innermost.transaction_id  and receipt_id= '&quot;+receipt_id+&quot;' inner join st_lms_agent_transaction_master satm on satm.transaction_id =innermost.transaction_id inner join  st_lms_user_master slum on slum.user_id= satm.user_id order by transaction_date;&quot;;</span>
<span class="nc" id="L922">				System.out.println(&quot; DR_NOTE_CASH queryyyyyyyyyyyyyyyyyyy&quot;</span>
						+ query);
<span class="nc" id="L924">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/Debit_Note_Cash.jasper&quot;;
<span class="nc" id="L926">				generateReport(query, file, parameterMap, null, null, null,</span>
						null);

<span class="nc bnc" id="L929" title="All 2 branches missed.">			} else if (receipt_type.equalsIgnoreCase(&quot;CR_NOTE&quot;)) {</span>

<span class="nc bnc" id="L931" title="All 2 branches missed.">				if (&quot;SALE_RET&quot;.equalsIgnoreCase(trnType)) {</span>
					// vat amount ambiguous query = &quot;select
					// retailer_sale_comm_rate,name,addr_line1,addr_line2,city,retailer_org_id,id,game_name
					// , ticket_price, nbr_of_tickets_per_book , nbr_of_books,
					// taxable_sale,vat_amt,comm_amt, sale,
					// (nbr_of_tickets_per_book*nbr_of_books)as
					// total_tickets,transaction_date from
					// st_lms_organization_master som , (select
					// retailer_sale_comm_rate,id,retailer_org_id,game_name,ticket_price,nbr_of_tickets_per_book,
					// result.game_id,result.nbr_of_books ,(net_amt) as
					// sale,taxable_sale,vat_amt,comm_amt,transaction_date from
					// st_se_game_master sgm, (select
					// sbat.retailer_org_id,game_id,nbr_of_books,net_amt,mrp_amt,vat_amt,comm_amt,
					// taxable_sale,sbat.transaction_id,id,transaction_date from
					// st_se_agent_retailer_transaction sbat, (select receipt_id
					// as id,transaction_id from
					// st_lms_agent_receipts_trn_mapping where receipt_id=
					// '&quot;+receipt_id+&quot;' ) innermost , (select
					// transaction_id,transaction_date from
					// st_lms_agent_transaction_master )satm where
					// sbat.transaction_id=innermost.transaction_id and
					// satm.transaction_id=innermost.transaction_id ) result
					// where sgm.game_id = result.game_id )result1 where
					// som.organization_id=result1.retailer_org_id&quot;;
<span class="nc" id="L955">					query = &quot;select retailer_sale_comm_rate,name,addr_line1,addr_line2,city,retailer_org_id,id,game_name ,  ticket_price, nbr_of_tickets_per_book , nbr_of_books, taxable_sale,vat_amt,comm_amt, sale, (nbr_of_tickets_per_book*nbr_of_books)as total_tickets,transaction_date from st_lms_organization_master som , (select retailer_sale_comm_rate,id,retailer_org_id,game_name,ticket_price,nbr_of_tickets_per_book, result.game_id,result.nbr_of_books ,(net_amt) as sale,taxable_sale,result.vat_amt,comm_amt,transaction_date from  st_se_game_master sgm, (select sbat.retailer_org_id,game_id,nbr_of_books,net_amt,mrp_amt,vat_amt,comm_amt, taxable_sale,sbat.transaction_id,id,transaction_date from st_se_agent_retailer_transaction sbat, (select receipt_id as id,transaction_id from st_lms_agent_receipts_trn_mapping where receipt_id= '&quot;</span>
							+ receipt_id
							+ &quot;' ) innermost , (select transaction_id,transaction_date from st_lms_agent_transaction_master )satm where sbat.transaction_id=innermost.transaction_id and satm.transaction_id=innermost.transaction_id ) result where sgm.game_id = result.game_id  )result1 where som.organization_id=result1.retailer_org_id order by transaction_date&quot;;
<span class="nc" id="L958">					System.out.println(&quot; CR_NOTE queryyyyyyyyyyyyyyyyyyy&quot;</span>
							+ query);
<span class="nc bnc" id="L960" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L962">						fileName = &quot;CrdtNtComVat.jasper&quot;;</span>
<span class="nc bnc" id="L963" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L965">						fileName = &quot;CrdtNtComNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L966" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L968">						fileName = &quot;CrdtNtRdpNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L969" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L971">						fileName = &quot;CrdtNtRdpVat.jasper&quot;;</span>
					}
				}
				
<span class="nc bnc" id="L975" title="All 4 branches missed.">				  if(&quot;CS_CANCEL_SERVER&quot;.equalsIgnoreCase(trnType)</span>
	                        || &quot;CS_CANCEL_RET&quot;.equalsIgnoreCase(trnType)){
<span class="nc" id="L977">	                    query = &quot;select name,addr_line1,addr_line2,city,product_code,description,sale,vat as vat_amt,comm_amt, transaction_date from st_lms_organization_master som, st_cs_product_master scpm,(select sbtm.transaction_date, sdbs.retailer_org_id as agt_id, product_id, mrp_amt as sale, sdbs.transaction_id, vat_amt as vat, net_amt, (mrp_amt*sdbs.retailer_comm/100) as comm_amt from st_cs_agt_refund sdbs,(select receipt_id as id, transaction_id from st_lms_agent_receipts_trn_mapping where receipt_id='&quot;+ receipt_id+ &quot;')innermost,(select party_id, transaction_id, transaction_date from st_lms_agent_transaction_master)sbtm where sdbs.transaction_id = innermost.transaction_id and sbtm.transaction_id=innermost.transaction_id and sbtm.party_id = sdbs.retailer_org_id)result where result.agt_id = som.organization_id and result.product_id = scpm.product_id&quot;;</span>
<span class="nc" id="L978">	                    System.out</span>
	                            .println(&quot;CS CR_NOTE queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;
	                                    + query);
<span class="nc" id="L981">	                    file = root_path</span>
	                            + &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
	                            + fileName;
<span class="nc bnc" id="L984" title="All 4 branches missed.">	                    if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
	                            &amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L986">	                        fileName = &quot;CSCrdtNtComVat.jasper&quot;;</span>
<span class="nc bnc" id="L987" title="All 4 branches missed.">	                    } else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
	                            &amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L989">	                        fileName = &quot;CSCrdtNtComNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L990" title="All 4 branches missed.">	                    } else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
	                            &amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L992">	                        fileName = &quot;CSCrdtNtRdpNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L993" title="All 4 branches missed.">	                    } else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
	                            &amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L995">	                        fileName = &quot;CSCrdtNtRdpVat.jasper&quot;;</span>
	                    }
	               
	                }
<span class="nc bnc" id="L999" title="All 2 branches missed.">				if (&quot;LOOSE_SALE_RET&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc" id="L1000">					query = &quot;select id,game_name,organization_id,transaction_date,nbr_of_tickets nbrOfTickets, net_amt sale, retailer_sale_comm_rate agent_sale_comm_rate,name,addr_line1,addr_line2,city,sale.transaction_id as transaction_id,vat_amt,taxable_sale,ticket_price,comm_amt,retComm agtSaleCommRate from st_lms_organization_master som ,(select retailer_org_id,id,game_name ,retailer_sale_comm_rate,sbs.nbr_of_tickets, ticket_price,taxable_sale,sbs.vat_amt ,net_amt,sbs.transaction_id, btm.transaction_date,comm_amt,retComm from st_se_agent_ret_loose_book_transaction sbs,st_se_game_master game, st_lms_agent_transaction_master btm,(select slbr.party_id as agent_id, slbr.receipt_id as id, transaction_id from st_lms_agent_receipts_trn_mapping slbrtm, st_lms_agent_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+ receipt_id+ &quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id and sbs.game_id=game.game_id)sale where som.organization_id = sale.retailer_org_id&quot;;</span>
<span class="nc" id="L1001">					System.out.println(&quot; CR_NOTE queryyyyyyyyyyyyyyyyyyy&quot;</span>
							+ query);
<span class="nc bnc" id="L1003" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1005">						fileName = &quot;looseSaleReturnCrdtNtComVat.jasper&quot;;</span>
<span class="nc bnc" id="L1006" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1008">						fileName = &quot;looseSaleReturnCrdtNtComNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L1009" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1011">						fileName = &quot;looseSaleReturnCrdtNtRdpNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L1012" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1014">						fileName = &quot;looseSaleReturnCrdtNtRdpVat.jasper&quot;;</span>
					}
				}
<span class="nc bnc" id="L1017" title="All 4 branches missed.">				if (&quot;DG_REFUND_CANCEL&quot;.equalsIgnoreCase(trnType)</span>
						|| &quot;DG_REFUND_FAILED&quot;.equalsIgnoreCase(trnType)) {
<span class="nc" id="L1019">					query = &quot;select name,addr_line1,addr_line2,city,game_name ,sale,taxable_sale,vat as vat_amt,agent_comm as comm_amt, transaction_date from st_lms_organization_master som, st_dg_game_master sdgm,(select sbtm.transaction_date, sdbs.retailer_org_id as ret_id, game_id, mrp_amt as sale, sdbs.transaction_id, vat_amt as vat, taxable_sale, net_amt, agent_comm from st_dg_agt_sale_refund sdbs,(select receipt_id as id, transaction_id from st_lms_agent_receipts_trn_mapping where receipt_id='&quot;</span>
							+ receipt_id
							+ &quot;')innermost,(select party_id, transaction_id, transaction_date from st_lms_agent_transaction_master)sbtm where sdbs.transaction_id = innermost.transaction_id and sbtm.transaction_id=innermost.transaction_id and sbtm.party_id = sdbs.retailer_org_id)result where result.ret_id = som.organization_id and result.game_id = sdgm.game_id order by transaction_date&quot;;
<span class="nc" id="L1022">					System.out</span>
							.println(&quot;CR_NOTE queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;
									+ query);
<span class="nc" id="L1025">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
							+ fileName;
<span class="nc bnc" id="L1028" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1030">						fileName = &quot;DGCrdtNtComVat.jasper&quot;;</span>
<span class="nc bnc" id="L1031" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1033">						fileName = &quot;DGCrdtNtComNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L1034" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1036">						fileName = &quot;DGCrdtNtRdpNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L1037" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1039">						fileName = &quot;DGCrdtNtRdpVat.jasper&quot;;</span>
					}
				}
				
<span class="nc bnc" id="L1043" title="All 2 branches missed.">				if (&quot;OLA_DEPOSIT_REFUND&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc" id="L1044">					query = &quot;select id,wallet_name,transaction_date,deposit_amt as deposit_refund, net_amt,(deposit_amt-net_amt) as comm_amt,name,addr_line1,addr_line2,city,deposit.transaction_id as transaction_id from st_ola_wallet_master sdgm ,st_lms_organization_master som ,(select retailer_org_id,id,wallet_id ,retailer_comm as comm_amt, deposit_amt, net_amt,sbs.transaction_id, btm.transaction_date from st_ola_agt_deposit_refund sbs, st_lms_agent_transaction_master btm, (select slbr.party_id as retailer_id, slbr.receipt_id as id, transaction_id from st_lms_agent_receipts_trn_mapping slbrtm, st_lms_agent_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+receipt_id+&quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id)deposit where deposit.wallet_id = sdgm.wallet_id and som.organization_id = deposit.retailer_org_id&quot;;</span>
<span class="nc" id="L1045">					System.out</span>
							.println(&quot;OLA Agent end CR_NOTE queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;
									+ query);
<span class="nc" id="L1048">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
							+ fileName;
<span class="nc" id="L1051">						fileName = &quot;OLACrdtNtRdpNoVat.jasper&quot;;</span>
				}
				/*
				 * else{ query=&quot;select
				 * name,addr_line1,addr_line2,city,id,game_name
				 * ,sale,taxable_sale,vat_amt,comm_amt from
				 * st_lms_organization_master som ,(select
				 * id,game_name,result.game_id,taxable_sale,vat_amt,(net_amt) as
				 * sale,comm_amt,transaction_id from st_se_game_master
				 * sgm,(select sdbs.retailer_org_id,game_id,mrp_amt
				 * ,sdbs.transaction_id,id,
				 * vat_amt,taxable_sale,net_amt,comm_amt from st_dg_agt_sale
				 * sdbs,(select receipt_id as id,transaction_id from
				 * st_lms_agent_receipts_trn_mapping where receipt_id=
				 * '&quot;+receipt_id+&quot;') innermost,(select
				 * transaction_id,transaction_date from
				 * st_lms_agent_transaction_master )sbtm where
				 * sdbs.transaction_id=innermost.transaction_id and
				 * sbtm.transaction_id=innermost.transaction_id and
				 * retailer_org_id='') result where sgm.game_id = result.game_id
				 * )result1 where som.organization_id=result1.retailer_org_id&quot;;
				 * System.out.println(&quot;CR_NOTE
				 * queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;+query);file=root_path+
				 * &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;+fileName;
				 * if(isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)&amp;&amp;isVatApplicable.
				 * equalsIgnoreCase(&quot;yes&quot;)){ fileName=&quot;DGCrdtNtComVat.jasper&quot;;
				 * }else
				 * if(isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)&amp;&amp;isVatApplicable
				 * .equalsIgnoreCase(&quot;no&quot;)){ fileName=&quot;DGCrdtNtComNoVat.jasper&quot;;
				 * }else
				 * if(isCommApplicable.equalsIgnoreCase(&quot;no&quot;)&amp;&amp;isVatApplicable
				 * .equalsIgnoreCase(&quot;no&quot;)){ fileName=&quot;DGCrdtNtRdpNoVat.jasper&quot;;
				 * }else
				 * if(isCommApplicable.equalsIgnoreCase(&quot;no&quot;)&amp;&amp;isVatApplicable
				 * .equalsIgnoreCase(&quot;yes&quot;)){ fileName=&quot;DGCrdtNtRdpVat.jasper&quot;;
				 * } }
				 */

<span class="nc" id="L1089">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
						+ fileName;
<span class="nc" id="L1092">				generateReport(query, file, parameterMap, null, null, null,</span>
						null);
<span class="nc bnc" id="L1094" title="All 2 branches missed.">			} else if (receipt_type.equalsIgnoreCase(&quot;CR_NOTE_CASH&quot;)) {</span>
<span class="nc" id="L1095">				System.out.println(&quot;inside CR Note CASH&quot;);</span>
<span class="nc" id="L1096">				query = &quot;select name,addr_line1,addr_line2,city,retailer_org_id,innermost.receipt_id as id,amount,sbdn.transaction_type,remarks, user_name,sbdn.transaction_id,transaction_date from st_lms_organization_master som INNER Join   st_lms_agent_credit_note  sbdn on som.organization_id=sbdn.retailer_org_id inner join  st_lms_agent_receipts_trn_mapping innermost on sbdn.transaction_id =innermost.transaction_id  and receipt_id= '&quot;+receipt_id+&quot;' inner join st_lms_agent_transaction_master satm on satm.transaction_id =innermost.transaction_id inner join  st_lms_user_master slum on slum.user_id= satm.user_id order by transaction_date;&quot;;</span>
<span class="nc" id="L1097">				System.out.println(&quot; CR_NOTE_CASH for agent queryyyy&quot;);</span>
<span class="nc" id="L1098">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/Credit_Note_Cash.jasper&quot;;
<span class="nc" id="L1100">				generateReport(query, file, parameterMap, null, null, null,</span>
						null);

<span class="nc bnc" id="L1103" title="All 2 branches missed.">			} else if (receipt_type.equalsIgnoreCase(&quot;GOVT_RCPT&quot;)) {</span>
<span class="nc" id="L1104">				vatPartyName = (String) ServletActionContext</span>
						.getServletContext().getAttribute(&quot;VAT_PARTY_NAME&quot;);
<span class="nc" id="L1106">				tdsPartyName = (String) ServletActionContext</span>
						.getServletContext().getAttribute(&quot;TDS_PARTY_NAME&quot;);
<span class="nc" id="L1108">				govComPartyName = (String) ServletActionContext</span>
						.getServletContext().getAttribute(
								&quot;GOVT_COMM_PARTY_NAME&quot;);
<span class="nc" id="L1111">				parameterMap.put(&quot;vatPartyName&quot;, vatPartyName);</span>
<span class="nc" id="L1112">				parameterMap.put(&quot;tdsPartyName&quot;, tdsPartyName);</span>
<span class="nc" id="L1113">				parameterMap.put(&quot;govComPartyName&quot;, govComPartyName);</span>
<span class="nc" id="L1114">				System.out</span>
						.println(&quot;================== inside GOVT_RCPT =================&quot;
								+ trnType);
				// query=&quot;select
				// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,net_amount
				// ,comm_amount from st_lms_organization_master som ,(select
				// 'cash' t_type,cash_agent as agent,cash_amount as amount
				// ,cash_amount as net_amount ,0.00 comm_amount ,cash_trans_id
				// as trans_id, 'cash' issuing_party_name,'cash'
				// cheque_nbr,'cash' cheque_date, 'cash' drawee_bank,cash_id as
				// id from ( select id as cash_id,sbct.agent_org_id as
				// cash_agent,sbct.amount as cash_amount ,sbct.transaction_id as
				// cash_trans_id from st_lms_bo_cash_transaction sbct, (select
				// id,transaction_id from st_lms_bo_receipts_trn_mapping where
				// id= '&quot;+receipt_id+&quot;') innermost where
				// sbct.transaction_id=innermost.transaction_id) cash union
				// select 'pwt' t_type,pwt_agent as agent,pwt_amount as
				// amount,net_amount ,comm_amount ,pwt_trans_id as
				// trans_id,'pwt' issuing_party_name,'pwt' cheque_nbr, 'pwt'
				// cheque_date, 'pwt' drawee_bank , pwt_id as id from (select id
				// as pwt_id,sbp.agent_org_id as pwt_agent,sum(sbp.pwt_amt) as
				// pwt_amount,sum(sbp.net_amt)as net_amount ,sum(sbp.comm_amt)as
				// comm_amount,sbp.transaction_id as pwt_trans_id from
				// st_se_bo_pwt sbp, (select id,transaction_id from
				// st_lms_bo_receipts_trn_mapping where id= '&quot;+receipt_id+&quot;')
				// innermost where sbp.transaction_id=innermost.transaction_id
				// group by sbp.transaction_id) pwt union select 'cheque'
				// t_type,cheque_agent as agent,cheque_amt as amount,cheque_amt
				// as net_amount ,0.00 comm_amount,cheque_id as
				// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id
				// from ( select id ,agent_org_id as
				// cheque_agent,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
				// as cheque_id from st_lms_bo_sale_chq sbsc, (select
				// id,transaction_id from st_lms_bo_receipts_trn_mapping where
				// id= '&quot;+receipt_id+&quot;') innermost where
				// sbsc.transaction_id=innermost.transaction_id) cheque) result
				// where result.agent = som.organization_id&quot;;
				// query=&quot;select
				// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,net_amount
				// ,comm_amount,transaction_date from st_lms_organization_master
				// som ,(select 'cash' t_type,cash_agent as agent,cash_amount as
				// amount ,cash_amount as net_amount ,0.00 comm_amount
				// ,cash_trans_id as trans_id,'cash' issuing_party_name,'cash'
				// cheque_nbr,'cash' cheque_date, 'cash' drawee_bank,cash_id as
				// id,transaction_date from ( select id as
				// cash_id,sbct.agent_org_id as cash_agent,sbct.amount as
				// cash_amount , sbct.transaction_id as
				// cash_trans_id,transaction_date from
				// st_lms_bo_cash_transaction sbct, (select id,transaction_id
				// from st_lms_bo_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;') innermost, (select
				// transaction_id,transaction_date from
				// st_lms_bo_transaction_master)sbtm where
				// sbct.transaction_id=innermost.transaction_id and
				// sbtm.transaction_id=innermost.transaction_id ) cash union
				// select 'pwt' t_type,pwt_agent as agent,pwt_amount as
				// amount,net_amount ,comm_amount ,pwt_trans_id as
				// trans_id,'pwt' issuing_party_name,'pwt' cheque_nbr,'pwt'
				// cheque_date, 'pwt' drawee_bank , pwt_id as
				// id,transaction_date from (select id as
				// pwt_id,sbp.agent_org_id as pwt_agent,sum(sbp.pwt_amt) as
				// pwt_amount,sum(sbp.net_amt)as net_amount ,sum(sbp.comm_amt)as
				// comm_amount,sbp.transaction_id as
				// pwt_trans_id,transaction_date from st_se_bo_pwt sbp, (select
				// id,transaction_id from st_lms_bo_receipts_trn_mapping where
				// id= '&quot;+receipt_id+&quot;') innermost,(select
				// transaction_id,transaction_date from
				// st_lms_bo_transaction_master)sbtm where
				// sbp.transaction_id=innermost.transaction_id and
				// sbtm.transaction_id=innermost.transaction_id group by
				// sbp.transaction_id) pwt union select 'cheque'
				// t_type,cheque_agent as agent,cheque_amt as amount,cheque_amt
				// as net_amount,0.00 comm_amount,cheque_id as
				// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id,transaction_date
				// from (select id ,agent_org_id as
				// cheque_agent,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
				// as cheque_id,transaction_date from st_lms_bo_sale_chq sbsc,
				// (select id,transaction_id from st_lms_bo_receipts_trn_mapping
				// where id= '&quot;+receipt_id+&quot;') innermost,(select
				// transaction_id,transaction_date from
				// st_lms_bo_transaction_master)sbtm where
				// sbsc.transaction_id=innermost.transaction_id and
				// sbtm.transaction_id=innermost.transaction_id) cheque) result
				// where result.agent = som.organization_id&quot;;
<span class="nc bnc" id="L1198" title="All 2 branches missed.">				if (trnType.equalsIgnoreCase(&quot;VAT&quot;)) {</span>
					// query=&quot; select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,transaction_date,temp_receipt_id
					// from st_lms_organization_master som ,(select 'cheque'
					// t_type,cheque_agent as agent,cheque_amt as
					// amount,cheque_amt as net_amount,cheque_id as
					// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id,transaction_date,temp_receipt_id
					// from (select id ,sbsc.agent_org_id as
					// cheque_agent,sbsc.issuing_party_name,sbsc.cheque_nbr,sbsc.cheque_date,sbsc.drawee_bank,sbsc.cheque_amt,sbsc.transaction_id
					// as cheque_id,transaction_date,temp_receipt_id from
					// st_lms_bo_sale_chq sbsc,st_lms_bo_cheque_temp_receipt
					// sbctr,(select id,transaction_id from
					// st_lms_bo_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master )sbtm where
					// sbsc.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id and
					// sbctr.cheque_nbr=sbsc.cheque_nbr ) cheque ) result where
					// result.agent = som.organization_id&quot;;
					// query=&quot;select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,transaction_date
					// from st_lms_organization_master som ,(select 'cheque'
					// t_type,cheque_agent as agent,cheque_amt as
					// amount,cheque_amt as net_amount,cheque_id as
					// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id,transaction_date
					// from (select id ,sbsc.agent_org_id as
					// cheque_agent,sbsc.issuing_party_name,sbsc.cheque_nbr,sbsc.cheque_date,sbsc.drawee_bank,sbsc.cheque_amt,sbsc.transaction_id
					// as cheque_id,transaction_date from st_lms_bo_sale_chq
					// sbsc,(select id,transaction_id from
					// st_lms_bo_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master )sbtm where
					// sbsc.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id ) cheque )
					// result where result.agent = som.organization_id&quot;;
<span class="nc" id="L1235">					query = &quot;select generated_id,sbrtm.transaction_id,amount,month, transaction_date, 'VAT Paid' as remarks from st_lms_agent_receipts_trn_mapping sbrtm,st_lms_agent_receipts sbr,st_lms_agent_govt_transaction sbgt ,st_lms_agent_transaction_master sbtm where sbr.receipt_id='&quot;</span>
							+ receipt_id
							+ &quot;' and sbrtm.receipt_id=sbr.receipt_id and sbgt.transaction_id=sbrtm.transaction_id and sbtm.transaction_id=sbrtm.transaction_id order by transaction_date&quot;;
<span class="nc" id="L1238">					System.out</span>
							.println(&quot; GOVT_RCPT VAT  queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L1241">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/VATAgent.jasper&quot;;
				} 

<span class="nc" id="L1245">				generateReport(query, file, parameterMap, null, null);</span>

			}
<span class="nc" id="L1248">			System.out.println(&quot;Query -- &quot; + query);</span>
<span class="nc" id="L1249">		} catch (SQLException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L1251">			e.printStackTrace();</span>
<span class="nc" id="L1252">		} catch (Exception e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L1254">			e.printStackTrace();</span>
		} finally {
<span class="nc" id="L1256">			try {</span>

<span class="nc" id="L1258">				System.out.println(&quot; closing connection  &quot;);</span>
<span class="nc bnc" id="L1259" title="All 8 branches missed.">				if (connection != null) {</span>
<span class="nc" id="L1260">					connection.close();</span>
				}
<span class="nc" id="L1262">			} catch (SQLException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L1264">				e.printStackTrace();</span>
<span class="nc" id="L1265">			}</span>

<span class="nc" id="L1267">		}</span>
<span class="nc" id="L1268">	}</span>

	/**
	 * This method checks which type of Receipt is to be Generated at Back
	 * Office and send the data to Graph Report Method for generation of Pdf
	 * Receipts
	 * 
	 * @param receipt_id
	 *            as Integer
	 * @param root_path
	 *            as String
	 */
	public void createTextReportBO(int receipt_id, String boOrgName,
			int userOrgID, String root_path) {
<span class="nc" id="L1282">		String isVatApplicable = null;</span>
<span class="nc" id="L1283">		String isCommApplicable = null;</span>
<span class="nc" id="L1284">		String receipt_type = null;</span>
<span class="nc" id="L1285">		String receipt_no = null;</span>
<span class="nc" id="L1286">		Timestamp voucher_date = null;</span>

<span class="nc" id="L1288">		connection = DBConnect.getConnection();</span>
<span class="nc" id="L1289">		Statement stmt = null;</span>
<span class="nc" id="L1290">		ResultSet rs = null;</span>
<span class="nc" id="L1291">		String query = null;</span>
<span class="nc" id="L1292">		String file = null;</span>
<span class="nc" id="L1293">		String trnType = null;</span>

<span class="nc" id="L1295">		HashMap parameterMap = new HashMap();</span>

<span class="nc" id="L1297">		System.out</span>
				.println(&quot;======================= reciept_id : &quot; + receipt_id);
<span class="nc" id="L1299">		System.setProperty(&quot;java.awt.headless&quot;, &quot;true&quot;);</span>
<span class="nc" id="L1300">		String orgAdd = null;</span>
<span class="nc" id="L1301">		String addQuery = null;</span>
<span class="nc" id="L1302">		String vatNum = null;</span>
<span class="nc" id="L1303">		String fileName = null;</span>
<span class="nc" id="L1304">		String timeFormat = null;</span>
<span class="nc" id="L1305">		String currencySymbol = null;</span>
<span class="nc" id="L1306">		String dateFormat = null;</span>
<span class="nc" id="L1307">		String decimalFormat = null;</span>
<span class="nc" id="L1308">		String tdsPartyName = null;</span>
<span class="nc" id="L1309">		String vatPartyName = null;</span>
<span class="nc" id="L1310">		String govComPartyName = null;</span>
<span class="nc" id="L1311">		String isScratch = null;</span>
<span class="nc" id="L1312">		String isDraw = null;</span>
<span class="nc" id="L1313">		Statement statement = null;</span>
<span class="nc" id="L1314">		ResultSet set = null;</span>
<span class="nc" id="L1315">		String textForTax = null;</span>

		try {
<span class="nc" id="L1318">			timeFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TIME_FORMAT&quot;);
<span class="nc" id="L1320">			currencySymbol = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;CURRENCY_SYMBOL&quot;);
<span class="nc" id="L1322">			decimalFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;DECIMAL_FORMAT&quot;);
<span class="nc" id="L1324">			dateFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;date_format&quot;);
<span class="nc" id="L1326">			textForTax = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TEXT_FOR_TAX&quot;);
<span class="nc" id="L1328">			isScratch = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;IS_SCRATCH&quot;);
<span class="nc" id="L1330">			isDraw = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;IS_DRAW&quot;);
<span class="nc" id="L1332">			parameterMap.put(&quot;decimal_format&quot;, decimalFormat);</span>
<span class="nc" id="L1333">			parameterMap.put(&quot;timeFormat&quot;, timeFormat);</span>
<span class="nc" id="L1334">			parameterMap.put(&quot;currency_symbol&quot;, currencySymbol);</span>
<span class="nc" id="L1335">			parameterMap.put(&quot;dateFormat&quot;, dateFormat);</span>
<span class="nc" id="L1336">			parameterMap.put(&quot;textForTax&quot;, textForTax);</span>

<span class="nc" id="L1338">			LedgerHelper ledger = new LedgerHelper();</span>
<span class="nc" id="L1339">			addQuery = QueryManager.getST6AddressQuery();</span>
<span class="nc" id="L1340">			orgAdd = ledger.getAddress(addQuery, &quot;&quot; + userOrgID, null);</span>
<span class="nc" id="L1341">			parameterMap.put(&quot;orgAdd&quot;, orgAdd);</span>
<span class="nc" id="L1342">			parameterMap.put(&quot;header&quot;, boOrgName);</span>
			
<span class="nc" id="L1344">			vatNum = ledger.getVatNumber(&quot;&quot; + userOrgID);</span>
<span class="nc" id="L1345">			parameterMap.put(&quot;vatNum&quot;, vatNum);</span>
<span class="nc" id="L1346">			stmt = connection.createStatement();</span>
			// query = &quot;select receipt_type,id from st_lms_bo_receipts where id
			// ='&quot;+receipt_id+&quot;'&quot;;
			// query =&quot;select
			// sbtm.transaction_id,transaction_type,sbrgm.receipt_type,sbrgm.generated_id
			// from st_lms_bo_receipts_trn_mapping
			// sbrtm,st_lms_bo_transaction_master sbtm,st_bo_receipt_gen_mapping
			// sbrgm where sbrgm.id='&quot;+receipt_id+&quot;' andlms.
			// sbrtm.transaction_id=sbtm.transaction_id and sbrgm.id=sbrtm.id&quot;;
			// &quot;select receipt_type,generated_id from st_bo_receipt_gen_mapping
			// where id='&quot;+receipt_id+&quot;'&quot;;
<span class="nc" id="L1357">			query = &quot;select sbtm.transaction_id,transaction_type,sbr.receipt_type,sbr.generated_id, sbr.voucher_date from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_transaction_master sbtm,st_lms_bo_receipts sbr where sbrtm.receipt_id='&quot;</span>
					+ receipt_id
					+ &quot;' and  sbrtm.transaction_id=sbtm.transaction_id and sbr.receipt_id=sbrtm.receipt_id&quot;;
<span class="nc" id="L1360">			System.out.println(&quot;-------------------- &quot; + query);</span>
<span class="nc" id="L1361">			rs = stmt.executeQuery(query);</span>

<span class="nc bnc" id="L1363" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1364">				receipt_type = rs.getString(&quot;receipt_type&quot;);</span>
<span class="nc" id="L1365">				receipt_no = rs.getString(&quot;generated_id&quot;);</span>
<span class="nc" id="L1366">				trnType = rs.getString(&quot;transaction_type&quot;);</span>
<span class="nc" id="L1367">				voucher_date = rs.getTimestamp(&quot;voucher_date&quot;);</span>
			}
			/*
			 * query for temp receipt no
			 */

<span class="nc" id="L1373">			parameterMap.put(&quot;receipt_no&quot;, receipt_no);</span>
<span class="nc" id="L1374">			parameterMap.put(&quot;voucher_date&quot;, voucher_date);</span>
<span class="nc" id="L1375">			isVatApplicable = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;VAT_APPLICABLE&quot;);
<span class="nc" id="L1377">			isCommApplicable = (String) ServletActionContext</span>
					.getServletContext().getAttribute(&quot;COMM_APPLICABLE&quot;);
			
<span class="nc bnc" id="L1380" title="All 2 branches missed.">			if (receipt_type.equalsIgnoreCase(&quot;SLE_INVOICE&quot;)) {</span>
<span class="nc" id="L1381">				root_path = root_path.replace(&quot;\\&quot;, &quot;/&quot;);</span>
<span class="nc bnc" id="L1382" title="All 2 branches missed.">				if (&quot;SLE_SALE&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc" id="L1383">					query = &quot;select id,game_disp_name game_name,transaction_date,voucher_date,mrp_amt as sale, net_amt, comm_amt,vat,taxable_sale,name,addr_line1,addr_line2,city,sale.transaction_id as transaction_id from st_sle_game_master sdgm ,st_lms_organization_master som ,(select agent_id,id,game_id ,agent_comm as comm_amt, mrp_amt, net_amt, vat_amt as vat, taxable_sale,sbs.transaction_id, btm.transaction_date, voucher_date from st_sle_bo_sale sbs, st_lms_bo_transaction_master btm, (select slbr.voucher_date as voucher_date,slbr.party_id as agent_id, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;</span>
							+ receipt_id
							+ &quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id)sale where sale.game_id = sdgm.game_id and som.organization_id = sale.agent_id order by transaction_date&quot;;
<span class="nc" id="L1386">					System.out</span>
							.println(&quot; SLE_INVOICE queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc bnc" id="L1389" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1391">						fileName = &quot;SLESaleInvcComVat.jasper&quot;; // changes</span>
						// .jasper to
						// jrxml
<span class="nc bnc" id="L1394" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1396">						fileName = &quot;SLESaleInvcComNoVat.jasper&quot;; // changes</span>
						// .jasper to
						// jrxml
<span class="nc bnc" id="L1399" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1401">						fileName = &quot;SLESaleInvcRdpNoVat.jasper&quot;;// changes</span>
						// .jasper to
						// jrxml
<span class="nc bnc" id="L1404" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1406">						fileName = &quot;SLESaleInvcRdpVat.jasper&quot;;//</span>
					}
				}
<span class="nc" id="L1409">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
						+ fileName;
<span class="nc" id="L1412">				generateReport(query, file, parameterMap, null, null, null,</span>
						null);
			}
			
			
			
			
<span class="nc bnc" id="L1419" title="All 2 branches missed.">			if (receipt_type.equalsIgnoreCase(&quot;DG_INVOICE&quot;)) {</span>
<span class="nc" id="L1420">				root_path = root_path.replace(&quot;\\&quot;, &quot;/&quot;);</span>
<span class="nc bnc" id="L1421" title="All 2 branches missed.">				if (&quot;DG_SALE&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc" id="L1422">					query = &quot;select id,game_name,transaction_date,voucher_date,mrp_amt as sale, net_amt, comm_amt,vat,taxable_sale,name,addr_line1,addr_line2,city,sale.transaction_id as transaction_id from st_dg_game_master sdgm ,st_lms_organization_master som ,(select agent_id,id,game_id ,agent_comm as comm_amt, mrp_amt, net_amt, vat_amt as vat, taxable_sale,sbs.transaction_id, btm.transaction_date, voucher_date from st_dg_bo_sale sbs, st_lms_bo_transaction_master btm, (select slbr.voucher_date as voucher_date,slbr.party_id as agent_id, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;</span>
							+ receipt_id
							+ &quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id)sale where sale.game_id = sdgm.game_id and som.organization_id = sale.agent_id order by transaction_date&quot;;
<span class="nc" id="L1425">					System.out</span>
							.println(&quot; DG_INVOICE queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc bnc" id="L1428" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1430">						fileName = &quot;DGSaleInvcComVat.jasper&quot;; // changes</span>
						// .jasper to
						// jrxml
<span class="nc bnc" id="L1433" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1435">						fileName = &quot;DGSaleInvcComNoVat.jasper&quot;; // changes</span>
						// .jasper to
						// jrxml
<span class="nc bnc" id="L1438" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1440">						fileName = &quot;DGSaleInvcRdpNoVat.jasper&quot;;// changes</span>
						// .jasper to
						// jrxml
<span class="nc bnc" id="L1443" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1445">						fileName = &quot;DGSaleInvcRdpVat.jasper&quot;;//</span>
					}
				}
<span class="nc" id="L1448">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
						+ fileName;
<span class="nc" id="L1451">				generateReport(query, file, parameterMap, null, null, null,</span>
						null);
			}
<span class="nc bnc" id="L1454" title="All 2 branches missed.">			if(receipt_type.equalsIgnoreCase(&quot;CS_INVOICE&quot;)){</span>
<span class="nc" id="L1455">				root_path = root_path.replace(&quot;\\&quot;, &quot;/&quot;);</span>
<span class="nc bnc" id="L1456" title="All 2 branches missed.">			if (&quot;CS_SALE&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc" id="L1457">				query = &quot;select id,product_code,description,transaction_date,voucher_date,mrp_amt as sale, net_amt, comm_amt,vat,name,addr_line1,addr_line2,city,sale.transaction_id as transaction_id from st_cs_product_master scpm ,st_lms_organization_master som ,(select agent_id,voucher_date,id,product_id ,(mrp_amt*agent_comm/100) as comm_amt, mrp_amt, net_amt, vat_amt as vat, sbs.transaction_id, btm.transaction_date from st_cs_bo_sale sbs, st_lms_bo_transaction_master btm, (select slbr.voucher_date as voucher_date,slbr.party_id as agent_id, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+</span>
						+ receipt_id
						+ &quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id)sale where sale.product_id = scpm.product_id and scpm.product_id and som.organization_id = sale.agent_id order by transaction_date&quot;;
<span class="nc" id="L1460">				System.out</span>
						.println(&quot; CS_INVOICE queryyyyyyyyyyyyyyyy BOOOOO &quot;
								+ query);
<span class="nc bnc" id="L1463" title="All 4 branches missed.">				if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
						&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1465">					fileName = &quot;CSSaleInvcComVat.jasper&quot;; // changes</span>
					// .jasper to
					// jrxml
<span class="nc bnc" id="L1468" title="All 4 branches missed.">				} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
						&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1470">					fileName = &quot;CSSaleInvcComNoVat.jasper&quot;; // changes</span>
					// .jasper to
					// jrxml
<span class="nc bnc" id="L1473" title="All 4 branches missed.">				} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
						&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1475">					fileName = &quot;CSSaleInvcRdpNoVat.jasper&quot;;// changes</span>
					// .jasper to
					// jrxml
<span class="nc bnc" id="L1478" title="All 4 branches missed.">				} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
						&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1480">					fileName = &quot;CSSaleInvcRdpVat.jasper&quot;;//</span>
				}
			}
<span class="nc" id="L1483">			file = root_path</span>
					+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
					+ fileName;
<span class="nc" id="L1486">			generateReport(query, file, parameterMap, null, null, null,</span>
					null);
		}
			
<span class="nc bnc" id="L1490" title="All 2 branches missed.">			if(receipt_type.equalsIgnoreCase(&quot;OLA_INVOICE&quot;)){</span>
<span class="nc" id="L1491">				root_path = root_path.replace(&quot;\\&quot;, &quot;/&quot;);</span>
<span class="nc bnc" id="L1492" title="All 2 branches missed.">			if (&quot;OLA_DEPOSIT&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc" id="L1493">				query = &quot;select id,wallet_name,transaction_date,voucher_date,deposit_amt as deposit, net_amt , (deposit_amt-net_amt) comm_amt,name,addr_line1,addr_line2,city,deposit.transaction_id as transaction_id from st_lms_organization_master som ,(select agent_id,voucher_date,id,wallet_name ,agent_comm as comm_amt, deposit_amt, net_amt,sbs.transaction_id, btm.transaction_date from st_ola_bo_deposit sbs,st_ola_wallet_master wamaster, st_lms_bo_transaction_master btm,(select slbr.party_id as agent_id,slbr.voucher_date as voucher_date, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+receipt_id+&quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id and sbs.wallet_id=wamaster.wallet_id)deposit where som.organization_id = deposit.agent_id&quot;;</span>
<span class="nc" id="L1494">				System.out</span>
						.println(&quot; OLA_INVOICE queryyyyyyyyyyyyyyyy BOOOOO &quot;
								+ query);
<span class="nc" id="L1497">			fileName = &quot;OLADepositInvcRdpNoVat.jasper&quot;;</span>
			}
<span class="nc bnc" id="L1499" title="All 2 branches missed.">			if (&quot;OLA_CASHCARD_SALE&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc" id="L1500">				query = &quot;select distributor name,'india' addr_line1,'XYZ' addr_line2,'delhi' city,voucher_date,id,wallet_name ,totalamount , sale_comm_rate,amount,sbs.transaction_id, btm.transaction_date from st_ola_bo_distributor_transaction sbs,st_ola_wallet_master wamaster, st_lms_bo_transaction_master btm,(select  slbr.voucher_date as voucher_date, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = &quot;+receipt_id+&quot;)innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id and sbs.wallet_id=wamaster.wallet_id&quot;;</span>
<span class="nc" id="L1501">				System.out</span>
						.println(&quot; OLA_INVOICE queryyyyyyyyyyyyyyyy BOOOOO &quot;
								+ query);
<span class="nc" id="L1504">			fileName = &quot;OLACashCardSaleInvcRdpNoVat.jasper&quot;;</span>
			}
<span class="nc" id="L1506">			file = root_path</span>
					+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
					+ fileName;
<span class="nc" id="L1509">			generateReport(query, file, parameterMap, null, null, null,</span>
					null);
		}
<span class="nc bnc" id="L1512" title="All 2 branches missed.">			if(receipt_type.equalsIgnoreCase(&quot;OLA_RECEIPT&quot;)){</span>
<span class="nc" id="L1513">				root_path = root_path.replace(&quot;\\&quot;, &quot;/&quot;);</span>
<span class="nc bnc" id="L1514" title="All 2 branches missed.">			if (&quot;OLA_WITHDRAWL&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc" id="L1515">				query = &quot;select id,wallet_name,transaction_date,voucher_date,withdrawl_amt as withdrawal, net_amt ,(withdrawl_amt-net_amt) comm_amt,name,addr_line1,addr_line2,city,deposit.transaction_id as transaction_id from st_lms_organization_master som ,(select agent_id,voucher_date,id,wallet_name ,agent_comm as comm_amt, withdrawl_amt, net_amt,sbs.transaction_id, btm.transaction_date from st_ola_bo_withdrawl sbs,st_ola_wallet_master wamaster, st_lms_bo_transaction_master btm,(select slbr.party_id as agent_id,slbr.voucher_date as voucher_date, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+receipt_id+&quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id and sbs.wallet_id=wamaster.wallet_id)deposit where som.organization_id = deposit.agent_id&quot;;</span>
<span class="nc" id="L1516">				System.out</span>
						.println(&quot; OLA_RECEIPT queryyyyyyyyyyyyyyyy BOOOOO &quot;
								+ query);
<span class="nc" id="L1519">			fileName = &quot;OLAWithdrawalInvcRdpNoVat.jasper&quot;;</span>
			}
			// Check for OLA_COMMISSION transaction type
<span class="nc bnc" id="L1522" title="All 2 branches missed.">			if (&quot;OLA_COMMISSION&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc" id="L1523">				query = &quot;select id,wallet_name,transaction_date,voucher_date,comm_amt,netgame.tds_comm_rate,net_comm_amt,name,addr_line1,addr_line2,city,netgame.transaction_id as transaction_id from st_ola_wallet_master sdgm ,st_lms_organization_master som ,(select agent_org_id ,voucher_date,id,wallet_id ,agt_claim_comm as comm_amt,sbs.tds_comm_rate,agt_net_claim_comm as net_comm_amt , sbs.transaction_id, btm.transaction_date from st_ola_bo_comm sbs, st_lms_bo_transaction_master btm, (select slbr.party_id as agent_id,slbr.voucher_date as voucher_date,slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+receipt_id+&quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id)netgame where netgame.wallet_id = sdgm.wallet_id and som.organization_id = netgame.agent_org_id&quot;;</span>
<span class="nc" id="L1524">				System.out</span>
						.println(&quot; OLA_RECEIPT queryyyyyyyyyyyyyyyy BOOOOO &quot;
								+ query);
<span class="nc" id="L1527">			fileName = &quot;OLANetGameInvcRdpNoVat.jasper&quot;;</span>
			}
<span class="nc" id="L1529">			file = root_path</span>
					+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
					+ fileName;
<span class="nc" id="L1532">			generateReport(query, file, parameterMap, null, null, null,</span>
					null);
		}
<span class="nc bnc" id="L1535" title="All 2 branches missed.">			if (receipt_type.equalsIgnoreCase(&quot;INVOICE&quot;)) {</span>
<span class="nc" id="L1536">				System.out</span>
						.println(&quot;================== inside Invoice =================&quot;);
<span class="nc" id="L1538">				System.out.println(root_path);</span>
<span class="nc" id="L1539">				root_path = root_path.replace(&quot;\\&quot;, &quot;/&quot;);</span>
<span class="nc bnc" id="L1540" title="All 2 branches missed.">				if (&quot;SALE&quot;.equalsIgnoreCase(trnType)) {</span>
					// VAT AMOUNT AMBIGUOUS &quot;select
					// distinct(transaction_id),agent_sale_comm_rate,name,addr_line1,addr_line2,city,agent_org_id,id,game_name
					// ,sale,taxable_sale,vat_amt,ticket_price,
					// nbr_of_tickets_per_book ,
					// nbr_of_books,total_tickets,transaction_date,order_id,order_date,comm_amt
					// from (select
					// agent_sale_comm_rate,name,addr_line1,addr_line2,city,
					// agent_org_id,id, game_name
					// ,sale,taxable_sale,sale.vat_amt,ticket_price,
					// nbr_of_tickets_per_book ,
					// nbr_of_books,(nbr_of_tickets_per_book*nbr_of_books)as
					// total_tickets,transaction_date,transaction_id,order_id,order_date,comm_amt
					// from st_lms_organization_master som ,( select
					// agent_sale_comm_rate,id,sale.agent_org_id,game_name
					// ,ticket_price, nbr_of_tickets_per_book ,
					// sale.nbr_of_books,taxable_sale, vat_amt,(net_amt) as
					// sale,transaction_date,transaction_id,sale.order_id,order_date,comm_amt
					// from st_se_game_master ,st_se_bo_order sbo, (select
					// sbat.agent_org_id,id,sbat.game_id , nbr_of_books,
					// mrp_amt,sbat.transaction_id,
					// vat_amt,taxable_sale,net_amt,transaction_date,order_id,comm_amt
					// from st_se_bo_agent_transaction sbat ,
					// st_se_bo_order_invoices sboi,(select receipt_id as
					// id,transaction_id from st_lms_bo_receipts_trn_mapping
					// where receipt_id = '&quot;+receipt_id+&quot;' )innermost ,(select
					// transaction_date,transaction_id from
					// st_lms_bo_transaction_master )sbtm where
					// sbat.transaction_id = innermost.transaction_id and
					// innermost.transaction_id=sbtm.transaction_id and
					// sboi.invoice_id=innermost.id )sale where sale.game_id =
					// st_se_game_master.game_id and sbo.order_id=sale.order_id
					// )result1 where som.organization_id=result1.agent_org_id )
					// res&quot;;
//					query = &quot;select distinct(transaction_id),agent_sale_comm_rate,name,addr_line1,addr_line2,city,agent_org_id,id,game_name ,sale,taxable_sale,vat_amt,ticket_price, nbr_of_tickets_per_book , nbr_of_books,total_tickets,transaction_date,order_id,order_date,comm_amt from (select agent_sale_comm_rate,name,addr_line1,addr_line2,city, agent_org_id,id, game_name ,sale,taxable_sale,vat_amt,ticket_price, nbr_of_tickets_per_book , nbr_of_books,(nbr_of_tickets_per_book*nbr_of_books)as total_tickets,transaction_date,transaction_id,order_id,order_date,comm_amt from  st_lms_organization_master som ,( select agent_sale_comm_rate,id,sale.agent_org_id,game_name ,ticket_price, nbr_of_tickets_per_book , sale.nbr_of_books,taxable_sale, sale.vat_amt,(net_amt) as sale,transaction_date,transaction_id,sale.order_id,order_date,comm_amt from  st_se_game_master ,st_se_bo_order sbo, (select sbat.agent_org_id,id,sbat.game_id , nbr_of_books, mrp_amt,sbat.transaction_id, sbat.vat_amt,taxable_sale,net_amt,transaction_date,order_id,comm_amt from st_se_bo_agent_transaction sbat , st_se_bo_order_invoices sboi,(select receipt_id as id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id = '&quot;
//							+ receipt_id
//							+ &quot;' )innermost ,(select transaction_date,transaction_id from st_lms_bo_transaction_master     )sbtm where  sbat.transaction_id = innermost.transaction_id and innermost.transaction_id=sbtm.transaction_id and sboi.invoice_id=innermost.id )sale where sale.game_id = st_se_game_master.game_id and sbo.order_id=sale.order_id  )result1   where som.organization_id=result1.agent_org_id ) res order by transaction_date&quot;;
					
<span class="nc" id="L1578">					query = &quot;select distinct(transaction_id), agent_sale_comm_rate, name, addr_line1, addr_line2, city, agent_org_id, id, game_name, sale, taxable_sale, vat_amt, ticket_price, nbr_of_tickets_per_book,  nbr_of_books, total_tickets, transaction_date, 'NA' order_id, 'NA' order_date, comm_amt from(select agent_sale_comm_rate, name, addr_line1, addr_line2, city, agent_org_id, id, game_name , sale, taxable_sale, vat_amt, ticket_price, nbr_of_tickets_per_book , nbr_of_books, (nbr_of_tickets_per_book * nbr_of_books) as total_tickets, transaction_date, transaction_id, comm_amt from st_lms_organization_master som, (select agent_sale_comm_rate, id, sale.agent_org_id, game_name, ticket_price, nbr_of_tickets_per_book, sale.nbr_of_books, taxable_sale, sale.vat_amt, (net_amt) as sale, transaction_date, transaction_id, comm_amt from st_se_game_master,(select sbat.agent_org_id, id, sbat.game_id, nbr_of_books, mrp_amt, sbat.transaction_id, sbat.vat_amt, taxable_sale, net_amt, transaction_date, comm_amt from st_se_bo_agent_transaction sbat,(select receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id = '&quot;</span>
							+ receipt_id
							+ &quot;')innermost, (select transaction_date, transaction_id from st_lms_bo_transaction_master)sbtm where sbat.transaction_id = innermost.transaction_id and innermost.transaction_id = sbtm.transaction_id)sale where sale.game_id = st_se_game_master.game_id)result1 where som.organization_id = result1.agent_org_id)res order by transaction_date;&quot;;
<span class="nc" id="L1581">					System.out.println(&quot; INVOICE queryyyyyyyyyyyyyyyy BOOOOO &quot;</span>
							+ query);

<span class="nc bnc" id="L1584" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1586">						fileName = &quot;InvcComVat.jasper&quot;; // changes .jasper to</span>
						// jrxml
<span class="nc bnc" id="L1588" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1590">						fileName = &quot;InvcComNoVat.jasper&quot;; // changes .jasper</span>
						// to jrxml
<span class="nc bnc" id="L1592" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1594">						fileName = &quot;InvcRdpNoVat.jasper&quot;;// changes .jasper</span>
						// to jrxml
<span class="nc bnc" id="L1596" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1598">						fileName = &quot;InvcRdpVat.jasper&quot;;//</span>
					}
				} 
<span class="nc bnc" id="L1601" title="All 2 branches missed.">				else if (&quot;LOOSE_SALE&quot;.equalsIgnoreCase(trnType)) {</span>
					
<span class="nc" id="L1603">					query = &quot;select id,game_name,organization_id,transaction_date,nbrOfTickets, net_amt sale, agent_sale_comm_rate,name,addr_line1,addr_line2,city,sale.transaction_id as transaction_id,vat_amt,taxable_sale,ticket_price,comm_amt,agtSaleCommRate  from st_lms_organization_master som ,(select agent_id,id,game_name ,agent_sale_comm_rate as agent_sale_comm_rate,nbrOfTickets, ticket_price,taxable_sale,sbs.vat_amt ,net_amt,sbs.transaction_id, btm.transaction_date,comm_amt,agtSaleCommRate from st_se_bo_agent_loose_book_transaction sbs,st_se_game_master game, st_lms_bo_transaction_master btm,(select slbr.party_id as agent_id, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id ='&quot;+ receipt_id+ &quot;' )innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id and sbs.game_id=game.game_id)sale where som.organization_id = sale.agent_id&quot;;</span>
<span class="nc" id="L1604">					System.out.println(&quot; INVOICE queryyyyyyyyyyyyyyyy BOOOOO &quot;</span>
							+ query);

<span class="nc bnc" id="L1607" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1609">						fileName = &quot;looseSaleInvcComVat.jasper&quot;; // changes .jasper to</span>
						// jrxml
<span class="nc bnc" id="L1611" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1613">						fileName = &quot;looseSaleInvcComNoVat.jasper&quot;; // changes .jasper</span>
						// to jrxml
<span class="nc bnc" id="L1615" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1617">						fileName = &quot;looseSaleInvcRdpNoVat.jasper&quot;;// changes .jasper</span>
						// to jrxml
<span class="nc bnc" id="L1619" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1621">						fileName = &quot;looseSaleInvcRdpVat.jasper&quot;;//</span>
					}
				}
				
				else {
					// select id,game_name,taxable_sale, vat_amt,net_amt as
					// sale,comm_amt,transaction_id from st_dg_game_master sdgm
					// ,(select id,game_id ,agent_comm as comm_amt, mrp_amt,
					// vat_amt,taxable_sale,net_amt,sbat.transaction_id from
					// st_dg_bo_sale sbat,(select receipt_id as
					// id,transaction_id from st_lms_bo_receipts_trn_mapping
					// where receipt_id = '&quot;+receipt_id+&quot;' ) innermost where
					// sbat.transaction_id = innermost.transaction_id )sale
					// where sale.game_id = sdgm.game_id and
					// agent_org_id='&quot;+userOrgID+&quot;'&quot;;
					// query=&quot; select id,game_name,taxable_sale,
					// sale.vat_amt,net_amt as sale,comm_amt,sale.transaction_id
					// from st_dg_game_master sdgm ,(select
					// agent_org_id,id,game_id ,agent_comm as comm_amt, mrp_amt,
					// vat_amt,taxable_sale,net_amt,sbat.transaction_id from
					// st_dg_bo_sale sbat,(select receipt_id as
					// id,transaction_id from st_lms_bo_receipts_trn_mapping
					// where receipt_id = '&quot;+receipt_id+&quot;' ) innermost where
					// sbat.transaction_id = innermost.transaction_id )sale
					// where sale.game_id = sdgm.game_id and
					// agent_org_id='&quot;+userOrgID+&quot;'&quot;;
<span class="nc" id="L1647">					query = &quot;select id,game_name,taxable_sale, sale.vat_amt,net_amt as sale,comm_amt,name,addr_line1,addr_line2,city,sale.transaction_id from st_dg_game_master sdgm ,st_lms_organization_master som ,(select agent_org_id,id,game_id ,agent_comm as comm_amt, mrp_amt, vat_amt,taxable_sale,net_amt,sbat.transaction_id from  st_dg_bo_sale sbat,(select receipt_id as id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id = '&quot;</span>
							+ receipt_id
							+ &quot;' ) innermost where  sbat.transaction_id = innermost.transaction_id )sale where sale.game_id = sdgm.game_id and sale.agent_org_id='&quot;
							+ userOrgID
							+ &quot;' and som.organization_id=sale.agent_org_id&quot;;
<span class="nc" id="L1652">					System.out.println(&quot; INVOICE queryyyyyyyyyyyyyyyy BOOOOO &quot;</span>
							+ query);

<span class="nc bnc" id="L1655" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1657">						fileName = &quot;DGInvcComVat.jasper&quot;;//</span>
<span class="nc bnc" id="L1658" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1660">						fileName = &quot;DGInvcComNoVat.jasper&quot;;//</span>
<span class="nc bnc" id="L1661" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1663">						fileName = &quot;DGInvcRdpNoVat.jasper&quot;;//</span>
<span class="nc bnc" id="L1664" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1666">						fileName = &quot;DGInvcRdpVat.jasper&quot;;//</span>
					}
				}
<span class="nc" id="L1669">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
						+ fileName;
<span class="nc" id="L1672">				generateReport(query, file, parameterMap, null, null, null,</span>
						null);

			}
			
<span class="nc bnc" id="L1677" title="All 2 branches missed.">			if (receipt_type.equalsIgnoreCase(&quot;DG_RECEIPT&quot;)) {</span>
<span class="nc bnc" id="L1678" title="All 4 branches missed.">				if (trnType.equalsIgnoreCase(&quot;DG_PWT&quot;)</span>
						|| trnType.equalsIgnoreCase(&quot;DG_PWT_AUTO&quot;)) {
<span class="nc" id="L1680">					query = &quot;select id,game_nbr,game_name,t_type,transaction_date,voucher_date,pwt_amt as amount, net_amt as net_amount,comm_amt as comm_amount,name,addr_line1,addr_line2,city,sale.transaction_id as trans_id from st_dg_game_master sdgm ,st_lms_organization_master som ,(select 'pwt' t_type, agent_id,id,game_id ,comm_amt, pwt_amt, net_amt,sbat.transaction_id,btm.transaction_date,voucher_date from  st_dg_bo_pwt sbat,st_lms_bo_transaction_master btm,(select slbr.voucher_date as voucher_date,slbr.party_id as agent_id, slbr.receipt_id as id,transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;</span>
							+ receipt_id
							+ &quot;' ) innermost where  sbat.transaction_id = innermost.transaction_id and innermost.transaction_id = btm.transaction_id)sale where sale.game_id = sdgm.game_id and som.organization_id=sale.agent_id order by transaction_date&quot;;
<span class="nc" id="L1683">					System.out</span>
							.println(&quot;DG_RECEIPT PWT queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L1686">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/DGNewPWTReceipt.jasper&quot;;
<span class="nc" id="L1688">					generateReport(query, file, parameterMap, &quot;Receipt&quot;,</span>
							receipt_id + &quot;&quot;);
				}
			} 
			
<span class="nc bnc" id="L1693" title="All 2 branches missed.">			if (receipt_type.equalsIgnoreCase(&quot;SLE_RECEIPT&quot;)) {</span>
<span class="nc bnc" id="L1694" title="All 4 branches missed.">				if (trnType.equalsIgnoreCase(&quot;SLE_PWT&quot;)</span>
						|| trnType.equalsIgnoreCase(&quot;SLE_PWT_AUTO&quot;)) {
<span class="nc" id="L1696">					query = &quot;select id,game_no game_nbr,game_disp_name game_name,t_type,transaction_date,voucher_date,pwt_amt as amount, net_amt as net_amount,comm_amt as comm_amount,name,addr_line1,addr_line2,city,sale.transaction_id as trans_id from st_sle_game_master sdgm ,st_lms_organization_master som ,(select 'pwt' t_type, agent_id,id,game_id ,comm_amt, pwt_amt, net_amt,sbat.transaction_id,btm.transaction_date,voucher_date from  st_sle_bo_pwt sbat,st_lms_bo_transaction_master btm,(select slbr.voucher_date as voucher_date,slbr.party_id as agent_id, slbr.receipt_id as id,transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;</span>
							+ receipt_id
							+ &quot;' ) innermost where  sbat.transaction_id = innermost.transaction_id and innermost.transaction_id = btm.transaction_id)sale where sale.game_id = sdgm.game_id and som.organization_id=sale.agent_id order by transaction_date&quot;;
<span class="nc" id="L1699">					System.out</span>
							.println(&quot;SLE_RECEIPT PWT queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L1702">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/SLENewPWTReceipt.jasper&quot;;
<span class="nc" id="L1704">					generateReport(query, file, parameterMap, &quot;Receipt&quot;,</span>
							receipt_id + &quot;&quot;);
				}
			} 
			
<span class="nc bnc" id="L1709" title="All 4 branches missed.">			else if(receipt_type.equalsIgnoreCase(&quot;RECEIPT&quot;) &amp;&amp; trnType.equalsIgnoreCase(&quot;OLA_COMMISSION&quot;))</span>
			{
<span class="nc" id="L1711">				query = &quot;select id,wallet_name,transaction_date,voucher_date,commission_calculated as commission_calculated, name,addr_line1,addr_line2,city,netGaming.transaction_id as transaction_id from st_lms_organization_master som ,(select agent_id,id,wallet_name, commission_calculated,sbs.transaction_id, btm.transaction_date from st_ola_bo_agt_commission sbs,st_ola_wallet_master wamaster, st_lms_bo_transaction_master btm,(select slbr.party_id as agent_id, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+receipt_id+&quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id and sbs.wallet_id=wamaster.wallet_id)netGaming where som.organization_id = netGaming.agent_id&quot;;</span>
<span class="nc" id="L1712">				System.out</span>
						.println(&quot; RECEIPT OLA COMMISSION queryyyyyyyyyyyyyyyy BOOOOO &quot;
								+ query);
<span class="nc" id="L1715">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/OLAReceipt.jasper&quot;;
<span class="nc" id="L1717">				generateReport(query, file, parameterMap, null, null, null,</span>
						null);
			}
<span class="nc bnc" id="L1720" title="All 2 branches missed.">			else if (receipt_type.equalsIgnoreCase(&quot;RECEIPT&quot;)) {</span>
<span class="nc" id="L1721">				System.out</span>
						.println(&quot;================== inside reciept111 =================&quot;
								+ trnType);
<span class="nc bnc" id="L1724" title="All 2 branches missed.">				if (trnType.equalsIgnoreCase(&quot;cheque&quot;)) {</span>
<span class="nc" id="L1725">					query = &quot;select name,addr_line1,addr_line2,city,t_type,agent,trans_id,receipt_id as id,issuing_party_name,user_name,cheque_nbr,cheque_date,drawee_bank,amount,transaction_date,temp_receipt_id from  st_lms_organization_master som , (select 'cheque' t_type,cheque_agent as agent,cheque_amt as amount,user_name,cheque_amt as net_amount, cheque_id as trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,receipt_id,transaction_date,temp_receipt_id  from (select receipt_id ,slum.user_name,sbsc.agent_org_id as cheque_agent,sbsc.issuing_party_name,sbsc.cheque_nbr,sbsc.cheque_date,sbsc.drawee_bank,sbsc.cheque_amt,sbsc.transaction_id as cheque_id,transaction_date,temp_receipt_id from st_lms_bo_sale_chq sbsc,st_lms_bo_cheque_temp_receipt sbctr, (select receipt_id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id=&quot;</span>
							+receipt_id+
							&quot;) innermost,(select user_id,transaction_id,transaction_date from st_lms_bo_transaction_master )sbtm,(select user_id, user_name from st_lms_user_master)slum where sbsc.transaction_id=innermost.transaction_id and sbtm.transaction_id=innermost.transaction_id  and sbsc.transaction_id=sbctr.transaction_id and slum.user_id = sbtm.user_id) cheque ) result where result.agent = som.organization_id order by transaction_date&quot;;
<span class="nc" id="L1728">					System.out</span>
							.println(&quot; RECEIPT Cheque queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L1731">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;;
<span class="nc bnc" id="L1733" title="All 2 branches missed.">				} else if (trnType.equalsIgnoreCase(&quot;bank_deposit&quot;)) {</span>
<span class="nc" id="L1734">					query = &quot;select name,addr_line1,addr_line2,city,t_type,agent,trans_id,receipt_id as id,user_name,amount,transaction_date from  st_lms_organization_master som ,(select 'cash' t_type,cash_agent  as agent,user_name,cash_amount as amount ,trans_id,receipt_id,transaction_date from ( select receipt_id,sbct.agent_org_id as cash_agent,sbct.amount as cash_amount ,sbct.transaction_id as trans_id,slum.user_name,transaction_date from  st_lms_bo_bank_deposit_transaction sbct,( select receipt_id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id= '&quot;</span>
							+ receipt_id
							+ &quot;' ) innermost, (select  user_id,transaction_id,transaction_date from st_lms_bo_transaction_master )sbtm, (select user_id, user_name from st_lms_user_master)slum  where sbct.transaction_id=innermost.transaction_id and  sbtm.transaction_id=innermost.transaction_id and slum.user_id = sbtm.user_id  ) cash )result where result.agent = som.organization_id order by transaction_date&quot;;
<span class="nc" id="L1737">					System.out</span>
							.println(&quot; RECEIPT BANK DEPOSIT queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L1740">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/CashReceipt.jasper&quot;;
<span class="nc bnc" id="L1742" title="All 2 branches missed.">				} else if (trnType.equalsIgnoreCase(&quot;CASH&quot;)) {</span>
<span class="nc" id="L1743">					query = &quot;select name,addr_line1,addr_line2,city,t_type,agent,trans_id,receipt_id as id,user_name,amount,transaction_date from  st_lms_organization_master som ,(select 'cash' t_type,cash_agent  as agent,user_name,cash_amount as amount ,trans_id,receipt_id,transaction_date from ( select receipt_id,sbct.agent_org_id as cash_agent,sbct.amount as cash_amount ,sbct.transaction_id as trans_id,slum.user_name,transaction_date from  st_lms_bo_cash_transaction sbct,( select receipt_id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id=&quot;</span>
							+receipt_id+
							&quot;) innermost, (select user_id, transaction_id,transaction_date from st_lms_bo_transaction_master )sbtm, (select user_id, user_name from st_lms_user_master)slum  where sbct.transaction_id=innermost.transaction_id and  sbtm.transaction_id=innermost.transaction_id and slum.user_id = sbtm.user_id ) cash )result where result.agent = som.organization_id order by transaction_date&quot;;
<span class="nc" id="L1746">					System.out</span>
							.println(&quot; RECEIPT CASH queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L1749">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/CashReceipt.jasper&quot;;
<span class="nc bnc" id="L1751" title="All 4 branches missed.">				} else if (trnType.equalsIgnoreCase(&quot;PWT&quot;)</span>
						|| trnType.equalsIgnoreCase(&quot;PWT_AUTO&quot;)) {
<span class="nc" id="L1753">					query = &quot;select name,addr_line1,addr_line2,city,t_type,agent,trans_id,receipt_id as id,amount,net_amount ,comm_amount,transaction_date,game_nbr,game_name from st_lms_organization_master som ,(select 'pwt' t_type,pwt_agent  as agent,pwt_amount as amount,net_amount ,comm_amount ,pwt_trans_id as trans_id, receipt_id,transaction_date,game_nbr,game_name from  (select receipt_id,sbp.agent_org_id as pwt_agent,sum(sbp.pwt_amt) as pwt_amount, sum(sbp.net_amt)as net_amount ,sum(sbp.comm_amt)as comm_amount,sbp.transaction_id as pwt_trans_id, transaction_date,sbp.game_id,game_nbr,game_name from st_se_bo_pwt sbp,(select game_nbr,game_id,game_name from st_se_game_master )sgm, (select receipt_id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id= '&quot;</span>
							+ receipt_id
							+ &quot;') innermost,(select transaction_id,transaction_date from st_lms_bo_transaction_master )sbtm where sbp.transaction_id=innermost.transaction_id and  sbtm.transaction_id=innermost.transaction_id and sbp.game_id=sgm.game_id group by sbp.transaction_id ) pwt )result where result.agent = som.organization_id order by transaction_date&quot;;
<span class="nc" id="L1756">					System.out</span>
							.println(&quot; RECEIPT PWT queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L1759">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/PWTReceipt.jasper&quot;;
<span class="nc bnc" id="L1761" title="All 4 branches missed.">				} else if (trnType.equalsIgnoreCase(&quot;DG_PWT&quot;)</span>
						|| trnType.equalsIgnoreCase(&quot;DG_PWT_AUTO&quot;)) {
<span class="nc" id="L1763">					query = &quot;select name,addr_line1,addr_line2,city,t_type,trans_id,receipt_id as id,amount,net_amount ,comm_amt,game_nbr,game_name from st_lms_organization_master som ,(select 'pwt' t_type,pwt_amount as amount,net_amount ,comm_amt , receipt_id,game_nbr,game_name from (select receipt_id,sbp.agent_org_id as agent,sbp.pwt_amt as pwt_amount, sbp.net_amt as net_amount ,sbp.comm_amt as comm_amt,sbp.transaction_id as pwt_trans_id, sbp.game_id,game_nbr,game_name from st_se_bo_pwt sbp,(select game_nbr,game_id,game_name from st_se_game_master  )sgm,(select receipt_id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id= '&quot;</span>
							+ receipt_id
							+ &quot;') innermost,(select transaction_id from st_lms_bo_transaction_master)sbtm where sbp.transaction_id=innermost.transaction_id and  sbtm.transaction_id=innermost.transaction_id and sbp.game_id=sgm.game_id and agent_org_id='') pwt )result where result.agent = som.organization_id&quot;;
<span class="nc" id="L1766">					System.out</span>
							.println(&quot; RECEIPT PWT queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L1769">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/DGPWTReceipt.jasper&quot;;
				}
<span class="nc" id="L1772">				generateReport(query, file, parameterMap, &quot;Receipt&quot;, receipt_id</span>
						+ &quot;&quot;);
			}

<span class="nc bnc" id="L1776" title="All 2 branches missed.">			else if (receipt_type.equalsIgnoreCase(&quot;DR_NOTE&quot;)) {</span>
<span class="nc" id="L1777">				System.out</span>
						.println(&quot;================== inside note =================&quot;);
				// query=&quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,transaction_id
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
				// from st_lms_bo_sale_chq sbsc, (select id,transaction_id from
				// st_lms_bo_receipts_trn_mapping where id= '&quot;+receipt_id+&quot;')
				// innermost where
				// sbsc.transaction_id=innermost.transaction_id)result1 where
				// som.organization_id=result1.agent_org_id&quot;;
				// query= &quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,issuing_party_name,cheque_nbr,amount,transaction_type,remarks,cheque_date,drawee_bank,cheque_amt,transaction_id
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,
				// sbdn.transaction_type,remarks, cheque_amt,sbsc.transaction_id
				// from st_lms_bo_sale_chq sbsc,(select
				// amount,transaction_type,remarks,transaction_id from
				// st_lms_bo_debit_note) sbdn, (select id,transaction_id from
				// st_lms_bo_receipts_trn_mapping where id= '&quot;+receipt_id+&quot;')
				// innermost where sbsc.transaction_id=innermost.transaction_id
				// and sbdn.transaction_id =innermost.transaction_id )result1
				// where som.organization_id=result1.agent_org_id&quot;;
				// query=&quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,transaction_type,remarks,transaction_id,transaction_date
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,issuing_party_name, cheque_nbr, cheque_date,
				// drawee_bank, cheque_amt as amount,transaction_id,
				// transaction_type,remarks,transaction_date from (select 0.00
				// amount,id,transaction_type,'Cheque
				// Bounce'remarks,sbsc.transaction_id,agent_org_id,
				// issuing_party_name, cheque_nbr, cheque_date,drawee_bank,
				// cheque_amt,transaction_date from st_lms_bo_sale_chq
				// sbsc,(select id,transaction_id from
				// st_lms_bo_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;')innermost,(select
				// transaction_id,transaction_date from
				// st_lms_bo_transaction_master)sbtm where
				// innermost.transaction_id=sbsc.transaction_id and
				// sbtm.transaction_id=innermost.transaction_id)cheque union
				// select agent_org_id,id,'N.A.'issuing_party_name,'N.A.'
				// cheque_nbr,'N.A.' cheque_date,'N.A.' drawee_bank,
				// amount,transaction_id,transaction_type,remarks,transaction_date
				// from (select
				// amount,id,transaction_type,remarks,sbdn.transaction_id,agent_org_id,transaction_date
				// from st_lms_bo_debit_note sbdn,(select id,transaction_id from
				// st_lms_bo_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;')innermost,(select
				// transaction_id,transaction_date from
				// st_lms_bo_transaction_master)sbtm where
				// innermost.transaction_id=sbdn.transaction_id and
				// sbtm.transaction_id=innermost.transaction_id )bounce) result1
				// where som.organization_id=result1.agent_org_id &quot;;
<span class="nc" id="L1830">				query = &quot;select name,addr_line1,addr_line2,city,agent_org_id,receipt_id as id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,transaction_type,remarks,transaction_id,transaction_date from st_lms_organization_master som ,(select agent_org_id,receipt_id,issuing_party_name, cheque_nbr, cheque_date, drawee_bank,cheque_amt as amount,transaction_id, transaction_type,remarks,transaction_date from (select 0.00 amount,receipt_id,transaction_type,'Cheque Bounce'remarks,sbsc.transaction_id,agent_org_id, issuing_party_name, cheque_nbr, cheque_date,drawee_bank, cheque_amt,transaction_date from st_lms_bo_sale_chq  sbsc,(select receipt_id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id= '&quot;</span>
						+ receipt_id
						+ &quot;' )innermost,(select transaction_id,transaction_date from st_lms_bo_transaction_master)sbtm  where innermost.transaction_id=sbsc.transaction_id and sbtm.transaction_id=innermost.transaction_id )cheque union select agent_org_id,receipt_id as id,'N.A.'issuing_party_name,'N.A.' cheque_nbr,'N.A.' cheque_date,'N.A.' drawee_bank, amount,transaction_id,transaction_type,remarks,transaction_date from (select  amount,receipt_id,transaction_type,remarks,sbdn.transaction_id,agent_org_id,transaction_date from st_lms_bo_debit_note  sbdn,(select receipt_id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id= '&quot;
						+ receipt_id
						+ &quot;' )innermost,(select transaction_id,transaction_date from st_lms_bo_transaction_master )sbtm  where innermost.transaction_id=sbdn.transaction_id and  sbtm.transaction_id=innermost.transaction_id  )bounce) result1 where som.organization_id=result1.agent_org_id order by transaction_date&quot;;
<span class="nc" id="L1835">				System.out.println(&quot;queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot; + query);</span>
<span class="nc" id="L1836">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;;
<span class="nc" id="L1838">				generateReport(query, file, parameterMap, &quot;DebitNote&quot;,</span>
						receipt_id + &quot;&quot;);

<span class="nc bnc" id="L1841" title="All 2 branches missed.">			} else if (receipt_type.equalsIgnoreCase(&quot;DR_NOTE_CASH&quot;)) {</span>
<span class="nc" id="L1842">				System.out</span>
						.println(&quot;================== inside note =================&quot;);
				// query=&quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,transaction_id
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
				// from st_lms_bo_sale_chq sbsc, (select id,transaction_id from
				// st_lms_bo_receipts_trn_mapping where id= '&quot;+receipt_id+&quot;')
				// innermost where
				// sbsc.transaction_id=innermost.transaction_id)result1 where
				// som.organization_id=result1.agent_org_id&quot;;
				// query=&quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,amount,transaction_type,remarks,transaction_id
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,amount,sbdn.transaction_type,remarks,sbdn.transaction_id
				// from (select
				// amount,transaction_type,remarks,transaction_id,agent_org_id
				// from st_lms_bo_debit_note) sbdn,(select id,transaction_id
				// from st_lms_bo_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;') innermost where sbdn.transaction_id
				// =innermost.transaction_id )result1 where
				// som.organization_id=result1.agent_org_id&quot;;
				// query=&quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,amount,transaction_type,remarks,transaction_id,transaction_date
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,amount,sbdn.transaction_type,remarks,sbdn.transaction_id,transaction_date
				// from (select
				// amount,transaction_type,remarks,transaction_id,agent_org_id
				// from st_lms_bo_debit_note) sbdn,(select id,transaction_id
				// from st_lms_bo_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;') innermost,(select
				// transaction_id,transaction_date from
				// st_lms_bo_transaction_master)sbtm where sbdn.transaction_id
				// =innermost.transaction_id and
				// sbtm.transaction_id=innermost.transaction_id)result1 where
				// som.organization_id=result1.agent_org_id&quot;;
<span class="nc" id="L1878">				query = &quot;select name,addr_line1,addr_line2,city,agent_org_id,id,user_name,amount,transaction_type,remarks,transaction_id,transaction_date from  st_lms_organization_master som , (select agent_org_id,id,amount,sbdn.transaction_type,slum.user_name,remarks,sbdn.transaction_id,transaction_date from (select  amount,transaction_type,remarks,transaction_id,agent_org_id from st_lms_bo_debit_note ) sbdn,(select receipt_id as id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id= &quot;</span>
						+receipt_id+
						&quot;) innermost,(select user_id,transaction_id,transaction_date from st_lms_bo_transaction_master )sbtm, (select user_id, user_name from st_lms_user_master)slum where sbdn.transaction_id =innermost.transaction_id and sbtm.transaction_id=innermost.transaction_id and slum.user_id = sbtm.user_id)result1 where som.organization_id=result1.agent_org_id order by transaction_date&quot;;
<span class="nc" id="L1881">				System.out</span>
						.println(&quot;DR_NOTE_CASH queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;
								+ query);
<span class="nc" id="L1884">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/Debit_Note_Cash.jasper&quot;;
<span class="nc" id="L1886">				generateReport(query, file, parameterMap, null, null, null,</span>
						null);

<span class="nc bnc" id="L1889" title="All 2 branches missed.">			} else if (receipt_type.equalsIgnoreCase(&quot;CR_NOTE&quot;)) {</span>
<span class="nc bnc" id="L1890" title="All 2 branches missed.">				if (&quot;SALE_RET&quot;.equalsIgnoreCase(trnType)) {</span>
					// query=&quot;select
					// agent_sale_comm_rate,name,addr_line1,addr_line2,city,agent_org_id,id,game_name
					// ,sale,taxable_sale,vat_amt,comm_amt, ticket_price,
					// nbr_of_tickets_per_book
					// ,nbr_of_books,(nbr_of_tickets_per_book*nbr_of_books)as
					// total_tickets, transaction_date from
					// st_lms_organization_master som , (select
					// agent_sale_comm_rate,id,agent_org_id,game_name,ticket_price,nbr_of_tickets_per_book,result.game_id,result.nbr_of_books
					// ,taxable_sale,vat_amt,(net_amt) as
					// sale,comm_amt,transaction_id,transaction_date from
					// st_se_game_master sgm,(select
					// sbat.agent_org_id,game_id,nbr_of_books,mrp_amt
					// ,sbat.transaction_id,id,
					// vat_amt,taxable_sale,net_amt,comm_amt,transaction_date
					// from st_se_bo_agent_transaction sbat, (select receipt_id
					// as id,transaction_id from st_lms_bo_receipts_trn_mapping
					// where receipt_id= '&quot;+receipt_id+&quot;' ) innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master )sbtm where
					// sbat.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id ) result
					// where sgm.game_id = result.game_id )result1 where
					// som.organization_id=result1.agent_org_id&quot;;
<span class="nc" id="L1914">					query = &quot;select agent_sale_comm_rate,name,addr_line1,addr_line2,city,agent_org_id,id,game_name ,sale,taxable_sale,vat_amt,comm_amt, ticket_price, nbr_of_tickets_per_book ,nbr_of_books,(nbr_of_tickets_per_book*nbr_of_books)as total_tickets, transaction_date from  st_lms_organization_master som , (select agent_sale_comm_rate,id,agent_org_id,game_name,ticket_price,nbr_of_tickets_per_book,result.game_id,result.nbr_of_books ,taxable_sale,result.vat_amt,(net_amt) as sale,comm_amt,transaction_id,transaction_date from st_se_game_master sgm,(select sbat.agent_org_id,game_id,nbr_of_books,mrp_amt ,sbat.transaction_id,id, vat_amt,taxable_sale,net_amt,comm_amt,transaction_date from st_se_bo_agent_transaction sbat, (select receipt_id as id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id= '&quot;</span>
							+ receipt_id
							+ &quot;' ) innermost,(select transaction_id,transaction_date from st_lms_bo_transaction_master )sbtm where sbat.transaction_id=innermost.transaction_id and sbtm.transaction_id=innermost.transaction_id ) result where sgm.game_id = result.game_id  )result1 where som.organization_id=result1.agent_org_id order by transaction_date&quot;;
<span class="nc" id="L1917">					System.out</span>
							.println(&quot;CR_NOTE queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;
									+ query);
<span class="nc" id="L1920">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
							+ fileName;
<span class="nc bnc" id="L1923" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1925">						fileName = &quot;CrdtNtComVat.jasper&quot;;</span>
<span class="nc bnc" id="L1926" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1928">						fileName = &quot;CrdtNtComNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L1929" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1931">						fileName = &quot;CrdtNtRdpNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L1932" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1934">						fileName = &quot;CrdtNtRdpVat.jasper&quot;;</span>
					}
				}
<span class="nc bnc" id="L1937" title="All 2 branches missed.">				if (&quot;LOOSE_SALE_RET&quot;.equalsIgnoreCase(trnType)) {</span>
					
<span class="nc" id="L1939">					query = &quot;select id,game_name,organization_id,transaction_date,nbrOfTickets, net_amt sale, agent_sale_comm_rate,name,addr_line1,addr_line2,city,sale.transaction_id as transaction_id,vat_amt,taxable_sale,ticket_price,comm_amt,agtSaleCommRate from st_lms_organization_master som ,(select agent_id,id,game_name ,agent_sale_comm_rate as agent_sale_comm_rate,nbrOfTickets, ticket_price,taxable_sale,sbs.vat_amt ,net_amt,sbs.transaction_id, btm.transaction_date,comm_amt,agtSaleCommRate from st_se_bo_agent_loose_book_transaction sbs,st_se_game_master game, st_lms_bo_transaction_master btm,(select slbr.party_id as agent_id, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+ receipt_id+ &quot;' )innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id and sbs.game_id=game.game_id)sale where som.organization_id = sale.agent_id&quot;;</span>
<span class="nc" id="L1940">					System.out</span>
							.println(&quot;CR_NOTE queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;
									+ query);
<span class="nc" id="L1943">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
							+ fileName;
<span class="nc bnc" id="L1946" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1948">						fileName = &quot;looseSaleReturnCrdtNtComVat.jasper&quot;;</span>
<span class="nc bnc" id="L1949" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1951">						fileName = &quot;looseSaleReturnCrdtNtComNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L1952" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1954">						fileName = &quot;looseSaleReturnCrdtNtRdpNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L1955" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1957">						fileName = &quot;looseSaleReturnCrdtNtRdpVat.jasper&quot;;</span>
					}
				}
<span class="nc bnc" id="L1960" title="All 4 branches missed.">				if (&quot;DG_REFUND_CANCEL&quot;.equalsIgnoreCase(trnType)</span>
						|| &quot;DG_REFUND_FAILED&quot;.equalsIgnoreCase(trnType)) {
<span class="nc" id="L1962">					query = &quot;select name,addr_line1,addr_line2,city,game_name ,sale,taxable_sale,vat as vat_amt,agent_comm as comm_amt, transaction_date from st_lms_organization_master som, st_dg_game_master sdgm,(select sbtm.transaction_date, sdbs.agent_org_id as agt_id, game_id, mrp_amt as sale, sdbs.transaction_id, vat_amt as vat, taxable_sale, net_amt, agent_comm from st_dg_bo_sale_refund sdbs,(select receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id='&quot;</span>
							+ receipt_id
							+ &quot;')innermost,(select party_id, transaction_id, transaction_date from st_lms_bo_transaction_master)sbtm where sdbs.transaction_id = innermost.transaction_id and sbtm.transaction_id=innermost.transaction_id and sbtm.party_id = sdbs.agent_org_id)result where result.agt_id = som.organization_id and result.game_id = sdgm.game_id order by transaction_date&quot;;
<span class="nc" id="L1965">					System.out</span>
							.println(&quot;CR_NOTE queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;
									+ query);
<span class="nc" id="L1968">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
							+ fileName;
<span class="nc bnc" id="L1971" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1973">						fileName = &quot;DGCrdtNtComVat.jasper&quot;;</span>
<span class="nc bnc" id="L1974" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1976">						fileName = &quot;DGCrdtNtComNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L1977" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L1979">						fileName = &quot;DGCrdtNtRdpNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L1980" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1982">						fileName = &quot;DGCrdtNtRdpVat.jasper&quot;;</span>
					}
				}
<span class="nc bnc" id="L1985" title="All 4 branches missed.">				if(&quot;CS_CANCEL_SERVER&quot;.equalsIgnoreCase(trnType)</span>
						|| &quot;CS_CANCEL_RET&quot;.equalsIgnoreCase(trnType)){
<span class="nc" id="L1987">					query = &quot;select name,addr_line1,addr_line2,city,product_code,description,sale,vat as vat_amt,comm_amt, transaction_date from st_lms_organization_master som, st_cs_product_master scpm,(select sbtm.transaction_date, sdbs.agent_org_id as agt_id, product_id, mrp_amt as sale, sdbs.transaction_id, vat_amt as vat, net_amt, (mrp_amt*sdbs.agent_comm/100) as comm_amt from st_cs_bo_refund sdbs,(select receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id='&quot;</span>
							+ receipt_id
							+ &quot;')innermost,(select party_id, transaction_id, transaction_date from st_lms_bo_transaction_master)sbtm where sdbs.transaction_id = innermost.transaction_id and sbtm.transaction_id=innermost.transaction_id and sbtm.party_id = sdbs.agent_org_id)result where result.agt_id = som.organization_id and result.product_id = scpm.product_id order by transaction_date&quot;;
<span class="nc" id="L1990">					System.out</span>
							.println(&quot;CS CR_NOTE queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;
									+ query);
<span class="nc" id="L1993">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
							+ fileName;
<span class="nc bnc" id="L1996" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L1998">						fileName = &quot;CSCrdtNtComVat.jasper&quot;;</span>
<span class="nc bnc" id="L1999" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L2001">						fileName = &quot;CSCrdtNtComNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L2002" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L2004">						fileName = &quot;CSCrdtNtRdpNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L2005" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L2007">						fileName = &quot;CSCrdtNtRdpVat.jasper&quot;;</span>
					}
				
				}
<span class="nc bnc" id="L2011" title="All 2 branches missed.">				if(&quot;OLA_DEPOSIT_REFUND&quot;.equalsIgnoreCase(trnType)){</span>
<span class="nc" id="L2012">					query = &quot;select id,wallet_name,transaction_date,voucher_date,deposit_amt as deposit_refund, net_amt ,(deposit_amt-net_amt) comm_amt,name,addr_line1,addr_line2,city,deposit.transaction_id as transaction_id from st_lms_organization_master som ,(select agent_id,id,wallet_name ,agent_comm as comm_amt, deposit_amt, net_amt,sbs.transaction_id, btm.transaction_date from st_ola_bo_deposit_refund sbs,st_ola_wallet_master wamaster, st_lms_bo_transaction_master btm,(select slbr.party_id as agent_id, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+receipt_id+&quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id and sbs.wallet_id=wamaster.wallet_id)deposit where som.organization_id = deposit.agent_id&quot;;</span>
<span class="nc" id="L2013">					System.out</span>
							.println(&quot;OLA CR_NOTE queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;
									+ query);
<span class="nc" id="L2016">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
							+ fileName;
					
<span class="nc" id="L2020">						fileName = &quot;OLACrdtNtRdpNoVat.jasper&quot;;</span>
				}
				/*
				 * else{ query=&quot;select
				 * name,addr_line1,addr_line2,city,id,game_name
				 * ,sale,taxable_sale,vat_amt,comm_amt from
				 * st_lms_organization_master som ,(select
				 * id,game_name,result.game_id,taxable_sale,vat_amt,(net_amt) as
				 * sale,comm_amt,transaction_id from st_se_game_master
				 * sgm,(select sdbs.agent_org_id,game_id,mrp_amt
				 * ,sdbs.transaction_id,id,
				 * vat_amt,taxable_sale,net_amt,comm_amt from st_dg_bo_sale
				 * sdbs,(select receipt_id as id,transaction_id from
				 * st_lms_bo_receipts_trn_mapping where receipt_id=
				 * '&quot;+receipt_id+&quot;') innermost,(select
				 * transaction_id,transaction_date from
				 * st_lms_bo_transaction_master )sbtm where
				 * sdbs.transaction_id=innermost.transaction_id and
				 * sbtm.transaction_id=innermost.transaction_id and
				 * agent_org_id='') result where sgm.game_id = result.game_id
				 * )result1 where som.organization_id=result1.agent_org_id&quot;;
				 * System.out.println(&quot;CR_NOTE
				 * queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;+query);file=root_path+
				 * &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;+fileName;
				 * if(isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)&amp;&amp;isVatApplicable.
				 * equalsIgnoreCase(&quot;yes&quot;)){ fileName=&quot;DGCrdtNtComVat.jasper&quot;;
				 * }else
				 * if(isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)&amp;&amp;isVatApplicable
				 * .equalsIgnoreCase(&quot;no&quot;)){ fileName=&quot;DGCrdtNtComNoVat.jasper&quot;;
				 * }else
				 * if(isCommApplicable.equalsIgnoreCase(&quot;no&quot;)&amp;&amp;isVatApplicable
				 * .equalsIgnoreCase(&quot;no&quot;)){ fileName=&quot;DGCrdtNtRdpNoVat.jasper&quot;;
				 * }else
				 * if(isCommApplicable.equalsIgnoreCase(&quot;no&quot;)&amp;&amp;isVatApplicable
				 * .equalsIgnoreCase(&quot;yes&quot;)){ fileName=&quot;DGCrdtNtRdpVat.jasper&quot;;
				 * } }
				 */

<span class="nc" id="L2058">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
						+ fileName;
<span class="nc" id="L2061">				generateReport(query, file, parameterMap, null, null, null,</span>
						null);
			}

<span class="nc bnc" id="L2065" title="All 2 branches missed.">			else if (receipt_type.equalsIgnoreCase(&quot;CR_NOTE_CASH&quot;)) {</span>
<span class="nc" id="L2066">				System.out</span>
						.println(&quot;================== inside note =================&quot;);
				// query=&quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,transaction_id
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
				// from st_lms_bo_sale_chq sbsc, (select id,transaction_id from
				// st_lms_bo_receipts_trn_mapping where id= '&quot;+receipt_id+&quot;')
				// innermost where
				// sbsc.transaction_id=innermost.transaction_id)result1 where
				// som.organization_id=result1.agent_org_id&quot;;
				// query=&quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,amount,transaction_type,remarks,transaction_id
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,amount,sbdn.transaction_type,remarks,sbdn.transaction_id
				// from (select
				// amount,transaction_type,remarks,transaction_id,agent_org_id
				// from st_lms_bo_debit_note) sbdn,(select id,transaction_id
				// from st_lms_bo_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;') innermost where sbdn.transaction_id
				// =innermost.transaction_id )result1 where
				// som.organization_id=result1.agent_org_id&quot;;
				// query=&quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,amount,transaction_type,remarks,transaction_id,transaction_date
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,amount,sbdn.transaction_type,remarks,sbdn.transaction_id,transaction_date
				// from (select
				// amount,transaction_type,remarks,transaction_id,agent_org_id
				// from st_lms_bo_debit_note) sbdn,(select id,transaction_id
				// from st_lms_bo_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;') innermost,(select
				// transaction_id,transaction_date from
				// st_lms_bo_transaction_master)sbtm where sbdn.transaction_id
				// =innermost.transaction_id and
				// sbtm.transaction_id=innermost.transaction_id)result1 where
				// som.organization_id=result1.agent_org_id&quot;;
<span class="nc" id="L2102">				query = &quot;select name,addr_line1,addr_line2,city,agent_org_id,id,amount,transaction_type,remarks,user_name,transaction_id,transaction_date from  st_lms_organization_master som , (select agent_org_id,id,slum.user_name,amount,sbdn.transaction_type,remarks,sbdn.transaction_id,transaction_date from (select  amount,transaction_type,remarks,transaction_id,agent_org_id from st_lms_bo_credit_note ) sbdn,(select receipt_id as id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id= &quot;</span>
						+receipt_id+
						&quot;) innermost,(select user_id, transaction_id,transaction_date from st_lms_bo_transaction_master )sbtm, (select user_name, user_id from st_lms_user_master) slum where sbdn.transaction_id =innermost.transaction_id and sbtm.transaction_id=innermost.transaction_id and slum.user_id = sbtm.user_id)result1 where som.organization_id=result1.agent_org_id order by transaction_date&quot;;
<span class="nc" id="L2105">				System.out</span>
						.println(&quot;CR_NOTE_CASH queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;
								+ query);
<span class="nc" id="L2108">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/Credit_Note_Cash.jasper&quot;;
<span class="nc" id="L2110">				generateReport(query, file, parameterMap, null, null, null,</span>
						null);

<span class="nc bnc" id="L2113" title="All 2 branches missed.">			} else if (receipt_type.equalsIgnoreCase(&quot;GOVT_RCPT&quot;)) {</span>
<span class="nc" id="L2114">				vatPartyName = (String) ServletActionContext</span>
						.getServletContext().getAttribute(&quot;VAT_PARTY_NAME&quot;);
<span class="nc" id="L2116">				tdsPartyName = (String) ServletActionContext</span>
						.getServletContext().getAttribute(&quot;TDS_PARTY_NAME&quot;);
<span class="nc" id="L2118">				govComPartyName = (String) ServletActionContext</span>
						.getServletContext().getAttribute(
								&quot;GOVT_COMM_PARTY_NAME&quot;);
<span class="nc" id="L2121">				parameterMap.put(&quot;vatPartyName&quot;, vatPartyName);</span>
<span class="nc" id="L2122">				parameterMap.put(&quot;tdsPartyName&quot;, tdsPartyName);</span>
<span class="nc" id="L2123">				parameterMap.put(&quot;govComPartyName&quot;, govComPartyName);</span>
<span class="nc" id="L2124">				System.out</span>
						.println(&quot;================== inside GOVT_RCPT =================&quot;
								+ trnType);
				// query=&quot;select
				// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,net_amount
				// ,comm_amount from st_lms_organization_master som ,(select
				// 'cash' t_type,cash_agent as agent,cash_amount as amount
				// ,cash_amount as net_amount ,0.00 comm_amount ,cash_trans_id
				// as trans_id, 'cash' issuing_party_name,'cash'
				// cheque_nbr,'cash' cheque_date, 'cash' drawee_bank,cash_id as
				// id from ( select id as cash_id,sbct.agent_org_id as
				// cash_agent,sbct.amount as cash_amount ,sbct.transaction_id as
				// cash_trans_id from st_lms_bo_cash_transaction sbct, (select
				// id,transaction_id from st_lms_bo_receipts_trn_mapping where
				// id= '&quot;+receipt_id+&quot;') innermost where
				// sbct.transaction_id=innermost.transaction_id) cash union
				// select 'pwt' t_type,pwt_agent as agent,pwt_amount as
				// amount,net_amount ,comm_amount ,pwt_trans_id as
				// trans_id,'pwt' issuing_party_name,'pwt' cheque_nbr, 'pwt'
				// cheque_date, 'pwt' drawee_bank , pwt_id as id from (select id
				// as pwt_id,sbp.agent_org_id as pwt_agent,sum(sbp.pwt_amt) as
				// pwt_amount,sum(sbp.net_amt)as net_amount ,sum(sbp.comm_amt)as
				// comm_amount,sbp.transaction_id as pwt_trans_id from
				// st_se_bo_pwt sbp, (select id,transaction_id from
				// st_lms_bo_receipts_trn_mapping where id= '&quot;+receipt_id+&quot;')
				// innermost where sbp.transaction_id=innermost.transaction_id
				// group by sbp.transaction_id) pwt union select 'cheque'
				// t_type,cheque_agent as agent,cheque_amt as amount,cheque_amt
				// as net_amount ,0.00 comm_amount,cheque_id as
				// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id
				// from ( select id ,agent_org_id as
				// cheque_agent,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
				// as cheque_id from st_lms_bo_sale_chq sbsc, (select
				// id,transaction_id from st_lms_bo_receipts_trn_mapping where
				// id= '&quot;+receipt_id+&quot;') innermost where
				// sbsc.transaction_id=innermost.transaction_id) cheque) result
				// where result.agent = som.organization_id&quot;;
				// query=&quot;select
				// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,net_amount
				// ,comm_amount,transaction_date from st_lms_organization_master
				// som ,(select 'cash' t_type,cash_agent as agent,cash_amount as
				// amount ,cash_amount as net_amount ,0.00 comm_amount
				// ,cash_trans_id as trans_id,'cash' issuing_party_name,'cash'
				// cheque_nbr,'cash' cheque_date, 'cash' drawee_bank,cash_id as
				// id,transaction_date from ( select id as
				// cash_id,sbct.agent_org_id as cash_agent,sbct.amount as
				// cash_amount , sbct.transaction_id as
				// cash_trans_id,transaction_date from
				// st_lms_bo_cash_transaction sbct, (select id,transaction_id
				// from st_lms_bo_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;') innermost, (select
				// transaction_id,transaction_date from
				// st_lms_bo_transaction_master)sbtm where
				// sbct.transaction_id=innermost.transaction_id and
				// sbtm.transaction_id=innermost.transaction_id ) cash union
				// select 'pwt' t_type,pwt_agent as agent,pwt_amount as
				// amount,net_amount ,comm_amount ,pwt_trans_id as
				// trans_id,'pwt' issuing_party_name,'pwt' cheque_nbr,'pwt'
				// cheque_date, 'pwt' drawee_bank , pwt_id as
				// id,transaction_date from (select id as
				// pwt_id,sbp.agent_org_id as pwt_agent,sum(sbp.pwt_amt) as
				// pwt_amount,sum(sbp.net_amt)as net_amount ,sum(sbp.comm_amt)as
				// comm_amount,sbp.transaction_id as
				// pwt_trans_id,transaction_date from st_se_bo_pwt sbp, (select
				// id,transaction_id from st_lms_bo_receipts_trn_mapping where
				// id= '&quot;+receipt_id+&quot;') innermost,(select
				// transaction_id,transaction_date from
				// st_lms_bo_transaction_master)sbtm where
				// sbp.transaction_id=innermost.transaction_id and
				// sbtm.transaction_id=innermost.transaction_id group by
				// sbp.transaction_id) pwt union select 'cheque'
				// t_type,cheque_agent as agent,cheque_amt as amount,cheque_amt
				// as net_amount,0.00 comm_amount,cheque_id as
				// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id,transaction_date
				// from (select id ,agent_org_id as
				// cheque_agent,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
				// as cheque_id,transaction_date from st_lms_bo_sale_chq sbsc,
				// (select id,transaction_id from st_lms_bo_receipts_trn_mapping
				// where id= '&quot;+receipt_id+&quot;') innermost,(select
				// transaction_id,transaction_date from
				// st_lms_bo_transaction_master)sbtm where
				// sbsc.transaction_id=innermost.transaction_id and
				// sbtm.transaction_id=innermost.transaction_id) cheque) result
				// where result.agent = som.organization_id&quot;;
<span class="nc bnc" id="L2208" title="All 2 branches missed.">				if (trnType.equalsIgnoreCase(&quot;VAT&quot;)) {</span>
					// query=&quot; select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,transaction_date,temp_receipt_id
					// from st_lms_organization_master som ,(select 'cheque'
					// t_type,cheque_agent as agent,cheque_amt as
					// amount,cheque_amt as net_amount,cheque_id as
					// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id,transaction_date,temp_receipt_id
					// from (select id ,sbsc.agent_org_id as
					// cheque_agent,sbsc.issuing_party_name,sbsc.cheque_nbr,sbsc.cheque_date,sbsc.drawee_bank,sbsc.cheque_amt,sbsc.transaction_id
					// as cheque_id,transaction_date,temp_receipt_id from
					// st_lms_bo_sale_chq sbsc,st_lms_bo_cheque_temp_receipt
					// sbctr,(select id,transaction_id from
					// st_lms_bo_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master )sbtm where
					// sbsc.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id and
					// sbctr.cheque_nbr=sbsc.cheque_nbr ) cheque ) result where
					// result.agent = som.organization_id&quot;;
					// query=&quot;select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,transaction_date
					// from st_lms_organization_master som ,(select 'cheque'
					// t_type,cheque_agent as agent,cheque_amt as
					// amount,cheque_amt as net_amount,cheque_id as
					// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id,transaction_date
					// from (select id ,sbsc.agent_org_id as
					// cheque_agent,sbsc.issuing_party_name,sbsc.cheque_nbr,sbsc.cheque_date,sbsc.drawee_bank,sbsc.cheque_amt,sbsc.transaction_id
					// as cheque_id,transaction_date from st_lms_bo_sale_chq
					// sbsc,(select id,transaction_id from
					// st_lms_bo_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master )sbtm where
					// sbsc.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id ) cheque )
					// result where result.agent = som.organization_id&quot;;
<span class="nc" id="L2245">					query = &quot;select generated_id,sbrtm.transaction_id,amount,start_date,end_date, transaction_date, sbr.voucher_date,'VAT Paid' as remarks from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_receipts sbr,st_lms_bo_govt_transaction sbgt ,st_lms_bo_transaction_master sbtm where sbr.receipt_id='&quot;</span>
							+ receipt_id
							+ &quot;' and sbrtm.receipt_id=sbr.receipt_id and sbgt.transaction_id=sbrtm.transaction_id and sbtm.transaction_id=sbrtm.transaction_id order by transaction_date&quot;;
<span class="nc" id="L2248">					System.out</span>
							.println(&quot; RECEIPT VAT queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L2251">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/VAT.jasper&quot;;
<span class="nc bnc" id="L2253" title="All 2 branches missed.">				} else if (trnType.equalsIgnoreCase(&quot;TDS&quot;)) {</span>
					// query=&quot;select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,amount,transaction_date
					// from st_lms_organization_master som ,(select 'cash'
					// t_type,cash_agent as agent,cash_amount as amount
					// ,cash_trans_id as trans_id,cash_id as id,transaction_date
					// from ( select id as cash_id,sbct.agent_org_id as
					// cash_agent,sbct.amount as cash_amount ,
					// sbct.transaction_id as cash_trans_id,transaction_date
					// from st_lms_bo_cash_transaction sbct,(select
					// id,transaction_id from st_lms_bo_receipts_trn_mapping
					// where id= '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master )sbtm where
					// sbct.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id )
					// cash)result where result.agent = som.organization_id&quot;;
					// query=&quot;select
					// generated_id,sbrtm.transaction_id,amount,sbgt.start_date,sbgt.end_date,
					// sbtm.transaction_date, 'TDS Paid' as
					// remarks,sdpp.transaction_date as plr_date
					// ,sdpp.player_id,
					// first_name,last_name,photo_id_type,photo_id_nbr,sdpp.tax_amt,sdpp.pwt_amt
					// from st_lms_bo_receipts_trn_mapping
					// sbrtm,st_lms_bo_receipts sbr,st_lms_bo_govt_transaction
					// sbgt ,st_lms_bo_transaction_master
					// sbtm,st_se_direct_player_pwt sdpp,st_lms_player_master
					// spm where sbr.receipt_id='&quot;+receipt_id+&quot;' and
					// sbrtm.receipt_id=sbr.receipt_id and
					// sbgt.transaction_id=sbrtm.transaction_id and
					// sbtm.transaction_id=sbrtm.transaction_id and
					// sdpp.transaction_date &gt;= start_date and
					// sdpp.transaction_date &lt;=end_date and
					// sdpp.player_id=spm.player_id&quot;;
<span class="nc" id="L2287">					statement = connection.createStatement();</span>
<span class="nc" id="L2288">					set = statement</span>
							.executeQuery(&quot;select player_id  from   st_se_direct_player_pwt&quot;);
<span class="nc" id="L2290">					System.out.println(set.absolute(1));</span>
<span class="nc bnc" id="L2291" title="All 2 branches missed.">					if (set.absolute(1)) {</span>
<span class="nc" id="L2292">						query = &quot;select distinct(generated_id),sbrtm.transaction_id,amount,sbgt.start_date,sbgt.end_date, sbtm.transaction_date, sbr.voucher_date, '&quot;</span>
								+ textForTax
								+ &quot; Paid' as remarks,sdpp.player_id, first_name,last_name,photo_id_type,photo_id_nbr,sdpp.tax_amt,sdpp.pwt_amt from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_receipts sbr,st_lms_bo_govt_transaction sbgt ,st_lms_bo_transaction_master sbtm,st_se_direct_player_pwt sdpp,st_lms_player_master spm where sbr.receipt_id='&quot;
								+ receipt_id
								+ &quot;' and sbrtm.receipt_id=sbr.receipt_id and sbgt.transaction_id=sbrtm.transaction_id and sbtm.transaction_id=sbrtm.transaction_id and sdpp.transaction_date &gt;= start_date and sdpp.transaction_date &lt;=end_date and sdpp.player_id=spm.player_id union select distinct(generated_id),sbrtm.transaction_id,amount,sbgt.start_date,sbgt.end_date, sbtm.transaction_date, '&quot;
								+ textForTax
								+ &quot; Paid' as remarks, 'NA' player_id, 'NA'first_name,'NA' last_name,'NA' photo_id_type,'NA' photo_id_nbr,'NA' tax_amt,'NA' pwt_amt from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_receipts sbr,st_lms_bo_govt_transaction sbgt ,st_lms_bo_transaction_master sbtm,st_lms_player_master spm where sbr.receipt_id='&quot;
								+ receipt_id
								+ &quot;' and sbrtm.receipt_id=sbr.receipt_id and sbgt.transaction_id=sbrtm.transaction_id and sbtm.transaction_id=sbrtm.transaction_id order by sbtm.transaction_date&quot;;
					} else {
<span class="nc" id="L2302">						query = &quot;select distinct(generated_id),sbrtm.transaction_id,amount,sbgt.start_date,sbgt.end_date, sbtm.transaction_date, sbr.voucher_date, '&quot;</span>
								+ textForTax
								+ &quot; Paid' as remarks, 'NA' player_id, 'NA'first_name,'NA' last_name,'NA' photo_id_type,'NA' photo_id_nbr,'NA' tax_amt,'NA' pwt_amt from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_receipts sbr,st_lms_bo_govt_transaction sbgt ,st_lms_bo_transaction_master sbtm where sbr.receipt_id='&quot;
								+ receipt_id
								+ &quot;' and sbrtm.receipt_id=sbr.receipt_id and sbgt.transaction_id=sbrtm.transaction_id and sbtm.transaction_id=sbrtm.transaction_id order by sbtm.transaction_date&quot;;
					}
<span class="nc" id="L2308">					System.out</span>
							.println(&quot; RECEIPT TDS queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L2311">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/TDS.jasper&quot;;
<span class="nc bnc" id="L2313" title="All 2 branches missed.">				} else if (trnType.equalsIgnoreCase(&quot;GOVT_COMM&quot;)) {</span>
					// query=&quot;select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,amount,net_amount
					// ,comm_amount,transaction_date,game_nbr,game_name from
					// st_lms_organization_master som ,(select 'pwt'
					// t_type,pwt_agent as agent,pwt_amount as amount,net_amount
					// ,comm_amount ,pwt_trans_id as trans_id, pwt_id as
					// id,transaction_date,game_nbr,game_name from (select id as
					// pwt_id,sbp.agent_org_id as pwt_agent,sum(sbp.pwt_amt) as
					// pwt_amount,sum(sbp.net_amt)as net_amount
					// ,sum(sbp.comm_amt)as comm_amount,sbp.transaction_id as
					// pwt_trans_id,transaction_date,sbp.game_id,game_nbr,game_name
					// from st_se_bo_pwt sbp,(select game_nbr,game_id,game_name
					// from st_se_game_master )sgm,(select id,transaction_id
					// from st_lms_bo_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master )sbtm where
					// sbp.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id and
					// sbp.game_id=sgm.game_id group by sbp.transaction_id )
					// pwt)result where result.agent = som.organization_id&quot;;
					// &quot;select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,net_amount
					// ,comm_amount,transaction_date,game_nbr from
					// st_lms_organization_master som , (select 'cash'
					// t_type,cash_agent as agent,cash_amount as amount
					// ,cash_amount as net_amount ,0.00 comm_amount
					// ,cash_trans_id as trans_id,'cash'
					// issuing_party_name,'cash' cheque_nbr,'cash' cheque_date,
					// 'cash' drawee_bank,cash_id as id,transaction_date,'cash'
					// game_nbr from ( select id as cash_id,sbct.agent_org_id as
					// cash_agent,sbct.amount as cash_amount ,
					// sbct.transaction_id as cash_trans_id,transaction_date
					// from st_lms_bo_cash_transaction sbct, (select
					// id,transaction_id from st_lms_bo_receipts_trn_mapping
					// where id= '&quot;+receipt_id+&quot;') innermost, (select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master)sbtm where
					// sbct.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id ) cash union
					// select 'pwt' t_type,pwt_agent as agent,pwt_amount as
					// amount,net_amount ,comm_amount ,pwt_trans_id as
					// trans_id,'pwt' issuing_party_name,'pwt' cheque_nbr,'pwt'
					// cheque_date, 'pwt' drawee_bank , pwt_id as
					// id,transaction_date,game_nbr from (select id as
					// pwt_id,sbp.agent_org_id as pwt_agent,sum(sbp.pwt_amt) as
					// pwt_amount,sum(sbp.net_amt)as net_amount
					// ,sum(sbp.comm_amt)as comm_amount,sbp.transaction_id as
					// pwt_trans_id,transaction_date,sbp.game_id,game_nbr from
					// st_se_bo_pwt sbp,(select game_nbr,game_id from
					// st_se_game_master )sgm, (select id,transaction_id from
					// st_lms_bo_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master)sbtm where
					// sbp.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id and
					// sbp.game_id=sgm.game_id group by sbp.transaction_id) pwt
					// union select 'cheque' t_type,cheque_agent as
					// agent,cheque_amt as amount,cheque_amt as net_amount,0.00
					// comm_amount,cheque_id as
					// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id,transaction_date
					// , 'cheque' game_nbr from (select id ,agent_org_id as
					// cheque_agent,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
					// as cheque_id,transaction_date from st_lms_bo_sale_chq
					// sbsc, (select id,transaction_id from
					// st_lms_bo_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master)sbtm where
					// sbsc.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id) cheque)
					// result where result.agent = som.organization_id&quot;;
<span class="nc" id="L2387">					String serviceCode = checkServiceCode(receipt_id);</span>
<span class="nc bnc" id="L2388" title="All 2 branches missed.">					if (serviceCode.equalsIgnoreCase(&quot;se&quot;)) {</span>
<span class="nc" id="L2389">						query = &quot;select generated_id,sbrtm.transaction_id,amount,sbgt.start_date,sbgt.end_date, transaction_date, sbr.voucher_date, sbtm.transaction_type, 'Good Cause' as remarks,sbgt.game_id,game_name,game_nbr from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_receipts sbr,st_lms_bo_govt_transaction sbgt ,st_lms_bo_transaction_master sbtm,st_se_game_master sgm where sbr.receipt_id='&quot;</span>
								+ receipt_id
								+ &quot;' and sbrtm.receipt_id=sbr.receipt_id and sbgt.transaction_id=sbrtm.transaction_id and sbtm.transaction_id=sbrtm.transaction_id and sgm.game_id=sbgt.game_id order by transaction_date&quot;;
<span class="nc bnc" id="L2392" title="All 2 branches missed.">					} else if (serviceCode.equalsIgnoreCase(&quot;dg&quot;)) {</span>
<span class="nc" id="L2393">						query = &quot;select generated_id,sbrtm.transaction_id,amount,sbgt.start_date,sbgt.end_date, transaction_date, sbr.voucher_date, sbtm.transaction_type, 'Good Cause' as remarks,sbgt.game_id,game_name,game_nbr from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_receipts sbr,st_lms_bo_govt_transaction sbgt ,st_lms_bo_transaction_master sbtm,st_dg_game_master sgm where sbr.receipt_id='&quot;</span>
								+ receipt_id
								+ &quot;' and sbrtm.receipt_id=sbr.receipt_id and sbgt.transaction_id=sbrtm.transaction_id and sbtm.transaction_id=sbrtm.transaction_id and sgm.game_id=sbgt.game_id order by transaction_date&quot;;
<span class="nc bnc" id="L2396" title="All 2 branches missed.">					} else if (serviceCode.equalsIgnoreCase(&quot;SLE&quot;)) {</span>
<span class="nc" id="L2397">						query = &quot;select generated_id,sbrtm.transaction_id,amount,sbgt.start_date,sbgt.end_date, transaction_date, sbr.voucher_date, sbtm.transaction_type, 'Good Cause' as remarks,sbgt.game_id,type_disp_name as game_name,game_type_id as game_nbr from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_receipts sbr,st_lms_bo_govt_transaction sbgt ,st_lms_bo_transaction_master sbtm,st_sle_game_type_master sgm where sbr.receipt_id='&quot;</span>
								+ receipt_id
								+ &quot;' and sbrtm.receipt_id=sbr.receipt_id and sbgt.transaction_id=sbrtm.transaction_id and sbtm.transaction_id=sbrtm.transaction_id and sgm.game_id=sbgt.game_id order by transaction_date&quot;;
					}
<span class="nc" id="L2401">					System.out</span>
							.println(&quot; GOVT_COMM queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L2404">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/GovtComm.jasper&quot;;
				
<span class="nc bnc" id="L2407" title="All 2 branches missed.">				} else if (trnType.equalsIgnoreCase(&quot;GOVT_COMM_PWT&quot;)) {</span>

<span class="nc" id="L2409">					String serviceCode = checkServiceCode(receipt_id);</span>
<span class="nc bnc" id="L2410" title="All 2 branches missed.">					if (serviceCode.equalsIgnoreCase(&quot;se&quot;)) {</span>
<span class="nc" id="L2411">						query = &quot;select generated_id,sbrtm.transaction_id,amount,sbgt.start_date,sbgt.end_date, transaction_date, sbr.voucher_date, sbtm.transaction_type, 'Good Cause' as remarks,sbgt.game_id,game_name,game_nbr from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_receipts sbr,st_lms_bo_govt_transaction sbgt ,st_lms_bo_transaction_master sbtm,st_se_game_master sgm where sbr.receipt_id='&quot;</span>
								+ receipt_id
								+ &quot;' and sbrtm.receipt_id=sbr.receipt_id and sbgt.transaction_id=sbrtm.transaction_id and sbtm.transaction_id=sbrtm.transaction_id and sgm.game_id=sbgt.game_id order by transaction_date&quot;;
<span class="nc bnc" id="L2414" title="All 2 branches missed.">					} else if (serviceCode.equalsIgnoreCase(&quot;dg&quot;)) {</span>
<span class="nc" id="L2415">						query = &quot;select generated_id,sbrtm.transaction_id,amount,sbgt.start_date,sbgt.end_date, transaction_date, sbr.voucher_date, sbtm.transaction_type, 'Good Cause' as remarks,sbgt.game_id,game_name,game_nbr from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_receipts sbr,st_lms_bo_govt_transaction sbgt ,st_lms_bo_transaction_master sbtm,st_dg_game_master sgm where sbr.receipt_id='&quot;</span>
								+ receipt_id
								+ &quot;' and sbrtm.receipt_id=sbr.receipt_id and sbgt.transaction_id=sbrtm.transaction_id and sbtm.transaction_id=sbrtm.transaction_id and sgm.game_id=sbgt.game_id order by transaction_date&quot;;
<span class="nc bnc" id="L2418" title="All 2 branches missed.">					} else if (serviceCode.equalsIgnoreCase(&quot;SLE&quot;)) {</span>
<span class="nc" id="L2419">						query = &quot;select generated_id,sbrtm.transaction_id,amount,sbgt.start_date,sbgt.end_date, transaction_date, sbr.voucher_date, sbtm.transaction_type, 'Good Cause' as remarks,sbgt.game_id,type_disp_name as game_name,game_type_id as game_nbr from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_receipts sbr,st_lms_bo_govt_transaction sbgt ,st_lms_bo_transaction_master sbtm,st_sle_game_type_master sgm where sbr.receipt_id='&quot;</span>
								+ receipt_id
								+ &quot;' and sbrtm.receipt_id=sbr.receipt_id and sbgt.transaction_id=sbrtm.transaction_id and sbtm.transaction_id=sbrtm.transaction_id and sgm.game_id=sbgt.game_id order by transaction_date&quot;;
					}
<span class="nc" id="L2423">					System.out.println(&quot; GOVT_COMM_PWT queryyyyyyyyyyyyyyyy BOOOOO &quot;</span>
									+ query);
<span class="nc" id="L2425">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/GovtComm.jasper&quot;;
				}
<span class="nc" id="L2428">				generateReport(query, file, parameterMap, null, null);</span>

			}

<span class="nc" id="L2432">			System.out.println(&quot;Query -- &quot; + query);</span>
<span class="nc" id="L2433">		} catch (SQLException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L2435">			e.printStackTrace();</span>
<span class="nc" id="L2436">		} catch (Exception e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L2438">			e.printStackTrace();</span>
		} finally {
<span class="nc" id="L2440">			try {</span>

<span class="nc" id="L2442">				System.out.println(&quot; closing connection  &quot;);</span>
<span class="nc bnc" id="L2443" title="All 8 branches missed.">				if (connection != null) {</span>
<span class="nc" id="L2444">					connection.close();</span>
				}
<span class="nc" id="L2446">			} catch (SQLException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L2448">				e.printStackTrace();</span>
<span class="nc" id="L2449">			}</span>

<span class="nc" id="L2451">		}</span>

<span class="nc" id="L2453">	}</span>

	public void createTextReportPlayer(int task_id, String root_path,
			String gameType) {
<span class="nc" id="L2457">		String receipt_type = null;</span>

<span class="nc" id="L2459">		Connection connection = DBConnect.getConnection();</span>
<span class="nc" id="L2460">		Statement stmt = null;</span>
<span class="nc" id="L2461">		ResultSet rs = null;</span>
<span class="nc" id="L2462">		ResultSet rs1 = null;</span>
<span class="nc" id="L2463">		String query = null;</span>
<span class="nc" id="L2464">		String addQuery = null;</span>
<span class="nc" id="L2465">		String file = null;</span>
<span class="nc" id="L2466">		String name = null;</span>
<span class="nc" id="L2467">		String addr_line1 = null;</span>
<span class="nc" id="L2468">		String addr_line2 = null;</span>
<span class="nc" id="L2469">		String city = null;</span>
<span class="nc" id="L2470">		String receipt_no = null;</span>
<span class="nc" id="L2471">		String orgAdd = null;</span>

<span class="nc" id="L2473">		HashMap parameterMap = new HashMap();</span>
<span class="nc" id="L2474">		System.out</span>
				.println(&quot;heeeeeellllllllloooooooooo  createTextReportPlayer&quot;);
<span class="nc" id="L2476">		System.setProperty(&quot;java.awt.headless&quot;, &quot;true&quot;);</span>

<span class="nc" id="L2478">		String timeFormat = null;</span>
<span class="nc" id="L2479">		String currencySymbol = null;</span>
<span class="nc" id="L2480">		String dateFormat = null;</span>
<span class="nc" id="L2481">		String decimalFormat = null;</span>
<span class="nc" id="L2482">		String textForTax = null;</span>

<span class="nc" id="L2484">		String queryForPartyType = null;</span>
<span class="nc" id="L2485">		String queryForPlayer = null;</span>
<span class="nc" id="L2486">		String queryForAnonymous = null;</span>
<span class="nc" id="L2487">		String queryforAgtRet = null;</span>
<span class="nc" id="L2488">		String partyType = null;</span>
<span class="nc" id="L2489">		String requestId = null;</span>
<span class="nc" id="L2490">		String payerType = null;</span>
<span class="nc" id="L2491">		int payersId = 0;</span>
<span class="nc" id="L2492">		String payersName = null;</span>
<span class="nc" id="L2493">		String payersAdd = null;</span>
<span class="nc" id="L2494">		String tableName = null;</span>
<span class="nc" id="L2495">		String rcptNoQuery = null;</span>
<span class="nc" id="L2496">		long  transactionId = 0;</span>

		try {
<span class="nc" id="L2499">			timeFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TIME_FORMAT&quot;);
<span class="nc" id="L2501">			currencySymbol = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;CURRENCY_SYMBOL&quot;);
<span class="nc" id="L2503">			decimalFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;DECIMAL_FORMAT&quot;);
<span class="nc" id="L2505">			dateFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;date_format&quot;);
<span class="nc" id="L2507">			textForTax = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TEXT_FOR_TAX&quot;);
<span class="nc" id="L2509">			parameterMap.put(&quot;decimal_format&quot;, decimalFormat);</span>
<span class="nc" id="L2510">			parameterMap.put(&quot;timeFormat&quot;, timeFormat);</span>
<span class="nc" id="L2511">			parameterMap.put(&quot;currency_symbol&quot;, currencySymbol);</span>
<span class="nc" id="L2512">			parameterMap.put(&quot;dateFormat&quot;, dateFormat);</span>
<span class="nc" id="L2513">			parameterMap.put(&quot;textForTax&quot;, textForTax);</span>
<span class="nc bnc" id="L2514" title="All 2 branches missed.">			if (&quot;DRAW_GAME&quot;.equalsIgnoreCase(gameType)) {</span>
<span class="nc" id="L2515">				queryForAnonymous = &quot;select 'Anonymous' name,'' addr_line1,'' addr_line2,'' city,'' photo_id_type,'' photo_id_nbr, transaction_id,cheque_nbr,cheque_date,drawee_bank,issuing_party_name,payment_type,pwt_amt,tax_amt,net_amt,concat(first_name,' ', last_name)as name ,addr_line1,addr_line2,city,photo_id_type,photo_id_nbr,draw_id from &quot;</span>
						+ tableName + &quot; dpp where task_id='&quot; + task_id + &quot;'&quot;;
				// queryForPlayer= &quot;select
				// transaction_id,transaction_date,cheque_nbr,cheque_date,drawee_bank,issuing_party_name,payment_type,pwt_amt,tax_amt,net_amt,concat(first_name,'
				// ', last_name)as name
				// ,addr_line1,addr_line2,city,photo_id_type,photo_id_nbr,draw_id
				// from st_dg_bo_direct_plr_pwt dpp, st_lms_player_master spm
				// where task_id='&quot;+task_id+&quot;' and spm.player_id=dpp.player_id&quot;;
<span class="nc" id="L2523">				queryForPartyType = &quot;select transaction_id,party_type,request_id,payment_done_by,payment_done_by_type,name from st_dg_approval_req_master ,st_lms_organization_master where task_id='&quot;</span>
						+ task_id + &quot;' and payment_done_by=organization_id&quot;;

			} else {
<span class="nc" id="L2527">				queryForAnonymous = &quot;select 'Anonymous' name,'' addr_line1,'' addr_line2,'' city,'' photo_id_type,'' photo_id_nbr, transaction_id,cheque_nbr,cheque_date,drawee_bank,issuing_party_name,payment_type,pwt_amt,tax_amt,net_amt,concat(first_name,' ', last_name)as name ,addr_line1,addr_line2,city,photo_id_type,photo_id_nbr from &quot;</span>
						+ tableName + &quot; dpp where task_id='&quot; + task_id + &quot;'&quot;;
				// queryForPlayer= &quot;select
				// transaction_id,transaction_date,cheque_nbr,cheque_date,drawee_bank,issuing_party_name,payment_type,pwt_amt,tax_amt,net_amt,concat(first_name,'
				// ', last_name)as name
				// ,addr_line1,addr_line2,city,photo_id_type,photo_id_nbr from
				// &quot;+tableName +&quot; dpp, st_lms_player_master spm where
				// task_id='&quot;+task_id+&quot;' and spm.player_id=dpp.player_id&quot;;
<span class="nc" id="L2535">				queryForPartyType = &quot;select transaction_id,party_type,request_id,payment_done_by,payment_done_by_type,name from st_se_pwt_approval_request_master,st_lms_organization_master where task_id='&quot;</span>
						+ task_id + &quot;' and payment_done_by=organization_id&quot;;
			}
			// queryForPartyType=&quot;select
			// transaction_id,party_type,request_id,payment_done_by,payment_done_by_type,name
			// from st_se_pwt_approval_request_master,st_lms_organization_master
			// where task_id='&quot;+task_id+&quot;' and payment_done_by=organization_id&quot;;
<span class="nc" id="L2542">			stmt = connection.createStatement();</span>
<span class="nc" id="L2543">			rs1 = stmt.executeQuery(queryForPartyType);</span>
<span class="nc" id="L2544">			System.out.println(&quot;queryForPartyType  &quot; + queryForPartyType + &quot;  &quot;</span>
					+ stmt.toString());
<span class="nc bnc" id="L2546" title="All 2 branches missed.">			while (rs1.next()) {</span>
<span class="nc" id="L2547">				partyType = rs1.getString(&quot;party_type&quot;);</span>
<span class="nc" id="L2548">				requestId = rs1.getString(&quot;request_id&quot;);</span>
<span class="nc" id="L2549">				payerType = rs1.getString(&quot;payment_done_by_type&quot;);</span>
<span class="nc" id="L2550">				payersId = rs1.getInt(&quot;payment_done_by&quot;);</span>
<span class="nc" id="L2551">				payersName = rs1.getString(&quot;name&quot;);</span>
<span class="nc" id="L2552">				transactionId = rs1.getLong(&quot;transaction_id&quot;);</span>
<span class="nc" id="L2553">				System.out.println(&quot;payerType &quot; + payerType);</span>
			}
<span class="nc" id="L2555">			LedgerHelper ledger = new LedgerHelper();</span>
<span class="nc" id="L2556">			addQuery = QueryManager.getST6AddressQuery();</span>
<span class="nc" id="L2557">			payersAdd = ledger.getAddress(addQuery, &quot;&quot; + payersId, null);</span>
<span class="nc" id="L2558">			parameterMap.put(&quot;orgAdd&quot;, payersAdd);</span>
<span class="nc" id="L2559">			parameterMap.put(&quot;header&quot;, payersName);</span>
<span class="nc" id="L2560">			parameterMap.put(&quot;requestId&quot;, requestId);</span>
<span class="nc" id="L2561">			root_path = root_path.replace(&quot;\\&quot;, &quot;/&quot;);</span>
<span class="nc bnc" id="L2562" title="All 2 branches missed.">			if (&quot;DRAW_GAME&quot;.equalsIgnoreCase(gameType)) {</span>
<span class="nc bnc" id="L2563" title="All 2 branches missed.">				if (payerType.equalsIgnoreCase(&quot;BO&quot;)) {</span>
<span class="nc bnc" id="L2564" title="All 2 branches missed.">					if (partyType.equalsIgnoreCase(&quot;PLAYER&quot;)) {</span>
<span class="nc" id="L2565">						tableName = &quot;st_dg_bo_direct_plr_pwt&quot;;</span>
<span class="nc" id="L2566">						query = &quot;select transaction_id,transaction_date,cheque_nbr,cheque_date,drawee_bank,issuing_party_name,payment_type,pwt_amt,tax_amt,net_amt,concat(first_name,' ', last_name)as name ,addr_line1,addr_line2,city,photo_id_type,photo_id_nbr,draw_id from &quot;</span>
								+ tableName
								+ &quot; dpp, st_lms_player_master spm where task_id='&quot;
								+ task_id
								+ &quot;' and  spm.player_id=dpp.player_id order by transaction_date&quot;;
<span class="nc" id="L2571">						rcptNoQuery = &quot;select generated_id,receipt_type,voucher_date from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_receipts  sbr where transaction_id='&quot;</span>
								+ transactionId
								+ &quot;' and sbr.receipt_id=sbrtm.receipt_id&quot;;
					}

<span class="nc bnc" id="L2576" title="All 2 branches missed.">				} else if (payerType.equalsIgnoreCase(&quot;AGENT&quot;)) {</span>

<span class="nc bnc" id="L2578" title="All 2 branches missed.">					if (partyType.equalsIgnoreCase(&quot;PLAYER&quot;)) {</span>
<span class="nc" id="L2579">						tableName = &quot;st_dg_agt_direct_plr_pwt&quot;;</span>
<span class="nc" id="L2580">						query = &quot;select transaction_id,transaction_date,cheque_nbr,cheque_date,drawee_bank,issuing_party_name,payment_type,pwt_amt,tax_amt,net_amt,concat(first_name,' ', last_name)as name ,addr_line1,addr_line2,city,photo_id_type,photo_id_nbr,draw_id from &quot;</span>
								+ tableName
								+ &quot; dpp, st_lms_player_master spm where task_id='&quot;
								+ task_id
								+ &quot;' and  spm.player_id=dpp.player_id order by transaction_date&quot;;
<span class="nc" id="L2585">						rcptNoQuery = &quot;select generated_id,receipt_type from st_lms_agent_receipts_trn_mapping sartm,st_lms_agent_receipts  sar where transaction_id='&quot;</span>
								+ transactionId
								+ &quot;' and sar.receipt_id=sartm.receipt_id&quot;;
					}

<span class="nc bnc" id="L2590" title="All 2 branches missed.">				} else if (payerType.equalsIgnoreCase(&quot;RETAILER&quot;)) {</span>
<span class="nc" id="L2591">					rcptNoQuery = &quot;select generated_id,receipt_type from st_ret_receipts_trn_mapping sartm,st_ret_receipts  sar where transaction_id='&quot;</span>
							+ transactionId
							+ &quot;' and sar.receipt_id=sartm.receipt_id&quot;;
<span class="nc" id="L2594">					tableName = &quot;st_dg_ret_direct_plr_pwt&quot;;</span>
<span class="nc bnc" id="L2595" title="All 2 branches missed.">					if (partyType.equalsIgnoreCase(&quot;PLAYER&quot;)) {</span>
<span class="nc" id="L2596">						query = &quot;select transaction_id,transaction_date,cheque_nbr,cheque_date,drawee_bank,issuing_party_name,payment_type,pwt_amt,tax_amt,net_amt,concat(first_name,' ', last_name)as name ,addr_line1,addr_line2,city,photo_id_type,photo_id_nbr,draw_id from &quot;</span>
								+ tableName
								+ &quot; dpp, st_lms_player_master spm where task_id='&quot;
								+ task_id
								+ &quot;' and  spm.player_id=dpp.player_id order by transaction_date&quot;;

<span class="nc bnc" id="L2602" title="All 2 branches missed.">					} else if (partyType.equalsIgnoreCase(&quot;ANONYMOUS&quot;)) {</span>
<span class="nc" id="L2603">						query = queryForAnonymous;</span>
					}
				}

				// queryForPlayer=&quot;select
				// transaction_id,transaction_date,cheque_nbr,cheque_date,drawee_bank,issuing_party_name,payment_type,pwt_amt,tax_amt,net_amt,concat(first_name,'
				// ', last_name)as name
				// ,addr_line1,addr_line2,city,photo_id_type,photo_id_nbr,draw_id
				// from &quot;+tableName +&quot; dpp, st_lms_player_master spm where
				// task_id='&quot;+task_id+&quot;' and spm.player_id=dpp.player_id&quot;;
<span class="nc" id="L2613">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/DGDirectPlayerReceipt.jasper&quot;;
			} else {
<span class="nc bnc" id="L2616" title="All 2 branches missed.">				if (payerType.equalsIgnoreCase(&quot;BO&quot;)) {</span>
<span class="nc bnc" id="L2617" title="All 2 branches missed.">					if (partyType.equalsIgnoreCase(&quot;PLAYER&quot;)) {</span>
<span class="nc" id="L2618">						tableName = &quot;st_se_direct_player_pwt&quot;;</span>
<span class="nc" id="L2619">						query = &quot;select transaction_id,transaction_date,cheque_nbr,cheque_date,drawee_bank,issuing_party_name,payment_type,pwt_amt,tax_amt,net_amt,concat(first_name,' ', last_name)as name ,addr_line1,addr_line2,city,photo_id_type,photo_id_nbr from &quot;</span>
								+ tableName
								+ &quot; dpp, st_lms_player_master spm where task_id='&quot;
								+ task_id
								+ &quot;' and  spm.player_id=dpp.player_id order by transaction_date&quot;;
<span class="nc" id="L2624">						rcptNoQuery = &quot;select generated_id,receipt_type,voucher_date from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_receipts  sbr where transaction_id='&quot;</span>
								+ transactionId
								+ &quot;' and sbr.receipt_id=sbrtm.receipt_id&quot;;
					}

<span class="nc bnc" id="L2629" title="All 2 branches missed.">				} else if (payerType.equalsIgnoreCase(&quot;AGENT&quot;)) {</span>

<span class="nc bnc" id="L2631" title="All 2 branches missed.">					if (partyType.equalsIgnoreCase(&quot;PLAYER&quot;)) {</span>
<span class="nc" id="L2632">						tableName = &quot;st_se_agt_direct_player_pwt&quot;;</span>
<span class="nc" id="L2633">						query = &quot;select transaction_id,transaction_date,cheque_nbr,cheque_date,drawee_bank,issuing_party_name,payment_type,pwt_amt,tax_amt,net_amt,concat(first_name,' ', last_name)as name ,addr_line1,addr_line2,city,photo_id_type,photo_id_nbr from &quot;</span>
								+ tableName
								+ &quot; dpp, st_lms_player_master spm where task_id='&quot;
								+ task_id
								+ &quot;' and  spm.player_id=dpp.player_id order by transaction_date&quot;;
<span class="nc" id="L2638">						rcptNoQuery = &quot;select generated_id,receipt_type from st_lms_agent_receipts_trn_mapping sartm,st_lms_agent_receipts  sar where transaction_id='&quot;</span>
								+ transactionId
								+ &quot;' and sar.receipt_id=sartm.receipt_id&quot;;
					}

				}
				// queryForPlayer=&quot;select
				// transaction_id,transaction_date,cheque_nbr,cheque_date,drawee_bank,issuing_party_name,payment_type,pwt_amt,tax_amt,net_amt,concat(first_name,'
				// ', last_name)as name
				// ,addr_line1,addr_line2,city,photo_id_type,photo_id_nbr from
				// &quot;+tableName +&quot; dpp, st_lms_player_master spm where
				// task_id='&quot;+task_id+&quot;' and spm.player_id=dpp.player_id&quot;;
<span class="nc" id="L2650">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/DirectPlayerReceipt.jasper&quot;;
			}
<span class="nc" id="L2653">			rs = stmt.executeQuery(rcptNoQuery);</span>

<span class="nc bnc" id="L2655" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L2656">				receipt_no = rs.getString(&quot;generated_id&quot;);</span>
<span class="nc" id="L2657">				receipt_type = rs.getString(&quot;receipt_type&quot;);</span>
<span class="nc" id="L2658">				System.out.println(&quot;receipt_type &quot; + receipt_type</span>
						+ &quot;  receipt_no &quot; + receipt_no);
			}

<span class="nc" id="L2662">			parameterMap.put(&quot;receipt_no&quot;, receipt_no);</span>
<span class="nc" id="L2663">			parameterMap.put(&quot;requestId&quot;, requestId);</span>

<span class="nc bnc" id="L2665" title="All 2 branches missed.">			if (receipt_type.equalsIgnoreCase(&quot;RECEIPT&quot;)) {</span>
				// query=queryForPlayer;
<span class="nc" id="L2667">				System.out.println(&quot;queryyyyyyyy createTextReportPlayer&quot;</span>
						+ query);
<span class="nc" id="L2669">				generateReport(query, file, parameterMap, null, null, null,</span>
						null);

			}

<span class="nc" id="L2674">			System.out.println(&quot;Query -- &quot; + query);</span>
<span class="nc" id="L2675">		} catch (SQLException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L2677">			e.printStackTrace();</span>
<span class="nc" id="L2678">		} catch (Exception e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L2680">			e.printStackTrace();</span>
		} finally {
<span class="nc" id="L2682">			try {</span>

<span class="nc" id="L2684">				System.out.println(&quot; closing connection  &quot;);</span>
<span class="nc bnc" id="L2685" title="All 8 branches missed.">				if (connection != null) {</span>
<span class="nc" id="L2686">					connection.close();</span>
				}
<span class="nc" id="L2688">			} catch (SQLException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L2690">				e.printStackTrace();</span>
<span class="nc" id="L2691">			}</span>

<span class="nc" id="L2693">		}</span>
<span class="nc" id="L2694">	}</span>

	public void createTextReportTempPlayerReceipt(String task_id,
			String viewerType, String root_path, String gameType) {
<span class="nc" id="L2698">		String receipt_type = null;</span>

<span class="nc" id="L2700">		connection = DBConnect.getConnection();</span>
<span class="nc" id="L2701">		Statement stmt = null;</span>
<span class="nc" id="L2702">		ResultSet rs = null;</span>
<span class="nc" id="L2703">		String query = null;</span>
<span class="nc" id="L2704">		String file = null;</span>
<span class="nc" id="L2705">		HashMap parameterMap = new HashMap();</span>
<span class="nc" id="L2706">		System.out</span>
				.println(&quot;heeeeeellllllllloooooooooo  createTextReportTempPlayerReceipt&quot;);
<span class="nc" id="L2708">		System.setProperty(&quot;java.awt.headless&quot;, &quot;true&quot;);</span>

<span class="nc" id="L2710">		String timeFormat = null;</span>
<span class="nc" id="L2711">		String currencySymbol = null;</span>
<span class="nc" id="L2712">		String dateFormat = null;</span>
<span class="nc" id="L2713">		String decimalFormat = null;</span>
<span class="nc" id="L2714">		String textForTax = null;</span>
<span class="nc" id="L2715">		String queryForPartyType = null;</span>
<span class="nc" id="L2716">		String queryForPlayer = null;</span>
<span class="nc" id="L2717">		String queryForAnonymous = null;</span>
<span class="nc" id="L2718">		String queryforAgtRet = null;</span>
<span class="nc" id="L2719">		String partType = null;</span>
<span class="nc" id="L2720">		int requestorsOrgId = 0;</span>
<span class="nc" id="L2721">		String addQuery = null;</span>
<span class="nc" id="L2722">		String approverName = null;</span>
<span class="nc" id="L2723">		String approverAdd = null;</span>
<span class="nc" id="L2724">		String requestid = task_id;</span>

		try {
<span class="nc" id="L2727">			timeFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TIME_FORMAT&quot;);
<span class="nc" id="L2729">			currencySymbol = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;CURRENCY_SYMBOL&quot;);
<span class="nc" id="L2731">			decimalFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;DECIMAL_FORMAT&quot;);
<span class="nc" id="L2733">			dateFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;date_format&quot;);
<span class="nc" id="L2735">			textForTax = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TEXT_FOR_TAX&quot;);
<span class="nc" id="L2737">			parameterMap.put(&quot;decimal_format&quot;, decimalFormat);</span>
<span class="nc" id="L2738">			parameterMap.put(&quot;timeFormat&quot;, timeFormat);</span>
<span class="nc" id="L2739">			parameterMap.put(&quot;currency_symbol&quot;, currencySymbol);</span>
<span class="nc" id="L2740">			parameterMap.put(&quot;dateFormat&quot;, dateFormat);</span>
<span class="nc" id="L2741">			parameterMap.put(&quot;textForTax&quot;, textForTax);</span>
<span class="nc" id="L2742">			parameterMap.put(&quot;viewerType&quot;, viewerType);</span>
<span class="nc bnc" id="L2743" title="All 2 branches missed.">			if (&quot;DRAW_GAME&quot;.equalsIgnoreCase(gameType)) {</span>
<span class="nc" id="L2744">				queryForPartyType = &quot;select party_type,requested_by_org_id ,name from st_dg_approval_req_master,st_lms_organization_master where request_id='&quot;</span>
						+ requestid
						+ &quot;' and requested_by_org_id=organization_id&quot;;
<span class="nc" id="L2747">				queryForPlayer = &quot;select party_type,party_id,request_id,ticket_nbr,pwt_amt,request_date,game_name,game_nbr ,concat(first_name,' ', last_name)as name ,addr_line1,addr_line2,city,photo_id_type,photo_id_nbr,draw_id from st_dg_approval_req_master sparm, st_se_game_master sgm,st_lms_player_master where request_id='&quot;</span>
						+ requestid
						+ &quot;' and sparm.game_id=sgm.game_id and player_id=party_id&quot;;
<span class="nc" id="L2750">				queryForAnonymous = &quot;select 'Anonymous' name,'' addr_line1,'' addr_line2,'' city,'' photo_id_type,'' photo_id_nbr,party_type,request_id,ticket_nbr,pwt_amt,request_date,game_name,game_nbr,draw_id from st_dg_approval_req_master sparm, st_se_game_master sgm where request_id='&quot;</span>
						+ requestid + &quot;'  and sparm.game_id=sgm.game_id&quot;;
<span class="nc" id="L2752">				queryforAgtRet = &quot;select party_type,party_id,request_id,ticket_nbr,pwt_amt,request_date,game_name,game_nbr ,name,addr_line1,addr_line2,city,draw_id from st_dg_approval_req_master sparm, st_se_game_master sgm,st_lms_organization_master where request_id='&quot;</span>
						+ requestid
						+ &quot;' and sparm.game_id=sgm.game_id and organization_id=party_id&quot;;

			} else {
<span class="nc" id="L2757">				queryForPartyType = &quot;select party_type,requested_by_org_id ,name from st_se_pwt_approval_request_master,st_lms_organization_master where task_id='&quot;</span>
						+ task_id + &quot;' and requested_by_org_id=organization_id&quot;;
<span class="nc" id="L2759">				queryForPlayer = &quot;select party_type,party_id,request_id,ticket_nbr,pwt_amt,request_date,game_name,game_nbr ,concat(first_name,' ', last_name)as name ,addr_line1,addr_line2,city,photo_id_type,photo_id_nbr from st_se_pwt_approval_request_master sparm, st_se_game_master sgm,st_lms_player_master where task_id='&quot;</span>
						+ task_id
						+ &quot;' and sparm.game_id=sgm.game_id and player_id=party_id;&quot;;
<span class="nc" id="L2762">				queryForAnonymous = &quot;select 'Anonymous' name,'' addr_line1,'' addr_line2,'' city,'' photo_id_type,'' photo_id_nbr,party_type,request_id,ticket_nbr,pwt_amt,request_date,game_name,game_nbr from st_se_pwt_approval_request_master sparm, st_se_game_master sgm where task_id='&quot;</span>
						+ task_id + &quot;'  and sparm.game_id=sgm.game_id&quot;;
<span class="nc" id="L2764">				queryforAgtRet = &quot;select party_type,party_id,request_id,ticket_nbr,pwt_amt,request_date,game_name,game_nbr ,name,addr_line1,addr_line2,city from st_se_pwt_approval_request_master sparm, st_se_game_master sgm,st_lms_organization_master where task_id='&quot;</span>
						+ task_id
						+ &quot;' and sparm.game_id=sgm.game_id and organization_id=party_id&quot;;
			}
<span class="nc" id="L2768">			stmt = connection.createStatement();</span>
<span class="nc" id="L2769">			rs = stmt.executeQuery(queryForPartyType);</span>
<span class="nc bnc" id="L2770" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L2771">				partType = rs.getString(&quot;party_type&quot;);</span>
<span class="nc" id="L2772">				requestorsOrgId = rs.getInt(&quot;requested_by_org_id&quot;);</span>
<span class="nc" id="L2773">				approverName = rs.getString(&quot;name&quot;);</span>

			}
<span class="nc" id="L2776">			LedgerHelper ledger = new LedgerHelper();</span>
<span class="nc" id="L2777">			addQuery = QueryManager.getST6AddressQuery();</span>
<span class="nc" id="L2778">			approverAdd = ledger.getAddress(addQuery, &quot;&quot; + requestorsOrgId,</span>
					null);
<span class="nc" id="L2780">			parameterMap.put(&quot;orgAdd&quot;, approverAdd);</span>
<span class="nc" id="L2781">			parameterMap.put(&quot;header&quot;, approverName);</span>

<span class="nc bnc" id="L2783" title="All 2 branches missed.">			if (partType.equalsIgnoreCase(&quot;PLAYER&quot;)) {</span>
<span class="nc" id="L2784">				query = queryForPlayer;</span>
<span class="nc bnc" id="L2785" title="All 2 branches missed.">			} else if (partType.equalsIgnoreCase(&quot;ANONYMOUS&quot;)) {</span>
<span class="nc" id="L2786">				query = queryForAnonymous;</span>

<span class="nc bnc" id="L2788" title="All 4 branches missed.">			} else if (partType.equalsIgnoreCase(&quot;AGENT&quot;)</span>
					|| partType.equalsIgnoreCase(&quot;RETAILER&quot;)) {
<span class="nc" id="L2790">				query = queryforAgtRet;</span>
			}

<span class="nc" id="L2793">			root_path = root_path.replace(&quot;\\&quot;, &quot;/&quot;);</span>
			// query=&quot;select
			// a.game_name,b.transaction_date,b.pwt_amt,ticket_nbr,game_name,game_nbr
			// from st_se_game_master a,st_se_direct_player_pwt_temp_receipt b
			// where a.game_id=&quot;+gameId +&quot; and
			// b.pwt_receipt_id='&quot;+receipt_id+&quot;'&quot;;
<span class="nc" id="L2799">			System.out.println(&quot;queryyyyyyyy createTextReportTempPlayerReceipt&quot;</span>
					+ query);

<span class="nc" id="L2802">			file = root_path</span>
					+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/DirectPlayerTempReceipt.jasper&quot;;
<span class="nc" id="L2804">			generateReport(query, file, parameterMap, null, null, null, null);</span>

<span class="nc" id="L2806">			System.out.println(&quot;Query -- &quot; + query);</span>
<span class="nc" id="L2807">		} catch (SQLException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L2809">			e.printStackTrace();</span>
<span class="nc" id="L2810">		} catch (Exception e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L2812">			e.printStackTrace();</span>
		} finally {
<span class="nc" id="L2814">			try {</span>

<span class="nc" id="L2816">				System.out.println(&quot; closing connection  &quot;);</span>
<span class="nc bnc" id="L2817" title="All 8 branches missed.">				if (connection != null) {</span>
<span class="nc" id="L2818">					connection.close();</span>
				}
<span class="nc" id="L2820">			} catch (SQLException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L2822">				e.printStackTrace();</span>
<span class="nc" id="L2823">			}</span>

<span class="nc" id="L2825">		}</span>
<span class="nc" id="L2826">	}</span>

	public List generateConsolidatedReport(String query, List consolidatedList,
			String agentName, Timestamp fromDate, Timestamp todate) {
<span class="nc" id="L2830">		DBConnect dbConnect = null;</span>
<span class="nc" id="L2831">		Connection connection = null;</span>
<span class="nc" id="L2832">		Timestamp date_entered = null;</span>
<span class="nc" id="L2833">		String tmp_receipt_id = null;</span>
<span class="nc" id="L2834">		String t_type = null;</span>
<span class="nc" id="L2835">		String tempType = null;</span>
<span class="nc" id="L2836">		int rowexists = 0;</span>
<span class="nc" id="L2837">		String type = null;</span>
<span class="nc" id="L2838">		double openingBalance = 0.0;</span>
<span class="nc" id="L2839">		double balance = 0.0;</span>
<span class="nc" id="L2840">		double amount = 0.0;</span>
<span class="nc" id="L2841">		String timeFormat = null;</span>
<span class="nc" id="L2842">		String currencySymbol = null;</span>
<span class="nc" id="L2843">		String decimalFormat = null;</span>
<span class="nc" id="L2844">		String dateFormat = null;</span>
<span class="nc" id="L2845">		String textForTax = null;</span>
<span class="nc" id="L2846">		Map&lt;String, List&lt;AgtLedAccDetailsBean&gt;&gt; AgentMap = new HashMap&lt;String, List&lt;AgtLedAccDetailsBean&gt;&gt;();</span>
<span class="nc" id="L2847">		Map&lt;String, Double&gt; accountMap = new HashMap&lt;String, Double&gt;();</span>
<span class="nc" id="L2848">		AgtLedAccDetailsBean accDetailsBean = null;</span>
<span class="nc" id="L2849">		List&lt;AgtLedAccDetailsBean&gt; ledAccBeanlist = new ArrayList&lt;AgtLedAccDetailsBean&gt;();</span>
<span class="nc" id="L2850">		double accbal = 0.0;</span>
<span class="nc" id="L2851">		String trParticulars = null;</span>

		try {
<span class="nc" id="L2854">			timeFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TIME_FORMAT&quot;);
<span class="nc" id="L2856">			currencySymbol = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;CURRENCY_SYMBOL&quot;);
<span class="nc" id="L2858">			decimalFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;DECIMAL_FORMAT&quot;);
<span class="nc" id="L2860">			textForTax = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TEXT_FOR_TAX&quot;);
<span class="nc" id="L2862">			consolidatedList.add(decimalFormat);// 5 7</span>
<span class="nc" id="L2863">			consolidatedList.add(timeFormat);// 6 8</span>
<span class="nc" id="L2864">			consolidatedList.add(currencySymbol);// 7 9</span>
<span class="nc" id="L2865">			consolidatedList.add(textForTax);// 8 10</span>

<span class="nc" id="L2867">			connection = DBConnect.getConnection();</span>
<span class="nc" id="L2868">			statement = connection.createStatement();</span>
<span class="nc" id="L2869">			resultSet2 = statement</span>
					.executeQuery(&quot;select transaction_type,receipt_id as transaction_id,account_type,balance,amount,transaction_date,transaction_with from st_lms_bo_ledger where account_type = (select organization_id from st_lms_organization_master where name = '&quot;
							+ agentName
							+ &quot;' ) and transaction_date &gt;= '&quot;
							+ fromDate
							+ &quot;' and transaction_date &lt;= '&quot;
							+ todate
							+ &quot;' limit 1&quot;);

<span class="nc bnc" id="L2878" title="All 2 branches missed.">			while (resultSet2.next()) {</span>
<span class="nc" id="L2879">				balance = resultSet2.getDouble(&quot;balance&quot;);</span>
<span class="nc" id="L2880">				amount = resultSet2.getDouble(&quot;amount&quot;);</span>

			}
<span class="nc" id="L2883">			openingBalance = balance - amount;</span>
<span class="nc" id="L2884">			consolidatedList.add(openingBalance);// 9 11</span>

<span class="nc" id="L2886">			System.out.println(&quot;openingBalance   _________-------&quot;</span>
					+ openingBalance);
<span class="nc" id="L2888">			resultSet2 = statement</span>
					.executeQuery(&quot;select transaction_type,receipt_id as transaction_id,account_type,balance,amount,transaction_date,transaction_with from st_lms_bo_ledger where account_type = (select organization_id from st_lms_organization_master where name = '&quot;
							+ agentName
							+ &quot;' ) and transaction_date &gt;= '&quot;
							+ fromDate
							+ &quot;' and transaction_date &lt;= '&quot;
							+ todate
							+ &quot;'&quot;);
<span class="nc bnc" id="L2896" title="All 2 branches missed.">			while (resultSet2.next()) {</span>

<span class="nc bnc" id="L2898" title="All 8 branches missed.">				if ((&quot;SALE_RET&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;))
						|| &quot;DG_REFUND_CANCEL&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)) || &quot;DG_REFUND_FAILED&quot;
						.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)) {
<span class="nc" id="L2905">					trParticulars = &quot;By Sales Return&quot;;</span>
<span class="nc bnc" id="L2906" title="All 6 branches missed.">				} else if ((&quot;SALE&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;)) || &quot;DG_SALE&quot;
						.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)) {
<span class="nc" id="L2911">					trParticulars = &quot;To Gross Sales&quot;;</span>
<span class="nc bnc" id="L2912" title="All 6 branches missed.">				} else if ((&quot;PWT_PLR&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;)) || &quot;DG_PWT_PLR&quot;
						.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)))
						&amp;&amp; &quot;PWT_PAY&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;account_type&quot;))) {
<span class="nc" id="L2918">					trParticulars = &quot;Player PWT&quot;;</span>
<span class="nc bnc" id="L2919" title="All 2 branches missed.">				} else if (&quot;PLAYER_CAS&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))) {
<span class="nc" id="L2921">					trParticulars = &quot;To Player Net&quot;;</span>
<span class="nc bnc" id="L2922" title="All 12 branches missed.">				} else if (&quot;CASH&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)
						|| &quot;CHEQUE&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)
						|| &quot;CR_NOTE_CASH&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)) {
<span class="nc" id="L2931">					trParticulars = &quot;By  Reciepts&quot;;</span>
<span class="nc bnc" id="L2932" title="All 8 branches missed.">				} else if ((&quot;CHQ_BOUNCE&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;))
						|| &quot;DR_NOTE_CASH&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)) || &quot;DR_NOTE&quot;
						.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)) {
<span class="nc" id="L2939">					trParticulars = &quot;To Reciept&quot;;</span>
<span class="nc bnc" id="L2940" title="All 10 branches missed.">				} else if (!resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)</span>
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;#&quot;)
						&amp;&amp; (&quot;PWT&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))
								|| &quot;PWT_AUTO&quot;.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)) || &quot;DG_PWT_AUTO&quot;
								.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)))) {
<span class="nc" id="L2948">					trParticulars = &quot;By PWT Collection&quot;;</span>
<span class="nc bnc" id="L2949" title="All 8 branches missed.">				} else if (resultSet2.getString(&quot;account_type&quot;).contains(&quot;#&quot;)</span>
						&amp;&amp; (&quot;PWT&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))
								|| &quot;PWT_AUTO&quot;.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)) || &quot;DG_PWT_AUTO&quot;
								.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)))) {
<span class="nc" id="L2956">					trParticulars = &quot;By Collection Charges&quot;;</span>
<span class="nc bnc" id="L2957" title="All 2 branches missed.">				} else if (&quot;GOVT_COMM&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))) {
<span class="nc" id="L2959">					trParticulars = &quot;To Govt Contribution&quot;;</span>
<span class="nc bnc" id="L2960" title="All 2 branches missed.">				} else if (&quot;VAT_PAY&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))) {
<span class="nc" id="L2962">					trParticulars = &quot;To VAT Contribution&quot;;</span>
<span class="nc bnc" id="L2963" title="All 4 branches missed.">				} else if (&quot;TDS_PAY&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))
						&amp;&amp; &quot;TDS&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))) {
<span class="nc" id="L2967">					trParticulars = &quot;To Deductions&quot;;</span>
<span class="nc bnc" id="L2968" title="All 6 branches missed.">				} else if (&quot;TDS_PAY&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))
						&amp;&amp; (&quot;PWT_PLR&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)) || &quot;DG_PWT_PLR&quot;
								.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)))) {
<span class="nc" id="L2974">					trParticulars = &quot;By Player Deduction&quot;;</span>
				}

<span class="nc bnc" id="L2977" title="All 2 branches missed.">				if (accountMap.containsKey(trParticulars)) {</span>

<span class="nc" id="L2979">					accbal = accountMap.get(trParticulars);</span>
<span class="nc" id="L2980">					accountMap.put(trParticulars, accbal</span>
							+ resultSet2.getDouble(&quot;amount&quot;));
				} else {
<span class="nc" id="L2983">					accountMap.put(trParticulars, resultSet2</span>
							.getDouble(&quot;amount&quot;));

				}
				/*
				 * for ledger details List
				 */
<span class="nc" id="L2990">				accDetailsBean = new AgtLedAccDetailsBean();</span>

<span class="nc" id="L2992">				accDetailsBean.setLedTransType(trParticulars);</span>
<span class="nc" id="L2993">				accDetailsBean.setTransactionID(resultSet2</span>
						.getString(&quot;transaction_id&quot;));
<span class="nc" id="L2995">				accDetailsBean.setAccBalance(resultSet2.getDouble(&quot;balance&quot;));</span>
<span class="nc" id="L2996">				accDetailsBean.setAmount(resultSet2.getDouble(&quot;amount&quot;));</span>
<span class="nc" id="L2997">				accDetailsBean.setTrDate(resultSet2</span>
						.getTimestamp(&quot;transaction_date&quot;));
<span class="nc" id="L2999">				accDetailsBean.setTransactionWith(resultSet2</span>
						.getString(&quot;transaction_with&quot;));
<span class="nc" id="L3001">				ledAccBeanlist.add(accDetailsBean);</span>

			}
<span class="nc" id="L3004">			TreeMap&lt;String, Map&lt;String, AgtLedAccDetailsBean&gt;&gt; dayWiseLedMap = getDayWiseLedMap(</span>
					agentName, fromDate, todate);

<span class="nc" id="L3007">			consolidatedList.add(accountMap);// 10 12</span>
<span class="nc" id="L3008">			consolidatedList.add(ledAccBeanlist);// detailed ledger 11 13</span>
<span class="nc" id="L3009">			consolidatedList.add(dayWiseLedMap);// day wise map 12 14</span>

<span class="nc" id="L3011">		} catch (Exception e) {</span>
<span class="nc" id="L3012">			e.printStackTrace();</span>
		} finally {
<span class="nc" id="L3014">			try {</span>

<span class="nc" id="L3016">				System.out.println(&quot; closing connection  &quot;);</span>
<span class="nc bnc" id="L3017" title="All 6 branches missed.">				if (connection != null) {</span>
<span class="nc" id="L3018">					connection.close();</span>
				}
<span class="nc" id="L3020">			} catch (SQLException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L3022">				e.printStackTrace();</span>
<span class="nc" id="L3023">			}</span>

<span class="nc" id="L3025">		}</span>

<span class="nc" id="L3027">		return consolidatedList;</span>
	}

	public List generateConsolidatedReportAgt(String query,
			List consolidatedList, String retName, Timestamp fromDate,
			Timestamp todate) {
<span class="nc" id="L3033">		DBConnect dbConnect = null;</span>
<span class="nc" id="L3034">		Connection connection = null;</span>
<span class="nc" id="L3035">		Timestamp date_entered = null;</span>
<span class="nc" id="L3036">		String tmp_receipt_id = null;</span>
<span class="nc" id="L3037">		String t_type = null;</span>
<span class="nc" id="L3038">		String tempType = null;</span>
<span class="nc" id="L3039">		int rowexists = 0;</span>
<span class="nc" id="L3040">		String type = null;</span>
<span class="nc" id="L3041">		double openingBalance = 0.0;</span>
<span class="nc" id="L3042">		double balance = 0.0;</span>
<span class="nc" id="L3043">		double amount = 0.0;</span>
<span class="nc" id="L3044">		String timeFormat = null;</span>
<span class="nc" id="L3045">		String currencySymbol = null;</span>
<span class="nc" id="L3046">		String decimalFormat = null;</span>
<span class="nc" id="L3047">		String dateFormat = null;</span>
<span class="nc" id="L3048">		String textForTax = null;</span>
<span class="nc" id="L3049">		Map&lt;String, List&lt;RetLedAccDetailsBean&gt;&gt; AgentMap = new HashMap&lt;String, List&lt;RetLedAccDetailsBean&gt;&gt;();</span>
<span class="nc" id="L3050">		Map&lt;String, Double&gt; accountMap = new HashMap&lt;String, Double&gt;();</span>
<span class="nc" id="L3051">		RetLedAccDetailsBean accDetailsBean = null;</span>
<span class="nc" id="L3052">		List&lt;RetLedAccDetailsBean&gt; ledAccBeanlist = new ArrayList&lt;RetLedAccDetailsBean&gt;();</span>
<span class="nc" id="L3053">		double accbal = 0.0;</span>
<span class="nc" id="L3054">		String trParticulars = null;</span>

		try {
<span class="nc" id="L3057">			timeFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TIME_FORMAT&quot;);
<span class="nc" id="L3059">			currencySymbol = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;CURRENCY_SYMBOL&quot;);
<span class="nc" id="L3061">			decimalFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;DECIMAL_FORMAT&quot;);
<span class="nc" id="L3063">			textForTax = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TEXT_FOR_TAX&quot;);
<span class="nc" id="L3065">			consolidatedList.add(decimalFormat);// 5 7</span>
<span class="nc" id="L3066">			consolidatedList.add(timeFormat);// 6 8</span>
<span class="nc" id="L3067">			consolidatedList.add(currencySymbol);// 7 9</span>
<span class="nc" id="L3068">			consolidatedList.add(textForTax);// 8 10</span>

<span class="nc" id="L3070">			connection = DBConnect.getConnection();</span>
<span class="nc" id="L3071">			statement = connection.createStatement();</span>
<span class="nc" id="L3072">			resultSet2 = statement</span>
					.executeQuery(&quot;select transaction_type,receipt_id as transaction_id,account_type,balance,amount,transaction_date,transaction_with from st_lms_agent_ledger where account_type = (select organization_id from st_lms_organization_master where name = '&quot;
							+ retName
							+ &quot;' ) and transaction_date &gt;= '&quot;
							+ fromDate
							+ &quot;' and transaction_date &lt;= '&quot;
							+ todate
							+ &quot;' limit 1&quot;);

<span class="nc bnc" id="L3081" title="All 2 branches missed.">			while (resultSet2.next()) {</span>
<span class="nc" id="L3082">				balance = resultSet2.getDouble(&quot;balance&quot;);</span>
<span class="nc" id="L3083">				amount = resultSet2.getDouble(&quot;amount&quot;);</span>

			}
<span class="nc" id="L3086">			openingBalance = balance - amount;</span>
<span class="nc" id="L3087">			consolidatedList.add(openingBalance);// 9 11</span>

<span class="nc" id="L3089">			System.out.println(&quot;openingBalance   _________-------&quot;</span>
					+ openingBalance);
<span class="nc" id="L3091">			resultSet2 = statement</span>
					.executeQuery(&quot;select transaction_type,receipt_id as transaction_id,account_type,balance,amount,transaction_date,transaction_with from st_lms_agent_ledger where account_type = (select organization_id from st_lms_organization_master where name = '&quot;
							+ retName
							+ &quot;' ) and transaction_date &gt;= '&quot;
							+ fromDate
							+ &quot;' and transaction_date &lt;= '&quot;
							+ todate
							+ &quot;'&quot;);
<span class="nc bnc" id="L3099" title="All 2 branches missed.">			while (resultSet2.next()) {</span>

<span class="nc bnc" id="L3101" title="All 8 branches missed.">				if ((&quot;SALE_RET&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;))
						|| &quot;DG_REFUND_CANCEL&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)) || &quot;DG_REFUND_FAILED&quot;
						.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)) {
<span class="nc" id="L3108">					trParticulars = &quot;By Sales Return&quot;;</span>
<span class="nc bnc" id="L3109" title="All 6 branches missed.">				} else if ((&quot;SALE&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;)) || &quot;DG_SALE&quot;
						.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)) {
<span class="nc" id="L3114">					trParticulars = &quot;To Gross Sales&quot;;</span>
<span class="nc bnc" id="L3115" title="All 2 branches missed.">				} else if (&quot;BO_SALE_ACC&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))) {
<span class="nc" id="L3117">					trParticulars = &quot;By  Gross Purchase&quot;;</span>
<span class="nc bnc" id="L3118" title="All 2 branches missed.">				} else if (&quot;BO_SALE_RET_ACC&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))) {
<span class="nc" id="L3120">					trParticulars = &quot;To Purchase Return&quot;;</span>
<span class="nc bnc" id="L3121" title="All 2 branches missed.">				} else if (&quot;BO_PWT_PAY&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))) {
<span class="nc" id="L3123">					trParticulars = &quot;To  PWT Recievable&quot;;</span>
<span class="nc bnc" id="L3124" title="All 12 branches missed.">				} else if (&quot;CASH&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)
						|| &quot;CHEQUE&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)
						|| &quot;CR_NOTE_CASH&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)) {
<span class="nc" id="L3133">					trParticulars = &quot;By  Reciepts&quot;;</span>
<span class="nc bnc" id="L3134" title="All 8 branches missed.">				} else if ((&quot;CHQ_BOUNCE&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;))
						|| &quot;DR_NOTE_CASH&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)) || &quot;DR_NOTE&quot;
						.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)) {
<span class="nc" id="L3141">					trParticulars = &quot;To Reciept&quot;;</span>
				}

<span class="nc bnc" id="L3144" title="All 12 branches missed.">				else if (resultSet2.getString(&quot;transaction_type&quot;)</span>
						.equalsIgnoreCase(&quot;BO_CASH&quot;)
						&amp;&amp; resultSet2.getString(&quot;account_type&quot;)
								.equalsIgnoreCase(&quot;BO_BANK_ACC&quot;)
						|| resultSet2.getString(&quot;transaction_type&quot;)
								.equalsIgnoreCase(&quot;BO_CHEQUE&quot;)
						&amp;&amp; resultSet2.getString(&quot;account_type&quot;)
								.equalsIgnoreCase(&quot;BO_BANK_ACC&quot;)
						|| resultSet2.getString(&quot;transaction_type&quot;)
								.equalsIgnoreCase(&quot;BO_CR_NOTE_CASH&quot;)
						&amp;&amp; resultSet2.getString(&quot;account_type&quot;)
								.equalsIgnoreCase(&quot;BO_BANK_ACC&quot;)) {
<span class="nc" id="L3156">					trParticulars = &quot;To Reciept&quot;;</span>
<span class="nc bnc" id="L3157" title="All 8 branches missed.">				} else if ((resultSet2.getString(&quot;transaction_type&quot;)</span>
						.equalsIgnoreCase(&quot;BO_CH_BOUN&quot;)
						|| resultSet2.getString(&quot;transaction_type&quot;)
								.equalsIgnoreCase(&quot;BO_DR_NOTE_CASH&quot;) || resultSet2
						.getString(&quot;transaction_type&quot;).equalsIgnoreCase(
								&quot;BO_DR_NOTE&quot;))
						&amp;&amp; resultSet2.getString(&quot;account_type&quot;)
								.equalsIgnoreCase(&quot;BO_BANK_ACC&quot;)) {
<span class="nc" id="L3165">					trParticulars = &quot;By Reciept&quot;;</span>
				}

<span class="nc bnc" id="L3168" title="All 10 branches missed.">				else if (resultSet2.getString(&quot;account_type&quot;).contains(&quot;#&quot;)</span>
						&amp;&amp; (&quot;PWT&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))
								|| &quot;PWT_AUTO&quot;.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;))
								|| &quot;DG_PWT&quot;.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)) || &quot;DG_PWT_AUTO&quot;
								.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)))) {
<span class="nc" id="L3177">					trParticulars = &quot;By Collection Charges&quot;;</span>
<span class="nc bnc" id="L3178" title="All 2 branches missed.">				} else if (&quot;BO_PWT_CHARGES&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))) {
<span class="nc" id="L3180">					trParticulars = &quot;To Collection Charges Recievable&quot;;</span>
<span class="nc bnc" id="L3181" title="All 12 branches missed.">				} else if (!resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)</span>
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;#&quot;)
						&amp;&amp; (&quot;PWT&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))
								|| &quot;PWT_AUTO&quot;.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;))
								|| &quot;DG_PWT&quot;.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)) || &quot;DG_PWT_AUTO&quot;
								.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)))) {
<span class="nc" id="L3191">					trParticulars = &quot;By PWT Collection&quot;;</span>
<span class="nc bnc" id="L3192" title="All 6 branches missed.">				} else if ((&quot;PWT_PLR&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;)) || &quot;DG_PWT_PLR&quot;
						.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)))
						&amp;&amp; &quot;AGNT_PWT_PAY&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;account_type&quot;))) {
<span class="nc" id="L3198">					trParticulars = &quot;Player PWT&quot;;</span>

<span class="nc bnc" id="L3200" title="All 2 branches missed.">				} else if (&quot;PLAYER_CAS&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))) {
<span class="nc" id="L3202">					trParticulars = &quot;To Player Net&quot;;</span>
<span class="nc bnc" id="L3203" title="All 4 branches missed.">				} else if (&quot;AGNT_TDS_PAY&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))
						&amp;&amp; &quot;PWT_PLR&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))) {
<span class="nc" id="L3207">					trParticulars = &quot;By Player Deduction&quot;;</span>
				}

<span class="nc bnc" id="L3210" title="All 2 branches missed.">				if (accountMap.containsKey(trParticulars)) {</span>

<span class="nc" id="L3212">					accbal = accountMap.get(trParticulars);</span>
<span class="nc" id="L3213">					accountMap.put(trParticulars, accbal</span>
							+ resultSet2.getDouble(&quot;amount&quot;));
				} else {
<span class="nc" id="L3216">					accountMap.put(trParticulars, resultSet2</span>
							.getDouble(&quot;amount&quot;));

				}
				/*
				 * for ledger details List
				 */
<span class="nc" id="L3223">				accDetailsBean = new RetLedAccDetailsBean();</span>

<span class="nc" id="L3225">				accDetailsBean.setLedTransType(trParticulars);</span>
<span class="nc" id="L3226">				accDetailsBean.setTransactionID(resultSet2</span>
						.getString(&quot;transaction_id&quot;));
<span class="nc" id="L3228">				accDetailsBean.setAccBalance(resultSet2.getDouble(&quot;balance&quot;));</span>
<span class="nc" id="L3229">				accDetailsBean.setAmount(resultSet2.getDouble(&quot;amount&quot;));</span>
<span class="nc" id="L3230">				accDetailsBean.setTrDate(resultSet2</span>
						.getTimestamp(&quot;transaction_date&quot;));
<span class="nc" id="L3232">				accDetailsBean.setTransactionWith(resultSet2</span>
						.getString(&quot;transaction_with&quot;));
<span class="nc" id="L3234">				ledAccBeanlist.add(accDetailsBean);</span>

			}
<span class="nc" id="L3237">			TreeMap&lt;String, Map&lt;String, RetLedAccDetailsBean&gt;&gt; dayWiseLedMap = getDayWiseLedAgtMap(</span>
					retName, fromDate, todate);

<span class="nc" id="L3240">			consolidatedList.add(accountMap);// 10 12</span>
<span class="nc" id="L3241">			consolidatedList.add(ledAccBeanlist);// detailed ledger 11 13</span>
<span class="nc" id="L3242">			consolidatedList.add(dayWiseLedMap);// day wise map 12 14</span>

<span class="nc" id="L3244">		} catch (Exception e) {</span>
<span class="nc" id="L3245">			e.printStackTrace();</span>
		} finally {
<span class="nc" id="L3247">			try {</span>

<span class="nc" id="L3249">				System.out.println(&quot; closing connection  &quot;);</span>
<span class="nc bnc" id="L3250" title="All 6 branches missed.">				if (connection != null) {</span>
<span class="nc" id="L3251">					connection.close();</span>
				}
<span class="nc" id="L3253">			} catch (SQLException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L3255">				e.printStackTrace();</span>
<span class="nc" id="L3256">			}</span>

<span class="nc" id="L3258">		}</span>

<span class="nc" id="L3260">		return consolidatedList;</span>
	}

	/**
	 * This method Genarates the PDF Report using Jasper Compiler
	 * 
	 * @param query
	 *            as String
	 * @param file
	 *            as String
	 * @param connection
	 *            as Connection
	 * @return Byte Array
	 * @throws SQLException
	 */

	public byte[] generateReport(String query, String file,
			Connection connection) throws SQLException {
<span class="nc" id="L3278">		String timeFormat = null;</span>
<span class="nc" id="L3279">		String currencySymbol = null;</span>
<span class="nc" id="L3280">		String dateFormat = null;</span>
<span class="nc" id="L3281">		String decimalFormat = null;</span>
<span class="nc" id="L3282">		String textForTax = null;</span>
<span class="nc" id="L3283">		HashMap parameterMap = new HashMap();</span>

		try {
<span class="nc" id="L3286">			timeFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TIME_FORMAT&quot;);
<span class="nc" id="L3288">			currencySymbol = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;CURRENCY_SYMBOL&quot;);
<span class="nc" id="L3290">			decimalFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;DECIMAL_FORMAT&quot;);
<span class="nc" id="L3292">			dateFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;date_format&quot;);
<span class="nc" id="L3294">			textForTax = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TEXT_FOR_TAX&quot;);
<span class="nc" id="L3296">			parameterMap.put(&quot;decimal_format&quot;, decimalFormat);</span>
<span class="nc" id="L3297">			parameterMap.put(&quot;timeFormat&quot;, timeFormat);</span>
<span class="nc" id="L3298">			parameterMap.put(&quot;currency_symbol&quot;, currencySymbol);</span>
<span class="nc" id="L3299">			parameterMap.put(&quot;dateFormat&quot;, dateFormat);</span>
<span class="nc" id="L3300">			parameterMap.put(&quot;textForTax&quot;, textForTax);</span>
<span class="nc" id="L3301">			statement = connection.createStatement();</span>
<span class="nc" id="L3302">			resultSet = statement.executeQuery(query);</span>

<span class="nc" id="L3304">			JRResultSetDataSource resultSetDataSource = new JRResultSetDataSource(</span>
					resultSet);
<span class="nc" id="L3306">			LedgerAction ledgerAction = new LedgerAction();</span>
<span class="nc" id="L3307">			System.out.println(&quot;received file&quot; + file);</span>
<span class="nc" id="L3308">			System.out</span>
					.println(&quot;heeeeeellllllllloooooooooo  generateReport33333333333&quot;);
<span class="nc" id="L3310">			System.setProperty(&quot;java.awt.headless&quot;, &quot;true&quot;);</span>
			// System.out.println(&quot;Compiling report...&quot;);
			// jasperReport = JasperCompileManager.compileReport(file);
<span class="nc" id="L3313">			System.out.println(&quot;Filling report...&quot;);</span>
<span class="nc" id="L3314">			jasperPrint = JasperFillManager.fillReport(file, new HashMap(),</span>
					resultSetDataSource);
<span class="nc" id="L3316">			System.out.println(&quot;Done!&quot;);</span>
<span class="nc" id="L3317">			System.out.println(&quot;received file&quot; + file);</span>
<span class="nc" id="L3318">			newfile = file.substring(file.lastIndexOf(&quot;/&quot;), file</span>
					.lastIndexOf(&quot;.&quot;));
<span class="nc" id="L3320">			System.out.println(&quot;Created File&quot; + newfile);</span>
<span class="nc" id="L3321">			bytes = JasperExportManager.exportReportToPdf(jasperPrint);</span>
<span class="nc" id="L3322">			System.out.println(&quot;generated########&quot; + bytes.length);</span>
<span class="nc" id="L3323">		} catch (JRException jr) {</span>

<span class="nc" id="L3325">		}</span>
<span class="nc" id="L3326">		return bytes;</span>
	}

	/**
	 * This method Genarates the PDF Report using Jasper Compiler
	 * 
	 * @param query
	 *            as String
	 * @param file
	 *            as String
	 * @return Byte Array
	 */
	public byte[] generateReport(String query, String file, HashMap parameterMap) {
<span class="nc" id="L3339">		String timeFormat = null;</span>
<span class="nc" id="L3340">		String currencySymbol = null;</span>
<span class="nc" id="L3341">		String dateFormat = null;</span>
<span class="nc" id="L3342">		String decimalFormat = null;</span>
<span class="nc" id="L3343">		String textForTax = null;</span>

		try {
<span class="nc" id="L3346">			timeFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TIME_FORMAT&quot;);
<span class="nc" id="L3348">			currencySymbol = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;CURRENCY_SYMBOL&quot;);
<span class="nc" id="L3350">			decimalFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;DECIMAL_FORMAT&quot;);
<span class="nc" id="L3352">			dateFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;date_format&quot;);
<span class="nc" id="L3354">			textForTax = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TEXT_FOR_TAX&quot;);
<span class="nc" id="L3356">			parameterMap.put(&quot;decimal_format&quot;, decimalFormat);</span>
<span class="nc" id="L3357">			parameterMap.put(&quot;timeFormat&quot;, timeFormat);</span>
<span class="nc" id="L3358">			parameterMap.put(&quot;currency_symbol&quot;, currencySymbol);</span>
<span class="nc" id="L3359">			parameterMap.put(&quot;dateFormat&quot;, dateFormat);</span>
<span class="nc" id="L3360">			parameterMap.put(&quot;textForTax&quot;, textForTax);</span>

<span class="nc" id="L3362">			connection = DBConnect.getConnection();</span>
<span class="nc" id="L3363">			statement = connection.createStatement();</span>
<span class="nc" id="L3364">			resultSet = statement.executeQuery(query);</span>

<span class="nc" id="L3366">			JRResultSetDataSource resultSetDataSource = new JRResultSetDataSource(</span>
					resultSet);
<span class="nc" id="L3368">			System.out</span>
					.println(&quot;heeeeeellllllllloooooooooo  generateReport2222222&quot;);
<span class="nc" id="L3370">			System.setProperty(&quot;java.awt.headless&quot;, &quot;true&quot;);</span>

			// System.out.println(&quot;Compiling report...&quot;);//commented earlier
			// jasperReport =
			// JasperCompileManager.compileReport(file);//commented earlier

<span class="nc" id="L3376">			System.out.println(&quot;Filling report...&quot; + parameterMap);</span>
<span class="nc" id="L3377">			jasperPrint = JasperFillManager.fillReport(file, parameterMap,</span>
					resultSetDataSource);
<span class="nc" id="L3379">			System.out.println(&quot;Done!&quot;);</span>
<span class="nc" id="L3380">			System.out.println(&quot;received file&quot; + file);</span>
<span class="nc" id="L3381">			newfile = file.substring(file.lastIndexOf(&quot;/&quot;), file</span>
					.lastIndexOf(&quot;.&quot;));
<span class="nc" id="L3383">			System.out.println(&quot;Created File&quot; + newfile);</span>
<span class="nc" id="L3384">			bytes = JasperExportManager.exportReportToPdf(jasperPrint);</span>
<span class="nc" id="L3385">			System.out.println(&quot;generated########&quot; + bytes.length);</span>
<span class="nc" id="L3386">		} catch (Exception e) {</span>
<span class="nc" id="L3387">			e.printStackTrace();</span>
		} finally {
<span class="nc" id="L3389">			try {</span>
<span class="nc bnc" id="L3390" title="All 6 branches missed.">				if (resultSet != null) {</span>
<span class="nc" id="L3391">					resultSet.close();</span>
				}
<span class="nc bnc" id="L3393" title="All 6 branches missed.">				if (statement != null) {</span>
<span class="nc" id="L3394">					statement.close();</span>
				}
<span class="nc bnc" id="L3396" title="All 12 branches missed.">				if (connection != null &amp;&amp; !connection.isClosed()) {</span>
<span class="nc" id="L3397">					connection.close();</span>
				}
<span class="nc" id="L3399">			} catch (SQLException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L3401">				e.printStackTrace();</span>
<span class="nc" id="L3402">			}</span>

<span class="nc" id="L3404">		}</span>
<span class="nc" id="L3405">		GraphReportAction reportAction = new GraphReportAction();</span>
<span class="nc" id="L3406">		reportAction.getPDFReport(bytes);</span>
<span class="nc" id="L3407">		return bytes;</span>
	}

	public byte[] generateReport(String query, String file,
			HashMap parameterMap, String TypeName, String receipt_id) {
<span class="nc" id="L3412">		DBConnect dbConnect = null;</span>
<span class="nc" id="L3413">		Connection connection = null;</span>
<span class="nc" id="L3414">		Timestamp date_entered = null;</span>
<span class="nc" id="L3415">		String tmp_receipt_id = null;</span>
<span class="nc" id="L3416">		String t_type = null;</span>
<span class="nc" id="L3417">		String tempType = null;</span>
<span class="nc" id="L3418">		int rowexists = 0;</span>
<span class="nc" id="L3419">		String type = null;</span>
<span class="nc" id="L3420">		String timeFormat = null;</span>
<span class="nc" id="L3421">		String currencySymbol = null;</span>
<span class="nc" id="L3422">		String dateFormat = null;</span>
<span class="nc" id="L3423">		String decimalFormat = null;</span>
<span class="nc" id="L3424">		String textForTax = null;</span>

		try {
<span class="nc" id="L3427">			timeFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TIME_FORMAT&quot;);
<span class="nc" id="L3429">			currencySymbol = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;CURRENCY_SYMBOL&quot;);
<span class="nc" id="L3431">			decimalFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;DECIMAL_FORMAT&quot;);
<span class="nc" id="L3433">			dateFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;date_format&quot;);
<span class="nc" id="L3435">			textForTax = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TEXT_FOR_TAX&quot;);
<span class="nc" id="L3437">			parameterMap.put(&quot;decimal_format&quot;, decimalFormat);</span>
<span class="nc" id="L3438">			parameterMap.put(&quot;timeFormat&quot;, timeFormat);</span>
<span class="nc" id="L3439">			parameterMap.put(&quot;currency_symbol&quot;, currencySymbol);</span>
<span class="nc" id="L3440">			parameterMap.put(&quot;dateFormat&quot;, dateFormat);</span>
<span class="nc" id="L3441">			parameterMap.put(&quot;textForTax&quot;, textForTax);</span>

<span class="nc" id="L3443">			connection = DBConnect.getConnection();</span>
<span class="nc" id="L3444">			statement2 = connection.prepareStatement(query);</span>
<span class="nc" id="L3445">			resultSet1 = statement2.executeQuery();</span>
			// System.out.println(&quot;type name &quot;+TypeName +&quot; &quot;+
			// TypeName.equalsIgnoreCase(&quot;DebitNote&quot;)+&quot;
			// &quot;+TypeName.equalsIgnoreCase(&quot;Receipt&quot;));

<span class="nc bnc" id="L3450" title="All 4 branches missed.">			if (TypeName != null &amp;&amp; TypeName.equalsIgnoreCase(&quot;Receipt&quot;)) {</span>
<span class="nc" id="L3451">				System.out.println(&quot;RRRRRRR111111&quot;);</span>
<span class="nc" id="L3452">				rowexists = resultSet1.findColumn(&quot;t_type&quot;);</span>

			}

<span class="nc bnc" id="L3456" title="All 4 branches missed.">			if (TypeName != null &amp;&amp; TypeName.equalsIgnoreCase(&quot;DebitNote&quot;)) {</span>
<span class="nc" id="L3457">				System.out.println(&quot;DDDDDD&quot;);</span>
<span class="nc" id="L3458">				rowexists = resultSet1.findColumn(&quot;transaction_type&quot;);</span>

			}
<span class="nc bnc" id="L3461" title="All 4 branches missed.">			if (TypeName != null &amp;&amp; TypeName.equalsIgnoreCase(&quot;GOVT_COMM&quot;)) {</span>
<span class="nc" id="L3462">				rowexists = resultSet1.findColumn(&quot;transaction_type&quot;);</span>
			}

<span class="nc" id="L3465">			System.out.println(resultSet1.isFirst() + &quot;   ##########  &quot;</span>
					+ rowexists);

<span class="nc bnc" id="L3468" title="All 2 branches missed.">			if (rowexists != 0) {</span>
<span class="nc bnc" id="L3469" title="All 2 branches missed.">				while (resultSet1.next()) {</span>

<span class="nc bnc" id="L3471" title="All 2 branches missed.">					if (TypeName.equalsIgnoreCase(&quot;receipt&quot;)) {</span>
<span class="nc" id="L3472">						t_type = resultSet1.getString(&quot;t_type&quot;);</span>
<span class="nc" id="L3473">						System.out.println(&quot;receipt &quot; + t_type);</span>
<span class="nc bnc" id="L3474" title="All 2 branches missed.">					} else if (TypeName.equalsIgnoreCase(&quot;DebitNote&quot;)) {</span>
<span class="nc" id="L3475">						tempType = resultSet1.getString(&quot;transaction_type&quot;);</span>
<span class="nc bnc" id="L3476" title="All 2 branches missed.">						if (tempType.equalsIgnoreCase(&quot;CHQ_BOUNCE&quot;)) {</span>
<span class="nc" id="L3477">							t_type = &quot;CHQ_BOUNCE&quot;;</span>
						}
<span class="nc" id="L3479">						System.out.println(&quot;Debit_Note &quot; + t_type);</span>
					}

<span class="nc" id="L3482">					System.out</span>
							.println(&quot;t_type    +++++++++++++++++  &quot; + t_type);

				}

<span class="nc bnc" id="L3487" title="All 2 branches missed.">				if (t_type.equalsIgnoreCase(&quot;pwt&quot;)) {</span>
<span class="nc" id="L3488">					query = &quot;select tmp_receipt_id,date_entered from st_se_tmp_pwt_receipt_mapping,st_se_tmp_pwt_receipt where final_receipt_id='&quot;</span>
							+ receipt_id + &quot;'and tmp_receipt_id=receipt_id&quot;;
<span class="nc" id="L3490">					System.out.println(&quot;pwt cheque ##### &quot; + query);</span>
<span class="nc" id="L3491">					statement = connection.createStatement();</span>
<span class="nc" id="L3492">					resultSet = statement.executeQuery(query);</span>

<span class="nc bnc" id="L3494" title="All 2 branches missed.">					while (resultSet.next()) {</span>
<span class="nc" id="L3495">						tmp_receipt_id = resultSet.getString(&quot;tmp_receipt_id&quot;);</span>
<span class="nc" id="L3496">						date_entered = resultSet.getTimestamp(&quot;date_entered&quot;);</span>
					}
<span class="nc" id="L3498">					parameterMap.put(&quot;tmp_receipt_id&quot;, tmp_receipt_id);</span>
<span class="nc" id="L3499">					parameterMap.put(&quot;date_entered&quot;, date_entered);</span>

<span class="nc bnc" id="L3501" title="All 2 branches missed.">				} else if (t_type.equalsIgnoreCase(&quot;cheque&quot;)) {</span>

<span class="nc" id="L3503">					query = &quot;select temp_receipt_id,cheque_receiving_date,receipt_id as id from st_lms_bo_cheque_temp_receipt sbctr,st_lms_bo_receipts_trn_mapping sbrtm where receipt_id='&quot;</span>
							+ receipt_id
							+ &quot;'and sbctr.transaction_id=sbrtm.transaction_id&quot;;
<span class="nc" id="L3506">					System.out.println(&quot;temp cheque ##### &quot; + query);</span>
<span class="nc" id="L3507">					statement = connection.createStatement();</span>
<span class="nc" id="L3508">					resultSet = statement.executeQuery(query);</span>

<span class="nc bnc" id="L3510" title="All 2 branches missed.">					while (resultSet.next()) {</span>
<span class="nc" id="L3511">						tmp_receipt_id = resultSet.getString(&quot;temp_receipt_id&quot;);</span>
<span class="nc" id="L3512">						date_entered = resultSet</span>
								.getTimestamp(&quot;cheque_receiving_date&quot;);
					}
<span class="nc" id="L3515">					parameterMap.put(&quot;tmp_receipt_id&quot;, tmp_receipt_id);</span>
<span class="nc" id="L3516">					parameterMap.put(&quot;date_entered&quot;, date_entered);</span>

<span class="nc bnc" id="L3518" title="All 2 branches missed.">					if (tmp_receipt_id != null) {</span>
<span class="nc" id="L3519">						file = file + &quot;ChequeReceiptNew.jasper&quot;;</span>
					} else {
<span class="nc" id="L3521">						file = file + &quot;ChequeReceipt.jasper&quot;;</span>
					}

				}

<span class="nc bnc" id="L3526" title="All 2 branches missed.">				else if (t_type.equalsIgnoreCase(&quot;CHQ_BOUNCE&quot;)) {</span>

<span class="nc" id="L3528">					query = &quot;select temp_receipt_id,cheque_receiving_date,receipt_id as id from st_lms_bo_cheque_temp_receipt sbctr,st_lms_bo_receipts_trn_mapping sbrtm where receipt_id='&quot;</span>
							+ receipt_id
							+ &quot;'and sbctr.transaction_id=sbrtm.transaction_id&quot;;
<span class="nc" id="L3531">					System.out.println(&quot;temp cheque ##### &quot; + query);</span>
<span class="nc" id="L3532">					statement = connection.createStatement();</span>
<span class="nc" id="L3533">					resultSet = statement.executeQuery(query);</span>

<span class="nc bnc" id="L3535" title="All 2 branches missed.">					while (resultSet.next()) {</span>
<span class="nc" id="L3536">						tmp_receipt_id = resultSet.getString(&quot;temp_receipt_id&quot;);</span>
<span class="nc" id="L3537">						date_entered = resultSet</span>
								.getTimestamp(&quot;cheque_receiving_date&quot;);
					}
<span class="nc" id="L3540">					parameterMap.put(&quot;tmp_receipt_id&quot;, tmp_receipt_id);</span>
<span class="nc" id="L3541">					parameterMap.put(&quot;date_entered&quot;, date_entered);</span>

<span class="nc bnc" id="L3543" title="All 2 branches missed.">					if (tmp_receipt_id != null) {</span>
<span class="nc" id="L3544">						file = file + &quot;DebitNoteTmpRcpt.jasper&quot;;</span>
					} else {
<span class="nc" id="L3546">						file = file + &quot;Debit_Note.jasper&quot;;</span>
					}

				}

			}

<span class="nc" id="L3553">			resultSet2 = statement2.executeQuery();</span>
<span class="nc" id="L3554">			JRResultSetDataSource resultSetDataSource = new JRResultSetDataSource(</span>
					resultSet2);
<span class="nc" id="L3556">			System.out</span>
					.println(&quot;heeeeeellllllllloooooooooo   generateReport11111111&quot;);
<span class="nc" id="L3558">			System.setProperty(&quot;java.awt.headless&quot;, &quot;true&quot;);</span>
<span class="nc" id="L3559">			System.out.println(&quot;vineet---- &quot; + file);</span>
<span class="nc" id="L3560">			File fileObj = new File(file);</span>
<span class="nc" id="L3561">			System.out.println(&quot;file is ========= &quot; + fileObj.exists());</span>

			// jasperReport =
			// JasperCompileManager.compileReport(file);//commented earlier
<span class="nc" id="L3565">			System.out</span>
					.println(&quot;Filling report...11111111111111111111111111111&quot;);

<span class="nc" id="L3568">			jasperPrint = JasperFillManager.fillReport(file, parameterMap,</span>
					resultSetDataSource);
<span class="nc" id="L3570">			System.out.println(&quot;Done!&quot;);</span>
<span class="nc" id="L3571">			System.out.println(&quot;received file&quot; + file);</span>

<span class="nc" id="L3573">			newfile = file.substring(file.lastIndexOf(&quot;/&quot;), file</span>
					.lastIndexOf(&quot;.&quot;));
<span class="nc" id="L3575">			System.out.println(&quot;Created File&quot; + newfile);</span>
<span class="nc" id="L3576">			bytes = JasperExportManager.exportReportToPdf(jasperPrint);</span>
<span class="nc" id="L3577">			System.out.println(&quot;generated########&quot; + bytes.length);</span>

<span class="nc" id="L3579">		} catch (Exception e) {</span>
<span class="nc" id="L3580">			e.printStackTrace();</span>
		} finally {
<span class="nc" id="L3582">			try {</span>

<span class="nc" id="L3584">				System.out.println(&quot; closing connection  &quot;);</span>
<span class="nc bnc" id="L3585" title="All 6 branches missed.">				if (connection != null) {</span>
<span class="nc" id="L3586">					connection.close();</span>
				}
<span class="nc" id="L3588">			} catch (SQLException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L3590">				e.printStackTrace();</span>
<span class="nc" id="L3591">			}</span>

<span class="nc" id="L3593">		}</span>
<span class="nc" id="L3594">		GraphReportAction reportAction = new GraphReportAction();</span>
<span class="nc" id="L3595">		reportAction.getPDFReport(bytes);</span>
<span class="nc" id="L3596">		return bytes;</span>
	}

	/**
	 * This method Genarates the PDF Report using Jasper Compiler
	 * 
	 * @param query
	 *            as String
	 * @param file
	 *            as String
	 * @param parameterMap
	 *            as HAshMap
	 * @return Byte Array
	 */

	public byte[] generateReport(String query, String file,
			HashMap parameterMap, String TypeName, Timestamp fromTimeStamp,
			Timestamp dt, String id) {
<span class="nc" id="L3614">		DBConnect dbConnect = null;</span>
<span class="nc" id="L3615">		Connection connection = null;</span>
<span class="nc" id="L3616">		Timestamp date_entered = null;</span>
<span class="nc" id="L3617">		String tmp_receipt_id = null;</span>
<span class="nc" id="L3618">		String t_type = null;</span>
<span class="nc" id="L3619">		String tempType = null;</span>
<span class="nc" id="L3620">		int rowexists = 0;</span>
<span class="nc" id="L3621">		String type = null;</span>
<span class="nc" id="L3622">		double openingBalance = 0.0;</span>
<span class="nc" id="L3623">		double balance = 0.0;</span>
<span class="nc" id="L3624">		double amount = 0.0;</span>
<span class="nc" id="L3625">		String timeFormat = null;</span>
<span class="nc" id="L3626">		String currencySymbol = null;</span>
<span class="nc" id="L3627">		String decimalFormat = null;</span>
<span class="nc" id="L3628">		String dateFormat = null;</span>
<span class="nc" id="L3629">		String textForTax = null;</span>
<span class="nc" id="L3630">		String tempQryForBal = query;</span>

		try {
<span class="nc" id="L3633">			timeFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TIME_FORMAT&quot;);
<span class="nc" id="L3635">			currencySymbol = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;CURRENCY_SYMBOL&quot;);
<span class="nc" id="L3637">			decimalFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;DECIMAL_FORMAT&quot;);
<span class="nc" id="L3639">			dateFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;date_format&quot;);
<span class="nc" id="L3641">			textForTax = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TEXT_FOR_TAX&quot;);
<span class="nc" id="L3643">			parameterMap.put(&quot;decimal_format&quot;, decimalFormat);</span>
<span class="nc" id="L3644">			parameterMap.put(&quot;timeFormat&quot;, timeFormat);</span>
<span class="nc" id="L3645">			parameterMap.put(&quot;currency_symbol&quot;, currencySymbol);</span>
<span class="nc" id="L3646">			parameterMap.put(&quot;dateFormat&quot;, dateFormat);</span>
<span class="nc" id="L3647">			parameterMap.put(&quot;textForTax&quot;, textForTax);</span>

<span class="nc" id="L3649">			connection = DBConnect.getConnection();</span>
<span class="nc" id="L3650">			statement2 = connection.prepareStatement(query);</span>

<span class="nc bnc" id="L3652" title="All 2 branches missed.">			if (TypeName != null) {</span>
<span class="nc" id="L3653">				tempQryForBal = tempQryForBal.replace(&quot;sum(amount)&quot;, &quot;&quot;);</span>
<span class="nc bnc" id="L3654" title="All 2 branches missed.">				if (tempQryForBal.indexOf(&quot;group&quot;) != -1)</span>
<span class="nc" id="L3655">					tempQryForBal = tempQryForBal.substring(0, tempQryForBal</span>
							.indexOf(&quot;group&quot;));
<span class="nc" id="L3657">				PreparedStatement fetchOpenBal = connection</span>
						.prepareStatement(tempQryForBal);
<span class="nc bnc" id="L3659" title="All 2 branches missed.">				if (id != null) {</span>
<span class="nc" id="L3660">					System.out.println(&quot;id and typename not null&quot;);</span>
<span class="nc" id="L3661">					fetchOpenBal.setString(1, TypeName);</span>
<span class="nc" id="L3662">					fetchOpenBal.setString(2, id);</span>
<span class="nc" id="L3663">					fetchOpenBal.setTimestamp(3, fromTimeStamp);</span>
<span class="nc" id="L3664">					fetchOpenBal.setTimestamp(4, dt);</span>

<span class="nc" id="L3666">					statement2.setString(1, TypeName);</span>
<span class="nc" id="L3667">					statement2.setString(2, id);</span>
<span class="nc" id="L3668">					statement2.setTimestamp(3, fromTimeStamp);</span>
<span class="nc" id="L3669">					statement2.setTimestamp(4, dt);</span>
<span class="nc" id="L3670">					System.out</span>
							.println(&quot;In GRH**Opening Balance Query*************** &quot;
									+ fetchOpenBal);

<span class="nc" id="L3674">					resultSet2 = fetchOpenBal.executeQuery();</span>

<span class="nc bnc" id="L3676" title="All 2 branches missed.">					if (resultSet2.next()) {</span>
<span class="nc" id="L3677">						balance = resultSet2.getDouble(&quot;balance&quot;);</span>
<span class="nc" id="L3678">						amount = resultSet2.getDouble(&quot;amount&quot;);</span>

					}
<span class="nc" id="L3681">					openingBalance = balance - amount;</span>
<span class="nc" id="L3682">					parameterMap.put(&quot;openingBalance&quot;, openingBalance);</span>
<span class="nc" id="L3683">					System.out</span>
							.println(&quot;In GRH**Opening Balance *********************&quot;
									+ openingBalance);

				}

				else {
<span class="nc" id="L3690">					System.out.println(&quot;id  is null and typename not null&quot;);</span>
<span class="nc" id="L3691">					fetchOpenBal.setString(1, TypeName);</span>
<span class="nc" id="L3692">					fetchOpenBal.setTimestamp(2, fromTimeStamp);</span>
<span class="nc" id="L3693">					fetchOpenBal.setTimestamp(3, dt);</span>

<span class="nc" id="L3695">					statement2.setString(1, TypeName);</span>
<span class="nc" id="L3696">					statement2.setTimestamp(2, fromTimeStamp);</span>
<span class="nc" id="L3697">					statement2.setTimestamp(3, dt);</span>
<span class="nc" id="L3698">					resultSet2 = fetchOpenBal.executeQuery();</span>
<span class="nc" id="L3699">					System.out</span>
							.println(&quot;In GRH**Opening Balance Query*************** &quot;
									+ fetchOpenBal);
<span class="nc bnc" id="L3702" title="All 2 branches missed.">					if (resultSet2.next()) {</span>
<span class="nc" id="L3703">						balance = resultSet2.getDouble(&quot;balance&quot;);</span>
<span class="nc" id="L3704">						amount = resultSet2.getDouble(&quot;amount&quot;);</span>

					}
<span class="nc" id="L3707">					openingBalance = balance - amount;</span>
<span class="nc" id="L3708">					parameterMap.put(&quot;openingBalance&quot;, openingBalance);</span>
<span class="nc" id="L3709">					System.out</span>
							.println(&quot;In GRH**Opening Balance *********************&quot;
									+ openingBalance);
				}

<span class="nc" id="L3714">			} else {</span>

<span class="nc bnc" id="L3716" title="All 2 branches missed.">				if (id != null) {</span>
<span class="nc" id="L3717">					System.out.println(&quot;id  not  null and typename  null&quot;);</span>
<span class="nc" id="L3718">					statement2.setTimestamp(1, fromTimeStamp);</span>
<span class="nc" id="L3719">					statement2.setTimestamp(2, dt);</span>
<span class="nc" id="L3720">					statement2.setString(3, id);</span>
<span class="nc" id="L3721">					System.out.println(&quot; id !=0 &quot; + statement2);</span>
				} else {
<span class="nc" id="L3723">					System.out.println(&quot;id   and typename  null&quot;);</span>
<span class="nc bnc" id="L3724" title="All 2 branches missed.">					if (fromTimeStamp != null) {</span>
<span class="nc" id="L3725">						statement2.setTimestamp(1, fromTimeStamp);</span>
<span class="nc bnc" id="L3726" title="All 2 branches missed.">						if (dt != null) {</span>
<span class="nc" id="L3727">							statement2.setTimestamp(2, dt);</span>
<span class="nc" id="L3728">							System.out.println(&quot;dt!=null &quot; + statement2);</span>
						}
					}
				}
			}

<span class="nc" id="L3734">			System.out.println(&quot;In GRH**&quot; + statement2.toString());</span>

<span class="nc" id="L3736">			LedgerAction ledgerAction = new LedgerAction();</span>
<span class="nc" id="L3737">			resultSet2 = statement2.executeQuery();</span>
<span class="nc" id="L3738">			JRResultSetDataSource resultSetDataSource = new JRResultSetDataSource(</span>
					resultSet2);
<span class="nc" id="L3740">			System.setProperty(&quot;java.awt.headless&quot;, &quot;true&quot;);</span>
<span class="nc" id="L3741">			System.out.println(&quot;In GRH**File***********&quot; + file);</span>

			// jasperReport = JasperCompileManager.compileReport(file);
			// //commented earlier
<span class="nc" id="L3745">			System.out.println(&quot;In GRH**Filling report******************&quot;);</span>

<span class="nc" id="L3747">			jasperPrint = JasperFillManager.fillReport(file, parameterMap,</span>
					resultSetDataSource);
<span class="nc" id="L3749">			System.out.println(&quot;Done!&quot;);</span>
<span class="nc" id="L3750">			System.out.println(&quot;received file&quot; + file);</span>
<span class="nc" id="L3751">			newfile = file.substring(file.lastIndexOf(&quot;/&quot;), file</span>
					.lastIndexOf(&quot;.&quot;));
<span class="nc" id="L3753">			System.out.println(&quot;Created File&quot; + newfile);</span>
<span class="nc" id="L3754">			bytes = JasperExportManager.exportReportToPdf(jasperPrint);</span>
<span class="nc" id="L3755">			System.out.println(&quot;generated########&quot; + bytes.length);</span>

<span class="nc" id="L3757">		} catch (Exception e) {</span>
<span class="nc" id="L3758">			e.printStackTrace();</span>
		} finally {
<span class="nc" id="L3760">			try {</span>

<span class="nc" id="L3762">				System.out.println(&quot; closing connection  &quot;);</span>
<span class="nc bnc" id="L3763" title="All 6 branches missed.">				if (connection != null) {</span>
<span class="nc" id="L3764">					connection.close();</span>
				}
<span class="nc" id="L3766">			} catch (SQLException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L3768">				e.printStackTrace();</span>
<span class="nc" id="L3769">			}</span>

<span class="nc" id="L3771">		}</span>
<span class="nc" id="L3772">		GraphReportAction reportAction = new GraphReportAction();</span>
<span class="nc" id="L3773">		reportAction.getPDFReport(bytes);</span>
<span class="nc" id="L3774">		return bytes;</span>
	}

	/*
	 * This method is for Temporary PWT Receipt
	 */
	public byte[] generateTempPWTReceipt(String receipt_id, String boOrgName,
			int userOrgID, String root_path, int agentOrgId)
			throws SQLException {

<span class="nc" id="L3784">		System.out.println(&quot;Inside  generateTempPWTReceipt&quot;);</span>

<span class="nc" id="L3786">		connection = DBConnect.getConnection();</span>
<span class="nc" id="L3787">		Statement stmt = null;</span>
<span class="nc" id="L3788">		stmt = connection.createStatement();</span>
<span class="nc" id="L3789">		ResultSet rs1 = null;</span>
<span class="nc" id="L3790">		String addr_line1 = null;</span>
<span class="nc" id="L3791">		String addr_line2 = null;</span>
<span class="nc" id="L3792">		String city = null;</span>
<span class="nc" id="L3793">		String name = null;</span>

<span class="nc" id="L3795">		rs1 = stmt</span>
				.executeQuery(&quot;select name,addr_line1,addr_line2,city,state_code,country_code from st_lms_organization_master som where som.organization_id ='&quot;
						+ agentOrgId + &quot;'&quot;);
		// System.out.println(&quot;Add Query &quot;+&quot;select
		// name,addr_line1,addr_line2,city,state_code,country_code from
		// st_lms_organization_master som,(select organization_id from
		// st_lms_user_master where user_id='&quot;+agentId+&quot;')stum where
		// stum.organization_id=som.organization_id&quot;);;
<span class="nc bnc" id="L3803" title="All 2 branches missed.">		while (rs1.next()) {</span>
<span class="nc" id="L3804">			name = rs1.getString(&quot;name&quot;);</span>
<span class="nc" id="L3805">			addr_line1 = rs1.getString(&quot;addr_line1&quot;);</span>
<span class="nc" id="L3806">			addr_line2 = rs1.getString(&quot;addr_line2&quot;);</span>
<span class="nc" id="L3807">			city = rs1.getString(&quot;city&quot;);</span>
<span class="nc" id="L3808">			System.out.println(name + addr_line1 + addr_line2 + city);</span>
		}
<span class="nc" id="L3810">		String query = null;</span>
<span class="nc" id="L3811">		String file = null;</span>

<span class="nc" id="L3813">		HashMap parameterMap = new HashMap();</span>

<span class="nc" id="L3815">		System.out</span>
				.println(&quot;======================= reciept_id : &quot; + receipt_id);
<span class="nc" id="L3817">		System.setProperty(&quot;java.awt.headless&quot;, &quot;true&quot;);</span>
<span class="nc" id="L3818">		String orgAdd = null;</span>
<span class="nc" id="L3819">		String addQuery = null;</span>
<span class="nc" id="L3820">		String vatNum = null;</span>
<span class="nc" id="L3821">		LedgerHelper ledger = new LedgerHelper();</span>
<span class="nc" id="L3822">		String timeFormat = null;</span>
<span class="nc" id="L3823">		String currencySymbol = null;</span>
<span class="nc" id="L3824">		String dateFormat = null;</span>
<span class="nc" id="L3825">		String decimalFormat = null;</span>
<span class="nc" id="L3826">		String textForTax = null;</span>

		try {
<span class="nc" id="L3829">			timeFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TIME_FORMAT&quot;);
<span class="nc" id="L3831">			currencySymbol = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;CURRENCY_SYMBOL&quot;);
<span class="nc" id="L3833">			decimalFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;DECIMAL_FORMAT&quot;);
<span class="nc" id="L3835">			dateFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;date_format&quot;);
<span class="nc" id="L3837">			textForTax = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TEXT_FOR_TAX&quot;);
<span class="nc" id="L3839">			parameterMap.put(&quot;decimal_format&quot;, decimalFormat);</span>
<span class="nc" id="L3840">			parameterMap.put(&quot;timeFormat&quot;, timeFormat);</span>
<span class="nc" id="L3841">			parameterMap.put(&quot;currency_symbol&quot;, currencySymbol);</span>
<span class="nc" id="L3842">			parameterMap.put(&quot;dateFormat&quot;, dateFormat);</span>
<span class="nc" id="L3843">			parameterMap.put(&quot;textForTax&quot;, textForTax);</span>
<span class="nc" id="L3844">			addQuery = QueryManager.getST6AddressQuery();</span>
<span class="nc" id="L3845">			orgAdd = ledger.getAddress(addQuery, &quot;&quot; + userOrgID, null);</span>
<span class="nc" id="L3846">			parameterMap.put(&quot;orgAdd&quot;, orgAdd);</span>
<span class="nc" id="L3847">			parameterMap.put(&quot;header&quot;, boOrgName);</span>
<span class="nc" id="L3848">			parameterMap.put(&quot;addr_line1&quot;, addr_line1);</span>
<span class="nc" id="L3849">			parameterMap.put(&quot;addr_line2&quot;, addr_line2);</span>
<span class="nc" id="L3850">			parameterMap.put(&quot;city&quot;, city);</span>
<span class="nc" id="L3851">			parameterMap.put(&quot;name&quot;, name);</span>
<span class="nc" id="L3852">			parameterMap.put(&quot;name&quot;, name);</span>
<span class="nc" id="L3853">			parameterMap.put(&quot;receipt_id&quot;, receipt_id);</span>

<span class="nc" id="L3855">			statement = connection.createStatement();</span>
<span class="nc" id="L3856">			query = &quot;select game_name,no_of_tickets,prize_amt,date_entered from st_se_game_master sgm,st_se_tmp_pwt_receipt_detail stpr,st_se_tmp_pwt_receipt stp where stpr.receipt_id='&quot;</span>
					+ receipt_id
					+ &quot;'  and sgm.game_id=stpr.game_id  and stpr.receipt_id=stp.receipt_id order by game_name,prize_amt&quot;;

<span class="nc" id="L3860">			System.out.println(&quot;qqqqqqqqqqq &quot; + query);</span>
<span class="nc" id="L3861">			resultSet = statement.executeQuery(query);</span>

<span class="nc" id="L3863">			JRResultSetDataSource resultSetDataSource = new JRResultSetDataSource(</span>
					resultSet);

<span class="nc" id="L3866">			root_path = root_path.replace(&quot;\\&quot;, &quot;/&quot;);</span>
<span class="nc" id="L3867">			file = root_path</span>
					+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/TempPWTReceipt.jasper&quot;;
			// file=&quot;C:/Documents and
			// Settings/USER12/workspace/LMS_DELIVERY/WebRoot/com/skilrock/lms/web/reportsMgmt/rawReports/TempPWTReceipt.jasper&quot;;
<span class="nc" id="L3871">			System.out.println(&quot;received file&quot; + file);</span>
<span class="nc" id="L3872">			System.out</span>
					.println(&quot;heeeeeellllllllloooooooooo  generateReport33333333333&quot;);
<span class="nc" id="L3874">			System.setProperty(&quot;java.awt.headless&quot;, &quot;true&quot;);</span>
			// System.out.println(&quot;Compiling report...&quot;);
			// jasperReport = JasperCompileManager.compileReport(file);
<span class="nc" id="L3877">			System.out.println(&quot;Filling report...&quot;);</span>
			// System.out.println(jasperReport.getName());
			// System.out.println(jasperReport.getDatasets());
<span class="nc" id="L3880">			jasperPrint = JasperFillManager.fillReport(file, parameterMap,</span>
					resultSetDataSource);
<span class="nc" id="L3882">			System.out.println(&quot;Done!&quot;);</span>
<span class="nc" id="L3883">			System.out.println(&quot;received file&quot; + file);</span>
<span class="nc" id="L3884">			newfile = file.substring(file.lastIndexOf(&quot;/&quot;), file</span>
					.lastIndexOf(&quot;.&quot;));
<span class="nc" id="L3886">			System.out.println(&quot;Created File&quot; + newfile);</span>
<span class="nc" id="L3887">			bytes = JasperExportManager.exportReportToPdf(jasperPrint);</span>
			// JasperExportManager.exportReportToPdfFile(jasperPrint,&quot;C:/pp.pdf&quot;
			// );
<span class="nc" id="L3890">			System.out.println(&quot;generated########&quot; + bytes.length);</span>
<span class="nc" id="L3891">		} catch (JRException jr) {</span>
<span class="nc" id="L3892">			jr.printStackTrace();</span>
<span class="nc" id="L3893">		} catch (Exception e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L3895">			e.printStackTrace();</span>
		} finally {
<span class="nc" id="L3897">			try {</span>

<span class="nc" id="L3899">				System.out.println(&quot; closing connection  &quot;);</span>
<span class="nc bnc" id="L3900" title="All 8 branches missed.">				if (connection != null) {</span>
<span class="nc" id="L3901">					connection.close();</span>
				}
<span class="nc" id="L3903">			} catch (SQLException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L3905">				e.printStackTrace();</span>
<span class="nc" id="L3906">			}</span>

<span class="nc" id="L3908">		}</span>
<span class="nc" id="L3909">		GraphReportAction reportAction = new GraphReportAction();</span>
<span class="nc" id="L3910">		System.out.println(&quot;generated*************&quot; + bytes.length);</span>
<span class="nc" id="L3911">		reportAction.getPDFReport(bytes);</span>
<span class="nc" id="L3912">		return bytes;</span>

	}

	public String getAddress(String query) {
<span class="nc" id="L3917">		Connection connection = null;</span>

<span class="nc" id="L3919">		String add1 = null;</span>
<span class="nc" id="L3920">		String add2 = null;</span>
<span class="nc" id="L3921">		String add3 = null;</span>

		try {
<span class="nc" id="L3924">			connection = DBConnect.getConnection();</span>
<span class="nc" id="L3925">			Statement stmt = null;</span>
<span class="nc" id="L3926">			stmt = connection.createStatement();</span>
<span class="nc" id="L3927">			ResultSet rs1 = null;</span>
<span class="nc" id="L3928">			rs1 = stmt.executeQuery(query);</span>
<span class="nc bnc" id="L3929" title="All 2 branches missed.">			while (rs1.next()) {</span>

<span class="nc" id="L3931">				add1 = rs1.getString(&quot;addr_line1&quot;);</span>
<span class="nc" id="L3932">				add2 = rs1.getString(&quot;addr_line2&quot;);</span>
<span class="nc" id="L3933">				add3 = rs1.getString(&quot;city&quot;);</span>
			}

<span class="nc" id="L3936">		} catch (SQLException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L3938">			e.printStackTrace();</span>
		} finally {
<span class="nc" id="L3940">			try {</span>

<span class="nc" id="L3942">				System.out.println(&quot; closing connection  &quot;);</span>
<span class="nc bnc" id="L3943" title="All 6 branches missed.">				if (connection != null) {</span>
<span class="nc" id="L3944">					connection.close();</span>
				}
<span class="nc" id="L3946">			} catch (SQLException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L3948">				e.printStackTrace();</span>
<span class="nc" id="L3949">			}</span>

<span class="nc" id="L3951">		}</span>
<span class="nc" id="L3952">		return add1 + &quot; &quot; + add2 + &quot; &quot; + add3;</span>
	}

	public byte[] getBytes() {
<span class="nc" id="L3956">		return bytes;</span>
	}

	public Map&lt;String, RetLedAccDetailsBean&gt; getDayWiseAgtLeder(String retName,
			String fromDate, String todate) {
<span class="nc" id="L3961">		Map&lt;String, RetLedAccDetailsBean&gt; ledDayMap = new HashMap&lt;String, RetLedAccDetailsBean&gt;();</span>
<span class="nc" id="L3962">		String trParticulars = null;</span>
<span class="nc" id="L3963">		String trDate = null;</span>
<span class="nc" id="L3964">		double accbal = 0.0;</span>
<span class="nc" id="L3965">		RetLedAccDetailsBean retLedAccDetailsBean = null;</span>
<span class="nc" id="L3966">		SimpleDateFormat dateFormat = new SimpleDateFormat(&quot;dd-MM-yyyy&quot;);</span>
<span class="nc" id="L3967">		SimpleDateFormat dateDB = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span>
		try {
<span class="nc" id="L3969">			resultSet2 = statement</span>
					.executeQuery(&quot;select transaction_type,receipt_id as transaction_id,account_type,balance,amount,transaction_date,transaction_with from st_lms_agent_ledger where account_type = (select organization_id from st_lms_organization_master where name = '&quot;
							+ retName
							+ &quot;' ) and transaction_date &gt;= '&quot;
							+ fromDate
							+ &quot;' and transaction_date &lt;= '&quot;
							+ todate
							+ &quot;'&quot;);

<span class="nc" id="L3978">			System.out</span>
					.println(&quot;Queryyyy   &quot;
							+ &quot;select transaction_type,receipt_id as transaction_id,account_type,balance,amount,transaction_date,transaction_with from st_lms_agent_ledger where account_type = (select organization_id from st_lms_organization_master where name = '&quot;
							+ retName + &quot;' ) and transaction_date &gt;= '&quot;
							+ fromDate + &quot;' and transaction_date &lt;= '&quot; + todate
							+ &quot;'&quot;);
<span class="nc bnc" id="L3984" title="All 2 branches missed.">			while (resultSet2.next()) {</span>

<span class="nc bnc" id="L3986" title="All 8 branches missed.">				if ((&quot;SALE_RET&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;))
						|| &quot;DG_REFUND_FAILED&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)) || &quot;DG_REFUND_CANCEL&quot;
						.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)) {
<span class="nc" id="L3993">					trParticulars = &quot;By Sales Return&quot;;</span>
<span class="nc bnc" id="L3994" title="All 6 branches missed.">				} else if ((&quot;SALE&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;)) || &quot;DG_SALE&quot;
						.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)) {
<span class="nc" id="L3999">					trParticulars = &quot;To Gross Sales&quot;;</span>
<span class="nc bnc" id="L4000" title="All 2 branches missed.">				} else if (&quot;BO_SALE_ACC&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))) {
<span class="nc" id="L4002">					trParticulars = &quot;By  Gross Purchase&quot;;</span>
<span class="nc bnc" id="L4003" title="All 2 branches missed.">				} else if (&quot;BO_SALE_RET_ACC&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))) {
<span class="nc" id="L4005">					trParticulars = &quot;To Purchase Return&quot;;</span>
<span class="nc bnc" id="L4006" title="All 2 branches missed.">				} else if (&quot;BO_PWT_PAY&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))) {
<span class="nc" id="L4008">					trParticulars = &quot;To  PWT Recievable&quot;;</span>
<span class="nc bnc" id="L4009" title="All 12 branches missed.">				} else if (&quot;CASH&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)
						|| &quot;CHEQUE&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)
						|| &quot;CR_NOTE_CASH&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)) {
<span class="nc" id="L4018">					trParticulars = &quot;By  Reciepts&quot;;</span>
<span class="nc bnc" id="L4019" title="All 8 branches missed.">				} else if ((&quot;CHQ_BOUNCE&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;))
						|| &quot;DR_NOTE_CASH&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)) || &quot;DR_NOTE&quot;
						.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)) {
<span class="nc" id="L4026">					trParticulars = &quot;To Reciept&quot;;</span>
				}

<span class="nc bnc" id="L4029" title="All 12 branches missed.">				else if (resultSet2.getString(&quot;transaction_type&quot;)</span>
						.equalsIgnoreCase(&quot;BO_CASH&quot;)
						&amp;&amp; resultSet2.getString(&quot;account_type&quot;)
								.equalsIgnoreCase(&quot;BO_BANK_ACC&quot;)
						|| resultSet2.getString(&quot;transaction_type&quot;)
								.equalsIgnoreCase(&quot;BO_CHEQUE&quot;)
						&amp;&amp; resultSet2.getString(&quot;account_type&quot;)
								.equalsIgnoreCase(&quot;BO_BANK_ACC&quot;)
						|| resultSet2.getString(&quot;transaction_type&quot;)
								.equalsIgnoreCase(&quot;BO_CR_NOTE_CASH&quot;)
						&amp;&amp; resultSet2.getString(&quot;account_type&quot;)
								.equalsIgnoreCase(&quot;BO_BANK_ACC&quot;)) {
<span class="nc" id="L4041">					trParticulars = &quot;To Reciept&quot;;</span>
<span class="nc bnc" id="L4042" title="All 8 branches missed.">				} else if ((resultSet2.getString(&quot;transaction_type&quot;)</span>
						.equalsIgnoreCase(&quot;BO_CH_BOUN&quot;)
						|| resultSet2.getString(&quot;transaction_type&quot;)
								.equalsIgnoreCase(&quot;BO_DR_NOTE_CASH&quot;) || resultSet2
						.getString(&quot;transaction_type&quot;).equalsIgnoreCase(
								&quot;BO_DR_NOTE&quot;))
						&amp;&amp; resultSet2.getString(&quot;account_type&quot;)
								.equalsIgnoreCase(&quot;BO_BANK_ACC&quot;)) {
<span class="nc" id="L4050">					trParticulars = &quot;By Reciept&quot;;</span>
				}

<span class="nc bnc" id="L4053" title="All 10 branches missed.">				else if (resultSet2.getString(&quot;account_type&quot;).contains(&quot;#&quot;)</span>
						&amp;&amp; (&quot;PWT&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))
								|| &quot;PWT_AUTO&quot;.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;))
								|| &quot;DG_PWT&quot;.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)) || &quot;DG_PWT_AUTO&quot;
								.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)))) {
<span class="nc" id="L4062">					trParticulars = &quot;By Collection Charges&quot;;</span>
<span class="nc bnc" id="L4063" title="All 2 branches missed.">				} else if (&quot;BO_PWT_CHARGES&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))) {
<span class="nc" id="L4065">					trParticulars = &quot;To Collection Charges Recievable&quot;;</span>
<span class="nc bnc" id="L4066" title="All 12 branches missed.">				} else if (!resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)</span>
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;#&quot;)
						&amp;&amp; (&quot;PWT&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))
								|| &quot;PWT_AUTO&quot;.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;))
								|| &quot;DG_PWT&quot;.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)) || &quot;DG_PWT_AUTO&quot;
								.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)))) {
<span class="nc" id="L4076">					trParticulars = &quot;By PWT Collection&quot;;</span>
<span class="nc bnc" id="L4077" title="All 6 branches missed.">				} else if ((&quot;PWT_PLR&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;)) || &quot;DG_PWT_PLR&quot;
						.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)))
						&amp;&amp; &quot;AGNT_PWT_PAY&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;account_type&quot;))) {
<span class="nc" id="L4083">					trParticulars = &quot;Player PWT&quot;;</span>

<span class="nc bnc" id="L4085" title="All 2 branches missed.">				} else if (&quot;PLAYER_CAS&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))) {
<span class="nc" id="L4087">					trParticulars = &quot;To Player Net&quot;;</span>
<span class="nc bnc" id="L4088" title="All 6 branches missed.">				} else if (&quot;AGNT_TDS_PAY&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))
						&amp;&amp; (&quot;PWT_PLR&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)) || &quot;DG_PWT_PLR&quot;
								.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)))) {
<span class="nc" id="L4094">					trParticulars = &quot;By Player Deduction&quot;;</span>
				}

<span class="nc" id="L4097">				System.out.println(&quot; trParticulars ===== &quot; + trParticulars);</span>

<span class="nc bnc" id="L4099" title="All 2 branches missed.">				if (ledDayMap.containsKey(trParticulars)) {</span>

<span class="nc" id="L4101">					retLedAccDetailsBean = ledDayMap.get(trParticulars);</span>

<span class="nc" id="L4103">					retLedAccDetailsBean.setLedTransType(trParticulars);</span>
<span class="nc" id="L4104">					retLedAccDetailsBean.setAccBalance(resultSet2</span>
							.getDouble(&quot;balance&quot;));
<span class="nc" id="L4106">					retLedAccDetailsBean.setAmount(retLedAccDetailsBean</span>
							.getAmount()
							+ resultSet2.getDouble(&quot;amount&quot;));
<span class="nc" id="L4109">					retLedAccDetailsBean.setTrDateStr(dateFormat.format(dateDB</span>
							.parse(fromDate)));
<span class="nc" id="L4111">					ledDayMap.put(trParticulars, retLedAccDetailsBean);</span>
<span class="nc" id="L4112">					System.out.println(&quot;Les day Map ===== &quot; + ledDayMap);</span>

				} else {
<span class="nc" id="L4115">					retLedAccDetailsBean = new RetLedAccDetailsBean();</span>
<span class="nc" id="L4116">					System.out.println(&quot;======trParticulars===== &quot;</span>
							+ trParticulars + &quot; ======== &quot; + fromDate);
<span class="nc" id="L4118">					retLedAccDetailsBean.setLedTransType(trParticulars);</span>
<span class="nc" id="L4119">					retLedAccDetailsBean.setAccBalance(resultSet2</span>
							.getDouble(&quot;balance&quot;));
<span class="nc" id="L4121">					retLedAccDetailsBean.setAmount(resultSet2</span>
							.getDouble(&quot;amount&quot;));
<span class="nc" id="L4123">					retLedAccDetailsBean.setTrDateStr(dateFormat.format(dateDB</span>
							.parse(fromDate)));
<span class="nc" id="L4125">					ledDayMap.put(trParticulars, retLedAccDetailsBean);</span>

				}

			}
<span class="nc" id="L4130">		} catch (SQLException e) {</span>
<span class="nc" id="L4131">			e.printStackTrace();</span>
<span class="nc" id="L4132">		} catch (ParseException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L4134">			e.printStackTrace();</span>
<span class="nc" id="L4135">		}</span>
<span class="nc" id="L4136">		System.out.println(&quot;=======================  &quot; + ledDayMap);</span>
<span class="nc" id="L4137">		return ledDayMap;</span>
	}

	public TreeMap&lt;String, Map&lt;String, RetLedAccDetailsBean&gt;&gt; getDayWiseLedAgtMap(
			String retName, Timestamp fromDate, Timestamp todate) {
<span class="nc" id="L4142">		List frTimeList = new ArrayList();</span>
<span class="nc" id="L4143">		List toTimeList = new ArrayList();</span>
<span class="nc" id="L4144">		Calendar from = Calendar.getInstance();</span>
<span class="nc" id="L4145">		Calendar to = Calendar.getInstance();</span>
<span class="nc" id="L4146">		from.setTimeInMillis(fromDate.getTime());</span>
<span class="nc" id="L4147">		to.setTimeInMillis(todate.getTime());</span>
<span class="nc" id="L4148">		Map&lt;String, RetLedAccDetailsBean&gt; ledDayMap = null;</span>
<span class="nc" id="L4149">		SimpleDateFormat format = new SimpleDateFormat(&quot;dd-MM-yyyy&quot;);</span>
<span class="nc" id="L4150">		SimpleDateFormat formatDB = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span>
<span class="nc" id="L4151">		String dateString = null;</span>
<span class="nc" id="L4152">		String frDtString = null;</span>
<span class="nc" id="L4153">		String toDtString = null;</span>

<span class="nc bnc" id="L4155" title="All 2 branches missed.">		while (from.before(to)) {</span>
<span class="nc" id="L4156">			frTimeList.add(from.getTime());</span>
<span class="nc" id="L4157">			from.add(Calendar.DATE, 1);</span>
<span class="nc" id="L4158">			toTimeList.add(from.getTime());</span>
		}
<span class="nc" id="L4160">		System.out.println(&quot;frTimeList &quot; + frTimeList);</span>
<span class="nc" id="L4161">		System.out.println(&quot;toTimeList &quot; + toTimeList);</span>
<span class="nc" id="L4162">		TreeMap&lt;String, Map&lt;String, RetLedAccDetailsBean&gt;&gt; ledDayWiseMap = new TreeMap&lt;String, Map&lt;String, RetLedAccDetailsBean&gt;&gt;();</span>
<span class="nc" id="L4163">		System.out.println(&quot;fomr date ####### &quot;</span>
				+ formatDB.format((Date) frTimeList.get(0)));
<span class="nc" id="L4165">		System.out.println(&quot;To   date ####### &quot;</span>
				+ formatDB.format((Date) toTimeList.get(0)));
<span class="nc bnc" id="L4167" title="All 2 branches missed.">		for (int i = 0; i &lt; frTimeList.size(); i++) {</span>
<span class="nc" id="L4168">			frDtString = formatDB.format((Date) frTimeList.get(i));</span>
<span class="nc" id="L4169">			toDtString = formatDB.format((Date) toTimeList.get(i));</span>
<span class="nc" id="L4170">			ledDayMap = getDayWiseAgtLeder(retName, frDtString, toDtString);</span>
<span class="nc" id="L4171">			dateString = format.format((Date) frTimeList.get(i));</span>
<span class="nc bnc" id="L4172" title="All 2 branches missed.">			if (ledDayMap.size() &gt; 0) {</span>
<span class="nc" id="L4173">				ledDayWiseMap.put(dateString, ledDayMap);</span>
			}
		}

<span class="nc" id="L4177">		System.out.println(&quot;DAYWISE MAP &quot; + ledDayWiseMap.size());</span>
<span class="nc" id="L4178">		return ledDayWiseMap;</span>

	}

	public Map&lt;String, AgtLedAccDetailsBean&gt; getDayWiseLeder(String agentName,
			String fromDate, String todate) {
<span class="nc" id="L4184">		Map&lt;String, AgtLedAccDetailsBean&gt; ledDayMap = new HashMap&lt;String, AgtLedAccDetailsBean&gt;();</span>
<span class="nc" id="L4185">		String trParticulars = null;</span>
<span class="nc" id="L4186">		String trDate = null;</span>
<span class="nc" id="L4187">		double accbal = 0.0;</span>
<span class="nc" id="L4188">		AgtLedAccDetailsBean agtLedAccDetailsBean = null;</span>
<span class="nc" id="L4189">		SimpleDateFormat dateFormat = new SimpleDateFormat(&quot;dd-MM-yyyy&quot;);</span>
<span class="nc" id="L4190">		SimpleDateFormat dateDB = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span>
		try {
<span class="nc" id="L4192">			resultSet2 = statement</span>
					.executeQuery(&quot;select transaction_type,receipt_id as transaction_id,account_type,balance,amount,transaction_date,transaction_with from st_lms_bo_ledger where account_type = (select organization_id from st_lms_organization_master where name = '&quot;
							+ agentName
							+ &quot;' ) and transaction_date &gt;= '&quot;
							+ fromDate
							+ &quot;' and transaction_date &lt;= '&quot;
							+ todate
							+ &quot;'&quot;);
<span class="nc bnc" id="L4200" title="All 2 branches missed.">			while (resultSet2.next()) {</span>

<span class="nc bnc" id="L4202" title="All 8 branches missed.">				if ((&quot;SALE_RET&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;))
						|| &quot;DG_REFUND_CANCEL&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)) || &quot;DG_REFUND_FAILED&quot;
						.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)) {
<span class="nc" id="L4209">					trParticulars = &quot;By Sales Return&quot;;</span>
<span class="nc bnc" id="L4210" title="All 6 branches missed.">				} else if ((&quot;SALE&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;)) || &quot;DG_SALE&quot;
						.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)) {
<span class="nc" id="L4215">					trParticulars = &quot;To Gross Sales&quot;;</span>
<span class="nc bnc" id="L4216" title="All 6 branches missed.">				} else if ((&quot;PWT_PLR&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;)) || &quot;DG_PWT_PLR&quot;
						.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)))
						&amp;&amp; &quot;PWT_PAY&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;account_type&quot;))) {
<span class="nc" id="L4222">					trParticulars = &quot;Player PWT&quot;;</span>
<span class="nc bnc" id="L4223" title="All 2 branches missed.">				} else if (&quot;PLAYER_CAS&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))) {
<span class="nc" id="L4225">					trParticulars = &quot;To Player Net&quot;;</span>
<span class="nc bnc" id="L4226" title="All 12 branches missed.">				} else if (&quot;CASH&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)
						|| &quot;CHEQUE&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)
						|| &quot;CR_NOTE_CASH&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)) {
<span class="nc" id="L4235">					trParticulars = &quot;By  Reciepts&quot;;</span>
<span class="nc bnc" id="L4236" title="All 8 branches missed.">				} else if ((&quot;CHQ_BOUNCE&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;transaction_type&quot;))
						|| &quot;DR_NOTE_CASH&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)) || &quot;DR_NOTE&quot;
						.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)))
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)) {
<span class="nc" id="L4243">					trParticulars = &quot;To Reciept&quot;;</span>
<span class="nc bnc" id="L4244" title="All 12 branches missed.">				} else if (!resultSet2.getString(&quot;account_type&quot;).contains(&quot;_&quot;)</span>
						&amp;&amp; !resultSet2.getString(&quot;account_type&quot;).contains(&quot;#&quot;)
						&amp;&amp; (&quot;PWT&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))
								|| &quot;PWT_AUTO&quot;.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;))
								|| &quot;DG_PWT&quot;.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)) || &quot;DG_PWT_AUTO&quot;
								.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)))) {
<span class="nc" id="L4254">					trParticulars = &quot;By PWT Collection&quot;;</span>
<span class="nc bnc" id="L4255" title="All 10 branches missed.">				} else if (resultSet2.getString(&quot;account_type&quot;).contains(&quot;#&quot;)</span>
						&amp;&amp; (&quot;PWT&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))
								|| &quot;PWT_AUTO&quot;.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;))
								|| &quot;DG_PWT&quot;.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)) || &quot;DG_PWT_AUTO&quot;
								.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)))) {
<span class="nc" id="L4264">					trParticulars = &quot;By Collection Charges&quot;;</span>
<span class="nc bnc" id="L4265" title="All 2 branches missed.">				} else if (&quot;GOVT_COMM&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))) {
<span class="nc" id="L4267">					trParticulars = &quot;To Govt Contribution&quot;;</span>
<span class="nc bnc" id="L4268" title="All 2 branches missed.">				} else if (&quot;VAT_PAY&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))) {
<span class="nc" id="L4270">					trParticulars = &quot;To VAT Contribution&quot;;</span>
<span class="nc bnc" id="L4271" title="All 4 branches missed.">				} else if (&quot;TDS_PAY&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))
						&amp;&amp; &quot;TDS&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;))) {
<span class="nc" id="L4275">					trParticulars = &quot;To Deductions&quot;;</span>
<span class="nc bnc" id="L4276" title="All 6 branches missed.">				} else if (&quot;TDS_PAY&quot;.equalsIgnoreCase(resultSet2</span>
						.getString(&quot;account_type&quot;))
						&amp;&amp; (&quot;PWT_PLR&quot;.equalsIgnoreCase(resultSet2
								.getString(&quot;transaction_type&quot;)) || &quot;DG_PWT_PLR&quot;
								.equalsIgnoreCase(resultSet2
										.getString(&quot;transaction_type&quot;)))) {
<span class="nc" id="L4282">					trParticulars = &quot;By Player Deduction&quot;;</span>
				}

<span class="nc bnc" id="L4285" title="All 2 branches missed.">				if (ledDayMap.containsKey(trParticulars)) {</span>

<span class="nc" id="L4287">					agtLedAccDetailsBean = ledDayMap.get(trParticulars);</span>

<span class="nc" id="L4289">					agtLedAccDetailsBean.setLedTransType(trParticulars);</span>
<span class="nc" id="L4290">					agtLedAccDetailsBean.setAccBalance(resultSet2</span>
							.getDouble(&quot;balance&quot;));
<span class="nc" id="L4292">					agtLedAccDetailsBean.setAmount(agtLedAccDetailsBean</span>
							.getAmount()
							+ resultSet2.getDouble(&quot;amount&quot;));
<span class="nc" id="L4295">					agtLedAccDetailsBean.setTrDateStr(dateFormat.format(dateDB</span>
							.parse(fromDate)));
<span class="nc" id="L4297">					ledDayMap.put(trParticulars, agtLedAccDetailsBean);</span>
				} else {
<span class="nc" id="L4299">					agtLedAccDetailsBean = new AgtLedAccDetailsBean();</span>
<span class="nc" id="L4300">					System.out.println(&quot;======trParticulars===== &quot;</span>
							+ trParticulars + &quot; ======== &quot; + fromDate);
<span class="nc" id="L4302">					agtLedAccDetailsBean.setLedTransType(trParticulars);</span>
<span class="nc" id="L4303">					agtLedAccDetailsBean.setAccBalance(resultSet2</span>
							.getDouble(&quot;balance&quot;));
<span class="nc" id="L4305">					agtLedAccDetailsBean.setAmount(resultSet2</span>
							.getDouble(&quot;amount&quot;));
<span class="nc" id="L4307">					agtLedAccDetailsBean.setTrDateStr(dateFormat.format(dateDB</span>
							.parse(fromDate)));
<span class="nc" id="L4309">					ledDayMap.put(trParticulars, agtLedAccDetailsBean);</span>

				}

			}
<span class="nc" id="L4314">		} catch (SQLException e) {</span>
<span class="nc" id="L4315">			e.printStackTrace();</span>
<span class="nc" id="L4316">		} catch (ParseException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L4318">			e.printStackTrace();</span>
<span class="nc" id="L4319">		}</span>
<span class="nc" id="L4320">		System.out.println(&quot;=======================  &quot; + ledDayMap);</span>
<span class="nc" id="L4321">		return ledDayMap;</span>
	}

	public TreeMap&lt;String, Map&lt;String, AgtLedAccDetailsBean&gt;&gt; getDayWiseLedMap(
			String agentName, Timestamp fromDate, Timestamp todate) {
<span class="nc" id="L4326">		List frTimeList = new ArrayList();</span>
<span class="nc" id="L4327">		List toTimeList = new ArrayList();</span>
<span class="nc" id="L4328">		Calendar from = Calendar.getInstance();</span>
<span class="nc" id="L4329">		Calendar to = Calendar.getInstance();</span>
<span class="nc" id="L4330">		from.setTimeInMillis(fromDate.getTime());</span>
<span class="nc" id="L4331">		to.setTimeInMillis(todate.getTime());</span>
<span class="nc" id="L4332">		Map&lt;String, AgtLedAccDetailsBean&gt; ledDayMap = null;</span>
<span class="nc" id="L4333">		SimpleDateFormat format = new SimpleDateFormat(&quot;dd-MM-yyyy&quot;);</span>
<span class="nc" id="L4334">		SimpleDateFormat formatDB = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span>
<span class="nc" id="L4335">		String dateString = null;</span>
<span class="nc" id="L4336">		String frDtString = null;</span>
<span class="nc" id="L4337">		String toDtString = null;</span>

<span class="nc bnc" id="L4339" title="All 2 branches missed.">		while (from.before(to)) {</span>
<span class="nc" id="L4340">			frTimeList.add(from.getTime());</span>
<span class="nc" id="L4341">			from.add(Calendar.DATE, 1);</span>
<span class="nc" id="L4342">			toTimeList.add(from.getTime());</span>
		}
<span class="nc" id="L4344">		System.out.println(&quot;frTimeList &quot; + frTimeList);</span>
<span class="nc" id="L4345">		System.out.println(&quot;toTimeList &quot; + toTimeList);</span>
<span class="nc" id="L4346">		TreeMap&lt;String, Map&lt;String, AgtLedAccDetailsBean&gt;&gt; ledDayWiseMap = new TreeMap&lt;String, Map&lt;String, AgtLedAccDetailsBean&gt;&gt;();</span>

<span class="nc bnc" id="L4348" title="All 2 branches missed.">		for (int i = 0; i &lt; frTimeList.size(); i++) {</span>
<span class="nc" id="L4349">			frDtString = formatDB.format((Date) frTimeList.get(i));</span>
<span class="nc" id="L4350">			toDtString = formatDB.format((Date) toTimeList.get(i));</span>
<span class="nc" id="L4351">			ledDayMap = getDayWiseLeder(agentName, frDtString, toDtString);</span>
<span class="nc" id="L4352">			dateString = format.format((Date) frTimeList.get(i));</span>
<span class="nc bnc" id="L4353" title="All 2 branches missed.">			if (ledDayMap.size() &gt; 0) {</span>
<span class="nc" id="L4354">				ledDayWiseMap.put(dateString, ledDayMap);</span>
			}
		}

<span class="nc" id="L4358">		System.out.println(&quot;DAYWISE MAP &quot; + ledDayWiseMap.size());</span>
<span class="nc" id="L4359">		return ledDayWiseMap;</span>

	}

	// This Function checks for service Code of the GOVT_RCPT
	public String checkServiceCode(int id) {
<span class="nc" id="L4365">		String serviceCode = &quot;&quot;;</span>
<span class="nc" id="L4366">		Connection connection = null;</span>

<span class="nc" id="L4368">		String query = null;</span>
		try {
<span class="nc" id="L4370">			connection = DBConnect.getConnection();</span>
<span class="nc" id="L4371">			Statement stmt = null;</span>
<span class="nc" id="L4372">			stmt = connection.createStatement();</span>
<span class="nc" id="L4373">			ResultSet rs1 = null;</span>
<span class="nc" id="L4374">			query = &quot;select lbgt.service_code from st_lms_bo_receipts lbr, st_lms_bo_receipts_trn_mapping lbrtm , st_lms_bo_govt_transaction lbgt where lbr.receipt_id = lbrtm.receipt_id and lbrtm.transaction_id = lbgt.transaction_id and lbr.receipt_id = &quot;</span>
					+ id;
<span class="nc" id="L4376">			rs1 = stmt.executeQuery(query);</span>

<span class="nc bnc" id="L4378" title="All 2 branches missed.">			while (rs1.next()) {</span>
<span class="nc" id="L4379">				serviceCode = rs1.getString(&quot;service_code&quot;);</span>
			}
<span class="nc" id="L4381">		} catch (SQLException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L4383">			e.printStackTrace();</span>
		} finally {
<span class="nc" id="L4385">			try {</span>

<span class="nc" id="L4387">				System.out.println(&quot; closing connection  &quot;);</span>
<span class="nc bnc" id="L4388" title="All 6 branches missed.">				if (connection != null) {</span>
<span class="nc" id="L4389">					connection.close();</span>
				}
<span class="nc" id="L4391">			} catch (SQLException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L4393">				e.printStackTrace();</span>
<span class="nc" id="L4394">			}</span>

<span class="nc" id="L4396">		}</span>
<span class="nc" id="L4397">		return serviceCode;</span>
	}

	/**
	 * This method send the currently present Games and their Game Id's for the
	 * User Interface
	 * 
	 * @return Map of Games
	 */

	public Map getDefaultSelectGames(String gameStatus) {
<span class="nc" id="L4408">		Map m = new LinkedHashMap();</span>
<span class="nc" id="L4409">		Connection connection = null;</span>

<span class="nc" id="L4411">		String query = null;</span>
		try {
<span class="nc" id="L4413">			connection = DBConnect.getConnection();</span>
<span class="nc" id="L4414">			Statement stmt = null;</span>
<span class="nc" id="L4415">			stmt = connection.createStatement();</span>
<span class="nc" id="L4416">			ResultSet rs1 = null;</span>
<span class="nc" id="L4417">			query = &quot;select game_id,game_nbr from st_se_game_master where game_status='&quot;</span>
					+ gameStatus + &quot;'&quot;;
<span class="nc" id="L4419">			System.out.println(&quot;query -----------     &quot; + query);</span>
<span class="nc bnc" id="L4420" title="All 2 branches missed.">			if (gameStatus.equals(&quot;--Please Select--&quot;)) {</span>
<span class="nc" id="L4421">				query = &quot;select game_id,game_nbr from st_se_game_master where game_status!='NEW' &quot;;</span>
<span class="nc" id="L4422">				System.out</span>
						.println(&quot;query******************************************* -----------please select----     &quot;
								+ query);
			}

<span class="nc" id="L4427">			rs1 = stmt.executeQuery(query);</span>

<span class="nc bnc" id="L4429" title="All 2 branches missed.">			while (rs1.next()) {</span>
<span class="nc" id="L4430">				m.put(rs1.getInt(&quot;game_id&quot;), rs1.getInt(&quot;game_nbr&quot;));</span>
			}
<span class="nc" id="L4432">			System.out.println(m);</span>

<span class="nc" id="L4434">		} catch (SQLException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L4436">			e.printStackTrace();</span>
		} finally {
<span class="nc" id="L4438">			try {</span>

<span class="nc" id="L4440">				System.out.println(&quot; closing connection  &quot;);</span>
<span class="nc bnc" id="L4441" title="All 6 branches missed.">				if (connection != null) {</span>
<span class="nc" id="L4442">					connection.close();</span>
				}
<span class="nc" id="L4444">			} catch (SQLException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L4446">				e.printStackTrace();</span>
<span class="nc" id="L4447">			}</span>

<span class="nc" id="L4449">		}</span>
<span class="nc" id="L4450">		return m;</span>
	}

	public void setBytes(byte[] bytes) {
<span class="nc" id="L4454">		this.bytes = bytes;</span>
<span class="nc" id="L4455">	}</span>
	
	public byte[] createMultiTextReportBO(int receipt_id, String boOrgName,int userOrgID, String root_path) {
<span class="nc" id="L4458">		byte[] byteArr = null;</span>
		
<span class="nc" id="L4460">		String isVatApplicable = null;</span>
<span class="nc" id="L4461">		String isCommApplicable = null;</span>
<span class="nc" id="L4462">		String receipt_type = null;</span>
<span class="nc" id="L4463">		String receipt_no = null;</span>
<span class="nc" id="L4464">		Timestamp voucher_date = null;</span>

<span class="nc" id="L4466">		connection = DBConnect.getConnection();</span>
<span class="nc" id="L4467">		Statement stmt = null;</span>
<span class="nc" id="L4468">		ResultSet rs = null;</span>
<span class="nc" id="L4469">		String query = null;</span>
<span class="nc" id="L4470">		String file = null;</span>
<span class="nc" id="L4471">		String trnType = null;</span>

<span class="nc" id="L4473">		HashMap parameterMap = new HashMap();</span>

<span class="nc" id="L4475">		System.out</span>
				.println(&quot;======================= reciept_id : &quot; + receipt_id);
<span class="nc" id="L4477">		System.setProperty(&quot;java.awt.headless&quot;, &quot;true&quot;);</span>
<span class="nc" id="L4478">		String orgAdd = null;</span>
<span class="nc" id="L4479">		String addQuery = null;</span>
<span class="nc" id="L4480">		String vatNum = null;</span>
<span class="nc" id="L4481">		String fileName = null;</span>
<span class="nc" id="L4482">		String timeFormat = null;</span>
<span class="nc" id="L4483">		String currencySymbol = null;</span>
<span class="nc" id="L4484">		String dateFormat = null;</span>
<span class="nc" id="L4485">		String decimalFormat = null;</span>
<span class="nc" id="L4486">		String tdsPartyName = null;</span>
<span class="nc" id="L4487">		String vatPartyName = null;</span>
<span class="nc" id="L4488">		String govComPartyName = null;</span>
<span class="nc" id="L4489">		String isScratch = null;</span>
<span class="nc" id="L4490">		String isDraw = null;</span>
<span class="nc" id="L4491">		Statement statement = null;</span>
<span class="nc" id="L4492">		ResultSet set = null;</span>
<span class="nc" id="L4493">		String textForTax = null;</span>

		try {
<span class="nc" id="L4496">			timeFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TIME_FORMAT&quot;);
<span class="nc" id="L4498">			currencySymbol = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;CURRENCY_SYMBOL&quot;);
<span class="nc" id="L4500">			decimalFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;DECIMAL_FORMAT&quot;);
<span class="nc" id="L4502">			dateFormat = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;date_format&quot;);
<span class="nc" id="L4504">			textForTax = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;TEXT_FOR_TAX&quot;);
<span class="nc" id="L4506">			isScratch = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;IS_SCRATCH&quot;);
<span class="nc" id="L4508">			isDraw = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;IS_DRAW&quot;);
<span class="nc" id="L4510">			parameterMap.put(&quot;decimal_format&quot;, decimalFormat);</span>
<span class="nc" id="L4511">			parameterMap.put(&quot;timeFormat&quot;, timeFormat);</span>
<span class="nc" id="L4512">			parameterMap.put(&quot;currency_symbol&quot;, currencySymbol);</span>
<span class="nc" id="L4513">			parameterMap.put(&quot;dateFormat&quot;, dateFormat);</span>
<span class="nc" id="L4514">			parameterMap.put(&quot;textForTax&quot;, textForTax);</span>

<span class="nc" id="L4516">			LedgerHelper ledger = new LedgerHelper();</span>
<span class="nc" id="L4517">			addQuery = QueryManager.getST6AddressQuery();</span>
<span class="nc" id="L4518">			orgAdd = ledger.getAddress(addQuery, &quot;&quot; + userOrgID, null);</span>
<span class="nc" id="L4519">			parameterMap.put(&quot;orgAdd&quot;, orgAdd);</span>
<span class="nc" id="L4520">			parameterMap.put(&quot;header&quot;, boOrgName);</span>
			
<span class="nc" id="L4522">			vatNum = ledger.getVatNumber(&quot;&quot; + userOrgID);</span>
<span class="nc" id="L4523">			parameterMap.put(&quot;vatNum&quot;, vatNum);</span>
<span class="nc" id="L4524">			stmt = connection.createStatement();</span>
<span class="nc" id="L4525">			query = &quot;select sbtm.transaction_id,transaction_type,sbr.receipt_type,sbr.generated_id, sbr.voucher_date from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_transaction_master sbtm,st_lms_bo_receipts sbr where sbrtm.receipt_id='&quot;</span>
					+ receipt_id
					+ &quot;' and  sbrtm.transaction_id=sbtm.transaction_id and sbr.receipt_id=sbrtm.receipt_id&quot;;
<span class="nc" id="L4528">			System.out.println(&quot;-------------------- &quot; + query);</span>
<span class="nc" id="L4529">			rs = stmt.executeQuery(query);</span>

<span class="nc bnc" id="L4531" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L4532">				receipt_type = rs.getString(&quot;receipt_type&quot;);</span>
<span class="nc" id="L4533">				receipt_no = rs.getString(&quot;generated_id&quot;);</span>
<span class="nc" id="L4534">				trnType = rs.getString(&quot;transaction_type&quot;);</span>
<span class="nc" id="L4535">				voucher_date = rs.getTimestamp(&quot;voucher_date&quot;);</span>
			}
			/*
			 * query for temp receipt no
			 */

<span class="nc" id="L4541">			parameterMap.put(&quot;receipt_no&quot;, receipt_no);</span>
<span class="nc" id="L4542">			parameterMap.put(&quot;voucher_date&quot;, voucher_date);</span>
<span class="nc" id="L4543">			isVatApplicable = (String) ServletActionContext.getServletContext()</span>
					.getAttribute(&quot;VAT_APPLICABLE&quot;);
<span class="nc" id="L4545">			isCommApplicable = (String) ServletActionContext</span>
					.getServletContext().getAttribute(&quot;COMM_APPLICABLE&quot;);
<span class="nc bnc" id="L4547" title="All 2 branches missed.">			if (receipt_type.equalsIgnoreCase(&quot;DG_INVOICE&quot;)) {</span>
<span class="nc" id="L4548">				root_path = root_path.replace(&quot;\\&quot;, &quot;/&quot;);</span>
<span class="nc bnc" id="L4549" title="All 2 branches missed.">				if (&quot;DG_SALE&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc" id="L4550">					query = &quot;select id,game_name,transaction_date,voucher_date,mrp_amt as sale, net_amt, comm_amt,vat,taxable_sale,name,addr_line1,addr_line2,city,sale.transaction_id as transaction_id from st_dg_game_master sdgm ,st_lms_organization_master som ,(select agent_id,id,game_id ,agent_comm as comm_amt, mrp_amt, net_amt, vat_amt as vat, taxable_sale,sbs.transaction_id, btm.transaction_date, voucher_date from st_dg_bo_sale sbs, st_lms_bo_transaction_master btm, (select slbr.voucher_date as voucher_date,slbr.party_id as agent_id, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;</span>
							+ receipt_id
							+ &quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id)sale where sale.game_id = sdgm.game_id and som.organization_id = sale.agent_id order by transaction_date&quot;;
<span class="nc" id="L4553">					System.out</span>
							.println(&quot; DG_INVOICE queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc bnc" id="L4556" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L4558">						fileName = &quot;DGSaleInvcComVat.jasper&quot;; // changes</span>
						// .jasper to
						// jrxml
<span class="nc bnc" id="L4561" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L4563">						fileName = &quot;DGSaleInvcComNoVat.jasper&quot;; // changes</span>
						// .jasper to
						// jrxml
<span class="nc bnc" id="L4566" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L4568">						fileName = &quot;DGSaleInvcRdpNoVat.jasper&quot;;// changes</span>
						// .jasper to
						// jrxml
<span class="nc bnc" id="L4571" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L4573">						fileName = &quot;DGSaleInvcRdpVat.jasper&quot;;//</span>
					}
				}
<span class="nc" id="L4576">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
						+ fileName;
<span class="nc" id="L4579">				byteArr = generateReport(query, file, parameterMap, null, null, null,</span>
						null);
			}
<span class="nc bnc" id="L4582" title="All 2 branches missed.">			if(receipt_type.equalsIgnoreCase(&quot;CS_INVOICE&quot;)){</span>
<span class="nc" id="L4583">				root_path = root_path.replace(&quot;\\&quot;, &quot;/&quot;);</span>
<span class="nc bnc" id="L4584" title="All 2 branches missed.">			if (&quot;CS_SALE&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc" id="L4585">				query = &quot;select id,product_code,description,transaction_date,voucher_date,mrp_amt as sale, net_amt, comm_amt,vat,name,addr_line1,addr_line2,city,sale.transaction_id as transaction_id from st_cs_product_master scpm ,st_lms_organization_master som ,(select agent_id,voucher_date,id,product_id ,(mrp_amt*agent_comm/100) as comm_amt, mrp_amt, net_amt, vat_amt as vat, sbs.transaction_id, btm.transaction_date from st_cs_bo_sale sbs, st_lms_bo_transaction_master btm, (select slbr.voucher_date as voucher_date,slbr.party_id as agent_id, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+</span>
						+ receipt_id
						+ &quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id)sale where sale.product_id = scpm.product_id and scpm.product_id and som.organization_id = sale.agent_id order by transaction_date&quot;;
<span class="nc" id="L4588">				System.out</span>
						.println(&quot; CS_INVOICE queryyyyyyyyyyyyyyyy BOOOOO &quot;
								+ query);
<span class="nc bnc" id="L4591" title="All 4 branches missed.">				if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
						&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L4593">					fileName = &quot;CSSaleInvcComVat.jasper&quot;; // changes</span>
					// .jasper to
					// jrxml
<span class="nc bnc" id="L4596" title="All 4 branches missed.">				} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
						&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L4598">					fileName = &quot;CSSaleInvcComNoVat.jasper&quot;; // changes</span>
					// .jasper to
					// jrxml
<span class="nc bnc" id="L4601" title="All 4 branches missed.">				} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
						&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L4603">					fileName = &quot;CSSaleInvcRdpNoVat.jasper&quot;;// changes</span>
					// .jasper to
					// jrxml
<span class="nc bnc" id="L4606" title="All 4 branches missed.">				} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
						&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L4608">					fileName = &quot;CSSaleInvcRdpVat.jasper&quot;;//</span>
				}
			}
<span class="nc" id="L4611">			file = root_path</span>
					+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
					+ fileName;
<span class="nc" id="L4614">			byteArr = generateReport(query, file, parameterMap, null, null, null,</span>
					null);
		}
			
<span class="nc bnc" id="L4618" title="All 2 branches missed.">			if(receipt_type.equalsIgnoreCase(&quot;OLA_INVOICE&quot;)){</span>
<span class="nc" id="L4619">				root_path = root_path.replace(&quot;\\&quot;, &quot;/&quot;);</span>
<span class="nc bnc" id="L4620" title="All 2 branches missed.">			if (&quot;OLA_DEPOSIT&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc" id="L4621">				query = &quot;select id,wallet_name,transaction_date,voucher_date,deposit_amt as deposit, net_amt , (deposit_amt-net_amt) comm_amt,name,addr_line1,addr_line2,city,deposit.transaction_id as transaction_id from st_lms_organization_master som ,(select agent_id,voucher_date,id,wallet_name ,agent_comm as comm_amt, deposit_amt, net_amt,sbs.transaction_id, btm.transaction_date from st_ola_bo_deposit sbs,st_ola_wallet_master wamaster, st_lms_bo_transaction_master btm,(select slbr.party_id as agent_id,slbr.voucher_date as voucher_date, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+receipt_id+&quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id and sbs.wallet_id=wamaster.wallet_id)deposit where som.organization_id = deposit.agent_id&quot;;</span>
<span class="nc" id="L4622">				System.out</span>
						.println(&quot; OLA_INVOICE queryyyyyyyyyyyyyyyy BOOOOO &quot;
								+ query);
<span class="nc" id="L4625">			fileName = &quot;OLADepositInvcRdpNoVat.jasper&quot;;</span>
			}
<span class="nc bnc" id="L4627" title="All 2 branches missed.">			if (&quot;OLA_CASHCARD_SALE&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc" id="L4628">				query = &quot;select distributor name,'india' addr_line1,'XYZ' addr_line2,'delhi' city,voucher_date,id,wallet_name ,totalamount , sale_comm_rate,amount,sbs.transaction_id, btm.transaction_date from st_ola_bo_distributor_transaction sbs,st_ola_wallet_master wamaster, st_lms_bo_transaction_master btm,(select  slbr.voucher_date as voucher_date, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = &quot;+receipt_id+&quot;)innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id and sbs.wallet_id=wamaster.wallet_id&quot;;</span>
<span class="nc" id="L4629">				System.out</span>
						.println(&quot; OLA_INVOICE queryyyyyyyyyyyyyyyy BOOOOO &quot;
								+ query);
<span class="nc" id="L4632">			fileName = &quot;OLACashCardSaleInvcRdpNoVat.jasper&quot;;</span>
			}
<span class="nc" id="L4634">			file = root_path</span>
					+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
					+ fileName;
<span class="nc" id="L4637">			byteArr =  generateReport(query, file, parameterMap, null, null, null,</span>
					null);
		}
<span class="nc bnc" id="L4640" title="All 2 branches missed.">			if(receipt_type.equalsIgnoreCase(&quot;OLA_RECEIPT&quot;)){</span>
<span class="nc" id="L4641">				root_path = root_path.replace(&quot;\\&quot;, &quot;/&quot;);</span>
<span class="nc bnc" id="L4642" title="All 2 branches missed.">			if (&quot;OLA_WITHDRAWL&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc" id="L4643">				query = &quot;select id,wallet_name,transaction_date,voucher_date,withdrawl_amt as withdrawal, net_amt ,(withdrawl_amt-net_amt) comm_amt,name,addr_line1,addr_line2,city,deposit.transaction_id as transaction_id from st_lms_organization_master som ,(select agent_id,voucher_date,id,wallet_name ,agent_comm as comm_amt, withdrawl_amt, net_amt,sbs.transaction_id, btm.transaction_date from st_ola_bo_withdrawl sbs,st_ola_wallet_master wamaster, st_lms_bo_transaction_master btm,(select slbr.party_id as agent_id,slbr.voucher_date as voucher_date, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+receipt_id+&quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id and sbs.wallet_id=wamaster.wallet_id)deposit where som.organization_id = deposit.agent_id&quot;;</span>
<span class="nc" id="L4644">				System.out</span>
						.println(&quot; OLA_RECEIPT queryyyyyyyyyyyyyyyy BOOOOO &quot;
								+ query);
<span class="nc" id="L4647">			fileName = &quot;OLAWithdrawalInvcRdpNoVat.jasper&quot;;</span>
			}
			// Check for OLA_COMMISSION transaction type
<span class="nc bnc" id="L4650" title="All 2 branches missed.">			if (&quot;OLA_COMMISSION&quot;.equalsIgnoreCase(trnType)) {</span>
<span class="nc" id="L4651">				query = &quot;select id,wallet_name,transaction_date,voucher_date,comm_amt,netgame.tds_comm_rate,net_comm_amt,name,addr_line1,addr_line2,city,netgame.transaction_id as transaction_id from st_ola_wallet_master sdgm ,st_lms_organization_master som ,(select agent_org_id ,voucher_date,id,wallet_id ,agt_claim_comm as comm_amt,sbs.tds_comm_rate,agt_net_claim_comm as net_comm_amt , sbs.transaction_id, btm.transaction_date from st_ola_bo_comm sbs, st_lms_bo_transaction_master btm, (select slbr.party_id as agent_id,slbr.voucher_date as voucher_date,slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+receipt_id+&quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id)netgame where netgame.wallet_id = sdgm.wallet_id and som.organization_id = netgame.agent_org_id&quot;;</span>
<span class="nc" id="L4652">				System.out</span>
						.println(&quot; OLA_RECEIPT queryyyyyyyyyyyyyyyy BOOOOO &quot;
								+ query);
<span class="nc" id="L4655">			fileName = &quot;OLANetGameInvcRdpNoVat.jasper&quot;;</span>
			}
<span class="nc" id="L4657">			file = root_path</span>
					+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
					+ fileName;
<span class="nc" id="L4660">			byteArr = generateReport(query, file, parameterMap, null, null, null,</span>
					null);
		}
<span class="nc bnc" id="L4663" title="All 2 branches missed.">			if (receipt_type.equalsIgnoreCase(&quot;INVOICE&quot;)) {</span>
<span class="nc" id="L4664">				System.out</span>
						.println(&quot;================== inside Invoice =================&quot;);
<span class="nc" id="L4666">				System.out.println(root_path);</span>
<span class="nc" id="L4667">				root_path = root_path.replace(&quot;\\&quot;, &quot;/&quot;);</span>
<span class="nc bnc" id="L4668" title="All 2 branches missed.">				if (&quot;SALE&quot;.equalsIgnoreCase(trnType)) {</span>
					// VAT AMOUNT AMBIGUOUS &quot;select
					// distinct(transaction_id),agent_sale_comm_rate,name,addr_line1,addr_line2,city,agent_org_id,id,game_name
					// ,sale,taxable_sale,vat_amt,ticket_price,
					// nbr_of_tickets_per_book ,
					// nbr_of_books,total_tickets,transaction_date,order_id,order_date,comm_amt
					// from (select
					// agent_sale_comm_rate,name,addr_line1,addr_line2,city,
					// agent_org_id,id, game_name
					// ,sale,taxable_sale,sale.vat_amt,ticket_price,
					// nbr_of_tickets_per_book ,
					// nbr_of_books,(nbr_of_tickets_per_book*nbr_of_books)as
					// total_tickets,transaction_date,transaction_id,order_id,order_date,comm_amt
					// from st_lms_organization_master som ,( select
					// agent_sale_comm_rate,id,sale.agent_org_id,game_name
					// ,ticket_price, nbr_of_tickets_per_book ,
					// sale.nbr_of_books,taxable_sale, vat_amt,(net_amt) as
					// sale,transaction_date,transaction_id,sale.order_id,order_date,comm_amt
					// from st_se_game_master ,st_se_bo_order sbo, (select
					// sbat.agent_org_id,id,sbat.game_id , nbr_of_books,
					// mrp_amt,sbat.transaction_id,
					// vat_amt,taxable_sale,net_amt,transaction_date,order_id,comm_amt
					// from st_se_bo_agent_transaction sbat ,
					// st_se_bo_order_invoices sboi,(select receipt_id as
					// id,transaction_id from st_lms_bo_receipts_trn_mapping
					// where receipt_id = '&quot;+receipt_id+&quot;' )innermost ,(select
					// transaction_date,transaction_id from
					// st_lms_bo_transaction_master )sbtm where
					// sbat.transaction_id = innermost.transaction_id and
					// innermost.transaction_id=sbtm.transaction_id and
					// sboi.invoice_id=innermost.id )sale where sale.game_id =
					// st_se_game_master.game_id and sbo.order_id=sale.order_id
					// )result1 where som.organization_id=result1.agent_org_id )
					// res&quot;;
<span class="nc" id="L4702">					query = &quot;select distinct(transaction_id),agent_sale_comm_rate,name,addr_line1,addr_line2,city,agent_org_id,id,game_name ,sale,taxable_sale,vat_amt,ticket_price, nbr_of_tickets_per_book , nbr_of_books,total_tickets,transaction_date,order_id,order_date,comm_amt from (select agent_sale_comm_rate,name,addr_line1,addr_line2,city, agent_org_id,id, game_name ,sale,taxable_sale,vat_amt,ticket_price, nbr_of_tickets_per_book , nbr_of_books,(nbr_of_tickets_per_book*nbr_of_books)as total_tickets,transaction_date,transaction_id,order_id,order_date,comm_amt from  st_lms_organization_master som ,( select agent_sale_comm_rate,id,sale.agent_org_id,game_name ,ticket_price, nbr_of_tickets_per_book , sale.nbr_of_books,taxable_sale, sale.vat_amt,(net_amt) as sale,transaction_date,transaction_id,sale.order_id,order_date,comm_amt from  st_se_game_master ,st_se_bo_order sbo, (select sbat.agent_org_id,id,sbat.game_id , nbr_of_books, mrp_amt,sbat.transaction_id, sbat.vat_amt,taxable_sale,net_amt,transaction_date,order_id,comm_amt from st_se_bo_agent_transaction sbat , st_se_bo_order_invoices sboi,(select receipt_id as id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id = '&quot;</span>
							+ receipt_id
							+ &quot;' )innermost ,(select transaction_date,transaction_id from st_lms_bo_transaction_master     )sbtm where  sbat.transaction_id = innermost.transaction_id and innermost.transaction_id=sbtm.transaction_id and sboi.invoice_id=innermost.id )sale where sale.game_id = st_se_game_master.game_id and sbo.order_id=sale.order_id  )result1   where som.organization_id=result1.agent_org_id ) res order by transaction_date&quot;;
<span class="nc" id="L4705">					System.out.println(&quot; INVOICE queryyyyyyyyyyyyyyyy BOOOOO &quot;</span>
							+ query);

<span class="nc bnc" id="L4708" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L4710">						fileName = &quot;InvcComVat.jasper&quot;; // changes .jasper to</span>
						// jrxml
<span class="nc bnc" id="L4712" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L4714">						fileName = &quot;InvcComNoVat.jasper&quot;; // changes .jasper</span>
						// to jrxml
<span class="nc bnc" id="L4716" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L4718">						fileName = &quot;InvcRdpNoVat.jasper&quot;;// changes .jasper</span>
						// to jrxml
<span class="nc bnc" id="L4720" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L4722">						fileName = &quot;InvcRdpVat.jasper&quot;;//</span>
					}
				} 
<span class="nc bnc" id="L4725" title="All 2 branches missed.">				else if (&quot;LOOSE_SALE&quot;.equalsIgnoreCase(trnType)) {</span>
					
<span class="nc" id="L4727">					query = &quot;select id,game_name,organization_id,transaction_date,nbrOfTickets, net_amt sale, agent_sale_comm_rate,name,addr_line1,addr_line2,city,sale.transaction_id as transaction_id,vat_amt,taxable_sale,ticket_price,comm_amt,agtSaleCommRate  from st_lms_organization_master som ,(select agent_id,id,game_name ,agent_sale_comm_rate as agent_sale_comm_rate,nbrOfTickets, ticket_price,taxable_sale,sbs.vat_amt ,net_amt,sbs.transaction_id, btm.transaction_date,comm_amt,agtSaleCommRate from st_se_bo_agent_loose_book_transaction sbs,st_se_game_master game, st_lms_bo_transaction_master btm,(select slbr.party_id as agent_id, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id ='&quot;+ receipt_id+ &quot;' )innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id and sbs.game_id=game.game_id)sale where som.organization_id = sale.agent_id&quot;;</span>
<span class="nc" id="L4728">					System.out.println(&quot; INVOICE queryyyyyyyyyyyyyyyy BOOOOO &quot;</span>
							+ query);

<span class="nc bnc" id="L4731" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L4733">						fileName = &quot;looseSaleInvcComVat.jasper&quot;; // changes .jasper to</span>
						// jrxml
<span class="nc bnc" id="L4735" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L4737">						fileName = &quot;looseSaleInvcComNoVat.jasper&quot;; // changes .jasper</span>
						// to jrxml
<span class="nc bnc" id="L4739" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L4741">						fileName = &quot;looseSaleInvcRdpNoVat.jasper&quot;;// changes .jasper</span>
						// to jrxml
<span class="nc bnc" id="L4743" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L4745">						fileName = &quot;looseSaleInvcRdpVat.jasper&quot;;//</span>
					}
				}
				
				else {
					// select id,game_name,taxable_sale, vat_amt,net_amt as
					// sale,comm_amt,transaction_id from st_dg_game_master sdgm
					// ,(select id,game_id ,agent_comm as comm_amt, mrp_amt,
					// vat_amt,taxable_sale,net_amt,sbat.transaction_id from
					// st_dg_bo_sale sbat,(select receipt_id as
					// id,transaction_id from st_lms_bo_receipts_trn_mapping
					// where receipt_id = '&quot;+receipt_id+&quot;' ) innermost where
					// sbat.transaction_id = innermost.transaction_id )sale
					// where sale.game_id = sdgm.game_id and
					// agent_org_id='&quot;+userOrgID+&quot;'&quot;;
					// query=&quot; select id,game_name,taxable_sale,
					// sale.vat_amt,net_amt as sale,comm_amt,sale.transaction_id
					// from st_dg_game_master sdgm ,(select
					// agent_org_id,id,game_id ,agent_comm as comm_amt, mrp_amt,
					// vat_amt,taxable_sale,net_amt,sbat.transaction_id from
					// st_dg_bo_sale sbat,(select receipt_id as
					// id,transaction_id from st_lms_bo_receipts_trn_mapping
					// where receipt_id = '&quot;+receipt_id+&quot;' ) innermost where
					// sbat.transaction_id = innermost.transaction_id )sale
					// where sale.game_id = sdgm.game_id and
					// agent_org_id='&quot;+userOrgID+&quot;'&quot;;
<span class="nc" id="L4771">					query = &quot;select id,game_name,taxable_sale, sale.vat_amt,net_amt as sale,comm_amt,name,addr_line1,addr_line2,city,sale.transaction_id from st_dg_game_master sdgm ,st_lms_organization_master som ,(select agent_org_id,id,game_id ,agent_comm as comm_amt, mrp_amt, vat_amt,taxable_sale,net_amt,sbat.transaction_id from  st_dg_bo_sale sbat,(select receipt_id as id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id = '&quot;</span>
							+ receipt_id
							+ &quot;' ) innermost where  sbat.transaction_id = innermost.transaction_id )sale where sale.game_id = sdgm.game_id and sale.agent_org_id='&quot;
							+ userOrgID
							+ &quot;' and som.organization_id=sale.agent_org_id&quot;;
<span class="nc" id="L4776">					System.out.println(&quot; INVOICE queryyyyyyyyyyyyyyyy BOOOOO &quot;</span>
							+ query);

<span class="nc bnc" id="L4779" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L4781">						fileName = &quot;DGInvcComVat.jasper&quot;;//</span>
<span class="nc bnc" id="L4782" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L4784">						fileName = &quot;DGInvcComNoVat.jasper&quot;;//</span>
<span class="nc bnc" id="L4785" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L4787">						fileName = &quot;DGInvcRdpNoVat.jasper&quot;;//</span>
<span class="nc bnc" id="L4788" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L4790">						fileName = &quot;DGInvcRdpVat.jasper&quot;;//</span>
					}
				}
<span class="nc" id="L4793">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
						+ fileName;
<span class="nc" id="L4796">				byteArr = generateReport(query, file, parameterMap, null, null, null,</span>
						null);

			}
			
<span class="nc bnc" id="L4801" title="All 2 branches missed.">			if (receipt_type.equalsIgnoreCase(&quot;DG_RECEIPT&quot;)) {</span>
<span class="nc bnc" id="L4802" title="All 4 branches missed.">				if (trnType.equalsIgnoreCase(&quot;DG_PWT&quot;)</span>
						|| trnType.equalsIgnoreCase(&quot;DG_PWT_AUTO&quot;)) {
<span class="nc" id="L4804">					query = &quot;select id,game_nbr,game_name,t_type,transaction_date,voucher_date,pwt_amt as amount, net_amt as net_amount,comm_amt as comm_amount,name,addr_line1,addr_line2,city,sale.transaction_id as trans_id from st_dg_game_master sdgm ,st_lms_organization_master som ,(select 'pwt' t_type, agent_id,id,game_id ,comm_amt, pwt_amt, net_amt,sbat.transaction_id,btm.transaction_date,voucher_date from  st_dg_bo_pwt sbat,st_lms_bo_transaction_master btm,(select slbr.voucher_date as voucher_date,slbr.party_id as agent_id, slbr.receipt_id as id,transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;</span>
							+ receipt_id
							+ &quot;' ) innermost where  sbat.transaction_id = innermost.transaction_id and innermost.transaction_id = btm.transaction_id)sale where sale.game_id = sdgm.game_id and som.organization_id=sale.agent_id order by transaction_date&quot;;
<span class="nc" id="L4807">					System.out</span>
							.println(&quot;DG_RECEIPT PWT queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L4810">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/DGNewPWTReceipt.jasper&quot;;
<span class="nc" id="L4812">					byteArr = generateReport(query, file, parameterMap, &quot;Receipt&quot;,</span>
							receipt_id + &quot;&quot;);
				}
			} 
			
<span class="nc bnc" id="L4817" title="All 4 branches missed.">			else if(receipt_type.equalsIgnoreCase(&quot;RECEIPT&quot;) &amp;&amp; trnType.equalsIgnoreCase(&quot;OLA_COMMISSION&quot;))</span>
			{
<span class="nc" id="L4819">				query = &quot;select id,wallet_name,transaction_date,voucher_date,commission_calculated as commission_calculated, name,addr_line1,addr_line2,city,netGaming.transaction_id as transaction_id from st_lms_organization_master som ,(select agent_id,id,wallet_name, commission_calculated,sbs.transaction_id, btm.transaction_date from st_ola_bo_agt_commission sbs,st_ola_wallet_master wamaster, st_lms_bo_transaction_master btm,(select slbr.party_id as agent_id, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+receipt_id+&quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id and sbs.wallet_id=wamaster.wallet_id)netGaming where som.organization_id = netGaming.agent_id&quot;;</span>
<span class="nc" id="L4820">				System.out</span>
						.println(&quot; RECEIPT OLA COMMISSION queryyyyyyyyyyyyyyyy BOOOOO &quot;
								+ query);
<span class="nc" id="L4823">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/OLAReceipt.jasper&quot;;
<span class="nc" id="L4825">				byteArr = generateReport(query, file, parameterMap, null, null, null,</span>
						null);
			}
<span class="nc bnc" id="L4828" title="All 2 branches missed.">			else if (receipt_type.equalsIgnoreCase(&quot;RECEIPT&quot;)) {</span>
<span class="nc" id="L4829">				System.out</span>
						.println(&quot;================== inside reciept111 =================&quot;
								+ trnType);
<span class="nc bnc" id="L4832" title="All 2 branches missed.">				if (trnType.equalsIgnoreCase(&quot;cheque&quot;)) {</span>
<span class="nc" id="L4833">					query = &quot;select name,addr_line1,addr_line2,city,t_type,agent,trans_id,receipt_id as id,issuing_party_name,user_name,cheque_nbr,cheque_date,drawee_bank,amount,transaction_date,temp_receipt_id from  st_lms_organization_master som , (select 'cheque' t_type,cheque_agent as agent,cheque_amt as amount,user_name,cheque_amt as net_amount, cheque_id as trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,receipt_id,transaction_date,temp_receipt_id  from (select receipt_id ,slum.user_name,sbsc.agent_org_id as cheque_agent,sbsc.issuing_party_name,sbsc.cheque_nbr,sbsc.cheque_date,sbsc.drawee_bank,sbsc.cheque_amt,sbsc.transaction_id as cheque_id,transaction_date,temp_receipt_id from st_lms_bo_sale_chq sbsc,st_lms_bo_cheque_temp_receipt sbctr, (select receipt_id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id=&quot;</span>
							+receipt_id+
							&quot;) innermost,(select user_id,transaction_id,transaction_date from st_lms_bo_transaction_master )sbtm,(select user_id, user_name from st_lms_user_master)slum where sbsc.transaction_id=innermost.transaction_id and sbtm.transaction_id=innermost.transaction_id  and sbsc.transaction_id=sbctr.transaction_id and slum.user_id = sbtm.user_id) cheque ) result where result.agent = som.organization_id order by transaction_date&quot;;
<span class="nc" id="L4836">					System.out</span>
							.println(&quot; RECEIPT Cheque queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L4839">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;;
<span class="nc bnc" id="L4841" title="All 2 branches missed.">				} else if (trnType.equalsIgnoreCase(&quot;bank_deposit&quot;)) {</span>
<span class="nc" id="L4842">					query = &quot;select name,addr_line1,addr_line2,city,t_type,agent,trans_id,receipt_id as id,user_name,amount,transaction_date from  st_lms_organization_master som ,(select 'cash' t_type,cash_agent  as agent,user_name,cash_amount as amount ,trans_id,receipt_id,transaction_date from ( select receipt_id,sbct.agent_org_id as cash_agent,sbct.amount as cash_amount ,sbct.transaction_id as trans_id,slum.user_name,transaction_date from  st_lms_bo_bank_deposit_transaction sbct,( select receipt_id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id= '&quot;</span>
							+ receipt_id
							+ &quot;' ) innermost, (select  user_id,transaction_id,transaction_date from st_lms_bo_transaction_master )sbtm, (select user_id, user_name from st_lms_user_master)slum  where sbct.transaction_id=innermost.transaction_id and  sbtm.transaction_id=innermost.transaction_id and slum.user_id = sbtm.user_id  ) cash )result where result.agent = som.organization_id order by transaction_date&quot;;
<span class="nc" id="L4845">					System.out</span>
							.println(&quot; RECEIPT BANK DEPOSIT queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L4848">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/CashReceipt.jasper&quot;;
<span class="nc bnc" id="L4850" title="All 2 branches missed.">				} else if (trnType.equalsIgnoreCase(&quot;CASH&quot;)) {</span>
<span class="nc" id="L4851">					query = &quot;select name,addr_line1,addr_line2,city,t_type,agent,trans_id,receipt_id as id,user_name,amount,transaction_date from  st_lms_organization_master som ,(select 'cash' t_type,cash_agent  as agent,user_name,cash_amount as amount ,trans_id,receipt_id,transaction_date from ( select receipt_id,sbct.agent_org_id as cash_agent,sbct.amount as cash_amount ,sbct.transaction_id as trans_id,slum.user_name,transaction_date from  st_lms_bo_cash_transaction sbct,( select receipt_id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id=&quot;</span>
							+receipt_id+
							&quot;) innermost, (select user_id, transaction_id,transaction_date from st_lms_bo_transaction_master )sbtm, (select user_id, user_name from st_lms_user_master)slum  where sbct.transaction_id=innermost.transaction_id and  sbtm.transaction_id=innermost.transaction_id and slum.user_id = sbtm.user_id ) cash )result where result.agent = som.organization_id order by transaction_date&quot;;
<span class="nc" id="L4854">					System.out</span>
							.println(&quot; RECEIPT CASH queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L4857">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/CashReceipt.jasper&quot;;
<span class="nc bnc" id="L4859" title="All 4 branches missed.">				} else if (trnType.equalsIgnoreCase(&quot;PWT&quot;)</span>
						|| trnType.equalsIgnoreCase(&quot;PWT_AUTO&quot;)) {
<span class="nc" id="L4861">					query = &quot;select name,addr_line1,addr_line2,city,t_type,agent,trans_id,receipt_id as id,amount,net_amount ,comm_amount,transaction_date,game_nbr,game_name from st_lms_organization_master som ,(select 'pwt' t_type,pwt_agent  as agent,pwt_amount as amount,net_amount ,comm_amount ,pwt_trans_id as trans_id, receipt_id,transaction_date,game_nbr,game_name from  (select receipt_id,sbp.agent_org_id as pwt_agent,sum(sbp.pwt_amt) as pwt_amount, sum(sbp.net_amt)as net_amount ,sum(sbp.comm_amt)as comm_amount,sbp.transaction_id as pwt_trans_id, transaction_date,sbp.game_id,game_nbr,game_name from st_se_bo_pwt sbp,(select game_nbr,game_id,game_name from st_se_game_master )sgm, (select receipt_id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id= '&quot;</span>
							+ receipt_id
							+ &quot;') innermost,(select transaction_id,transaction_date from st_lms_bo_transaction_master )sbtm where sbp.transaction_id=innermost.transaction_id and  sbtm.transaction_id=innermost.transaction_id and sbp.game_id=sgm.game_id group by sbp.transaction_id ) pwt )result where result.agent = som.organization_id order by transaction_date&quot;;
<span class="nc" id="L4864">					System.out</span>
							.println(&quot; RECEIPT PWT queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L4867">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/PWTReceipt.jasper&quot;;
<span class="nc bnc" id="L4869" title="All 4 branches missed.">				} else if (trnType.equalsIgnoreCase(&quot;DG_PWT&quot;)</span>
						|| trnType.equalsIgnoreCase(&quot;DG_PWT_AUTO&quot;)) {
<span class="nc" id="L4871">					query = &quot;select name,addr_line1,addr_line2,city,t_type,trans_id,receipt_id as id,amount,net_amount ,comm_amt,game_nbr,game_name from st_lms_organization_master som ,(select 'pwt' t_type,pwt_amount as amount,net_amount ,comm_amt , receipt_id,game_nbr,game_name from (select receipt_id,sbp.agent_org_id as agent,sbp.pwt_amt as pwt_amount, sbp.net_amt as net_amount ,sbp.comm_amt as comm_amt,sbp.transaction_id as pwt_trans_id, sbp.game_id,game_nbr,game_name from st_se_bo_pwt sbp,(select game_nbr,game_id,game_name from st_se_game_master  )sgm,(select receipt_id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id= '&quot;</span>
							+ receipt_id
							+ &quot;') innermost,(select transaction_id from st_lms_bo_transaction_master)sbtm where sbp.transaction_id=innermost.transaction_id and  sbtm.transaction_id=innermost.transaction_id and sbp.game_id=sgm.game_id and agent_org_id='') pwt )result where result.agent = som.organization_id&quot;;
<span class="nc" id="L4874">					System.out</span>
							.println(&quot; RECEIPT PWT queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L4877">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/DGPWTReceipt.jasper&quot;;
				}
<span class="nc" id="L4880">				byteArr = generateReport(query, file, parameterMap, &quot;Receipt&quot;, receipt_id</span>
						+ &quot;&quot;);
			}

<span class="nc bnc" id="L4884" title="All 2 branches missed.">			else if (receipt_type.equalsIgnoreCase(&quot;DR_NOTE&quot;)) {</span>
<span class="nc" id="L4885">				System.out</span>
						.println(&quot;================== inside note =================&quot;);
				// query=&quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,transaction_id
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
				// from st_lms_bo_sale_chq sbsc, (select id,transaction_id from
				// st_lms_bo_receipts_trn_mapping where id= '&quot;+receipt_id+&quot;')
				// innermost where
				// sbsc.transaction_id=innermost.transaction_id)result1 where
				// som.organization_id=result1.agent_org_id&quot;;
				// query= &quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,issuing_party_name,cheque_nbr,amount,transaction_type,remarks,cheque_date,drawee_bank,cheque_amt,transaction_id
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,
				// sbdn.transaction_type,remarks, cheque_amt,sbsc.transaction_id
				// from st_lms_bo_sale_chq sbsc,(select
				// amount,transaction_type,remarks,transaction_id from
				// st_lms_bo_debit_note) sbdn, (select id,transaction_id from
				// st_lms_bo_receipts_trn_mapping where id= '&quot;+receipt_id+&quot;')
				// innermost where sbsc.transaction_id=innermost.transaction_id
				// and sbdn.transaction_id =innermost.transaction_id )result1
				// where som.organization_id=result1.agent_org_id&quot;;
				// query=&quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,transaction_type,remarks,transaction_id,transaction_date
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,issuing_party_name, cheque_nbr, cheque_date,
				// drawee_bank, cheque_amt as amount,transaction_id,
				// transaction_type,remarks,transaction_date from (select 0.00
				// amount,id,transaction_type,'Cheque
				// Bounce'remarks,sbsc.transaction_id,agent_org_id,
				// issuing_party_name, cheque_nbr, cheque_date,drawee_bank,
				// cheque_amt,transaction_date from st_lms_bo_sale_chq
				// sbsc,(select id,transaction_id from
				// st_lms_bo_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;')innermost,(select
				// transaction_id,transaction_date from
				// st_lms_bo_transaction_master)sbtm where
				// innermost.transaction_id=sbsc.transaction_id and
				// sbtm.transaction_id=innermost.transaction_id)cheque union
				// select agent_org_id,id,'N.A.'issuing_party_name,'N.A.'
				// cheque_nbr,'N.A.' cheque_date,'N.A.' drawee_bank,
				// amount,transaction_id,transaction_type,remarks,transaction_date
				// from (select
				// amount,id,transaction_type,remarks,sbdn.transaction_id,agent_org_id,transaction_date
				// from st_lms_bo_debit_note sbdn,(select id,transaction_id from
				// st_lms_bo_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;')innermost,(select
				// transaction_id,transaction_date from
				// st_lms_bo_transaction_master)sbtm where
				// innermost.transaction_id=sbdn.transaction_id and
				// sbtm.transaction_id=innermost.transaction_id )bounce) result1
				// where som.organization_id=result1.agent_org_id &quot;;
<span class="nc" id="L4938">				query = &quot;select name,addr_line1,addr_line2,city,agent_org_id,receipt_id as id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,transaction_type,remarks,transaction_id,transaction_date from st_lms_organization_master som ,(select agent_org_id,receipt_id,issuing_party_name, cheque_nbr, cheque_date, drawee_bank,cheque_amt as amount,transaction_id, transaction_type,remarks,transaction_date from (select 0.00 amount,receipt_id,transaction_type,'Cheque Bounce'remarks,sbsc.transaction_id,agent_org_id, issuing_party_name, cheque_nbr, cheque_date,drawee_bank, cheque_amt,transaction_date from st_lms_bo_sale_chq  sbsc,(select receipt_id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id= '&quot;</span>
						+ receipt_id
						+ &quot;' )innermost,(select transaction_id,transaction_date from st_lms_bo_transaction_master)sbtm  where innermost.transaction_id=sbsc.transaction_id and sbtm.transaction_id=innermost.transaction_id )cheque union select agent_org_id,receipt_id as id,'N.A.'issuing_party_name,'N.A.' cheque_nbr,'N.A.' cheque_date,'N.A.' drawee_bank, amount,transaction_id,transaction_type,remarks,transaction_date from (select  amount,receipt_id,transaction_type,remarks,sbdn.transaction_id,agent_org_id,transaction_date from st_lms_bo_debit_note  sbdn,(select receipt_id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id= '&quot;
						+ receipt_id
						+ &quot;' )innermost,(select transaction_id,transaction_date from st_lms_bo_transaction_master )sbtm  where innermost.transaction_id=sbdn.transaction_id and  sbtm.transaction_id=innermost.transaction_id  )bounce) result1 where som.organization_id=result1.agent_org_id order by transaction_date&quot;;
<span class="nc" id="L4943">				System.out.println(&quot;queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot; + query);</span>
<span class="nc" id="L4944">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;;
<span class="nc" id="L4946">				byteArr = generateReport(query, file, parameterMap, &quot;DebitNote&quot;,</span>
						receipt_id + &quot;&quot;);

<span class="nc bnc" id="L4949" title="All 2 branches missed.">			} else if (receipt_type.equalsIgnoreCase(&quot;DR_NOTE_CASH&quot;)) {</span>
<span class="nc" id="L4950">				System.out</span>
						.println(&quot;================== inside note =================&quot;);
				// query=&quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,transaction_id
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
				// from st_lms_bo_sale_chq sbsc, (select id,transaction_id from
				// st_lms_bo_receipts_trn_mapping where id= '&quot;+receipt_id+&quot;')
				// innermost where
				// sbsc.transaction_id=innermost.transaction_id)result1 where
				// som.organization_id=result1.agent_org_id&quot;;
				// query=&quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,amount,transaction_type,remarks,transaction_id
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,amount,sbdn.transaction_type,remarks,sbdn.transaction_id
				// from (select
				// amount,transaction_type,remarks,transaction_id,agent_org_id
				// from st_lms_bo_debit_note) sbdn,(select id,transaction_id
				// from st_lms_bo_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;') innermost where sbdn.transaction_id
				// =innermost.transaction_id )result1 where
				// som.organization_id=result1.agent_org_id&quot;;
				// query=&quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,amount,transaction_type,remarks,transaction_id,transaction_date
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,amount,sbdn.transaction_type,remarks,sbdn.transaction_id,transaction_date
				// from (select
				// amount,transaction_type,remarks,transaction_id,agent_org_id
				// from st_lms_bo_debit_note) sbdn,(select id,transaction_id
				// from st_lms_bo_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;') innermost,(select
				// transaction_id,transaction_date from
				// st_lms_bo_transaction_master)sbtm where sbdn.transaction_id
				// =innermost.transaction_id and
				// sbtm.transaction_id=innermost.transaction_id)result1 where
				// som.organization_id=result1.agent_org_id&quot;;
<span class="nc" id="L4986">				query = &quot;select name,addr_line1,addr_line2,city,agent_org_id,id,user_name,amount,transaction_type,remarks,transaction_id,transaction_date from  st_lms_organization_master som , (select agent_org_id,id,amount,sbdn.transaction_type,slum.user_name,remarks,sbdn.transaction_id,transaction_date from (select  amount,transaction_type,remarks,transaction_id,agent_org_id from st_lms_bo_debit_note ) sbdn,(select receipt_id as id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id= &quot;</span>
						+receipt_id+
						&quot;) innermost,(select user_id,transaction_id,transaction_date from st_lms_bo_transaction_master )sbtm, (select user_id, user_name from st_lms_user_master)slum where sbdn.transaction_id =innermost.transaction_id and sbtm.transaction_id=innermost.transaction_id and slum.user_id = sbtm.user_id)result1 where som.organization_id=result1.agent_org_id order by transaction_date&quot;;
<span class="nc" id="L4989">				System.out</span>
						.println(&quot;DR_NOTE_CASH queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;
								+ query);
<span class="nc" id="L4992">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/Debit_Note_Cash.jasper&quot;;
<span class="nc" id="L4994">				byteArr = generateReport(query, file, parameterMap, null, null, null,</span>
						null);

<span class="nc bnc" id="L4997" title="All 2 branches missed.">			} else if (receipt_type.equalsIgnoreCase(&quot;CR_NOTE&quot;)) {</span>
<span class="nc bnc" id="L4998" title="All 2 branches missed.">				if (&quot;SALE_RET&quot;.equalsIgnoreCase(trnType)) {</span>
					// query=&quot;select
					// agent_sale_comm_rate,name,addr_line1,addr_line2,city,agent_org_id,id,game_name
					// ,sale,taxable_sale,vat_amt,comm_amt, ticket_price,
					// nbr_of_tickets_per_book
					// ,nbr_of_books,(nbr_of_tickets_per_book*nbr_of_books)as
					// total_tickets, transaction_date from
					// st_lms_organization_master som , (select
					// agent_sale_comm_rate,id,agent_org_id,game_name,ticket_price,nbr_of_tickets_per_book,result.game_id,result.nbr_of_books
					// ,taxable_sale,vat_amt,(net_amt) as
					// sale,comm_amt,transaction_id,transaction_date from
					// st_se_game_master sgm,(select
					// sbat.agent_org_id,game_id,nbr_of_books,mrp_amt
					// ,sbat.transaction_id,id,
					// vat_amt,taxable_sale,net_amt,comm_amt,transaction_date
					// from st_se_bo_agent_transaction sbat, (select receipt_id
					// as id,transaction_id from st_lms_bo_receipts_trn_mapping
					// where receipt_id= '&quot;+receipt_id+&quot;' ) innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master )sbtm where
					// sbat.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id ) result
					// where sgm.game_id = result.game_id )result1 where
					// som.organization_id=result1.agent_org_id&quot;;
<span class="nc" id="L5022">					query = &quot;select agent_sale_comm_rate,name,addr_line1,addr_line2,city,agent_org_id,id,game_name ,sale,taxable_sale,vat_amt,comm_amt, ticket_price, nbr_of_tickets_per_book ,nbr_of_books,(nbr_of_tickets_per_book*nbr_of_books)as total_tickets, transaction_date from  st_lms_organization_master som , (select agent_sale_comm_rate,id,agent_org_id,game_name,ticket_price,nbr_of_tickets_per_book,result.game_id,result.nbr_of_books ,taxable_sale,result.vat_amt,(net_amt) as sale,comm_amt,transaction_id,transaction_date from st_se_game_master sgm,(select sbat.agent_org_id,game_id,nbr_of_books,mrp_amt ,sbat.transaction_id,id, vat_amt,taxable_sale,net_amt,comm_amt,transaction_date from st_se_bo_agent_transaction sbat, (select receipt_id as id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id= '&quot;</span>
							+ receipt_id
							+ &quot;' ) innermost,(select transaction_id,transaction_date from st_lms_bo_transaction_master )sbtm where sbat.transaction_id=innermost.transaction_id and sbtm.transaction_id=innermost.transaction_id ) result where sgm.game_id = result.game_id  )result1 where som.organization_id=result1.agent_org_id order by transaction_date&quot;;
<span class="nc" id="L5025">					System.out</span>
							.println(&quot;CR_NOTE queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;
									+ query);
<span class="nc" id="L5028">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
							+ fileName;
<span class="nc bnc" id="L5031" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L5033">						fileName = &quot;CrdtNtComVat.jasper&quot;;</span>
<span class="nc bnc" id="L5034" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L5036">						fileName = &quot;CrdtNtComNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L5037" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L5039">						fileName = &quot;CrdtNtRdpNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L5040" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L5042">						fileName = &quot;CrdtNtRdpVat.jasper&quot;;</span>
					}
				}
<span class="nc bnc" id="L5045" title="All 2 branches missed.">				if (&quot;LOOSE_SALE_RET&quot;.equalsIgnoreCase(trnType)) {</span>
					
<span class="nc" id="L5047">					query = &quot;select id,game_name,organization_id,transaction_date,nbrOfTickets, net_amt sale, agent_sale_comm_rate,name,addr_line1,addr_line2,city,sale.transaction_id as transaction_id,vat_amt,taxable_sale,ticket_price,comm_amt,agtSaleCommRate from st_lms_organization_master som ,(select agent_id,id,game_name ,agent_sale_comm_rate as agent_sale_comm_rate,nbrOfTickets, ticket_price,taxable_sale,sbs.vat_amt ,net_amt,sbs.transaction_id, btm.transaction_date,comm_amt,agtSaleCommRate from st_se_bo_agent_loose_book_transaction sbs,st_se_game_master game, st_lms_bo_transaction_master btm,(select slbr.party_id as agent_id, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+ receipt_id+ &quot;' )innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id and sbs.game_id=game.game_id)sale where som.organization_id = sale.agent_id&quot;;</span>
<span class="nc" id="L5048">					System.out</span>
							.println(&quot;CR_NOTE queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;
									+ query);
<span class="nc" id="L5051">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
							+ fileName;
<span class="nc bnc" id="L5054" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L5056">						fileName = &quot;looseSaleReturnCrdtNtComVat.jasper&quot;;</span>
<span class="nc bnc" id="L5057" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L5059">						fileName = &quot;looseSaleReturnCrdtNtComNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L5060" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L5062">						fileName = &quot;looseSaleReturnCrdtNtRdpNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L5063" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L5065">						fileName = &quot;looseSaleReturnCrdtNtRdpVat.jasper&quot;;</span>
					}
				}
<span class="nc bnc" id="L5068" title="All 4 branches missed.">				if (&quot;DG_REFUND_CANCEL&quot;.equalsIgnoreCase(trnType)</span>
						|| &quot;DG_REFUND_FAILED&quot;.equalsIgnoreCase(trnType)) {
<span class="nc" id="L5070">					query = &quot;select name,addr_line1,addr_line2,city,game_name ,sale,taxable_sale,vat as vat_amt,agent_comm as comm_amt, transaction_date from st_lms_organization_master som, st_dg_game_master sdgm,(select sbtm.transaction_date, sdbs.agent_org_id as agt_id, game_id, mrp_amt as sale, sdbs.transaction_id, vat_amt as vat, taxable_sale, net_amt, agent_comm from st_dg_bo_sale_refund sdbs,(select receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id='&quot;</span>
							+ receipt_id
							+ &quot;')innermost,(select party_id, transaction_id, transaction_date from st_lms_bo_transaction_master)sbtm where sdbs.transaction_id = innermost.transaction_id and sbtm.transaction_id=innermost.transaction_id and sbtm.party_id = sdbs.agent_org_id)result where result.agt_id = som.organization_id and result.game_id = sdgm.game_id order by transaction_date&quot;;
<span class="nc" id="L5073">					System.out</span>
							.println(&quot;CR_NOTE queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;
									+ query);
<span class="nc" id="L5076">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
							+ fileName;
<span class="nc bnc" id="L5079" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L5081">						fileName = &quot;DGCrdtNtComVat.jasper&quot;;</span>
<span class="nc bnc" id="L5082" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L5084">						fileName = &quot;DGCrdtNtComNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L5085" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L5087">						fileName = &quot;DGCrdtNtRdpNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L5088" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L5090">						fileName = &quot;DGCrdtNtRdpVat.jasper&quot;;</span>
					}
				}
<span class="nc bnc" id="L5093" title="All 4 branches missed.">				if(&quot;CS_CANCEL_SERVER&quot;.equalsIgnoreCase(trnType)</span>
						|| &quot;CS_CANCEL_RET&quot;.equalsIgnoreCase(trnType)){
<span class="nc" id="L5095">					query = &quot;select name,addr_line1,addr_line2,city,product_code,description,sale,vat as vat_amt,comm_amt, transaction_date from st_lms_organization_master som, st_cs_product_master scpm,(select sbtm.transaction_date, sdbs.agent_org_id as agt_id, product_id, mrp_amt as sale, sdbs.transaction_id, vat_amt as vat, net_amt, (mrp_amt*sdbs.agent_comm/100) as comm_amt from st_cs_bo_refund sdbs,(select receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id='&quot;</span>
							+ receipt_id
							+ &quot;')innermost,(select party_id, transaction_id, transaction_date from st_lms_bo_transaction_master)sbtm where sdbs.transaction_id = innermost.transaction_id and sbtm.transaction_id=innermost.transaction_id and sbtm.party_id = sdbs.agent_org_id)result where result.agt_id = som.organization_id and result.product_id = scpm.product_id order by transaction_date&quot;;
<span class="nc" id="L5098">					System.out</span>
							.println(&quot;CS CR_NOTE queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;
									+ query);
<span class="nc" id="L5101">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
							+ fileName;
<span class="nc bnc" id="L5104" title="All 4 branches missed.">					if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L5106">						fileName = &quot;CSCrdtNtComVat.jasper&quot;;</span>
<span class="nc bnc" id="L5107" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L5109">						fileName = &quot;CSCrdtNtComNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L5110" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;no&quot;)) {
<span class="nc" id="L5112">						fileName = &quot;CSCrdtNtRdpNoVat.jasper&quot;;</span>
<span class="nc bnc" id="L5113" title="All 4 branches missed.">					} else if (isCommApplicable.equalsIgnoreCase(&quot;no&quot;)</span>
							&amp;&amp; isVatApplicable.equalsIgnoreCase(&quot;yes&quot;)) {
<span class="nc" id="L5115">						fileName = &quot;CSCrdtNtRdpVat.jasper&quot;;</span>
					}
				
				}
<span class="nc bnc" id="L5119" title="All 2 branches missed.">				if(&quot;OLA_DEPOSIT_REFUND&quot;.equalsIgnoreCase(trnType)){</span>
<span class="nc" id="L5120">					query = &quot;select id,wallet_name,transaction_date,voucher_date,deposit_amt as deposit_refund, net_amt ,(deposit_amt-net_amt) comm_amt,name,addr_line1,addr_line2,city,deposit.transaction_id as transaction_id from st_lms_organization_master som ,(select agent_id,id,wallet_name ,agent_comm as comm_amt, deposit_amt, net_amt,sbs.transaction_id, btm.transaction_date from st_ola_bo_deposit_refund sbs,st_ola_wallet_master wamaster, st_lms_bo_transaction_master btm,(select slbr.party_id as agent_id, slbr.receipt_id as id, transaction_id from st_lms_bo_receipts_trn_mapping slbrtm, st_lms_bo_receipts slbr where slbrtm.receipt_id = slbr.receipt_id and slbr.receipt_id = '&quot;+receipt_id+&quot;')innermost where innermost.transaction_id = sbs.transaction_id and innermost.transaction_id = btm.transaction_id and sbs.wallet_id=wamaster.wallet_id)deposit where som.organization_id = deposit.agent_id&quot;;</span>
<span class="nc" id="L5121">					System.out</span>
							.println(&quot;OLA CR_NOTE queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;
									+ query);
<span class="nc" id="L5124">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
							+ fileName;
					
<span class="nc" id="L5128">						fileName = &quot;OLACrdtNtRdpNoVat.jasper&quot;;</span>
				}
				/*
				 * else{ query=&quot;select
				 * name,addr_line1,addr_line2,city,id,game_name
				 * ,sale,taxable_sale,vat_amt,comm_amt from
				 * st_lms_organization_master som ,(select
				 * id,game_name,result.game_id,taxable_sale,vat_amt,(net_amt) as
				 * sale,comm_amt,transaction_id from st_se_game_master
				 * sgm,(select sdbs.agent_org_id,game_id,mrp_amt
				 * ,sdbs.transaction_id,id,
				 * vat_amt,taxable_sale,net_amt,comm_amt from st_dg_bo_sale
				 * sdbs,(select receipt_id as id,transaction_id from
				 * st_lms_bo_receipts_trn_mapping where receipt_id=
				 * '&quot;+receipt_id+&quot;') innermost,(select
				 * transaction_id,transaction_date from
				 * st_lms_bo_transaction_master )sbtm where
				 * sdbs.transaction_id=innermost.transaction_id and
				 * sbtm.transaction_id=innermost.transaction_id and
				 * agent_org_id='') result where sgm.game_id = result.game_id
				 * )result1 where som.organization_id=result1.agent_org_id&quot;;
				 * System.out.println(&quot;CR_NOTE
				 * queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;+query);file=root_path+
				 * &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;+fileName;
				 * if(isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)&amp;&amp;isVatApplicable.
				 * equalsIgnoreCase(&quot;yes&quot;)){ fileName=&quot;DGCrdtNtComVat.jasper&quot;;
				 * }else
				 * if(isCommApplicable.equalsIgnoreCase(&quot;yes&quot;)&amp;&amp;isVatApplicable
				 * .equalsIgnoreCase(&quot;no&quot;)){ fileName=&quot;DGCrdtNtComNoVat.jasper&quot;;
				 * }else
				 * if(isCommApplicable.equalsIgnoreCase(&quot;no&quot;)&amp;&amp;isVatApplicable
				 * .equalsIgnoreCase(&quot;no&quot;)){ fileName=&quot;DGCrdtNtRdpNoVat.jasper&quot;;
				 * }else
				 * if(isCommApplicable.equalsIgnoreCase(&quot;no&quot;)&amp;&amp;isVatApplicable
				 * .equalsIgnoreCase(&quot;yes&quot;)){ fileName=&quot;DGCrdtNtRdpVat.jasper&quot;;
				 * } }
				 */

<span class="nc" id="L5166">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/&quot;
						+ fileName;
<span class="nc" id="L5169">				byteArr = generateReport(query, file, parameterMap, null, null, null,</span>
						null);
			}

<span class="nc bnc" id="L5173" title="All 2 branches missed.">			else if (receipt_type.equalsIgnoreCase(&quot;CR_NOTE_CASH&quot;)) {</span>
<span class="nc" id="L5174">				System.out</span>
						.println(&quot;================== inside note =================&quot;);
				// query=&quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,transaction_id
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
				// from st_lms_bo_sale_chq sbsc, (select id,transaction_id from
				// st_lms_bo_receipts_trn_mapping where id= '&quot;+receipt_id+&quot;')
				// innermost where
				// sbsc.transaction_id=innermost.transaction_id)result1 where
				// som.organization_id=result1.agent_org_id&quot;;
				// query=&quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,amount,transaction_type,remarks,transaction_id
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,amount,sbdn.transaction_type,remarks,sbdn.transaction_id
				// from (select
				// amount,transaction_type,remarks,transaction_id,agent_org_id
				// from st_lms_bo_debit_note) sbdn,(select id,transaction_id
				// from st_lms_bo_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;') innermost where sbdn.transaction_id
				// =innermost.transaction_id )result1 where
				// som.organization_id=result1.agent_org_id&quot;;
				// query=&quot;select
				// name,addr_line1,addr_line2,city,agent_org_id,id,amount,transaction_type,remarks,transaction_id,transaction_date
				// from st_lms_organization_master som ,(select
				// agent_org_id,id,amount,sbdn.transaction_type,remarks,sbdn.transaction_id,transaction_date
				// from (select
				// amount,transaction_type,remarks,transaction_id,agent_org_id
				// from st_lms_bo_debit_note) sbdn,(select id,transaction_id
				// from st_lms_bo_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;') innermost,(select
				// transaction_id,transaction_date from
				// st_lms_bo_transaction_master)sbtm where sbdn.transaction_id
				// =innermost.transaction_id and
				// sbtm.transaction_id=innermost.transaction_id)result1 where
				// som.organization_id=result1.agent_org_id&quot;;
<span class="nc" id="L5210">				query = &quot;select name,addr_line1,addr_line2,city,agent_org_id,id,amount,transaction_type,remarks,user_name,transaction_id,transaction_date from  st_lms_organization_master som , (select agent_org_id,id,slum.user_name,amount,sbdn.transaction_type,remarks,sbdn.transaction_id,transaction_date from (select  amount,transaction_type,remarks,transaction_id,agent_org_id from st_lms_bo_credit_note ) sbdn,(select receipt_id as id,transaction_id from st_lms_bo_receipts_trn_mapping where receipt_id= &quot;</span>
						+receipt_id+
						&quot;) innermost,(select user_id, transaction_id,transaction_date from st_lms_bo_transaction_master )sbtm, (select user_name, user_id from st_lms_user_master) slum where sbdn.transaction_id =innermost.transaction_id and sbtm.transaction_id=innermost.transaction_id and slum.user_id = sbtm.user_id)result1 where som.organization_id=result1.agent_org_id order by transaction_date&quot;;
<span class="nc" id="L5213">				System.out</span>
						.println(&quot;CR_NOTE_CASH queryyyyyyyyyyyyyyyyyyyBOOOOOOOOO&quot;
								+ query);
<span class="nc" id="L5216">				file = root_path</span>
						+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/Credit_Note_Cash.jasper&quot;;
<span class="nc" id="L5218">				byteArr = generateReport(query, file, parameterMap, null, null, null,</span>
						null);

<span class="nc bnc" id="L5221" title="All 2 branches missed.">			} else if (receipt_type.equalsIgnoreCase(&quot;GOVT_RCPT&quot;)) {</span>
<span class="nc" id="L5222">				vatPartyName = (String) ServletActionContext</span>
						.getServletContext().getAttribute(&quot;VAT_PARTY_NAME&quot;);
<span class="nc" id="L5224">				tdsPartyName = (String) ServletActionContext</span>
						.getServletContext().getAttribute(&quot;TDS_PARTY_NAME&quot;);
<span class="nc" id="L5226">				govComPartyName = (String) ServletActionContext</span>
						.getServletContext().getAttribute(
								&quot;GOVT_COMM_PARTY_NAME&quot;);
<span class="nc" id="L5229">				parameterMap.put(&quot;vatPartyName&quot;, vatPartyName);</span>
<span class="nc" id="L5230">				parameterMap.put(&quot;tdsPartyName&quot;, tdsPartyName);</span>
<span class="nc" id="L5231">				parameterMap.put(&quot;govComPartyName&quot;, govComPartyName);</span>
<span class="nc" id="L5232">				System.out</span>
						.println(&quot;================== inside GOVT_RCPT =================&quot;
								+ trnType);
				// query=&quot;select
				// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,net_amount
				// ,comm_amount from st_lms_organization_master som ,(select
				// 'cash' t_type,cash_agent as agent,cash_amount as amount
				// ,cash_amount as net_amount ,0.00 comm_amount ,cash_trans_id
				// as trans_id, 'cash' issuing_party_name,'cash'
				// cheque_nbr,'cash' cheque_date, 'cash' drawee_bank,cash_id as
				// id from ( select id as cash_id,sbct.agent_org_id as
				// cash_agent,sbct.amount as cash_amount ,sbct.transaction_id as
				// cash_trans_id from st_lms_bo_cash_transaction sbct, (select
				// id,transaction_id from st_lms_bo_receipts_trn_mapping where
				// id= '&quot;+receipt_id+&quot;') innermost where
				// sbct.transaction_id=innermost.transaction_id) cash union
				// select 'pwt' t_type,pwt_agent as agent,pwt_amount as
				// amount,net_amount ,comm_amount ,pwt_trans_id as
				// trans_id,'pwt' issuing_party_name,'pwt' cheque_nbr, 'pwt'
				// cheque_date, 'pwt' drawee_bank , pwt_id as id from (select id
				// as pwt_id,sbp.agent_org_id as pwt_agent,sum(sbp.pwt_amt) as
				// pwt_amount,sum(sbp.net_amt)as net_amount ,sum(sbp.comm_amt)as
				// comm_amount,sbp.transaction_id as pwt_trans_id from
				// st_se_bo_pwt sbp, (select id,transaction_id from
				// st_lms_bo_receipts_trn_mapping where id= '&quot;+receipt_id+&quot;')
				// innermost where sbp.transaction_id=innermost.transaction_id
				// group by sbp.transaction_id) pwt union select 'cheque'
				// t_type,cheque_agent as agent,cheque_amt as amount,cheque_amt
				// as net_amount ,0.00 comm_amount,cheque_id as
				// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id
				// from ( select id ,agent_org_id as
				// cheque_agent,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
				// as cheque_id from st_lms_bo_sale_chq sbsc, (select
				// id,transaction_id from st_lms_bo_receipts_trn_mapping where
				// id= '&quot;+receipt_id+&quot;') innermost where
				// sbsc.transaction_id=innermost.transaction_id) cheque) result
				// where result.agent = som.organization_id&quot;;
				// query=&quot;select
				// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,net_amount
				// ,comm_amount,transaction_date from st_lms_organization_master
				// som ,(select 'cash' t_type,cash_agent as agent,cash_amount as
				// amount ,cash_amount as net_amount ,0.00 comm_amount
				// ,cash_trans_id as trans_id,'cash' issuing_party_name,'cash'
				// cheque_nbr,'cash' cheque_date, 'cash' drawee_bank,cash_id as
				// id,transaction_date from ( select id as
				// cash_id,sbct.agent_org_id as cash_agent,sbct.amount as
				// cash_amount , sbct.transaction_id as
				// cash_trans_id,transaction_date from
				// st_lms_bo_cash_transaction sbct, (select id,transaction_id
				// from st_lms_bo_receipts_trn_mapping where id=
				// '&quot;+receipt_id+&quot;') innermost, (select
				// transaction_id,transaction_date from
				// st_lms_bo_transaction_master)sbtm where
				// sbct.transaction_id=innermost.transaction_id and
				// sbtm.transaction_id=innermost.transaction_id ) cash union
				// select 'pwt' t_type,pwt_agent as agent,pwt_amount as
				// amount,net_amount ,comm_amount ,pwt_trans_id as
				// trans_id,'pwt' issuing_party_name,'pwt' cheque_nbr,'pwt'
				// cheque_date, 'pwt' drawee_bank , pwt_id as
				// id,transaction_date from (select id as
				// pwt_id,sbp.agent_org_id as pwt_agent,sum(sbp.pwt_amt) as
				// pwt_amount,sum(sbp.net_amt)as net_amount ,sum(sbp.comm_amt)as
				// comm_amount,sbp.transaction_id as
				// pwt_trans_id,transaction_date from st_se_bo_pwt sbp, (select
				// id,transaction_id from st_lms_bo_receipts_trn_mapping where
				// id= '&quot;+receipt_id+&quot;') innermost,(select
				// transaction_id,transaction_date from
				// st_lms_bo_transaction_master)sbtm where
				// sbp.transaction_id=innermost.transaction_id and
				// sbtm.transaction_id=innermost.transaction_id group by
				// sbp.transaction_id) pwt union select 'cheque'
				// t_type,cheque_agent as agent,cheque_amt as amount,cheque_amt
				// as net_amount,0.00 comm_amount,cheque_id as
				// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id,transaction_date
				// from (select id ,agent_org_id as
				// cheque_agent,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
				// as cheque_id,transaction_date from st_lms_bo_sale_chq sbsc,
				// (select id,transaction_id from st_lms_bo_receipts_trn_mapping
				// where id= '&quot;+receipt_id+&quot;') innermost,(select
				// transaction_id,transaction_date from
				// st_lms_bo_transaction_master)sbtm where
				// sbsc.transaction_id=innermost.transaction_id and
				// sbtm.transaction_id=innermost.transaction_id) cheque) result
				// where result.agent = som.organization_id&quot;;
<span class="nc bnc" id="L5316" title="All 2 branches missed.">				if (trnType.equalsIgnoreCase(&quot;VAT&quot;)) {</span>
					// query=&quot; select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,transaction_date,temp_receipt_id
					// from st_lms_organization_master som ,(select 'cheque'
					// t_type,cheque_agent as agent,cheque_amt as
					// amount,cheque_amt as net_amount,cheque_id as
					// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id,transaction_date,temp_receipt_id
					// from (select id ,sbsc.agent_org_id as
					// cheque_agent,sbsc.issuing_party_name,sbsc.cheque_nbr,sbsc.cheque_date,sbsc.drawee_bank,sbsc.cheque_amt,sbsc.transaction_id
					// as cheque_id,transaction_date,temp_receipt_id from
					// st_lms_bo_sale_chq sbsc,st_lms_bo_cheque_temp_receipt
					// sbctr,(select id,transaction_id from
					// st_lms_bo_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master )sbtm where
					// sbsc.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id and
					// sbctr.cheque_nbr=sbsc.cheque_nbr ) cheque ) result where
					// result.agent = som.organization_id&quot;;
					// query=&quot;select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,transaction_date
					// from st_lms_organization_master som ,(select 'cheque'
					// t_type,cheque_agent as agent,cheque_amt as
					// amount,cheque_amt as net_amount,cheque_id as
					// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id,transaction_date
					// from (select id ,sbsc.agent_org_id as
					// cheque_agent,sbsc.issuing_party_name,sbsc.cheque_nbr,sbsc.cheque_date,sbsc.drawee_bank,sbsc.cheque_amt,sbsc.transaction_id
					// as cheque_id,transaction_date from st_lms_bo_sale_chq
					// sbsc,(select id,transaction_id from
					// st_lms_bo_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master )sbtm where
					// sbsc.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id ) cheque )
					// result where result.agent = som.organization_id&quot;;
<span class="nc" id="L5353">					query = &quot;select generated_id,sbrtm.transaction_id,amount,start_date,end_date, transaction_date, sbr.voucher_date,'VAT Paid' as remarks from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_receipts sbr,st_lms_bo_govt_transaction sbgt ,st_lms_bo_transaction_master sbtm where sbr.receipt_id='&quot;</span>
							+ receipt_id
							+ &quot;' and sbrtm.receipt_id=sbr.receipt_id and sbgt.transaction_id=sbrtm.transaction_id and sbtm.transaction_id=sbrtm.transaction_id order by transaction_date&quot;;
<span class="nc" id="L5356">					System.out</span>
							.println(&quot; RECEIPT VAT queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L5359">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/VAT.jasper&quot;;
<span class="nc bnc" id="L5361" title="All 2 branches missed.">				} else if (trnType.equalsIgnoreCase(&quot;TDS&quot;)) {</span>
					// query=&quot;select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,amount,transaction_date
					// from st_lms_organization_master som ,(select 'cash'
					// t_type,cash_agent as agent,cash_amount as amount
					// ,cash_trans_id as trans_id,cash_id as id,transaction_date
					// from ( select id as cash_id,sbct.agent_org_id as
					// cash_agent,sbct.amount as cash_amount ,
					// sbct.transaction_id as cash_trans_id,transaction_date
					// from st_lms_bo_cash_transaction sbct,(select
					// id,transaction_id from st_lms_bo_receipts_trn_mapping
					// where id= '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master )sbtm where
					// sbct.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id )
					// cash)result where result.agent = som.organization_id&quot;;
					// query=&quot;select
					// generated_id,sbrtm.transaction_id,amount,sbgt.start_date,sbgt.end_date,
					// sbtm.transaction_date, 'TDS Paid' as
					// remarks,sdpp.transaction_date as plr_date
					// ,sdpp.player_id,
					// first_name,last_name,photo_id_type,photo_id_nbr,sdpp.tax_amt,sdpp.pwt_amt
					// from st_lms_bo_receipts_trn_mapping
					// sbrtm,st_lms_bo_receipts sbr,st_lms_bo_govt_transaction
					// sbgt ,st_lms_bo_transaction_master
					// sbtm,st_se_direct_player_pwt sdpp,st_lms_player_master
					// spm where sbr.receipt_id='&quot;+receipt_id+&quot;' and
					// sbrtm.receipt_id=sbr.receipt_id and
					// sbgt.transaction_id=sbrtm.transaction_id and
					// sbtm.transaction_id=sbrtm.transaction_id and
					// sdpp.transaction_date &gt;= start_date and
					// sdpp.transaction_date &lt;=end_date and
					// sdpp.player_id=spm.player_id&quot;;
<span class="nc" id="L5395">					statement = connection.createStatement();</span>
<span class="nc" id="L5396">					set = statement</span>
							.executeQuery(&quot;select player_id  from   st_se_direct_player_pwt&quot;);
<span class="nc" id="L5398">					System.out.println(set.absolute(1));</span>
<span class="nc bnc" id="L5399" title="All 2 branches missed.">					if (set.absolute(1)) {</span>
<span class="nc" id="L5400">						query = &quot;select distinct(generated_id),sbrtm.transaction_id,amount,sbgt.start_date,sbgt.end_date, sbtm.transaction_date, sbr.voucher_date, '&quot;</span>
								+ textForTax
								+ &quot; Paid' as remarks,sdpp.player_id, first_name,last_name,photo_id_type,photo_id_nbr,sdpp.tax_amt,sdpp.pwt_amt from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_receipts sbr,st_lms_bo_govt_transaction sbgt ,st_lms_bo_transaction_master sbtm,st_se_direct_player_pwt sdpp,st_lms_player_master spm where sbr.receipt_id='&quot;
								+ receipt_id
								+ &quot;' and sbrtm.receipt_id=sbr.receipt_id and sbgt.transaction_id=sbrtm.transaction_id and sbtm.transaction_id=sbrtm.transaction_id and sdpp.transaction_date &gt;= start_date and sdpp.transaction_date &lt;=end_date and sdpp.player_id=spm.player_id union select distinct(generated_id),sbrtm.transaction_id,amount,sbgt.start_date,sbgt.end_date, sbtm.transaction_date, '&quot;
								+ textForTax
								+ &quot; Paid' as remarks, 'NA' player_id, 'NA'first_name,'NA' last_name,'NA' photo_id_type,'NA' photo_id_nbr,'NA' tax_amt,'NA' pwt_amt from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_receipts sbr,st_lms_bo_govt_transaction sbgt ,st_lms_bo_transaction_master sbtm,st_lms_player_master spm where sbr.receipt_id='&quot;
								+ receipt_id
								+ &quot;' and sbrtm.receipt_id=sbr.receipt_id and sbgt.transaction_id=sbrtm.transaction_id and sbtm.transaction_id=sbrtm.transaction_id order by sbtm.transaction_date&quot;;
					} else {
<span class="nc" id="L5410">						query = &quot;select distinct(generated_id),sbrtm.transaction_id,amount,sbgt.start_date,sbgt.end_date, sbtm.transaction_date, sbr.voucher_date, '&quot;</span>
								+ textForTax
								+ &quot; Paid' as remarks, 'NA' player_id, 'NA'first_name,'NA' last_name,'NA' photo_id_type,'NA' photo_id_nbr,'NA' tax_amt,'NA' pwt_amt from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_receipts sbr,st_lms_bo_govt_transaction sbgt ,st_lms_bo_transaction_master sbtm where sbr.receipt_id='&quot;
								+ receipt_id
								+ &quot;' and sbrtm.receipt_id=sbr.receipt_id and sbgt.transaction_id=sbrtm.transaction_id and sbtm.transaction_id=sbrtm.transaction_id order by sbtm.transaction_date&quot;;
					}
<span class="nc" id="L5416">					System.out</span>
							.println(&quot; RECEIPT TDS queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L5419">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/TDS.jasper&quot;;
<span class="nc bnc" id="L5421" title="All 2 branches missed.">				} else if (trnType.equalsIgnoreCase(&quot;GOVT_COMM&quot;)) {</span>
					// query=&quot;select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,amount,net_amount
					// ,comm_amount,transaction_date,game_nbr,game_name from
					// st_lms_organization_master som ,(select 'pwt'
					// t_type,pwt_agent as agent,pwt_amount as amount,net_amount
					// ,comm_amount ,pwt_trans_id as trans_id, pwt_id as
					// id,transaction_date,game_nbr,game_name from (select id as
					// pwt_id,sbp.agent_org_id as pwt_agent,sum(sbp.pwt_amt) as
					// pwt_amount,sum(sbp.net_amt)as net_amount
					// ,sum(sbp.comm_amt)as comm_amount,sbp.transaction_id as
					// pwt_trans_id,transaction_date,sbp.game_id,game_nbr,game_name
					// from st_se_bo_pwt sbp,(select game_nbr,game_id,game_name
					// from st_se_game_master )sgm,(select id,transaction_id
					// from st_lms_bo_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master )sbtm where
					// sbp.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id and
					// sbp.game_id=sgm.game_id group by sbp.transaction_id )
					// pwt)result where result.agent = som.organization_id&quot;;
					// &quot;select
					// name,addr_line1,addr_line2,city,t_type,agent,trans_id,id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,amount,net_amount
					// ,comm_amount,transaction_date,game_nbr from
					// st_lms_organization_master som , (select 'cash'
					// t_type,cash_agent as agent,cash_amount as amount
					// ,cash_amount as net_amount ,0.00 comm_amount
					// ,cash_trans_id as trans_id,'cash'
					// issuing_party_name,'cash' cheque_nbr,'cash' cheque_date,
					// 'cash' drawee_bank,cash_id as id,transaction_date,'cash'
					// game_nbr from ( select id as cash_id,sbct.agent_org_id as
					// cash_agent,sbct.amount as cash_amount ,
					// sbct.transaction_id as cash_trans_id,transaction_date
					// from st_lms_bo_cash_transaction sbct, (select
					// id,transaction_id from st_lms_bo_receipts_trn_mapping
					// where id= '&quot;+receipt_id+&quot;') innermost, (select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master)sbtm where
					// sbct.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id ) cash union
					// select 'pwt' t_type,pwt_agent as agent,pwt_amount as
					// amount,net_amount ,comm_amount ,pwt_trans_id as
					// trans_id,'pwt' issuing_party_name,'pwt' cheque_nbr,'pwt'
					// cheque_date, 'pwt' drawee_bank , pwt_id as
					// id,transaction_date,game_nbr from (select id as
					// pwt_id,sbp.agent_org_id as pwt_agent,sum(sbp.pwt_amt) as
					// pwt_amount,sum(sbp.net_amt)as net_amount
					// ,sum(sbp.comm_amt)as comm_amount,sbp.transaction_id as
					// pwt_trans_id,transaction_date,sbp.game_id,game_nbr from
					// st_se_bo_pwt sbp,(select game_nbr,game_id from
					// st_se_game_master )sgm, (select id,transaction_id from
					// st_lms_bo_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master)sbtm where
					// sbp.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id and
					// sbp.game_id=sgm.game_id group by sbp.transaction_id) pwt
					// union select 'cheque' t_type,cheque_agent as
					// agent,cheque_amt as amount,cheque_amt as net_amount,0.00
					// comm_amount,cheque_id as
					// trans_id,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,id,transaction_date
					// , 'cheque' game_nbr from (select id ,agent_org_id as
					// cheque_agent,issuing_party_name,cheque_nbr,cheque_date,drawee_bank,cheque_amt,sbsc.transaction_id
					// as cheque_id,transaction_date from st_lms_bo_sale_chq
					// sbsc, (select id,transaction_id from
					// st_lms_bo_receipts_trn_mapping where id=
					// '&quot;+receipt_id+&quot;') innermost,(select
					// transaction_id,transaction_date from
					// st_lms_bo_transaction_master)sbtm where
					// sbsc.transaction_id=innermost.transaction_id and
					// sbtm.transaction_id=innermost.transaction_id) cheque)
					// result where result.agent = som.organization_id&quot;;
<span class="nc" id="L5495">					String serviceCode = checkServiceCode(receipt_id);</span>
<span class="nc bnc" id="L5496" title="All 2 branches missed.">					if (serviceCode.equalsIgnoreCase(&quot;se&quot;)) {</span>
<span class="nc" id="L5497">						query = &quot;select generated_id,sbrtm.transaction_id,amount,sbgt.start_date,sbgt.end_date, transaction_date, sbr.voucher_date, sbtm.transaction_type, 'Good Cause' as remarks,sbgt.game_id,game_name,game_nbr from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_receipts sbr,st_lms_bo_govt_transaction sbgt ,st_lms_bo_transaction_master sbtm,st_se_game_master sgm where sbr.receipt_id='&quot;</span>
								+ receipt_id
								+ &quot;' and sbrtm.receipt_id=sbr.receipt_id and sbgt.transaction_id=sbrtm.transaction_id and sbtm.transaction_id=sbrtm.transaction_id and sgm.game_id=sbgt.game_id order by transaction_date&quot;;
<span class="nc bnc" id="L5500" title="All 2 branches missed.">					} else if (serviceCode.equalsIgnoreCase(&quot;dg&quot;)) {</span>
<span class="nc" id="L5501">						query = &quot;select generated_id,sbrtm.transaction_id,amount,sbgt.start_date,sbgt.end_date, transaction_date, sbr.voucher_date, sbtm.transaction_type, 'Good Cause' as remarks,sbgt.game_id,game_name,game_nbr from st_lms_bo_receipts_trn_mapping sbrtm,st_lms_bo_receipts sbr,st_lms_bo_govt_transaction sbgt ,st_lms_bo_transaction_master sbtm,st_dg_game_master sgm where sbr.receipt_id='&quot;</span>
								+ receipt_id
								+ &quot;' and sbrtm.receipt_id=sbr.receipt_id and sbgt.transaction_id=sbrtm.transaction_id and sbtm.transaction_id=sbrtm.transaction_id and sgm.game_id=sbgt.game_id order by transaction_date&quot;;
					}
<span class="nc" id="L5505">					System.out</span>
							.println(&quot; GOVT_COMM queryyyyyyyyyyyyyyyy BOOOOO &quot;
									+ query);
<span class="nc" id="L5508">					file = root_path</span>
							+ &quot;com/skilrock/lms/web/reportsMgmt/compiledReports/GovtComm.jasper&quot;;
				}
<span class="nc" id="L5511">				byteArr = generateReport(query, file, parameterMap, null, null);</span>

			}

<span class="nc" id="L5515">			System.out.println(&quot;Query -- &quot; + query);</span>
<span class="nc" id="L5516">		} catch (SQLException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L5518">			e.printStackTrace();</span>
<span class="nc" id="L5519">		} catch (Exception e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L5521">			e.printStackTrace();</span>
		} finally {
<span class="nc" id="L5523">			try {</span>

<span class="nc" id="L5525">				System.out.println(&quot; closing connection  &quot;);</span>
<span class="nc bnc" id="L5526" title="All 8 branches missed.">				if (connection != null) {</span>
<span class="nc" id="L5527">					connection.close();</span>
				}
<span class="nc" id="L5529">			} catch (SQLException e) {</span>
				// TODO Auto-generated catch block
<span class="nc" id="L5531">				e.printStackTrace();</span>
<span class="nc" id="L5532">			}</span>

<span class="nc" id="L5534">		}</span>
<span class="nc" id="L5535">		return byteArr;</span>

	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>