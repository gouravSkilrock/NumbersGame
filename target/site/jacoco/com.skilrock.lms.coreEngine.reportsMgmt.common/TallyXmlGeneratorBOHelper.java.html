<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TallyXmlGeneratorBOHelper.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">lms</a> &gt; <a href="index.source.html" class="el_package">com.skilrock.lms.coreEngine.reportsMgmt.common</a> &gt; <span class="el_source">TallyXmlGeneratorBOHelper.java</span></div><h1>TallyXmlGeneratorBOHelper.java</h1><pre class="source lang-java linenums">package com.skilrock.lms.coreEngine.reportsMgmt.common;

import java.io.BufferedInputStream;
import java.io.BufferedOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileWriter;
import java.io.IOException;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.sql.Timestamp;
import java.text.NumberFormat;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.ListIterator;
import java.util.Map;
import java.util.zip.ZipEntry;
import java.util.zip.ZipOutputStream;

import javax.mail.MessagingException;

import org.jdom.Document;
import org.jdom.Element;
import org.jdom.Namespace;
import org.jdom.output.Format;
import org.jdom.output.XMLOutputter;

import com.skilrock.lms.common.db.DBConnect;

<span class="nc" id="L37">public class TallyXmlGeneratorBOHelper {</span>
	static final int BUFFER = 10048;

	public static void main(String[] args) {
		try {
<span class="nc" id="L42">			FileWriter fileWriter = new FileWriter(new File(&quot;d:/XXXXXXXX.xml&quot;));</span>
<span class="nc" id="L43">			XMLOutputter outputter = new XMLOutputter(Format.getPrettyFormat());</span>
<span class="nc" id="L44">			Document myDocument = new Document(new Element(&quot;Vineeetttttt&quot;));</span>
<span class="nc" id="L45">			new Element(&quot;Vineeetttttt&quot;).addContent(new Element(&quot;wqwqw&quot;));</span>
<span class="nc" id="L46">			new Element(&quot;wqwqw&quot;).addContent(new Element(&quot;fsdf&quot;));</span>
<span class="nc" id="L47">			new Element(&quot;fsdf&quot;).addContent(new Element(&quot;wqwqgw&quot;));</span>
<span class="nc" id="L48">			new Element(&quot;wqwqgw&quot;).addContent(new Element(&quot;fsdf3&quot;));</span>
<span class="nc" id="L49">			new Element(&quot;fsdf3&quot;).addContent(new Element(&quot;wqwq1w&quot;));</span>
<span class="nc" id="L50">			new Element(&quot;wqwq1w&quot;).addContent(new Element(&quot;fsd1f&quot;));</span>

<span class="nc" id="L52">			Document myDocument1 = new Document(new Element(&quot;ANANT&quot;));</span>
<span class="nc" id="L53">			Document myDocument2 = new Document(new Element(&quot;GAURavvvvvvvvv&quot;));</span>
<span class="nc" id="L54">			outputter.output(myDocument2, fileWriter);</span>

			// outputter.output(myDocument, fileWriter.toString());

<span class="nc" id="L58">			System.out</span>
					.println(new File(&quot;d:/C.xml&quot;).length() + &quot;Doneeeeeeeeeee&quot;);

<span class="nc" id="L61">		} catch (IOException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L63">			e.printStackTrace();</span>
<span class="nc" id="L64">		}</span>
<span class="nc" id="L65">	}</span>

<span class="nc" id="L67">	String destination = null;</span>

	String sourceFile;

	public Map&lt;String, Timestamp&gt; getDuration(Timestamp fromDate,
			Timestamp toDate, String voucherType) {

<span class="nc" id="L74">		Connection connection = null;</span>

<span class="nc" id="L76">		connection = DBConnect.getConnection();</span>
<span class="nc" id="L77">		Statement stmt = null;</span>
<span class="nc" id="L78">		PreparedStatement prepstmt = null;</span>
<span class="nc" id="L79">		ResultSet rs = null;</span>
<span class="nc" id="L80">		Timestamp frDate = null;</span>
<span class="nc" id="L81">		Timestamp tDate = null;</span>
<span class="nc" id="L82">		Timestamp startDate = null;</span>
<span class="nc" id="L83">		String vouchType = null;</span>
<span class="nc" id="L84">		Boolean repeat = false;</span>
<span class="nc" id="L85">		Map&lt;String, Timestamp&gt; map = new HashMap&lt;String, Timestamp&gt;();</span>
		try {
<span class="nc" id="L87">			stmt = connection.createStatement();</span>

<span class="nc" id="L89">			rs = stmt</span>
					.executeQuery(&quot;select from_date,to_date,start_date from st_bo_xml_period where voucher_type='&quot;
							+ voucherType + &quot;'&quot;);
<span class="nc bnc" id="L92" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L93">				frDate = rs.getTimestamp(&quot;from_date&quot;);</span>
<span class="nc" id="L94">				tDate = rs.getTimestamp(&quot;to_date&quot;);</span>
<span class="nc" id="L95">				startDate = rs.getTimestamp(&quot;start_date&quot;);</span>
			}
<span class="nc bnc" id="L97" title="All 2 branches missed.">			if (frDate != null) {</span>
<span class="nc bnc" id="L98" title="All 2 branches missed.">				if (fromDate.equals(frDate)) {</span>
<span class="nc bnc" id="L99" title="All 2 branches missed.">					if (tDate.after(toDate)) {</span>
<span class="nc" id="L100">						map.put(&quot;fromDate&quot;, fromDate);</span>
<span class="nc" id="L101">						map.put(&quot;toDate&quot;, tDate);</span>
<span class="nc" id="L102">						map.put(&quot;startDate&quot;, startDate);</span>
						// updateDuration(fromDate,tDate,voucherType);
					} else {
<span class="nc" id="L105">						map.put(&quot;fromDate&quot;, fromDate);</span>
<span class="nc" id="L106">						map.put(&quot;toDate&quot;, toDate);</span>
<span class="nc" id="L107">						map.put(&quot;startDate&quot;, startDate);</span>
						// updateDuration(fromDate,toDate,voucherType);
					}
					// updateDuration(fromTimeStamp,dt,getTallyAccount());

<span class="nc bnc" id="L112" title="All 2 branches missed.">				} else if (fromDate.after(frDate)) {</span>
<span class="nc bnc" id="L113" title="All 2 branches missed.">					if (toDate.before(tDate)) {</span>
<span class="nc" id="L114">						map.put(&quot;fromDate&quot;, frDate);</span>
<span class="nc" id="L115">						map.put(&quot;toDate&quot;, tDate);</span>
<span class="nc" id="L116">						map.put(&quot;startDate&quot;, startDate);</span>
					} else {
<span class="nc" id="L118">						map.put(&quot;fromDate&quot;, frDate);</span>
<span class="nc" id="L119">						map.put(&quot;toDate&quot;, toDate);</span>
<span class="nc" id="L120">						map.put(&quot;startDate&quot;, startDate);</span>
					}

<span class="nc bnc" id="L123" title="All 2 branches missed.">				} else if (fromDate.before(frDate)) {</span>
<span class="nc bnc" id="L124" title="All 2 branches missed.">					if (toDate.before(tDate)) {</span>
<span class="nc" id="L125">						map.put(&quot;fromDate&quot;, fromDate);</span>
<span class="nc" id="L126">						map.put(&quot;toDate&quot;, tDate);</span>
<span class="nc" id="L127">						map.put(&quot;startDate&quot;, startDate);</span>
					} else {
<span class="nc" id="L129">						map.put(&quot;fromDate&quot;, fromDate);</span>
<span class="nc" id="L130">						map.put(&quot;toDate&quot;, toDate);</span>
<span class="nc" id="L131">						map.put(&quot;startDate&quot;, startDate);</span>
					}

				}
<span class="nc" id="L135">				System.out.println(&quot;st_bo_xml_period is not Empty  fromDate : &quot;</span>
						+ frDate + &quot; tDate &quot; + tDate);
			} else {
<span class="nc" id="L138">				prepstmt = connection</span>
						.prepareStatement(&quot;insert into   st_bo_xml_period (from_date,to_date,voucher_type,start_date) values(?,?,?,?)&quot;);
<span class="nc" id="L140">				prepstmt.setTimestamp(1, fromDate);</span>
<span class="nc" id="L141">				prepstmt.setTimestamp(2, toDate);</span>
<span class="nc" id="L142">				prepstmt.setString(3, voucherType);</span>
<span class="nc" id="L143">				prepstmt.setTimestamp(4, fromDate);</span>
<span class="nc" id="L144">				prepstmt.execute();</span>
<span class="nc" id="L145">				map.put(&quot;fromDate&quot;, fromDate);</span>
<span class="nc" id="L146">				map.put(&quot;toDate&quot;, toDate);</span>
<span class="nc" id="L147">				map.put(&quot;startDate&quot;, fromDate);</span>
<span class="nc" id="L148">				System.out.println(&quot;st_bo_xml_period is  Empty  fromDate : &quot;</span>
						+ fromDate + &quot; toDate &quot; + toDate);
			}

<span class="nc" id="L152">		} catch (SQLException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L154">			e.printStackTrace();</span>
		} finally {
<span class="nc bnc" id="L156" title="All 6 branches missed.">			if (connection != null) {</span>
				try {
<span class="nc" id="L158">					connection.close();</span>
<span class="nc" id="L159">				} catch (SQLException e) {</span>
					// TODO Auto-generated catch block
<span class="nc" id="L161">					e.printStackTrace();</span>
<span class="nc" id="L162">				}</span>
			}
		}

<span class="nc" id="L166">		return map;</span>

	}

	private String getNarration(long transactionId, Connection connection,
			String transactionType) {
		try {
<span class="nc" id="L173">			String sqlQuery = null;</span>
<span class="nc" id="L174">			Statement statement = null;</span>
<span class="nc" id="L175">			ResultSet resultSet = null;</span>
<span class="nc" id="L176">			String chqNum = null;</span>
<span class="nc" id="L177">			String bankName = null;</span>
<span class="nc" id="L178">			String partyName = null;</span>
<span class="nc" id="L179">			String remarks = null;</span>
<span class="nc bnc" id="L180" title="All 2 branches missed.">			if (transactionType.equalsIgnoreCase(&quot;CHQ_BOUNCE&quot;)) {</span>
<span class="nc" id="L181">				sqlQuery = &quot;select cheque_nbr,drawee_bank,issuing_party_name from st_lms_bo_sale_chq where transaction_id='&quot;</span>
						+ transactionId + &quot;'&quot;;
			} else {
<span class="nc" id="L184">				sqlQuery = &quot;select remarks from st_lms_bo_debit_note where transaction_id='&quot;</span>
						+ transactionId + &quot;'&quot;;
			}

<span class="nc" id="L188">			statement = connection.createStatement();</span>
<span class="nc" id="L189">			resultSet = statement.executeQuery(sqlQuery);</span>
<span class="nc bnc" id="L190" title="All 2 branches missed.">			if (transactionType.equalsIgnoreCase(&quot;CHQ_BOUNCE&quot;)) {</span>
<span class="nc bnc" id="L191" title="All 2 branches missed.">				while (resultSet.next()) {</span>
<span class="nc" id="L192">					chqNum = resultSet.getString(&quot;cheque_nbr&quot;);</span>
<span class="nc" id="L193">					bankName = resultSet.getString(&quot;drawee_bank&quot;);</span>
<span class="nc" id="L194">					partyName = resultSet.getString(&quot;issuing_party_name&quot;);</span>
				}
<span class="nc" id="L196">				remarks = &quot;Cheque No: &quot; + chqNum + &quot; bounced.  bank: &quot;</span>
						+ bankName + &quot; issued by: &quot; + partyName;
<span class="nc" id="L198">				System.out.println(&quot;reamrks 1 &quot; + remarks);</span>
<span class="nc" id="L199">				return remarks;</span>
			} else {
<span class="nc bnc" id="L201" title="All 2 branches missed.">				while (resultSet.next()) {</span>
<span class="nc" id="L202">					remarks = resultSet.getString(&quot;remarks&quot;);</span>
				}
<span class="nc" id="L204">				System.out.println(&quot;reamrks 2 &quot; + remarks);</span>
<span class="nc" id="L205">				return remarks;</span>
			}
<span class="nc" id="L207">		} catch (SQLException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L209">			e.printStackTrace();</span>
		}
<span class="nc" id="L211">		return null;</span>
	}

	public Element getTallyVouchElements(String tallyAccount,
			Timestamp fromTimeStamp, Timestamp dt, Connection connection,
			String voucherType, String partyLedger, Element reqDataElement,
			String tallyVersion) {
<span class="nc" id="L218">		Statement statement = null;</span>
<span class="nc" id="L219">		ResultSet rs = null;</span>
<span class="nc" id="L220">		String transactionType = null;</span>
<span class="nc" id="L221">		String accountType = null;</span>
<span class="nc" id="L222">		double amount = 0.0;</span>
<span class="nc" id="L223">		double sumAmount = 0.0;</span>
<span class="nc" id="L224">		long transactionId = 0;</span>
<span class="nc" id="L225">		String transationWith = null;</span>
<span class="nc" id="L226">		Timestamp timestamp = null;</span>
<span class="nc" id="L227">		String DateString = null;</span>

<span class="nc" id="L229">		String string = &quot;select transaction_type,transaction_id,account_type,balance,amount,transaction_date,transaction_with from st_lms_bo_ledger where  transaction_date &gt;= '&quot;</span>
				+ fromTimeStamp + &quot;'and transaction_date&lt;='&quot; + dt + &quot;'&quot;;
<span class="nc" id="L231">		String ledgerName = &quot;&quot;;</span>
<span class="nc" id="L232">		List&lt;Double&gt; list = new ArrayList&lt;Double&gt;();</span>
<span class="nc" id="L233">		List&lt;String&gt; nameList = new ArrayList&lt;String&gt;();</span>
<span class="nc" id="L234">		ListIterator iterator = null;</span>
<span class="nc" id="L235">		SimpleDateFormat dateFormat = new SimpleDateFormat(&quot;yyyyMMdd&quot;);</span>
<span class="nc" id="L236">		Element tallyVouchElement = null;</span>
<span class="nc" id="L237">		String narration = null;</span>
		// /

		// /
		try {

<span class="nc" id="L243">			statement = connection.createStatement();</span>
<span class="nc" id="L244">			rs = statement.executeQuery(string);</span>
<span class="nc bnc" id="L245" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L246">				transactionType = rs.getString(&quot;transaction_type&quot;);</span>
<span class="nc" id="L247">				accountType = rs.getString(&quot;account_type&quot;);</span>
<span class="nc" id="L248">				amount = rs.getDouble(&quot;amount&quot;);</span>
<span class="nc" id="L249">				timestamp = rs.getTimestamp(&quot;transaction_date&quot;);</span>
<span class="nc" id="L250">				transactionId = rs.getInt(&quot;transaction_id&quot;);</span>
<span class="nc" id="L251">				transationWith = rs.getString(&quot;transaction_with&quot;);</span>
<span class="nc" id="L252">				NumberFormat format = NumberFormat.getInstance();</span>
<span class="nc" id="L253">				format.setGroupingUsed(false);</span>
<span class="nc" id="L254">				format.setMinimumIntegerDigits(10);</span>
<span class="nc" id="L255">				format.setMaximumFractionDigits(0);</span>

<span class="nc bnc" id="L257" title="All 2 branches missed.">				if (tallyAccount.equalsIgnoreCase(&quot;RECEIPT&quot;)) {// done</span>
<span class="nc" id="L258">					DateString = dateFormat.format(timestamp);</span>

<span class="nc bnc" id="L260" title="All 8 branches missed.">					if (accountType.contains(&quot;_&quot;)</span>
							&amp;&amp; transactionType.equalsIgnoreCase(&quot;CASH&quot;)
							|| accountType.contains(&quot;_&quot;)
							&amp;&amp; transactionType.equalsIgnoreCase(&quot;CHEQUE&quot;)) {
<span class="nc" id="L264">						tallyVouchElement = getVouchInnerElements(format</span>
								.format(transactionId), DateString,
								voucherType, fromTimeStamp, partyLedger, null,
								tallyVersion);

<span class="nc" id="L269">						ledgerName = transationWith;</span>

<span class="nc" id="L271">						saveElements(tallyVouchElement, -1.0 * amount,</span>
								ledgerName, tallyAccount, tallyVersion,
								voucherType);
<span class="nc" id="L274">						System.out.println(&quot;111 transactionId &quot; + transactionId</span>
								+ &quot; amount &quot; + amount + &quot; transactionWith &quot;
								+ transationWith);

<span class="nc bnc" id="L278" title="All 8 branches missed.">					} else if (transactionType.equalsIgnoreCase(&quot;CASH&quot;)</span>
							&amp;&amp; !accountType.contains(&quot;_&quot;)
							|| transactionType.equalsIgnoreCase(&quot;CHEQUE&quot;)
							&amp;&amp; !accountType.contains(&quot;_&quot;)) {
<span class="nc" id="L282">						ledgerName = &quot;Receipt&quot;;</span>
<span class="nc" id="L283">						System.out.println(&quot;4444transactionId &quot; + transactionId</span>
								+ &quot; amount &quot; + amount);
<span class="nc" id="L285">						saveElements(tallyVouchElement, -1.0 * amount,</span>
								ledgerName, tallyAccount, tallyVersion,
								voucherType);
<span class="nc" id="L288">						Element tallyMesgElement = new Element(&quot;TALLYMESSAGE&quot;);</span>
<span class="nc" id="L289">						tallyMesgElement.setNamespace(Namespace</span>
								.getNamespace(&quot;TallyUDF&quot;));
<span class="nc" id="L291">						tallyMesgElement.addContent(tallyVouchElement);</span>
<span class="nc" id="L292">						reqDataElement.addContent(tallyMesgElement);</span>

					}
<span class="nc" id="L295">					System.out.println(&quot; sumAmount &quot; + sumAmount);</span>
				}
<span class="nc bnc" id="L297" title="All 2 branches missed.">				if (tallyAccount.equalsIgnoreCase(&quot;CHEQUE BOUNCE&quot;)) {// done</span>

<span class="nc" id="L299">					DateString = dateFormat.format(timestamp);</span>

<span class="nc bnc" id="L301" title="All 4 branches missed.">					if (transactionType.equalsIgnoreCase(&quot;CHQ_BOUNCE&quot;)</span>
							&amp;&amp; !accountType.contains(&quot;_&quot;)) {
<span class="nc" id="L303">						ledgerName = transationWith;</span>
<span class="nc" id="L304">						narration = getNarration(transactionId, connection,</span>
								transactionType);
<span class="nc" id="L306">						System.out.println(&quot;narration11111   &quot; + narration);</span>
<span class="nc" id="L307">						tallyVouchElement = getVouchInnerElements(format</span>
								.format(transactionId), DateString,
								voucherType, fromTimeStamp, partyLedger,
								narration, tallyVersion);
<span class="nc" id="L311">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);
<span class="nc" id="L313">						System.out.println(&quot;333 transactionId &quot; + transactionId</span>
								+ &quot; amount &quot; + amount);
<span class="nc bnc" id="L315" title="All 4 branches missed.">					} else if (transactionType.equalsIgnoreCase(&quot;CHQ_BOUNCE&quot;)</span>
							&amp;&amp; accountType.contains(&quot;_&quot;)) {
<span class="nc" id="L317">						ledgerName = &quot;Receipt&quot;;</span>
<span class="nc" id="L318">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);
<span class="nc" id="L320">						System.out.println(&quot;222 transactionId &quot; + transactionId</span>
								+ &quot; amount &quot; + amount);
<span class="nc" id="L322">						Element tallyMesgElement = new Element(&quot;TALLYMESSAGE&quot;);</span>
<span class="nc" id="L323">						tallyMesgElement.setNamespace(Namespace</span>
								.getNamespace(&quot;TallyUDF&quot;));
<span class="nc" id="L325">						tallyMesgElement.addContent(tallyVouchElement);</span>
<span class="nc" id="L326">						reqDataElement.addContent(tallyMesgElement);</span>
					}

				}
<span class="nc bnc" id="L330" title="All 2 branches missed.">				if (tallyAccount.equalsIgnoreCase(&quot;DEBIT NOTE&quot;)) {// done</span>

<span class="nc" id="L332">					DateString = dateFormat.format(timestamp);</span>

<span class="nc bnc" id="L334" title="All 6 branches missed.">					if ((transactionType.equalsIgnoreCase(&quot;DR_NOTE&quot;) || transactionType</span>
							.equalsIgnoreCase(&quot;DR_NOTE_CASH&quot;))
							&amp;&amp; !accountType.contains(&quot;_&quot;)) {
<span class="nc" id="L337">						ledgerName = transationWith;</span>
<span class="nc" id="L338">						narration = getNarration(transactionId, connection,</span>
								transactionType);
<span class="nc" id="L340">						tallyVouchElement = getVouchInnerElements(format</span>
								.format(transactionId), DateString,
								voucherType, fromTimeStamp, partyLedger,
								narration, tallyVersion);
<span class="nc" id="L344">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);
<span class="nc" id="L346">						System.out.println(&quot;333 transactionId &quot; + transactionId</span>
								+ &quot; amount &quot; + amount);
<span class="nc bnc" id="L348" title="All 6 branches missed.">					} else if ((transactionType.equalsIgnoreCase(&quot;DEBIT NOTE&quot;) || transactionType</span>
							.equalsIgnoreCase(&quot;DR_NOTE_CASH&quot;))
							&amp;&amp; accountType.contains(&quot;_&quot;)) {
<span class="nc" id="L351">						ledgerName = &quot;Receipt&quot;;</span>
<span class="nc" id="L352">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);
<span class="nc" id="L354">						System.out.println(&quot;222 transactionId &quot; + transactionId</span>
								+ &quot; amount &quot; + amount);
<span class="nc" id="L356">						Element tallyMesgElement = new Element(&quot;TALLYMESSAGE&quot;);</span>
<span class="nc" id="L357">						tallyMesgElement.setNamespace(Namespace</span>
								.getNamespace(&quot;TallyUDF&quot;));
<span class="nc" id="L359">						tallyMesgElement.addContent(tallyVouchElement);</span>
<span class="nc" id="L360">						reqDataElement.addContent(tallyMesgElement);</span>
					}

				}

<span class="nc bnc" id="L365" title="All 2 branches missed.">				if (tallyAccount.equalsIgnoreCase(&quot;TDS&quot;)) { // /done</span>

<span class="nc" id="L367">					DateString = dateFormat.format(timestamp);</span>

<span class="nc bnc" id="L369" title="All 4 branches missed.">					if (accountType.equalsIgnoreCase(&quot;TDS_PAY&quot;)</span>
							&amp;&amp; transactionType.equalsIgnoreCase(&quot;TDS&quot;)) {
<span class="nc" id="L371">						tallyVouchElement = getVouchInnerElements(format</span>
								.format(transactionId), DateString,
								voucherType, fromTimeStamp, partyLedger, null,
								tallyVersion);
						// ledgerName=&quot;By TDS&quot;;
<span class="nc" id="L376">						ledgerName = &quot;Deduction Payable&quot;;</span>
<span class="nc" id="L377">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);

<span class="nc bnc" id="L380" title="All 4 branches missed.">					} else if (accountType.equalsIgnoreCase(&quot;BANK_ACC&quot;)</span>
							&amp;&amp; transactionType.equalsIgnoreCase(&quot;TDS&quot;)) {
						// ledgerName=&quot;To Receipt&quot;;
<span class="nc" id="L383">						ledgerName = &quot;Receipt&quot;;</span>
						// saveElements(tallyVouchElement,amount,ledgerName);
<span class="nc" id="L385">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);
<span class="nc" id="L387">						System.out.println(&quot;222 transactionId &quot; + transactionId</span>
								+ &quot; amount &quot; + amount);
<span class="nc" id="L389">						Element tallyMesgElement = new Element(&quot;TALLYMESSAGE&quot;);</span>
<span class="nc" id="L390">						tallyMesgElement.setNamespace(Namespace</span>
								.getNamespace(&quot;TallyUDF&quot;));
<span class="nc" id="L392">						tallyMesgElement.addContent(tallyVouchElement);</span>
<span class="nc" id="L393">						reqDataElement.addContent(tallyMesgElement);</span>

					}

				}

<span class="nc bnc" id="L399" title="All 2 branches missed.">				if (tallyAccount.equalsIgnoreCase(&quot;Govt Contribution&quot;)) {// /done</span>

<span class="nc" id="L401">					DateString = dateFormat.format(timestamp);</span>
<span class="nc bnc" id="L402" title="All 2 branches missed.">					if (accountType.equalsIgnoreCase(&quot;GOVT_COMM&quot;)) {</span>
<span class="nc" id="L403">						tallyVouchElement = getVouchInnerElements(format</span>
								.format(transactionId), DateString,
								voucherType, fromTimeStamp, partyLedger, null,
								tallyVersion);
						// ledgerName=&quot;By Govt Contribution&quot;;
<span class="nc" id="L408">						ledgerName = &quot;Good Cause&quot;;</span>
<span class="nc" id="L409">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);

<span class="nc bnc" id="L412" title="All 4 branches missed.">					} else if (accountType.equalsIgnoreCase(&quot;BANK_ACC&quot;)</span>
							&amp;&amp; transactionType.equalsIgnoreCase(&quot;GOVT_COMM&quot;)) {
						// ledgerName=&quot;To Receipt&quot;;
<span class="nc" id="L415">						ledgerName = &quot;Receipt&quot;;</span>
<span class="nc" id="L416">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);
<span class="nc" id="L418">						System.out.println(&quot;222 transactionId &quot; + transactionId</span>
								+ &quot; amount &quot; + amount);
<span class="nc" id="L420">						Element tallyMesgElement = new Element(&quot;TALLYMESSAGE&quot;);</span>
<span class="nc" id="L421">						tallyMesgElement.setNamespace(Namespace</span>
								.getNamespace(&quot;TallyUDF&quot;));
<span class="nc" id="L423">						tallyMesgElement.addContent(tallyVouchElement);</span>
<span class="nc" id="L424">						reqDataElement.addContent(tallyMesgElement);</span>

<span class="nc" id="L426">					}</span>
<span class="nc bnc" id="L427" title="All 2 branches missed.">				} else if (tallyAccount.equalsIgnoreCase(&quot;VAT Contribution&quot;)) {// /done</span>

<span class="nc" id="L429">					DateString = dateFormat.format(timestamp);</span>
<span class="nc bnc" id="L430" title="All 2 branches missed.">					if (accountType.equalsIgnoreCase(&quot;VAT_PAY&quot;)) {</span>
<span class="nc" id="L431">						tallyVouchElement = getVouchInnerElements(format</span>
								.format(transactionId), DateString,
								voucherType, fromTimeStamp, partyLedger, null,
								tallyVersion);
						// ledgerName=&quot;By Govt Contribution&quot;;
<span class="nc" id="L436">						ledgerName = &quot;VAT Contribution&quot;;</span>
<span class="nc" id="L437">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);

<span class="nc bnc" id="L440" title="All 4 branches missed.">					} else if (accountType.equalsIgnoreCase(&quot;BANK_ACC&quot;)</span>
							&amp;&amp; transactionType.equalsIgnoreCase(&quot;VAT&quot;)) {
						// ledgerName=&quot;To Receipt&quot;;
<span class="nc" id="L443">						ledgerName = &quot;Receipt&quot;;</span>
<span class="nc" id="L444">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);
<span class="nc" id="L446">						System.out.println(&quot;222 transactionId &quot; + transactionId</span>
								+ &quot; amount &quot; + amount);
<span class="nc" id="L448">						Element tallyMesgElement = new Element(&quot;TALLYMESSAGE&quot;);</span>
<span class="nc" id="L449">						tallyMesgElement.setNamespace(Namespace</span>
								.getNamespace(&quot;TallyUDF&quot;));
<span class="nc" id="L451">						tallyMesgElement.addContent(tallyVouchElement);</span>
<span class="nc" id="L452">						reqDataElement.addContent(tallyMesgElement);</span>

<span class="nc" id="L454">					}</span>
				}

<span class="nc bnc" id="L457" title="All 2 branches missed.">				else if (tallyAccount.equalsIgnoreCase(&quot;Sales Return&quot;)) {// /done</span>

<span class="nc" id="L459">					DateString = dateFormat.format(timestamp);</span>
<span class="nc bnc" id="L460" title="All 2 branches missed.">					if (accountType.equalsIgnoreCase(&quot;SALE_RET&quot;)) {</span>
<span class="nc" id="L461">						tallyVouchElement = tallyVouchElement = getVouchInnerElements(</span>
								format.format(transactionId), DateString,
								voucherType, fromTimeStamp, partyLedger, null,
								tallyVersion);
						// ledgerName=&quot;By Sales Return&quot;;
<span class="nc" id="L466">						ledgerName = &quot;Sales Return&quot;;</span>
<span class="nc" id="L467">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);

<span class="nc bnc" id="L470" title="All 4 branches missed.">					} else if (transactionType.equalsIgnoreCase(&quot;SALE_RET&quot;)</span>
							&amp;&amp; !accountType.contains(&quot;_&quot;)) {
						// ledgerName=&quot;To Agent&quot;;
<span class="nc" id="L473">						ledgerName = transationWith;</span>
<span class="nc" id="L474">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);
<span class="nc" id="L476">						System.out.println(&quot;222 transactionId &quot; + transactionId</span>
								+ &quot; amount &quot; + amount);
<span class="nc" id="L478">						Element tallyMesgElement = new Element(&quot;TALLYMESSAGE&quot;);</span>
<span class="nc" id="L479">						tallyMesgElement.setNamespace(Namespace</span>
								.getNamespace(&quot;TallyUDF&quot;));
<span class="nc" id="L481">						tallyMesgElement.addContent(tallyVouchElement);</span>
<span class="nc" id="L482">						reqDataElement.addContent(tallyMesgElement);</span>

					}
				}
				// ///done/
<span class="nc bnc" id="L487" title="All 2 branches missed.">				if (tallyAccount.equalsIgnoreCase(&quot;Gross Sales&quot;)) {</span>

<span class="nc" id="L489">					DateString = dateFormat.format(timestamp);</span>

<span class="nc bnc" id="L491" title="All 4 branches missed.">					if (transactionType.equalsIgnoreCase(&quot;SALE&quot;)</span>
							&amp;&amp; !accountType.contains(&quot;_&quot;)) {
<span class="nc" id="L493">						tallyVouchElement = getVouchInnerElements(format</span>
								.format(transactionId), DateString,
								voucherType, fromTimeStamp, partyLedger, null,
								tallyVersion);
						// ledgerName=&quot;By Agent&quot;;
<span class="nc" id="L498">						ledgerName = transationWith;</span>
<span class="nc" id="L499">						System.out.println(ledgerName + &quot;   ledgerName &quot;</span>
								+ format.format(transactionId) + &quot;  &quot;
								+ format.getMaximumFractionDigits() + &quot;  &quot;
								+ format.getMinimumIntegerDigits());
						// sumAmount = sumAmount + amount;

						// list.add(amount);
<span class="nc" id="L506">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);

<span class="nc bnc" id="L509" title="All 4 branches missed.">					} else if (transactionType.equalsIgnoreCase(&quot;SALE&quot;)</span>
							&amp;&amp; accountType.contains(&quot;_&quot;)) {
						// ledgerName=&quot;To Gross Sales&quot;;
<span class="nc" id="L512">						ledgerName = &quot;Gross Sales&quot;;</span>
<span class="nc" id="L513">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);

<span class="nc" id="L516">						Element tallyMesgElement = new Element(&quot;TALLYMESSAGE&quot;);</span>
<span class="nc" id="L517">						tallyMesgElement.setNamespace(Namespace</span>
								.getNamespace(&quot;TallyUDF&quot;));
<span class="nc" id="L519">						tallyMesgElement.addContent(tallyVouchElement);</span>
<span class="nc" id="L520">						reqDataElement.addContent(tallyMesgElement);</span>
					}
				}

<span class="nc bnc" id="L524" title="All 2 branches missed.">				if (tallyAccount.equalsIgnoreCase(&quot;Player TDS&quot;)) {</span>

<span class="nc" id="L526">					DateString = dateFormat.format(timestamp);</span>

<span class="nc bnc" id="L528" title="All 4 branches missed.">					if (transactionType.equalsIgnoreCase(&quot;PWT_PLR&quot;)</span>
							&amp;&amp; accountType.equalsIgnoreCase(&quot;PLAYER_TDS&quot;)) {
<span class="nc" id="L530">						tallyVouchElement = getVouchInnerElements(format</span>
								.format(transactionId), DateString,
								voucherType, fromTimeStamp, partyLedger, null,
								tallyVersion);
						// ledgerName=&quot;By Player TDS&quot;;
<span class="nc" id="L535">						ledgerName = &quot;Player Deduction&quot;;</span>
						// sumAmount = sumAmount + amount;
						// list.add(amount);
<span class="nc" id="L538">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);

<span class="nc bnc" id="L541" title="All 4 branches missed.">					} else if (accountType.equalsIgnoreCase(&quot;TDS_PAY&quot;)</span>
							&amp;&amp; transactionType.equalsIgnoreCase(&quot;PWT_PLR&quot;)) {
						// ledgerName=&quot;To TDS Payable&quot;;
<span class="nc" id="L544">						ledgerName = &quot;Deduction Payable&quot;;</span>
<span class="nc" id="L545">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);

<span class="nc" id="L548">						Element tallyMesgElement = new Element(&quot;TALLYMESSAGE&quot;);</span>
<span class="nc" id="L549">						tallyMesgElement.setNamespace(Namespace</span>
								.getNamespace(&quot;TallyUDF&quot;));
<span class="nc" id="L551">						tallyMesgElement.addContent(tallyVouchElement);</span>
<span class="nc" id="L552">						reqDataElement.addContent(tallyMesgElement);</span>

					}
				}

				/*
				 * if (tallyAccount.equalsIgnoreCase(&quot;PWT Collection&quot;)) {
				 * DateString=dateFormat.format(timestamp);
				 * 
				 * if (((transactionType.equalsIgnoreCase(&quot;PWT&quot;)) ||
				 * (transactionType .equalsIgnoreCase(&quot;PWT_AUTO&quot;))) &amp;&amp;
				 * (accountType.equalsIgnoreCase(&quot;PWT_PAY&quot;))) {
				 * tallyVouchElement
				 * =getVouchInnerElements(format.format(transactionId
				 * ),DateString
				 * ,voucherType,fromTimeStamp,partyLedger,null,tallyVersion); //
				 * ledgerName=&quot;By PWT Collection&quot;; ledgerName = &quot;PWT
				 * Collection&quot;;
				 * saveElements(tallyVouchElement,amount,ledgerName,
				 * tallyAccount,tallyVersion,voucherType); } else if
				 * (((transactionType.equalsIgnoreCase(&quot;PWT&quot;)) ||
				 * (transactionType .equalsIgnoreCase(&quot;PWT_AUTO&quot;))) &amp;&amp;
				 * !(accountType.contains(&quot;_&quot;))) { // ledgerName=&quot;To Agent&quot;;
				 * ledgerName = transationWith;
				 * saveElements(tallyVouchElement,amount
				 * ,ledgerName,tallyAccount,tallyVersion,voucherType);
				 * 
				 * Element tallyMesgElement = new Element(&quot;TALLYMESSAGE&quot;);
				 * tallyMesgElement
				 * .setNamespace(Namespace.getNamespace(&quot;TallyUDF&quot;));
				 * tallyMesgElement.addContent(tallyVouchElement);
				 * reqDataElement.addContent(tallyMesgElement); } }
				 */
<span class="nc bnc" id="L585" title="All 2 branches missed.">				if (tallyAccount.equalsIgnoreCase(&quot;Collection Charges&quot;)) {</span>

<span class="nc" id="L587">					DateString = dateFormat.format(timestamp);</span>
<span class="nc bnc" id="L588" title="All 6 branches missed.">					if ((transactionType.equalsIgnoreCase(&quot;PWT&quot;) || transactionType</span>
							.equalsIgnoreCase(&quot;PWT_AUTO&quot;))
							&amp;&amp; accountType.equalsIgnoreCase(&quot;PWT_CHARGES&quot;)) {
<span class="nc" id="L591">						System.out.println(&quot;coll charges 111&quot;);</span>
<span class="nc" id="L592">						tallyVouchElement = getVouchInnerElements(format</span>
								.format(transactionId), DateString,
								voucherType, fromTimeStamp, partyLedger, null,
								tallyVersion);
						// ledgerName=&quot;By PWT Collection&quot;;
<span class="nc" id="L597">						ledgerName = &quot;Collection Charges&quot;;</span>
<span class="nc" id="L598">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);

<span class="nc bnc" id="L601" title="All 6 branches missed.">					} else if ((transactionType.equalsIgnoreCase(&quot;PWT&quot;) || transactionType</span>
							.equalsIgnoreCase(&quot;PWT_AUTO&quot;))
							&amp;&amp; accountType.contains(&quot;#&quot;)) {
<span class="nc" id="L604">						System.out.println(&quot;coll charges 22&quot;);</span>
						// ledgerName=&quot;To Agent&quot;;
<span class="nc" id="L606">						ledgerName = transationWith;</span>
<span class="nc" id="L607">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);

<span class="nc" id="L610">						Element tallyMesgElement = new Element(&quot;TALLYMESSAGE&quot;);</span>
<span class="nc" id="L611">						tallyMesgElement.setNamespace(Namespace</span>
								.getNamespace(&quot;TallyUDF&quot;));
<span class="nc" id="L613">						tallyMesgElement.addContent(tallyVouchElement);</span>
<span class="nc" id="L614">						reqDataElement.addContent(tallyMesgElement);</span>

					}

				}

<span class="nc bnc" id="L620" title="All 2 branches missed.">				if (tallyAccount.equalsIgnoreCase(&quot;Player PWT&quot;)) {</span>

<span class="nc" id="L622">					DateString = dateFormat.format(timestamp);</span>

<span class="nc bnc" id="L624" title="All 4 branches missed.">					if (transactionType.equalsIgnoreCase(&quot;PWT_PLR&quot;)</span>
							&amp;&amp; accountType.equalsIgnoreCase(&quot;PWT_PAY&quot;)) {
<span class="nc" id="L626">						tallyVouchElement = getVouchInnerElements(format</span>
								.format(transactionId), DateString,
								voucherType, fromTimeStamp, partyLedger, null,
								tallyVersion);
						// ledgerName=&quot;By PWT Collection&quot;;
<span class="nc" id="L631">						ledgerName = &quot;PWT Collection&quot;;</span>
<span class="nc" id="L632">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);

<span class="nc bnc" id="L635" title="All 4 branches missed.">					} else if (transactionType.equalsIgnoreCase(&quot;PWT_PLR&quot;)</span>
							&amp;&amp; accountType.equalsIgnoreCase(&quot;PLAYER_PWT&quot;)) {
						// ledgerName=&quot;To Player PWT&quot;;
<span class="nc" id="L638">						ledgerName = &quot;Player PWT&quot;;</span>
<span class="nc" id="L639">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);

<span class="nc" id="L642">						Element tallyMesgElement = new Element(&quot;TALLYMESSAGE&quot;);</span>
<span class="nc" id="L643">						tallyMesgElement.setNamespace(Namespace</span>
								.getNamespace(&quot;TallyUDF&quot;));
<span class="nc" id="L645">						tallyMesgElement.addContent(tallyVouchElement);</span>
<span class="nc" id="L646">						reqDataElement.addContent(tallyMesgElement);</span>

					}
				}

<span class="nc bnc" id="L651" title="All 2 branches missed.">				if (tallyAccount.equalsIgnoreCase(&quot;Player Net&quot;)) {</span>

<span class="nc" id="L653">					DateString = dateFormat.format(timestamp);</span>
<span class="nc bnc" id="L654" title="All 2 branches missed.">					if (accountType.equalsIgnoreCase(&quot;PLAYER_CAS&quot;)) {</span>
<span class="nc" id="L655">						tallyVouchElement = getVouchInnerElements(format</span>
								.format(transactionId), DateString,
								voucherType, fromTimeStamp, partyLedger, null,
								tallyVersion);
						// ledgerName=&quot;By Player Net&quot;;
<span class="nc" id="L660">						ledgerName = &quot;Player Net&quot;;</span>
<span class="nc" id="L661">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);

<span class="nc bnc" id="L664" title="All 4 branches missed.">					} else if (transactionType.equalsIgnoreCase(&quot;PWT_PLR&quot;)</span>
							&amp;&amp; accountType.equalsIgnoreCase(&quot;BANK_ACC&quot;)) {
						// ledgerName=&quot;To Reciept&quot;;
<span class="nc" id="L667">						ledgerName = &quot;Receipt&quot;;</span>
<span class="nc" id="L668">						saveElements(tallyVouchElement, amount, ledgerName,</span>
								tallyAccount, tallyVersion, voucherType);

<span class="nc" id="L671">						Element tallyMesgElement = new Element(&quot;TALLYMESSAGE&quot;);</span>
<span class="nc" id="L672">						tallyMesgElement.setNamespace(Namespace</span>
								.getNamespace(&quot;TallyUDF&quot;));
<span class="nc" id="L674">						tallyMesgElement.addContent(tallyVouchElement);</span>
<span class="nc" id="L675">						reqDataElement.addContent(tallyMesgElement);</span>

					}
				}

<span class="nc" id="L680">			}</span>

<span class="nc" id="L682">			System.out.println(&quot; Final   sumAmount &quot; + sumAmount);</span>
<span class="nc" id="L683">		} catch (SQLException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L685">			e.printStackTrace();</span>
<span class="nc" id="L686">		}</span>
<span class="nc" id="L687">		return tallyVouchElement;</span>
	}

	public Element getVouchInnerElements(String id, String date,
			String voucherType, Timestamp fromTimeStamp, String partyLedger,
			String narration, String tallyVersion) {
<span class="nc" id="L693">		SimpleDateFormat dateFormat = new SimpleDateFormat(&quot;yyyyMMdd&quot;);</span>

<span class="nc" id="L695">		Element tallyVouchElement = new Element(&quot;VOUCHER&quot;);</span>
<span class="nc" id="L696">		Element vouchIsOptionalElement = new Element(&quot;ISOPTIONAL&quot;);</span>
<span class="nc" id="L697">		Element vouchUseGainElement = new Element(&quot;USEFORGAINLOSS&quot;);</span>
<span class="nc" id="L698">		Element vouchUseCompElement = new Element(&quot;USEFORCOMPOUND&quot;);</span>
<span class="nc" id="L699">		Element vouchTypeElement = new Element(&quot;VOUCHERTYPENAME&quot;);</span>
<span class="nc" id="L700">		Element vouchDateElement = new Element(&quot;DATE&quot;);</span>
<span class="nc" id="L701">		Element vouchEffDateElement = new Element(&quot;EFFECTIVEDATE&quot;);</span>
<span class="nc" id="L702">		Element vouchIsCancElement = new Element(&quot;ISCANCELLED&quot;);</span>
<span class="nc" id="L703">		Element reqIsOptionalElement = new Element(&quot;USETRACKINGNUMBER&quot;);</span>
<span class="nc" id="L704">		Element vouchIsPostDtElement = new Element(&quot;ISPOSTDATED&quot;);</span>
<span class="nc" id="L705">		Element vouchIsInvoiceElement = new Element(&quot;ISINVOICE&quot;);</span>
<span class="nc" id="L706">		Element vouchDifActElement = new Element(&quot;DIFFACTUALQTY&quot;);</span>
<span class="nc" id="L707">		Element vouchNumElement = new Element(&quot;VOUCHERNUMBER&quot;);</span>
<span class="nc" id="L708">		Element vouchPartyLedElement = new Element(&quot;PARTYLEDGERNAME&quot;);</span>
<span class="nc" id="L709">		Element vouchNarrationElement = new Element(&quot;NARRATION&quot;);</span>
<span class="nc" id="L710">		Element vouchPaySlipElement = new Element(&quot;ASPAYSLIP&quot;);</span>
<span class="nc" id="L711">		Element vouchGuidElement = new Element(&quot;GUID&quot;);</span>
<span class="nc" id="L712">		Element vouchAlterIdElement = new Element(&quot;ALTERID&quot;);</span>
<span class="nc" id="L713">		Element vouchIsCostCentreElement = null;</span>
<span class="nc" id="L714">		Element vouchUseFrFinalProdElement = null;</span>
<span class="nc" id="L715">		Element vouchCstFrmIssueTypElement = null;</span>
<span class="nc" id="L716">		Element vouchCstFrmRecTypElement = null;</span>
<span class="nc" id="L717">		Element vouchFbtPmntTypElement = null;</span>
<span class="nc" id="L718">		Element vouchVchGstClassElement = null;</span>
<span class="nc" id="L719">		Element vouchAuditedElement = null;</span>
<span class="nc" id="L720">		Element vouchForJobCostingElement = null;</span>
<span class="nc" id="L721">		Element vouchUseFrIntrstElement = null;</span>
<span class="nc" id="L722">		Element vouchUseGdwnTrnfrElement = null;</span>
<span class="nc" id="L723">		Element vouchExciseOpeningElement = null;</span>
<span class="nc" id="L724">		Element vouchHasCashFlowElement = null;</span>
<span class="nc" id="L725">		Element vouchMfgJrnlElement = null;</span>

<span class="nc" id="L727">		Element vouchHasDiscntsElement = null;</span>
<span class="nc" id="L728">		Element vouchIsDeletedElement = null;</span>
<span class="nc" id="L729">		Element vouchAsOriginalElement = null;</span>

<span class="nc bnc" id="L731" title="All 2 branches missed.">		if (tallyVersion.equalsIgnoreCase(&quot;Tally9&quot;)) {</span>
<span class="nc" id="L732">			vouchCstFrmIssueTypElement = new Element(&quot;CSTFORMISSUETYPE&quot;);</span>
<span class="nc" id="L733">			vouchCstFrmRecTypElement = new Element(&quot;CSTFORMRECVTYPE&quot;);</span>
<span class="nc" id="L734">			vouchFbtPmntTypElement = new Element(&quot;FBTPAYMENTTYPE&quot;);</span>
<span class="nc" id="L735">			vouchVchGstClassElement = new Element(&quot;VCHGSTCLASS&quot;);</span>
<span class="nc" id="L736">			vouchAuditedElement = new Element(&quot;AUDITED&quot;);</span>
<span class="nc" id="L737">			vouchForJobCostingElement = new Element(&quot;FORJOBCOSTING&quot;);</span>
<span class="nc" id="L738">			vouchUseFrIntrstElement = new Element(&quot;USEFORINTEREST&quot;);</span>
<span class="nc" id="L739">			vouchUseGdwnTrnfrElement = new Element(&quot;USEFORGODOWNTRANSFER&quot;);</span>
<span class="nc" id="L740">			vouchExciseOpeningElement = new Element(&quot;EXCISEOPENING&quot;);</span>
<span class="nc" id="L741">			vouchHasCashFlowElement = new Element(&quot;HASCASHFLOW&quot;);</span>
<span class="nc" id="L742">			vouchMfgJrnlElement = new Element(&quot;MFGJOURNAL&quot;);</span>

<span class="nc" id="L744">			vouchHasDiscntsElement = new Element(&quot;HASDISCOUNTS&quot;);</span>
<span class="nc" id="L745">			vouchIsDeletedElement = new Element(&quot;ISDELETED&quot;);</span>
<span class="nc" id="L746">			vouchAsOriginalElement = new Element(&quot;ASORIGINAL&quot;);</span>

<span class="nc" id="L748">			vouchCstFrmIssueTypElement.addContent(&quot;&quot;);</span>
<span class="nc" id="L749">			vouchCstFrmRecTypElement.addContent(&quot;&quot;);</span>
<span class="nc" id="L750">			vouchFbtPmntTypElement.addContent(&quot;Default&quot;);</span>
<span class="nc" id="L751">			vouchVchGstClassElement.addContent(&quot;&quot;);</span>
<span class="nc" id="L752">			vouchAuditedElement.addContent(&quot;No&quot;);</span>
<span class="nc" id="L753">			vouchForJobCostingElement.addContent(&quot;No&quot;);</span>
<span class="nc" id="L754">			vouchUseFrIntrstElement.addContent(&quot;No&quot;);</span>
<span class="nc" id="L755">			vouchUseGdwnTrnfrElement.addContent(&quot;No&quot;);</span>
<span class="nc" id="L756">			vouchExciseOpeningElement.addContent(&quot;No&quot;);</span>
<span class="nc bnc" id="L757" title="All 4 branches missed.">			if (voucherType.equalsIgnoreCase(&quot;Sales&quot;)</span>
					|| voucherType.equalsIgnoreCase(&quot;Journal&quot;)) {
<span class="nc" id="L759">				vouchHasCashFlowElement.addContent(&quot;No&quot;);</span>
			} else {
<span class="nc" id="L761">				vouchHasCashFlowElement.addContent(&quot;Yes&quot;);</span>
			}

<span class="nc" id="L764">			vouchMfgJrnlElement.addContent(&quot;No&quot;);</span>
<span class="nc" id="L765">			vouchHasDiscntsElement.addContent(&quot;No&quot;);</span>
<span class="nc" id="L766">			vouchIsDeletedElement.addContent(&quot;No&quot;);</span>
<span class="nc" id="L767">			vouchAsOriginalElement.addContent(&quot;No&quot;);</span>
<span class="nc bnc" id="L768" title="All 2 branches missed.">			if (voucherType.equalsIgnoreCase(&quot;Sales&quot;)) {</span>
<span class="nc" id="L769">				vouchUseFrFinalProdElement = new Element(</span>
						&quot;USEFORFINALPRODUCTION&quot;);
<span class="nc" id="L771">				vouchIsCostCentreElement = new Element(&quot;ISCOSTCENTRE&quot;);</span>
<span class="nc" id="L772">				vouchUseFrFinalProdElement.addContent(&quot;No&quot;);</span>
<span class="nc" id="L773">				vouchIsCostCentreElement.addContent(&quot;No&quot;);</span>
			}

		}

<span class="nc" id="L778">		tallyVouchElement.setAttribute(&quot;REMOTEID&quot;, id);</span>
<span class="nc" id="L779">		tallyVouchElement.setAttribute(&quot;VCHTYPE&quot;, voucherType);</span>
<span class="nc" id="L780">		tallyVouchElement.setAttribute(&quot;ACTION&quot;, &quot;Create&quot;);</span>

		// /Element vouchIsOptionalElement = new Element(&quot;ISOPTIONAL&quot;);
<span class="nc" id="L783">		vouchIsOptionalElement.addContent(&quot;No&quot;);</span>
		// / Element vouchUseGainElement = new Element(&quot;USEFORGAINLOSS&quot;);
<span class="nc" id="L785">		vouchUseGainElement.addContent(&quot;No&quot;);</span>
		// / Element vouchUseCompElement = new Element(&quot;USEFORCOMPOUND&quot;);
<span class="nc" id="L787">		vouchUseCompElement.addContent(&quot;No&quot;);</span>
		// /Element vouchTypeElement = new Element(&quot;VOUCHERTYPENAME&quot;);
<span class="nc" id="L789">		vouchTypeElement.addContent(voucherType);</span>
		// /Element vouchDateElement = new Element(&quot;DATE&quot;);
<span class="nc" id="L791">		vouchDateElement.addContent(date);</span>
		// / Element vouchEffDateElement = new Element(&quot;EFFECTIVEDATE&quot;);
<span class="nc" id="L793">		System.out.println(date);</span>
<span class="nc" id="L794">		vouchEffDateElement.addContent(date);</span>
		// / Element vouchIsCancElement = new Element(&quot;ISCANCELLED&quot;);
<span class="nc" id="L796">		vouchIsCancElement.addContent(&quot;No&quot;);</span>
		// / Element reqIsOptionalElement = new Element(&quot;USETRACKINGNUMBER&quot;);
<span class="nc" id="L798">		reqIsOptionalElement.addContent(&quot;No&quot;);</span>
		// / Element vouchIsPostDtElement = new Element(&quot;ISPOSTDATED&quot;);
<span class="nc" id="L800">		vouchIsPostDtElement.addContent(&quot;No&quot;);</span>
		// / Element vouchIsInvoiceElement = new Element(&quot;ISINVOICE&quot;);
<span class="nc" id="L802">		vouchIsInvoiceElement.addContent(&quot;No&quot;);</span>
		// / Element vouchDifActElement = new Element(&quot;DIFFACTUALQTY&quot;);
<span class="nc" id="L804">		vouchDifActElement.addContent(&quot;No&quot;);</span>
		// / Element vouchNumElement = new Element(&quot;VOUCHERNUMBER&quot;);
<span class="nc" id="L806">		vouchNumElement.addContent(&quot;1&quot;);</span>
		// / Element vouchPartyLedElement = new Element(&quot;PARTYLEDGERNAME&quot;);
<span class="nc" id="L808">		vouchPartyLedElement.addContent(partyLedger);</span>
		// / Element vouchNarrationElement = new Element(&quot;NARRATION&quot;);
<span class="nc bnc" id="L810" title="All 2 branches missed.">		if (narration != null) {</span>
<span class="nc" id="L811">			vouchNarrationElement.addContent(narration);</span>
		} else {
<span class="nc" id="L813">			vouchNarrationElement.addContent(&quot;Bill No&quot;);</span>
		}

		// / Element vouchPaySlipElement = new Element(&quot;ASPAYSLIP&quot;);
<span class="nc" id="L817">		vouchPaySlipElement.addContent(&quot;No&quot;);</span>
		// / Element vouchGuidElement = new Element(&quot;GUID&quot;);
<span class="nc" id="L819">		vouchGuidElement.addContent(id);</span>
		// / Element vouchAlterIdElement = new Element(&quot;ALTERID&quot;);
<span class="nc" id="L821">		vouchAlterIdElement.addContent(id);</span>

<span class="nc" id="L823">		tallyVouchElement.addContent(vouchIsOptionalElement);</span>
<span class="nc" id="L824">		tallyVouchElement.addContent(vouchUseGainElement);</span>
<span class="nc" id="L825">		tallyVouchElement.addContent(vouchUseCompElement);</span>
<span class="nc" id="L826">		tallyVouchElement.addContent(vouchTypeElement);</span>
<span class="nc" id="L827">		tallyVouchElement.addContent(vouchDateElement);</span>
<span class="nc" id="L828">		tallyVouchElement.addContent(vouchEffDateElement);</span>
<span class="nc" id="L829">		tallyVouchElement.addContent(vouchIsCancElement);</span>
<span class="nc" id="L830">		tallyVouchElement.addContent(reqIsOptionalElement);</span>
<span class="nc" id="L831">		tallyVouchElement.addContent(vouchIsPostDtElement);</span>
<span class="nc" id="L832">		tallyVouchElement.addContent(vouchIsInvoiceElement);</span>
<span class="nc" id="L833">		tallyVouchElement.addContent(vouchDifActElement);</span>
<span class="nc" id="L834">		tallyVouchElement.addContent(vouchNumElement);</span>
<span class="nc" id="L835">		tallyVouchElement.addContent(vouchPartyLedElement);</span>
<span class="nc" id="L836">		tallyVouchElement.addContent(vouchNarrationElement);</span>
<span class="nc" id="L837">		tallyVouchElement.addContent(vouchPaySlipElement);</span>
<span class="nc" id="L838">		tallyVouchElement.addContent(vouchGuidElement);</span>
<span class="nc" id="L839">		tallyVouchElement.addContent(vouchAlterIdElement);</span>
<span class="nc bnc" id="L840" title="All 2 branches missed.">		if (tallyVersion.equalsIgnoreCase(&quot;Tally9&quot;)) {</span>
<span class="nc" id="L841">			tallyVouchElement.addContent(vouchCstFrmIssueTypElement);</span>
<span class="nc" id="L842">			tallyVouchElement.addContent(vouchCstFrmRecTypElement);</span>
<span class="nc" id="L843">			tallyVouchElement.addContent(vouchFbtPmntTypElement);</span>
<span class="nc" id="L844">			tallyVouchElement.addContent(vouchVchGstClassElement);</span>
<span class="nc" id="L845">			tallyVouchElement.addContent(vouchAuditedElement);</span>
<span class="nc" id="L846">			tallyVouchElement.addContent(vouchForJobCostingElement);</span>
<span class="nc" id="L847">			tallyVouchElement.addContent(vouchUseFrIntrstElement);</span>
<span class="nc" id="L848">			tallyVouchElement.addContent(vouchUseGdwnTrnfrElement);</span>
<span class="nc" id="L849">			tallyVouchElement.addContent(vouchExciseOpeningElement);</span>
<span class="nc" id="L850">			tallyVouchElement.addContent(vouchHasCashFlowElement);</span>
<span class="nc" id="L851">			tallyVouchElement.addContent(vouchMfgJrnlElement);</span>
<span class="nc" id="L852">			tallyVouchElement.addContent(vouchHasDiscntsElement);</span>
<span class="nc" id="L853">			tallyVouchElement.addContent(vouchIsDeletedElement);</span>
<span class="nc" id="L854">			tallyVouchElement.addContent(vouchAsOriginalElement);</span>
<span class="nc bnc" id="L855" title="All 2 branches missed.">			if (voucherType.equalsIgnoreCase(&quot;Sales&quot;)) {</span>
<span class="nc" id="L856">				tallyVouchElement.addContent(vouchUseFrFinalProdElement);</span>
<span class="nc" id="L857">				tallyVouchElement.addContent(vouchIsCostCentreElement);</span>
			}
		}

<span class="nc" id="L861">		return tallyVouchElement;</span>

	}

	public Element saveElements(Element tallyVouchElement, double amount,
			String ledgerName, String tallyAccount, String tallyVersion,
			String voucherType) {
<span class="nc" id="L868">		Element vouchLedEntryElement = null;</span>

<span class="nc" id="L870">		Element vouchLedRemZeroElement = null;</span>
<span class="nc" id="L871">		Element vouchLedIsDeemPostvElement = null;</span>
<span class="nc" id="L872">		Element vouchLedFromItemElement = null;</span>
<span class="nc" id="L873">		Element vouchLedgerNameElement = null;</span>
<span class="nc" id="L874">		Element vouchLedAmountElement = null;</span>
<span class="nc" id="L875">		Element vouchLedGstClassElement = null;</span>
<span class="nc" id="L876">		Element vouchLedIsPartyLedElement = null;</span>

<span class="nc" id="L878">		NumberFormat numFormat = NumberFormat.getInstance();</span>
<span class="nc" id="L879">		String amt = numFormat.format(amount).replaceAll(&quot;,&quot;, &quot;&quot;);</span>
<span class="nc bnc" id="L880" title="All 2 branches missed.">		if (amount &lt; 0.0) {</span>
<span class="nc" id="L881">			vouchLedEntryElement = new Element(&quot;ALLLEDGERENTRIES.LIST&quot;);</span>

<span class="nc" id="L883">			vouchLedRemZeroElement = new Element(&quot;REMOVEZEROENTRIES&quot;);</span>
<span class="nc" id="L884">			vouchLedIsDeemPostvElement = new Element(&quot;ISDEEMEDPOSITIVE&quot;);</span>
<span class="nc" id="L885">			vouchLedFromItemElement = new Element(&quot;LEDGERFROMITEM&quot;);</span>
<span class="nc" id="L886">			vouchLedgerNameElement = new Element(&quot;LEDGERNAME&quot;);</span>
<span class="nc" id="L887">			vouchLedAmountElement = new Element(&quot;AMOUNT&quot;);</span>

<span class="nc bnc" id="L889" title="All 2 branches missed.">			if (tallyVersion.equalsIgnoreCase(&quot;Tally9&quot;)) {</span>

<span class="nc" id="L891">				vouchLedGstClassElement = new Element(&quot;GSTCLASS&quot;);</span>
<span class="nc" id="L892">				vouchLedIsPartyLedElement = new Element(&quot;ISPARTYLEDGER&quot;);</span>

<span class="nc" id="L894">				vouchLedGstClassElement.addContent(&quot;&quot;);</span>
<span class="nc bnc" id="L895" title="All 2 branches missed.">				if (voucherType.equalsIgnoreCase(&quot;Journal&quot;)) {</span>
<span class="nc" id="L896">					vouchLedIsPartyLedElement.addContent(&quot;No&quot;);</span>
				} else {
<span class="nc" id="L898">					vouchLedIsPartyLedElement.addContent(&quot;Yes&quot;);</span>
				}
			}
<span class="nc" id="L901">			vouchLedRemZeroElement.addContent(&quot;No&quot;);</span>

<span class="nc" id="L903">			vouchLedIsDeemPostvElement.addContent(&quot;Yes&quot;);</span>

<span class="nc" id="L905">			vouchLedFromItemElement.addContent(&quot;No&quot;);</span>
<span class="nc" id="L906">			vouchLedgerNameElement.addContent(ledgerName);</span>

<span class="nc" id="L908">			vouchLedAmountElement.addContent(amt);</span>

<span class="nc bnc" id="L910" title="All 2 branches missed.">			if (tallyVersion.equalsIgnoreCase(&quot;Tally9&quot;)) {</span>

<span class="nc" id="L912">				vouchLedEntryElement.addContent(vouchLedGstClassElement);</span>
<span class="nc" id="L913">				vouchLedEntryElement.addContent(vouchLedIsPartyLedElement);</span>

			}

<span class="nc" id="L917">			vouchLedEntryElement.addContent(vouchLedRemZeroElement);</span>
<span class="nc" id="L918">			vouchLedEntryElement.addContent(vouchLedIsDeemPostvElement);</span>
<span class="nc" id="L919">			vouchLedEntryElement.addContent(vouchLedFromItemElement);</span>
<span class="nc" id="L920">			vouchLedEntryElement.addContent(vouchLedgerNameElement);</span>
<span class="nc" id="L921">			vouchLedEntryElement.addContent(vouchLedAmountElement);</span>

<span class="nc" id="L923">			tallyVouchElement.addContent(vouchLedEntryElement);</span>
		} else {

<span class="nc" id="L926">			vouchLedEntryElement = new Element(&quot;ALLLEDGERENTRIES.LIST&quot;);</span>

<span class="nc" id="L928">			vouchLedRemZeroElement = new Element(&quot;REMOVEZEROENTRIES&quot;);</span>
<span class="nc" id="L929">			vouchLedIsDeemPostvElement = new Element(&quot;ISDEEMEDPOSITIVE&quot;);</span>
<span class="nc" id="L930">			vouchLedFromItemElement = new Element(&quot;LEDGERFROMITEM&quot;);</span>
<span class="nc" id="L931">			vouchLedgerNameElement = new Element(&quot;LEDGERNAME&quot;);</span>
<span class="nc" id="L932">			vouchLedAmountElement = new Element(&quot;AMOUNT&quot;);</span>
<span class="nc bnc" id="L933" title="All 2 branches missed.">			if (tallyVersion.equalsIgnoreCase(&quot;Tally9&quot;)) {</span>

<span class="nc" id="L935">				vouchLedGstClassElement = new Element(&quot;GSTCLASS&quot;);</span>
<span class="nc" id="L936">				vouchLedIsPartyLedElement = new Element(&quot;ISPARTYLEDGER&quot;);</span>

<span class="nc" id="L938">				vouchLedGstClassElement.addContent(&quot;&quot;);</span>
<span class="nc bnc" id="L939" title="All 2 branches missed.">				if (voucherType.equalsIgnoreCase(&quot;Sales&quot;)) {</span>
<span class="nc" id="L940">					vouchLedIsPartyLedElement.addContent(&quot;No&quot;);</span>
				} else {
<span class="nc" id="L942">					vouchLedIsPartyLedElement.addContent(&quot;Yes&quot;);</span>
				}
			}
<span class="nc" id="L945">			vouchLedRemZeroElement.addContent(&quot;No&quot;);</span>
<span class="nc" id="L946">			vouchLedIsDeemPostvElement.addContent(&quot;No&quot;);</span>
<span class="nc" id="L947">			vouchLedFromItemElement.addContent(&quot;No&quot;);</span>
<span class="nc" id="L948">			vouchLedgerNameElement.addContent(ledgerName);</span>
<span class="nc bnc" id="L949" title="All 2 branches missed.">			if (amt.equals(&quot;-0&quot;)) {</span>
<span class="nc" id="L950">				amt = &quot;0&quot;;</span>
			}
<span class="nc" id="L952">			vouchLedAmountElement.addContent(amt);</span>
<span class="nc bnc" id="L953" title="All 2 branches missed.">			if (tallyVersion.equalsIgnoreCase(&quot;Tally9&quot;)) {</span>

<span class="nc" id="L955">				vouchLedEntryElement.addContent(vouchLedGstClassElement);</span>
<span class="nc" id="L956">				vouchLedEntryElement.addContent(vouchLedIsPartyLedElement);</span>

			}
<span class="nc" id="L959">			vouchLedEntryElement.addContent(vouchLedRemZeroElement);</span>
<span class="nc" id="L960">			vouchLedEntryElement.addContent(vouchLedIsDeemPostvElement);</span>
<span class="nc" id="L961">			vouchLedEntryElement.addContent(vouchLedFromItemElement);</span>
<span class="nc" id="L962">			vouchLedEntryElement.addContent(vouchLedgerNameElement);</span>
<span class="nc" id="L963">			vouchLedEntryElement.addContent(vouchLedAmountElement);</span>

<span class="nc" id="L965">			tallyVouchElement.addContent(vouchLedEntryElement);</span>

		}
<span class="nc" id="L968">		return tallyVouchElement;</span>

	}

	/*
	 * public String zipLog(String filePath,String destPath) throws IOException,
	 * MessagingException{ sourceFile=source; destination=source+&quot;.zip&quot;;
	 * sourceFile=filePath; destination=destPath; BufferedInputStream origin =
	 * null; FileOutputStream dest = new FileOutputStream(destination);
	 * ZipOutputStream out = new ZipOutputStream(new
	 * BufferedOutputStream(dest));
	 * 
	 * byte data[] = new byte[BUFFER];
	 * 
	 * File f = new File(sourceFile);
	 * 
	 * FileInputStream fi = new FileInputStream(f); origin = new
	 * BufferedInputStream(fi, BUFFER); ZipEntry entry = new ZipEntry(filePath);
	 * out.putNextEntry(entry); int count; while((count = origin.read(data,
	 * 0,BUFFER)) != -1) { out.write(data, 0, count); } origin.close();
	 * 
	 * out.close();
	 * 
	 * System.out.println(&quot;Zipping Completed&quot;); long fileSize = new
	 * File(destination).length();
	 * 
	 * return destination; }
	 */

	public ZipOutputStream zipLog(FileOutputStream dest, List&lt;String&gt; fileList)
			throws IOException, MessagingException {
		// destination=source+&quot;.zip&quot;;
<span class="nc" id="L1000">		BufferedInputStream origin = null;</span>
		// FileOutputStream dest = new FileOutputStream(destination);
<span class="nc" id="L1002">		ZipOutputStream out = new ZipOutputStream(</span>
				new BufferedOutputStream(dest));
<span class="nc" id="L1004">		Iterator iterator = fileList.listIterator();</span>
<span class="nc" id="L1005">		int noOfFiles = 0;</span>
<span class="nc" id="L1006">		String filename = null;</span>
<span class="nc bnc" id="L1007" title="All 2 branches missed.">		while (iterator.hasNext()) {</span>
<span class="nc" id="L1008">			noOfFiles++;</span>
<span class="nc" id="L1009">			byte data[] = new byte[BUFFER];</span>
<span class="nc" id="L1010">			filename = (String) iterator.next();</span>
<span class="nc" id="L1011">			File f = new File(filename);</span>

<span class="nc" id="L1013">			FileInputStream fi = new FileInputStream(f);</span>
<span class="nc" id="L1014">			origin = new BufferedInputStream(fi, BUFFER);</span>
<span class="nc" id="L1015">			System.out.println(filename + &quot; |||||||||||||| &quot;);</span>
<span class="nc" id="L1016">			System.out.println(&quot;filename.lastIndexOf(/) &quot;</span>
					+ filename.lastIndexOf(&quot;/&quot;));
<span class="nc" id="L1018">			System.out.println(&quot;filename.lastIndexOf(.) &quot;</span>
					+ filename.indexOf(&quot;.&quot;));
<span class="nc" id="L1020">			filename = filename.substring(filename.lastIndexOf(&quot;/&quot;) + 1,</span>
					filename.lastIndexOf(&quot;.&quot;))
					+ &quot;.xml&quot;;
<span class="nc" id="L1023">			ZipEntry entry = new ZipEntry(filename);</span>
<span class="nc" id="L1024">			out.putNextEntry(entry);</span>
			int count;
<span class="nc bnc" id="L1026" title="All 2 branches missed.">			while ((count = origin.read(data, 0, BUFFER)) != -1) {</span>
<span class="nc" id="L1027">				out.write(data, 0, count);</span>
			}
<span class="nc" id="L1029">			origin.close();</span>

<span class="nc" id="L1031">			System.out.println(noOfFiles + &quot; ========= file count&quot;);</span>
<span class="nc" id="L1032">		}</span>
<span class="nc" id="L1033">		System.out.println(&quot;Zipping Completed&quot;);</span>
<span class="nc" id="L1034">		out.close();</span>
<span class="nc" id="L1035">		return out;</span>

	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>