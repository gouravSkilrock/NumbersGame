<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>IWAgentReportDaoImpl.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">lms</a> &gt; <a href="index.source.html" class="el_package">com.skilrock.lms.web.instantWin.reportsMgmt.daoImpl</a> &gt; <span class="el_source">IWAgentReportDaoImpl.java</span></div><h1>IWAgentReportDaoImpl.java</h1><pre class="source lang-java linenums">
package com.skilrock.lms.web.instantWin.reportsMgmt.daoImpl;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.sql.Timestamp;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.HashMap;
import java.util.Map;

import com.skilrock.lms.common.db.DBConnect;
import com.skilrock.lms.common.exception.GenericException;
import com.skilrock.lms.common.exception.LMSErrors;
import com.skilrock.lms.web.instantWin.reportsMgmt.beans.IWOrgReportRequestBean;
import com.skilrock.lms.web.instantWin.reportsMgmt.beans.IWOrgReportResponseBean;

<span class="nc" id="L20">public class IWAgentReportDaoImpl {</span>

	// private static final Logger logger = LoggerFactory
	// .getLogger(&quot;SLAgentReportDaoImpl&quot;);

	/**
	 * @param args
	 * @throws Exception
	 */
	/**
	 * @param args
	 * @throws Exception
	 */
	/**
	 * @param args
	 * @throws Exception
	 */
	public static void main(String[] args) throws Exception {
<span class="nc" id="L38">		DateFormat dateFormat = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);</span>
<span class="nc" id="L39">		IWOrgReportRequestBean requestBean = new IWOrgReportRequestBean();</span>
<span class="nc" id="L40">		requestBean.setOrgId(3);</span>
<span class="nc" id="L41">		requestBean.setFromDate(new Timestamp(dateFormat.parse(</span>
				&quot;2014-11-01 00:00:00&quot;).getTime()));
<span class="nc" id="L43">		requestBean.setToDate(new Timestamp(dateFormat.parse(</span>
				&quot;2014-11-11 00:00:00&quot;).getTime()));

		/*
		 * requestBean.setGameId(2); Map&lt;Integer, IWOrgReportResponseBean&gt;
		 * responseMap = fetchDirPlyPWTDataGameWiseMultipleAgent( requestBean,
		 * DBConnect.getConnection()); System.out.println(&quot;Res Map:&quot; +
		 * responseMap);
		 */

<span class="nc" id="L53">		requestBean.setGameId(1);</span>
<span class="nc" id="L54">		requestBean.setOrgId(1);</span>
<span class="nc" id="L55">		Map&lt;Integer, IWOrgReportResponseBean&gt; responseMap = fetchCancelDataGameWiseMultipleAgent(</span>
				requestBean, DBConnect.getConnection());

<span class="nc" id="L58">		System.out.println(&quot;Res Map:&quot; + responseMap);</span>
		// System.out.println(&quot;Res Map:&quot; + responseMap.get(1));
<span class="nc" id="L60">	}</span>

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;Integer, IWOrgReportResponseBean&gt; fetchSaleDataGameWiseMultipleAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L72">		Map&lt;Integer, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L73">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L74">		Statement stmt = null;</span>
<span class="nc" id="L75">		ResultSet rs = null;</span>
<span class="nc" id="L76">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L78">			responseBeanMap = new HashMap&lt;Integer, IWOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L83">			String archiveAppender = &quot; UNION ALL select organization_id,ifnull(sum(sale_net),0.0) as sale from st_rep_iw_agent where game_id=&quot;</span>
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by organization_id&quot;;

<span class="nc" id="L93">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L94">			saleQueryBuilder</span>
					.append(
							&quot;select parent_id,sum(main.sale) as sale from(select sale.parent_id,sum(sale) sale from(select organization_id,parent_id,SUM(ifnull(sale,0.0)) sale from st_lms_organization_master om left outer join (select srs.retailer_org_id,sum(agent_net_amt) as sale from st_iw_ret_sale srs inner join st_lms_retailer_transaction_master rtm on srs.transaction_id=rtm.transaction_id&quot;)
					.append(&quot; WHERE srs.game_id=&quot;)
					.append(requestBean.getGameId())
					.append(
							&quot; AND rtm.transaction_type in('IW_SALE') and rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; group by srs.retailer_org_id) sale on om.organization_id=retailer_org_id where om.organization_type='RETAILER' group by parent_id ) sale group by parent_id&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.parent_id&quot;);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L114">			stmt = connection.createStatement();</span>
<span class="nc" id="L115">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L116" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L117">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L118">				responseBean.setSaleAmt(rs.getDouble(&quot;sale&quot;));</span>
<span class="nc" id="L119">				responseBeanMap.put(rs.getInt(&quot;parent_id&quot;), responseBean);</span>
			}
<span class="nc" id="L121">		} catch (SQLException se) {</span>
<span class="nc" id="L122">			se.printStackTrace();</span>
<span class="nc" id="L123">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L124">		} catch (Exception e) {</span>
<span class="nc" id="L125">			e.printStackTrace();</span>
<span class="nc" id="L126">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L128">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L129">		}</span>

<span class="nc" id="L131">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;Integer, IWOrgReportResponseBean&gt; fetchSaleDataAllGameMultipleAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L144">		Map&lt;Integer, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L145">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L146">		Statement stmt = null;</span>
<span class="nc" id="L147">		ResultSet rs = null;</span>
<span class="nc" id="L148">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L150">			responseBeanMap = new HashMap&lt;Integer, IWOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L155">			String archiveAppender = &quot; UNION ALL select organization_id,ifnull(sum(sale_net),0.0) as sale from st_rep_iw_agent where organization_id in (select organization_id from st_lms_user_master where termination_date&gt;'&quot;+requestBean.getFromDate()+&quot;' or registration_date &lt;'&quot;+requestBean.getToDate()+&quot;' and isrolehead='Y' and organization_type='AGENT' ) and  finaldate&gt;=date('&quot;</span>
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by organization_id&quot;;

<span class="nc" id="L163">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L164">			saleQueryBuilder</span>
					.append(
							&quot;select parent_id,sum(main.sale) as sale from(select sale.parent_id,sum(sale) sale from(select organization_id,parent_id,ifnull(sum(sale),0.0) sale from st_lms_organization_master om left outer join (select drs.retailer_org_id,sum(agent_net_amt) as sale from st_iw_ret_sale&quot;)
					.append(
							&quot; drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.retailer_org_id in (select organization_id from st_lms_user_master where parent_user_id not in (select user_id from st_lms_user_master where termination_date&lt;'&quot;+requestBean.getFromDate()+&quot;' or registration_date &gt;'&quot;+requestBean.getToDate()+&quot;' and isrolehead='Y' and organization_type='AGENT' ) AND  organization_type='RETAILER' ) and  rtm.transaction_type in('IW_SALE') and rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; group by drs.retailer_org_id) sale on om.organization_id=retailer_org_id where om.organization_type='RETAILER' group by parent_id ) sale group by parent_id&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.parent_id&quot;);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L182">			System.out.println(&quot;fetchSaleDataMultipleAgent - &quot;+saleQueryBuilder.toString());</span>
			
<span class="nc" id="L184">			stmt = connection.createStatement();</span>
<span class="nc" id="L185">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L186" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L187">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L188">				responseBean.setSaleAmt(rs.getDouble(&quot;sale&quot;));</span>
<span class="nc" id="L189">				responseBeanMap.put(rs.getInt(&quot;parent_id&quot;), responseBean);</span>
			}
<span class="nc" id="L191">		} catch (SQLException se) {</span>
<span class="nc" id="L192">			se.printStackTrace();</span>
<span class="nc" id="L193">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L194">		} catch (Exception e) {</span>
<span class="nc" id="L195">			e.printStackTrace();</span>
<span class="nc" id="L196">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L198">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L199">		}</span>

<span class="nc" id="L201">		return responseBeanMap;</span>
	}
	
	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static void fetchSaleDataAllGameSingleAgent(
			IWOrgReportRequestBean requestBean, IWOrgReportResponseBean responseBean, Connection connection)
			throws GenericException {
<span class="nc" id="L214">		Statement stmt = null;</span>
<span class="nc" id="L215">		ResultSet rs = null;</span>
<span class="nc" id="L216">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L218">			String archiveAppender = &quot; UNION ALL SELECT organization_id,IFNULL(SUM(sale_net),0.0) AS sale FROM st_rep_iw_agent WHERE organization_id=&quot;</span>
					+ requestBean.getOrgId()
					+ &quot; AND finaldate&gt;=DATE('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=DATE('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;;

<span class="nc" id="L227">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L228">			saleQueryBuilder</span>
					.append(
							&quot;select parent_id,sum(main.sale) as sale from (select sale.parent_id,sum(sale) sale from (select organization_id,parent_id,ifnull(sale,0.0) sale from st_lms_organization_master om left outer join (select retailer_org_id,sum(agent_net_amt) as sale from st_iw_ret_sale WHERE transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(&quot; group by retailer_org_id) sale on om.organization_id=retailer_org_id where om.organization_type='RETAILER' and om.parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(&quot;) sale&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.parent_id&quot;);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L245">			System.out.println(&quot;fetchSaleDataAllGameSingleAgent - &quot;+saleQueryBuilder.toString());</span>
			
<span class="nc" id="L247">			stmt = connection.createStatement();</span>
<span class="nc" id="L248">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L249" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L250">				responseBean.setSaleAmt(responseBean.getSaleAmt()+ rs.getDouble(&quot;sale&quot;));</span>
			}
<span class="nc" id="L252">		} catch (SQLException se) {</span>
<span class="nc" id="L253">			se.printStackTrace();</span>
<span class="nc" id="L254">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L255">		} catch (Exception e) {</span>
<span class="nc" id="L256">			e.printStackTrace();</span>
<span class="nc" id="L257">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L259">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L260">		}</span>
		
<span class="nc" id="L262">	}</span>

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchSaleDataDayWisePerGameForBO(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L274">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L275">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L276">		Statement stmt = null;</span>
<span class="nc" id="L277">		ResultSet rs = null;</span>
<span class="nc" id="L278">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L280">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

<span class="nc" id="L282">			String archiveAppender = &quot; union all select finaldate as alldate, SUM(sale_net) as sale from st_rep_iw_agent where organization_id in (select organization_id from st_lms_user_master  where (termination_date &gt; '&quot;+requestBean.getFromDate()+&quot;' or registration_date&lt; '&quot;+requestBean.getToDate()+&quot;') and isrolehead='Y' and organization_type='AGENT') and  game_id=&quot;</span>
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY finaldate&quot;;

<span class="nc" id="L292">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L293">			saleQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.sale)as sale from (select sale.alldate,ifnull(sale,0.0) sale from(select alldate,sale from tempdate left outer join (select date(rtm.transaction_date) tx_date,sum(agent_net_amt) sale from st_iw_ret_sale&quot;)
					.append(
							&quot; srs inner join st_lms_retailer_transaction_master rtm on srs.transaction_id=rtm.transaction_id where rtm.retailer_org_id in (select organization_id from st_lms_user_master where parent_user_id not in (select user_id from st_lms_user_master  where (termination_date &lt; '&quot;+requestBean.getFromDate()+&quot;' or registration_date&gt; '&quot;+requestBean.getToDate()+&quot;') and isrolehead='Y' and organization_type='AGENT') and organization_type='RETAILER' ) and srs.game_id=&quot;)
					.append(requestBean.getGameId())
					.append(&quot; AND rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('IW_SALE') group by tx_date) sale on alldate=sale.tx_date) sale&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L313">			System.out.println(&quot;fetchSaleDataSingleAgent - &quot;</span>
					+ saleQueryBuilder.toString());

<span class="nc" id="L316">			stmt = connection.createStatement();</span>
<span class="nc" id="L317">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L318" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L319">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L320">				responseBean.setSaleAmt(rs.getDouble(&quot;sale&quot;));</span>
<span class="nc" id="L321">				responseBeanMap.put(rs.getDate(&quot;alldate&quot;).toString(), responseBean);</span>
			}
<span class="nc" id="L323">		} catch (SQLException se) {</span>
<span class="nc" id="L324">			se.printStackTrace();</span>
<span class="nc" id="L325">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L326">		} catch (Exception e) {</span>
<span class="nc" id="L327">			e.printStackTrace();</span>
<span class="nc" id="L328">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L330">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L331">		}</span>
		 
		
<span class="nc" id="L334">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchSaleDataDayWiseAllGameForBO(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L347">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L348">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L349">		Statement stmt = null;</span>
<span class="nc" id="L350">		ResultSet rs = null;</span>
<span class="nc" id="L351">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L353">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

<span class="nc" id="L355">			String archiveAppender = &quot; union all select finaldate as alldate, SUM(sale_net) as sale from st_rep_iw_agent where finaldate&gt;=date('&quot;</span>
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY organization_id&quot;;

<span class="nc" id="L363">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L364">			saleQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.sale)as sale from (select sale.alldate,ifnull(sale,0.0) sale from(select alldate,sale from tempdate left outer join (select date(rtm.transaction_date) tx_date,sum(agent_net_amt) sale from st_iw_ret_sale&quot;)
					.append(
							&quot; drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('IW_SALE') group by tx_date) sale on alldate=sale.tx_date) sale&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L382">			System.out.println(&quot;fetchSaleDataSingleAgent - &quot;</span>
					+ saleQueryBuilder.toString());

<span class="nc" id="L385">			stmt = connection.createStatement();</span>
<span class="nc" id="L386">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L387" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L388">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L389">				responseBean.setSaleAmt(rs.getDouble(&quot;sale&quot;));</span>
<span class="nc" id="L390">				responseBeanMap.put(rs.getString(&quot;alldate&quot;), responseBean);</span>
			}
<span class="nc" id="L392">		} catch (SQLException se) {</span>
<span class="nc" id="L393">			se.printStackTrace();</span>
<span class="nc" id="L394">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L395">		} catch (Exception e) {</span>
<span class="nc" id="L396">			e.printStackTrace();</span>
<span class="nc" id="L397">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L399">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L400">		}</span>

<span class="nc" id="L402">		return responseBeanMap;</span>
	}

	/**
	 * For Sale-PWT Report view by Agent
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchSaleDataDayWisePerGameForAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L416">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L417">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L418">		Statement stmt = null;</span>
<span class="nc" id="L419">		ResultSet rs = null;</span>
<span class="nc" id="L420">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L422">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>
//TODO: Check this for single Agent...
<span class="nc" id="L424">			String archiveAppend = &quot; UNION ALL select finaldate,ifnull(sum(sale_net),0.0) as sale from st_rep_iw_retailer where parent_id =&quot; +requestBean.getOrgId()+&quot; and  finaldate&gt;=date('&quot;</span>
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by finaldate&quot;;

<span class="nc" id="L432">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L433">			saleQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.sale)as sale from (select sale.alldate,ifnull(sale,0.0) sale from(select alldate,sale1.sale from tempdate left outer join (select organization_id,sale.tx_date,sale.sale from st_lms_organization_master om left outer join (select date(rtm.transaction_date) tx_date,sum(agent_net_amt) sale, rtm.retailer_org_id from st_iw_ret_sale drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where drs.game_id=&quot;)
					.append(requestBean.getGameId())
					.append(&quot; AND rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; AND rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('IW_SALE') group by tx_date,retailer_org_id) sale on retailer_org_id=om.organization_id where parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(
							&quot; group by sale.tx_date,organization_id) sale1 on alldate=sale1.tx_date) sale&quot;)
					.append(archiveAppend).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L454">			System.out.println(&quot;fetchSaleDataSingleAgentViewByAgent - &quot;</span>
					+ saleQueryBuilder.toString());

<span class="nc" id="L457">			stmt = connection.createStatement();</span>
<span class="nc" id="L458">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L459" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L460">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L461">				responseBean.setSaleAmt(rs.getDouble(&quot;sale&quot;));</span>
<span class="nc" id="L462">				responseBeanMap.put(rs.getString(&quot;alldate&quot;).split(&quot; &quot;)[0], responseBean);</span>
			}
<span class="nc" id="L464">		} catch (SQLException se) {</span>
<span class="nc" id="L465">			se.printStackTrace();</span>
<span class="nc" id="L466">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L467">		} catch (Exception e) {</span>
<span class="nc" id="L468">			e.printStackTrace();</span>
<span class="nc" id="L469">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L471">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L472">		}</span>

<span class="nc" id="L474">		return responseBeanMap;</span>
	}

	/**
	 * For Sale-PWT Report view by Agent
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchSaleDataDayWiseAllGameForAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L488">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L489">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L490">		Statement stmt = null;</span>
<span class="nc" id="L491">		ResultSet rs = null;</span>
<span class="nc" id="L492">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L494">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

<span class="nc" id="L496">			String archiveAppender = &quot; union all select sgr.finaldate as alldate,sum(sgr.sale_net) as sale from st_rep_iw_retailer as sgr left outer join  st_rep_iw_agent as sga on sgr.finaldate=sga.finaldate and sgr.parent_id=sga.parent_id where sgr.parent_id=&quot;</span>
					+ requestBean.getOrgId()
					// + &quot; AND sgr.game_id=&quot;
					// + requestBean.getGameId()
					+ &quot; AND sgr.finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND sgr.finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by sgr.finaldate&quot;;

<span class="nc" id="L508">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L509">			saleQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.sale)as sale from (select sale.alldate,ifnull(sale,0.0) sale from(select alldate,sale1.sale from tempdate left outer join (select organization_id,sale.tx_date,sale.sale from st_lms_organization_master om left outer join (select date(rtm.transaction_date) tx_date,sum(retailer_net_amt) sale, rtm.retailer_org_id from st_iw_ret_sale&quot;)
					// .append(requestBean.getGameId())
					.append(
							&quot; drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('IW_SALE')) sale on retailer_org_id=om.organization_id where parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(
							&quot; group by sale.tx_date) sale1 on alldate=sale1.tx_date) sale&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L531">			System.out.println(&quot;fetchSaleDataSingleAgentViewByAgent - &quot;</span>
					+ saleQueryBuilder.toString());

<span class="nc" id="L534">			stmt = connection.createStatement();</span>
<span class="nc" id="L535">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L536" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L537">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L538">				responseBean.setSaleAmt(rs.getDouble(&quot;sale&quot;));</span>
<span class="nc" id="L539">				responseBeanMap.put(rs.getString(&quot;alldate&quot;), responseBean);</span>
			}
<span class="nc" id="L541">		} catch (SQLException se) {</span>
<span class="nc" id="L542">			se.printStackTrace();</span>
<span class="nc" id="L543">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L544">		} catch (Exception e) {</span>
<span class="nc" id="L545">			e.printStackTrace();</span>
<span class="nc" id="L546">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L548">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L549">		}</span>

<span class="nc" id="L551">		return responseBeanMap;</span>
	}
	
	/**
	 * For Payment-Ledger Report view by BO
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchSaleDataDayWiseAllGameSingleAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L565">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L566">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L567">		Statement stmt = null;</span>
<span class="nc" id="L568">		ResultSet rs = null;</span>
<span class="nc" id="L569">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L571">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

<span class="nc" id="L573">			String archiveAppender = &quot; union all SELECT finaldate,organization_id,SUM(sale_net) AS sale FROM st_rep_iw_agent WHERE finaldate&gt;='&quot;</span>
					+ requestBean.getFromDate()
					+ &quot;' AND finaldate&lt;='&quot;
					+ requestBean.getToDate()
					+ &quot;'AND organization_id=&quot;
					+ requestBean.getOrgId()
					+ &quot; GROUP BY finaldate&quot;;

<span class="nc" id="L581">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L582">			saleQueryBuilder</span>
					.append(
							&quot;SELECT DATE(transaction_date) DATE,parent_id,SUM(sale) AS sale FROM (SELECT retailer_org_id,SUM(agent_net_amt) AS sale,transaction_DATE FROM st_iw_ret_sale WHERE transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;' AND transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;' AND retailer_org_id IN (SELECT organization_id FROM st_lms_organization_master WHERE organization_type='RETAILER') GROUP BY DATE(transaction_date),retailer_org_id)aa,st_lms_organization_master bb WHERE retailer_org_id=organization_id AND parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(&quot; GROUP BY DATE(transaction_date)&quot;)
					.append(archiveAppender);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L596">			System.out.println(&quot;fetchSaleDataDayWiseAllGameSingleAgent - &quot;</span>
					+ saleQueryBuilder.toString());

<span class="nc" id="L599">			stmt = connection.createStatement();</span>
<span class="nc" id="L600">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L601" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L602">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L603">				responseBean.setSaleAmt(rs.getDouble(&quot;sale&quot;));</span>
<span class="nc" id="L604">				responseBeanMap.put(rs.getString(&quot;date&quot;), responseBean);</span>
			}
<span class="nc" id="L606">		} catch (SQLException se) {</span>
<span class="nc" id="L607">			se.printStackTrace();</span>
<span class="nc" id="L608">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L609">		} catch (Exception e) {</span>
<span class="nc" id="L610">			e.printStackTrace();</span>
<span class="nc" id="L611">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L613">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L614">		}</span>

<span class="nc" id="L616">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;Integer, IWOrgReportResponseBean&gt; fetchCancelDataGameWiseMultipleAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L629">		Map&lt;Integer, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L630">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L631">		Statement stmt = null;</span>
<span class="nc" id="L632">		ResultSet rs = null;</span>
<span class="nc" id="L633">		StringBuilder cancelQueryBuilder = null;</span>
		try {
<span class="nc" id="L635">			responseBeanMap = new HashMap&lt;Integer, IWOrgReportResponseBean&gt;();</span>

<span class="nc" id="L637">			String archiveAppender = &quot; UNION ALL select organization_id,sum(ref_net_amt) as cancel from st_rep_iw_agent where game_id=&quot;</span>
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by organization_id&quot;;

<span class="nc" id="L647">			cancelQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L648">			cancelQueryBuilder</span>
					.append(
							&quot;select parent_id,sum(main.cancel) as cancel from (select cancel.parent_id,sum(cancel) cancel from (select organization_id,parent_id,ifnull(cancel,0.0) cancel from st_lms_organization_master om left outer join (select drs.retailer_org_id,sum(agent_net_amt) as cancel from st_iw_ret_sale_refund drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where drs.game_id=&quot;)
					.append(requestBean.getGameId())
					.append(
							&quot; AND rtm.transaction_type in('IW_REFUND_CANCEL','IW_REFUND_FAILED') and rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; AND rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; group by drs.retailer_org_id)cancel on om.organization_id=retailer_org_id where om.organization_type='RETAILER' group by parent_id ) cancel group by parent_id&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.parent_id&quot;);
			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L666">			System.out.println(&quot;fetchCancelDataMultipleAgent - &quot;</span>
					+ cancelQueryBuilder.toString());

<span class="nc" id="L669">			stmt = connection.createStatement();</span>
<span class="nc" id="L670">			rs = stmt.executeQuery(cancelQueryBuilder.toString());</span>
<span class="nc bnc" id="L671" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L672">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L673">				responseBean.setCancelAmt(rs.getDouble(&quot;cancel&quot;));</span>
<span class="nc" id="L674">				responseBeanMap.put(rs.getInt(&quot;parent_id&quot;), responseBean);</span>
			}
<span class="nc" id="L676">			System.out.println(&quot;fetchCancelDataMultipleAgent - &quot;</span>
					+ cancelQueryBuilder.toString());
<span class="nc" id="L678">		} catch (SQLException se) {</span>
<span class="nc" id="L679">			se.printStackTrace();</span>
<span class="nc" id="L680">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L681">		} catch (Exception e) {</span>
<span class="nc" id="L682">			e.printStackTrace();</span>
<span class="nc" id="L683">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L685">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L686">		}</span>

<span class="nc" id="L688">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;Integer, IWOrgReportResponseBean&gt; fetchCancelDataAllGameMultipleAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L701">		Map&lt;Integer, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L702">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L703">		Statement stmt = null;</span>
<span class="nc" id="L704">		ResultSet rs = null;</span>
<span class="nc" id="L705">		StringBuilder cancelQueryBuilder = null;</span>
		try {
<span class="nc" id="L707">			responseBeanMap = new HashMap&lt;Integer, IWOrgReportResponseBean&gt;();</span>

<span class="nc" id="L709">			String archiveAppender = &quot; UNION ALL select organization_id,sum(ref_net_amt) as cancel from st_rep_iw_agent where organization_id in (select organization_id from st_lms_user_master where termination_date&gt;'&quot;+requestBean.getFromDate()+&quot;' or registration_date &lt;'&quot;+requestBean.getToDate()+&quot;' and isrolehead='Y' and organization_type='AGENT' ) and finaldate&gt;=date('&quot;</span>
					// + requestBean.getGameId()
					// + &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by organization_id&quot;;

<span class="nc" id="L719">			cancelQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L720">			cancelQueryBuilder</span>
					.append(
							&quot;select parent_id,sum(main.cancel) as cancel from (select cancel.parent_id,sum(cancel) cancel from (select organization_id,parent_id,ifnull(sum(cancel),0.0) cancel from st_lms_organization_master om left outer join (select drs.retailer_org_id,sum(agent_net_amt) as cancel from st_iw_ret_sale_refund&quot;)
					// .append(requestBean.getGameId())
					.append(
							&quot; drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.retailer_org_id in (select organization_id from st_lms_user_master where parent_user_id not in (select user_id from st_lms_user_master where termination_date&lt;'&quot;+requestBean.getFromDate()+&quot;' or registration_date &gt;'&quot;+requestBean.getToDate()+&quot;' and isrolehead='Y' and organization_type='AGENT' ) AND  organization_type='RETAILER' ) and  rtm.transaction_type in('IW_REFUND_CANCEL','IW_REFUND_FAILED') and rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; group by drs.retailer_org_id)cancel on om.organization_id=retailer_org_id where om.organization_type='RETAILER' group by parent_id ) cancel group by parent_id&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.parent_id&quot;);
			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L738">			System.out.println(&quot;fetchCancelDataMultipleAgent - &quot;</span>
					+ cancelQueryBuilder.toString());

<span class="nc" id="L741">			stmt = connection.createStatement();</span>
<span class="nc" id="L742">			rs = stmt.executeQuery(cancelQueryBuilder.toString());</span>
<span class="nc bnc" id="L743" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L744">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L745">				responseBean.setCancelAmt(rs.getDouble(&quot;cancel&quot;));</span>
<span class="nc" id="L746">				responseBeanMap.put(rs.getInt(&quot;parent_id&quot;), responseBean);</span>
			}
<span class="nc" id="L748">			System.out.println(&quot;fetchCancelDataMultipleAgent - &quot; + cancelQueryBuilder.toString());</span>
<span class="nc" id="L749">		} catch (SQLException se) {</span>
<span class="nc" id="L750">			se.printStackTrace();</span>
<span class="nc" id="L751">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L752">		} catch (Exception e) {</span>
<span class="nc" id="L753">			e.printStackTrace();</span>
<span class="nc" id="L754">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L756">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L757">		}</span>

<span class="nc" id="L759">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchCancelDataDayWisePerGameForBO(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L772">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L773">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L774">		Statement stmt = null;</span>
<span class="nc" id="L775">		ResultSet rs = null;</span>
<span class="nc" id="L776">		StringBuilder cancelQueryBuilder = null;</span>
		try {
<span class="nc" id="L778">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L783">			String archiveAppender = &quot; union all select finaldate as alldate, SUM(ref_net_amt) as cancel from st_rep_iw_agent where organization_id in (select organization_id from st_lms_user_master  where (termination_date &gt; '&quot;+requestBean.getFromDate()+&quot;' or registration_date&lt; '&quot;+requestBean.getToDate()+&quot;') and isrolehead='Y' and organization_type='AGENT') and  game_id=&quot;</span>
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY finaldate&quot;;

<span class="nc" id="L793">			cancelQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L794">			cancelQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.cancel)as cancel from (select cancel.alldate,ifnull(cancel,0.0) cancel from(select alldate,cancel from tempdate left outer join (select date(rtm.transaction_date) tx_date,sum(agent_net_amt) cancel from st_iw_ret_sale_refund drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.retailer_org_id in (select organization_id from st_lms_user_master where parent_user_id not in (select user_id from st_lms_user_master  where (termination_date &lt; '&quot;+requestBean.getFromDate()+&quot;' or registration_date&gt; '&quot;+requestBean.getToDate()+&quot;') and isrolehead='Y' and organization_type='AGENT') and organization_type='RETAILER' ) and  drs.game_id=&quot;)
					.append(requestBean.getGameId())
					.append(&quot; AND rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; AND rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('IW_REFUND_CANCEL','IW_REFUND_FAILED') group by tx_date) cancel on alldate=cancel.tx_date) cancel&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchCancelDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L812">			System.out.println(&quot;fetchCancelDataDayWisePerGameSingleAgent - &quot;</span>
					+ cancelQueryBuilder.toString());

<span class="nc" id="L815">			stmt = connection.createStatement();</span>
<span class="nc" id="L816">			rs = stmt.executeQuery(cancelQueryBuilder.toString());</span>
<span class="nc bnc" id="L817" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L818">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L819">				responseBean.setCancelAmt(rs.getDouble(&quot;cancel&quot;));</span>
<span class="nc" id="L820">				responseBeanMap.put(rs.getDate(&quot;alldate&quot;).toString(), responseBean);</span>
			}
<span class="nc" id="L822">		} catch (SQLException se) {</span>
<span class="nc" id="L823">			se.printStackTrace();</span>
<span class="nc" id="L824">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L825">		} catch (Exception e) {</span>
<span class="nc" id="L826">			e.printStackTrace();</span>
<span class="nc" id="L827">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L829">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L830">		}</span>

<span class="nc" id="L832">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchCancelDataDayWiseAllGameForBO(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L845">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L846">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L847">		Statement stmt = null;</span>
<span class="nc" id="L848">		ResultSet rs = null;</span>
<span class="nc" id="L849">		StringBuilder cancelQueryBuilder = null;</span>
		try {
<span class="nc" id="L851">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L856">			String archiveAppender = &quot; union all select finaldate as alldate, SUM(ref_net_amt) as cancel from st_rep_iw_agent where finaldate&gt;=date('&quot;</span>
					// + requestBean.getGameId()
					// + &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY organization_id&quot;;

<span class="nc" id="L866">			cancelQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L867">			cancelQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.cancel)as cancel from (select cancel.alldate,ifnull(cancel,0.0) cancel from(select alldate,cancel from tempdate left outer join (select date(transaction_date) tx_date,sum(agent_net_amt) cancel from st_iw_ret_sale_refund drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					// .append(requestBean.getGameId())
					// .append(
					// &quot; drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('IW_REFUND_CANCEL','IW_REFUND_FAILED') group by tx_date) cancel on alldate=cancel.tx_date) cancel&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchCancelDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L886">			System.out.println(&quot;fetchCancelDataDayWisePerGameSingleAgent - &quot;</span>
					+ cancelQueryBuilder.toString());

<span class="nc" id="L889">			stmt = connection.createStatement();</span>
<span class="nc" id="L890">			rs = stmt.executeQuery(cancelQueryBuilder.toString());</span>
<span class="nc bnc" id="L891" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L892">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L893">				responseBean.setCancelAmt(rs.getDouble(&quot;cancel&quot;));</span>
<span class="nc" id="L894">				responseBeanMap.put(rs.getString(&quot;alldate&quot;), responseBean);</span>
			}
<span class="nc" id="L896">		} catch (SQLException se) {</span>
<span class="nc" id="L897">			se.printStackTrace();</span>
<span class="nc" id="L898">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L899">		} catch (Exception e) {</span>
<span class="nc" id="L900">			e.printStackTrace();</span>
<span class="nc" id="L901">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L903">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L904">		}</span>

<span class="nc" id="L906">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchCancelDataDayWisePerGameForAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L919">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L920">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L921">		Statement stmt = null;</span>
<span class="nc" id="L922">		ResultSet rs = null;</span>
<span class="nc" id="L923">		StringBuilder cancelQueryBuilder = null;</span>
		try {
<span class="nc" id="L925">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L930">			String archiveAppender = &quot; union all select sgr.finaldate as alldate,sum(sgr.ref_net_amt) as cancel from st_rep_iw_retailer as sgr where sgr.parent_id=&quot;</span>
					+ requestBean.getOrgId()
					+ &quot; AND sgr.game_id=&quot;
					+ requestBean.getGameId()
					+ &quot; AND sgr.finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND sgr.finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot; + &quot; group by sgr.finaldate&quot;;

<span class="nc" id="L941">			cancelQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L942">			cancelQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.cancel)as cancel from (select cancel.alldate,ifnull(cancel,0.0) cancel from(select alldate,cancel1.cancel from tempdate left outer join (select organization_id,cancel.tx_date,cancel.cancel from st_lms_organization_master om left outer join (select date(rtm.transaction_date) tx_date,sum(retailer_net_amt) cancel, rtm.retailer_org_id from st_iw_ret_sale_refund srs inner join st_lms_retailer_transaction_master rtm on srs.transaction_id=rtm.transaction_id where srs.game_id=&quot;)
					.append(requestBean.getGameId())
					.append(&quot; AND rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; AND rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('IW_REFUND_CANCEL','IW_REFUND_FAILED') group by tx_date,retailer_org_id) cancel on retailer_org_id=om.organization_id where parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(
							&quot; group by cancel.tx_date,organization_id) cancel1 on alldate=cancel1.tx_date) cancel&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchCancelDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L963">			System.out</span>
					.println(&quot;fetchCancelDataDayWisePerGameSingleAgentViewByAgent - &quot;
							+ cancelQueryBuilder.toString());

<span class="nc" id="L967">			stmt = connection.createStatement();</span>
<span class="nc" id="L968">			rs = stmt.executeQuery(cancelQueryBuilder.toString());</span>
<span class="nc bnc" id="L969" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L970">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L971">				responseBean.setCancelAmt(rs.getDouble(&quot;cancel&quot;));</span>
<span class="nc" id="L972">				responseBeanMap.put(rs.getString(&quot;alldate&quot;).split(&quot; &quot;)[0], responseBean);</span>
			}
<span class="nc" id="L974">		} catch (SQLException se) {</span>
<span class="nc" id="L975">			se.printStackTrace();</span>
<span class="nc" id="L976">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L977">		} catch (Exception e) {</span>
<span class="nc" id="L978">			e.printStackTrace();</span>
<span class="nc" id="L979">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L981">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L982">		}</span>

<span class="nc" id="L984">		return responseBeanMap;</span>
	}
	
	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static void fetchCancelDataAllGameSingleAgent(
			IWOrgReportRequestBean requestBean, IWOrgReportResponseBean responseBean, Connection connection)
			throws GenericException {
<span class="nc" id="L997">		Statement stmt = null;</span>
<span class="nc" id="L998">		ResultSet rs = null;</span>
<span class="nc" id="L999">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L1001">			String archiveAppender = &quot; UNION ALL SELECT organization_id,IFNULL(SUM(ref_net_amt),0.0) AS cancel FROM st_rep_iw_agent WHERE organization_id=&quot;</span>
					+ requestBean.getOrgId()
					+ &quot; AND finaldate&gt;=DATE('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=DATE('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;;

<span class="nc" id="L1010">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1011">			saleQueryBuilder</span>
					.append(
							&quot;SELECT parent_id,sum(main.cancel) as cancel from (select cancel.parent_id,sum(cancel) cancel from (select organization_id,parent_id,ifnull(cancel,0.0) cancel from st_lms_organization_master om left outer join (select retailer_org_id,sum(agent_net_amt) as cancel from st_iw_ret_sale_refund WHERE transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; AND transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(&quot; group by retailer_org_id) cancel on om.organization_id=retailer_org_id where om.organization_type='RETAILER' and om.parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(&quot;) cancel&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.parent_id&quot;);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L1028">			System.out.println(&quot;fetchCancelDataAllGameSingleAgent - &quot;+saleQueryBuilder.toString());</span>
			
<span class="nc" id="L1030">			stmt = connection.createStatement();</span>
<span class="nc" id="L1031">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L1032" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1033">				responseBean.setCancelAmt(responseBean.getCancelAmt() + rs.getDouble(&quot;cancel&quot;));</span>
			}
<span class="nc" id="L1035">		} catch (SQLException se) {</span>
<span class="nc" id="L1036">			se.printStackTrace();</span>
<span class="nc" id="L1037">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1038">		} catch (Exception e) {</span>
<span class="nc" id="L1039">			e.printStackTrace();</span>
<span class="nc" id="L1040">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1042">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1043">		}</span>

<span class="nc" id="L1045">	}</span>

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchCancelDataDayWiseAllGameForAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1057">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1058">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1059">		Statement stmt = null;</span>
<span class="nc" id="L1060">		ResultSet rs = null;</span>
<span class="nc" id="L1061">		StringBuilder cancelQueryBuilder = null;</span>
		try {
<span class="nc" id="L1063">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L1068">			String archiveAppender = &quot; union all select sgr.finaldate as alldate,sum(sgr.ref_net_amt) as cancel from st_rep_iw_retailer as sgr left outer join  st_rep_iw_agent as sga on sgr.finaldate=sga.finaldate and sgr.parent_id=sga.parent_id where sgr.parent_id=&quot;</span>
					+ requestBean.getOrgId()
					// + &quot; AND sgr.game_id=&quot;
					// + requestBean.getGameId()
					+ &quot; AND sgr.finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND sgr.finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by sgr.finaldate&quot;;

<span class="nc" id="L1080">			cancelQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1081">			cancelQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.cancel)as cancel from (select cancel.alldate,ifnull(cancel,0.0) cancel from(select alldate,cancel1.cancel from tempdate left outer join (select organization_id,cancel.tx_date,cancel.cancel from st_lms_organization_master om left outer join (select date(rtm.transaction_date) tx_date,sum(agent_net_amt) cancel, rtm.retailer_org_id from st_iw_ret_sale_refund srs inner join st_lms_retailer_transaction_master rtm on srs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					// .append(requestBean.getGameId())
					// .append(
					// &quot; srs inner join st_lms_retailer_transaction_master rtm on srs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('IW_REFUND_CANCEL','IW_REFUND_FAILED')) cancel on retailer_org_id=om.organization_id where parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(
							&quot; group by cancel.tx_date) cancel1 on alldate=cancel1.tx_date) cancel&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchCancelDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L1103">			System.out</span>
					.println(&quot;fetchCancelDataDayWisePerGameSingleAgentViewByAgent - &quot;
							+ cancelQueryBuilder.toString());

<span class="nc" id="L1107">			stmt = connection.createStatement();</span>
<span class="nc" id="L1108">			rs = stmt.executeQuery(cancelQueryBuilder.toString());</span>
<span class="nc bnc" id="L1109" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1110">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L1111">				responseBean.setCancelAmt(rs.getDouble(&quot;cancel&quot;));</span>
<span class="nc" id="L1112">				responseBeanMap.put(rs.getString(&quot;alldate&quot;), responseBean);</span>
			}
<span class="nc" id="L1114">		} catch (SQLException se) {</span>
<span class="nc" id="L1115">			se.printStackTrace();</span>
<span class="nc" id="L1116">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1117">		} catch (Exception e) {</span>
<span class="nc" id="L1118">			e.printStackTrace();</span>
<span class="nc" id="L1119">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1121">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1122">		}</span>

<span class="nc" id="L1124">		return responseBeanMap;</span>
	}
	
	/**
	 * For Payment-Ledger Report view by BO
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchCancelDataDayWiseAllGameSingleAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1138">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1139">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1140">		Statement stmt = null;</span>
<span class="nc" id="L1141">		ResultSet rs = null;</span>
<span class="nc" id="L1142">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L1144">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

<span class="nc" id="L1146">			String archiveAppender = &quot; UNION ALL SELECT finaldate,organization_id,SUM(ref_net_amt) AS cancel FROM st_rep_iw_agent WHERE finaldate&gt;='&quot;</span>
					+ requestBean.getFromDate()
					+ &quot;' AND finaldate&lt;='&quot;
					+ requestBean.getToDate()
					+ &quot;'AND organization_id=&quot;
					+ requestBean.getOrgId()
					+ &quot; GROUP BY finaldate&quot;;

<span class="nc" id="L1154">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1155">			saleQueryBuilder</span>
					.append(&quot;SELECT DATE(transaction_date) DATE,parent_id,SUM(cancel) AS cancel FROM (SELECT retailer_org_id,SUM(agent_net_amt) AS cancel,transaction_date FROM st_iw_ret_sale_refund WHERE transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;' AND transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;' AND retailer_org_id IN (SELECT organization_id FROM st_lms_organization_master WHERE organization_type='RETAILER') GROUP BY DATE(transaction_date),retailer_org_id)aa,st_lms_organization_master bb WHERE retailer_org_id=organization_id AND parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(&quot; GROUP BY DATE(transaction_date)&quot;)
					.append(archiveAppender);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L1168">			System.out.println(&quot;fetchCancelDataDayWiseAllGameSingleAgent - &quot;+ saleQueryBuilder.toString());</span>

<span class="nc" id="L1170">			stmt = connection.createStatement();</span>
<span class="nc" id="L1171">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L1172" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1173">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L1174">				responseBean.setCancelAmt(rs.getDouble(&quot;cancel&quot;));</span>
<span class="nc" id="L1175">				responseBeanMap.put(rs.getString(&quot;date&quot;), responseBean);</span>
			}
<span class="nc" id="L1177">		} catch (SQLException se) {</span>
<span class="nc" id="L1178">			se.printStackTrace();</span>
<span class="nc" id="L1179">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1180">		} catch (Exception e) {</span>
<span class="nc" id="L1181">			e.printStackTrace();</span>
<span class="nc" id="L1182">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1184">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1185">		}</span>

<span class="nc" id="L1187">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;Integer, IWOrgReportResponseBean&gt; fetchPWTDataGameWiseMultipleAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1200">		Map&lt;Integer, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1201">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1202">		Statement stmt = null;</span>
<span class="nc" id="L1203">		ResultSet rs = null;</span>
<span class="nc" id="L1204">		StringBuilder pwtQueryBuilder = null;</span>
		try {
<span class="nc" id="L1206">			responseBeanMap = new HashMap&lt;Integer, IWOrgReportResponseBean&gt;();</span>

<span class="nc" id="L1208">			String archiveAppender = &quot; UNION ALL select organization_id,sum(pwt_net_amt) as pwt from st_rep_iw_agent where game_id=&quot;</span>
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by organization_id&quot;;

<span class="nc" id="L1218">			pwtQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1219">			pwtQueryBuilder</span>
					.append(
							&quot;select parent_id,sum(main.pwt) as pwt from (select pwt.parent_id,sum(pwt) pwt from (select organization_id,parent_id,ifnull(pwt,0.0) pwt from st_lms_organization_master om left outer join (select drs.retailer_org_id,sum(pwt_amt+agt_claim_comm) as pwt from st_iw_ret_pwt drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where drs.game_id=&quot;)
					.append(requestBean.getGameId())
					.append(
							&quot; AND rtm.transaction_type in('IW_PWT_AUTO','IW_PWT_PLR','IW_PWT') and rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; group by drs.retailer_org_id) pwt on om.organization_id=retailer_org_id where om.organization_type='RETAILER' group by parent_id ) pwt group by parent_id&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.parent_id&quot;);
			// logger.debug(&quot;fetchPWTDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L1237">			System.out.println(&quot;fetchPWTDataMultipleAgent - &quot;</span>
					+ pwtQueryBuilder.toString());

<span class="nc" id="L1240">			stmt = connection.createStatement();</span>
<span class="nc" id="L1241">			rs = stmt.executeQuery(pwtQueryBuilder.toString());</span>
<span class="nc bnc" id="L1242" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1243">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L1244">				responseBean.setPwtAmt(rs.getDouble(&quot;pwt&quot;));</span>
<span class="nc" id="L1245">				responseBeanMap.put(rs.getInt(&quot;parent_id&quot;), responseBean);</span>
			}
<span class="nc" id="L1247">		} catch (SQLException se) {</span>
<span class="nc" id="L1248">			se.printStackTrace();</span>
<span class="nc" id="L1249">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1250">		} catch (Exception e) {</span>
<span class="nc" id="L1251">			e.printStackTrace();</span>
<span class="nc" id="L1252">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1254">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1255">		}</span>

<span class="nc" id="L1257">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;Integer, IWOrgReportResponseBean&gt; fetchPWTDataAllGameMultipleAgent(IWOrgReportRequestBean requestBean, Connection connection) throws GenericException {
<span class="nc" id="L1268">		Map&lt;Integer, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1269">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1270">		Statement stmt = null;</span>
<span class="nc" id="L1271">		ResultSet rs = null;</span>
<span class="nc" id="L1272">		StringBuilder pwtQueryBuilder = null;</span>
		try {
<span class="nc" id="L1274">			responseBeanMap = new HashMap&lt;Integer, IWOrgReportResponseBean&gt;();</span>

<span class="nc" id="L1276">			String archiveAppender = &quot; UNION ALL select organization_id,sum(pwt_net_amt) as pwt from st_rep_iw_agent where organization_id in (select organization_id from st_lms_user_master where termination_date&gt;'&quot;+requestBean.getFromDate()+&quot;' or registration_date &lt;'&quot;+requestBean.getToDate()+&quot;' and isrolehead='Y' and organization_type='AGENT' ) and  finaldate&gt;=date('&quot;</span>
					// + requestBean.getGameId()
					// + &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by organization_id&quot;;

<span class="nc" id="L1286">			pwtQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1287">			pwtQueryBuilder</span>
					.append(
							&quot;select parent_id,sum(main.pwt) as pwt from (select pwt.parent_id,sum(pwt) pwt from (select organization_id,parent_id,ifnull(sum(pwt),0.0) pwt from st_lms_organization_master om left outer join (select drs.retailer_org_id,sum(pwt_amt+agt_claim_comm) as pwt from st_iw_ret_pwt drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where  rtm.retailer_org_id in (select organization_id from st_lms_user_master where parent_user_id not in (select user_id from st_lms_user_master where termination_date&lt;'&quot;+requestBean.getFromDate()+&quot;' or registration_date &gt;'&quot;+requestBean.getToDate()+&quot;' and isrolehead='Y' and organization_type='AGENT' ) AND  organization_type='RETAILER' ) and  rtm.transaction_type in('IW_PWT_AUTO','IW_PWT_PLR','IW_PWT') and rtm.transaction_date&gt;='&quot;)
					// .append(requestBean.getGameId())
					// .append(
					// &quot; drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.transaction_type in('IW_PWT_AUTO','IW_PWT_PLR','IW_PWT') and rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; group by drs.retailer_org_id) pwt on om.organization_id=retailer_org_id where om.organization_type='RETAILER' group by parent_id ) pwt group by parent_id&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.parent_id&quot;);
			// logger.debug(&quot;fetchPWTDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L1305">			System.out.println(&quot;fetchPWTDataMultipleAgent - &quot;</span>
					+ pwtQueryBuilder.toString());

<span class="nc" id="L1308">			stmt = connection.createStatement();</span>
<span class="nc" id="L1309">			rs = stmt.executeQuery(pwtQueryBuilder.toString());</span>
<span class="nc bnc" id="L1310" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1311">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L1312">				responseBean.setPwtAmt(rs.getDouble(&quot;pwt&quot;));</span>
<span class="nc" id="L1313">				responseBeanMap.put(rs.getInt(&quot;parent_id&quot;), responseBean);</span>
			}
<span class="nc" id="L1315">		} catch (SQLException se) {</span>
<span class="nc" id="L1316">			se.printStackTrace();</span>
<span class="nc" id="L1317">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1318">		} catch (Exception e) {</span>
<span class="nc" id="L1319">			e.printStackTrace();</span>
<span class="nc" id="L1320">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1322">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1323">		}</span>

<span class="nc" id="L1325">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchPWTDataDayWisePerGameForBO(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1338">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1339">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1340">		Statement stmt = null;</span>
<span class="nc" id="L1341">		ResultSet rs = null;</span>
<span class="nc" id="L1342">		StringBuilder pwtQueryBuilder = null;</span>
		try {
<span class="nc" id="L1344">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L1349">			String archiveAppender = &quot; union all select finaldate as alldate, SUM(pwt_net_amt) as pwt from st_rep_iw_agent where organization_id in (select organization_id from st_lms_user_master  where (termination_date &gt; '&quot;+requestBean.getFromDate()+&quot;' or registration_date&lt; '&quot;+requestBean.getToDate()+&quot;') and isrolehead='Y' and organization_type='AGENT') and  game_id=&quot;</span>
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY finaldate&quot;;

<span class="nc" id="L1359">			pwtQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1360">			pwtQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.pwt)as pwt from (select pwt.alldate,ifnull(pwt,0.0) pwt from(select alldate,pwt from tempdate left outer join (select date(rtm.transaction_date) tx_date,sum(pwt_amt+agt_claim_comm) pwt from st_iw_ret_pwt drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.retailer_org_id in (select organization_id from st_lms_user_master where parent_user_id not in (select user_id from st_lms_user_master  where (termination_date &lt; '&quot;+requestBean.getFromDate()+&quot;' or registration_date&gt; '&quot;+requestBean.getToDate()+&quot;') and isrolehead='Y' and organization_type='AGENT') and organization_type='RETAILER' ) and drs.game_id=&quot;)
					.append(requestBean.getGameId())
					.append(&quot; AND rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; AND rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('IW_PWT_AUTO','IW_PWT_PLR','IW_PWT') group by tx_date) pwt on alldate=pwt.tx_date) pwt&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L1378">			System.out.println(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;</span>
					+ pwtQueryBuilder.toString());

<span class="nc" id="L1381">			stmt = connection.createStatement();</span>
<span class="nc" id="L1382">			rs = stmt.executeQuery(pwtQueryBuilder.toString());</span>
<span class="nc bnc" id="L1383" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1384">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L1385">				responseBean.setPwtAmt(rs.getDouble(&quot;pwt&quot;));</span>
<span class="nc" id="L1386">				responseBeanMap.put(rs.getDate(&quot;alldate&quot;).toString(), responseBean);</span>
			}
<span class="nc" id="L1388">		} catch (SQLException se) {</span>
<span class="nc" id="L1389">			se.printStackTrace();</span>
<span class="nc" id="L1390">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1391">		} catch (Exception e) {</span>
<span class="nc" id="L1392">			e.printStackTrace();</span>
<span class="nc" id="L1393">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1395">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1396">		}</span>

<span class="nc" id="L1398">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchPWTDataDayWiseAllGameForBO(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1411">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1412">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1413">		Statement stmt = null;</span>
<span class="nc" id="L1414">		ResultSet rs = null;</span>
<span class="nc" id="L1415">		StringBuilder pwtQueryBuilder = null;</span>
		try {
<span class="nc" id="L1417">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L1422">			String archiveAppender = &quot; union all select finaldate as alldate, SUM(pwt_net_amt) as pwt from st_rep_iw_agent where finaldate&gt;=date('&quot;</span>
					// + requestBean.getGameId()
					// + &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY organization_id&quot;;

<span class="nc" id="L1432">			pwtQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1433">			pwtQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.pwt)as pwt from (select pwt.alldate,ifnull(pwt,0.0) pwt from(select alldate,pwt from tempdate left outer join (select date(rtm.transaction_date) tx_date,sum(pwt_amt+agt_claim_comm) pwt from st_iw_ret_pwt drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					// .append(requestBean.getGameId())
					// .append(
					// &quot; drs inner join st_lms_retailer_transaction_master rtm on drs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('IW_PWT_AUTO','IW_PWT_PLR','IW_PWT') group by tx_date) pwt on alldate=pwt.tx_date) pwt&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L1452">			System.out.println(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;</span>
					+ pwtQueryBuilder.toString());

<span class="nc" id="L1455">			stmt = connection.createStatement();</span>
<span class="nc" id="L1456">			rs = stmt.executeQuery(pwtQueryBuilder.toString());</span>
<span class="nc bnc" id="L1457" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1458">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L1459">				responseBean.setPwtAmt(rs.getDouble(&quot;pwt&quot;));</span>
<span class="nc" id="L1460">				responseBeanMap.put(rs.getString(&quot;alldate&quot;), responseBean);</span>
			}
<span class="nc" id="L1462">		} catch (SQLException se) {</span>
<span class="nc" id="L1463">			se.printStackTrace();</span>
<span class="nc" id="L1464">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1465">		} catch (Exception e) {</span>
<span class="nc" id="L1466">			e.printStackTrace();</span>
<span class="nc" id="L1467">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1469">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1470">		}</span>

<span class="nc" id="L1472">		return responseBeanMap;</span>
	}
	
	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchPWTDataDayWisePerGameForAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1485">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1486">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1487">		Statement stmt = null;</span>
<span class="nc" id="L1488">		ResultSet rs = null;</span>
<span class="nc" id="L1489">		StringBuilder pwtQueryBuilder = null;</span>
		try {
<span class="nc" id="L1491">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L1496">			String archiveAppender = &quot; UNION ALL SELECT alldate,sum(pwt+directPlrPwt) pwt FROM (SELECT finaldate as alldate,sum(pwt_net_amt) pwt,0.00 directPlrPwt  FROM st_rep_iw_retailer WHERE parent_id=&quot;</span>
					+ requestBean.getOrgId()
					+ &quot; AND game_id=&quot;
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot; + &quot; GROUP BY finaldate UNION ALL SELECT finaldate as alldate,0.00 pwt,sum(ifnull(direct_pwt_net_amt,0.00))as directPlrPwt  FROM st_rep_iw_agent WHERE organization_id in (SELECT organization_id FROM st_lms_user_master  WHERE (termination_date &gt; '&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; or registration_date&lt; ('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot; + &quot; AND isrolehead='Y' AND organization_type='AGENT' AND organization_id=&quot;
					+ requestBean.getOrgId()
					+ &quot;) AND organization_id=&quot;
					+ requestBean.getOrgId()
					+ &quot; AND game_id=&quot;
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot; + &quot; GROUP BY finaldate) al GROUP BY alldate&quot;;
			
<span class="nc" id="L1523">			pwtQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1524">			pwtQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.pwt)as pwt from (select pwt.alldate,ifnull(pwt,0.0) pwt from(select alldate,pwt1.pwt from tempdate left outer join (select organization_id,pwt.tx_date,pwt.pwt from st_lms_organization_master om left outer join (select date(rtm.transaction_date) tx_date,sum(pwt_amt+retailer_claim_comm) pwt, rtm.retailer_org_id from st_iw_ret_pwt srs inner join st_lms_retailer_transaction_master rtm on srs.transaction_id=rtm.transaction_id where srs.game_id=&quot;)
					.append(requestBean.getGameId())
					.append(&quot; AND rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; AND rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('IW_PWT_AUTO','IW_PWT_PLR','IW_PWT') group by tx_date,retailer_org_id) pwt on retailer_org_id=om.organization_id where parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(
							&quot; group by pwt.tx_date, organization_id) pwt1 on alldate=pwt1.tx_date) pwt&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L1545">			System.out.println(&quot;fetchPWTDataDayWisePerGameForAgent - &quot;</span>
					+ pwtQueryBuilder.toString());

<span class="nc" id="L1548">			stmt = connection.createStatement();</span>
<span class="nc" id="L1549">			rs = stmt.executeQuery(pwtQueryBuilder.toString());</span>
<span class="nc bnc" id="L1550" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1551">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L1552">				responseBean.setPwtAmt(rs.getDouble(&quot;pwt&quot;));</span>
<span class="nc" id="L1553">				responseBeanMap.put(rs.getString(&quot;alldate&quot;).split(&quot; &quot;)[0], responseBean);</span>
			}
<span class="nc" id="L1555">		} catch (SQLException se) {</span>
<span class="nc" id="L1556">			se.printStackTrace();</span>
<span class="nc" id="L1557">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1558">		} catch (Exception e) {</span>
<span class="nc" id="L1559">			e.printStackTrace();</span>
<span class="nc" id="L1560">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1562">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1563">		}</span>

<span class="nc" id="L1565">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchPWTDataDayWiseAllGameForAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1578">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1579">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1580">		Statement stmt = null;</span>
<span class="nc" id="L1581">		ResultSet rs = null;</span>
<span class="nc" id="L1582">		StringBuilder pwtQueryBuilder = null;</span>
		try {
<span class="nc" id="L1584">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L1589">			String archiveAppender = &quot; union all select sgr.finaldate as alldate,sum(sgr.pwt_net_amt) as pwt from st_rep_iw_retailer as sgr left outer join  st_rep_iw_agent as sga on sgr.finaldate=sga.finaldate and sgr.parent_id=sga.parent_id where sgr.parent_id=&quot;</span>
					+ requestBean.getOrgId()
					// + &quot; AND sgr.game_id=&quot;
					// + requestBean.getGameId()
					+ &quot; AND sgr.finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND sgr.finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY sgr.finaldate&quot;;

<span class="nc" id="L1601">			pwtQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1602">			pwtQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.pwt)as pwt from (select pwt.alldate,ifnull(pwt,0.0) pwt from(select alldate,pwt1.pwt from tempdate left outer join (select organization_id,pwt.tx_date,pwt.pwt from st_lms_organization_master om left outer join (select date(rtm.transaction_date) tx_date,sum(pwt_amt+retailer_claim_comm) pwt, rtm.retailer_org_id from st_iw_ret_pwt srs inner join st_lms_retailer_transaction_master rtm on srs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					// .append(requestBean.getGameId())
					// .append(
					// &quot; srs inner join st_lms_retailer_transaction_master rtm on srs.transaction_id=rtm.transaction_id where rtm.transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and rtm.transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(
							&quot; and transaction_type in('IW_PWT_AUTO','IW_PWT_PLR','IW_PWT')) pwt on retailer_org_id=om.organization_id where parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(
							&quot; group by pwt.tx_date) pwt1 on alldate=pwt1.tx_date) pwt&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L1624">			System.out.println(&quot;fetchPWTDataDayWisePerGameForAgent - &quot;</span>
					+ pwtQueryBuilder.toString());

<span class="nc" id="L1627">			stmt = connection.createStatement();</span>
<span class="nc" id="L1628">			rs = stmt.executeQuery(pwtQueryBuilder.toString());</span>
<span class="nc bnc" id="L1629" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1630">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L1631">				responseBean.setPwtAmt(rs.getDouble(&quot;pwt&quot;));</span>
<span class="nc" id="L1632">				responseBeanMap.put(rs.getString(&quot;alldate&quot;), responseBean);</span>
			}
<span class="nc" id="L1634">		} catch (SQLException se) {</span>
<span class="nc" id="L1635">			se.printStackTrace();</span>
<span class="nc" id="L1636">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1637">		} catch (Exception e) {</span>
<span class="nc" id="L1638">			e.printStackTrace();</span>
<span class="nc" id="L1639">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1641">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1642">		}</span>

<span class="nc" id="L1644">		return responseBeanMap;</span>
	}
	
	/**
	 * For Payment-Ledger Report view by BO
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchPWTDataDayWiseAllGameSingleAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1658">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1659">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1660">		Statement stmt = null;</span>
<span class="nc" id="L1661">		ResultSet rs = null;</span>
<span class="nc" id="L1662">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L1664">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

<span class="nc" id="L1666">			String archiveAppender = &quot; UNION ALL SELECT finaldate,organization_id,SUM(pwt_net_amt) AS pwt FROM st_rep_iw_agent WHERE finaldate&gt;='&quot;</span>
					+ requestBean.getFromDate()
					+ &quot;' AND finaldate&lt;='&quot;
					+ requestBean.getToDate()
					+ &quot;'AND organization_id=&quot;
					+ requestBean.getOrgId()
					+ &quot; GROUP BY finaldate&quot;;

<span class="nc" id="L1674">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1675">			saleQueryBuilder</span>
					.append(&quot;SELECT DATE(transaction_date) DATE,parent_id,SUM(pwt) AS pwt FROM (SELECT retailer_org_id,SUM(pwt_amt+agt_claim_comm) AS pwt,transaction_date FROM st_iw_ret_pwt WHERE transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;' AND transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;' AND retailer_org_id IN (SELECT organization_id FROM st_lms_organization_master WHERE organization_type='RETAILER') GROUP BY DATE(transaction_date),retailer_org_id)aa,st_lms_organization_master bb WHERE retailer_org_id=organization_id AND parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(&quot; GROUP BY DATE(transaction_date)&quot;)
					.append(archiveAppender);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L1688">			System.out.println(&quot;fetchPWTDataDayWiseAllGameSingleAgent - &quot;+ saleQueryBuilder.toString());</span>

<span class="nc" id="L1690">			stmt = connection.createStatement();</span>
<span class="nc" id="L1691">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L1692" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1693">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L1694">				responseBean.setPwtAmt(rs.getDouble(&quot;pwt&quot;));</span>
<span class="nc" id="L1695">				responseBeanMap.put(rs.getString(&quot;date&quot;), responseBean);</span>
			}
<span class="nc" id="L1697">		} catch (SQLException se) {</span>
<span class="nc" id="L1698">			se.printStackTrace();</span>
<span class="nc" id="L1699">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1700">		} catch (Exception e) {</span>
<span class="nc" id="L1701">			e.printStackTrace();</span>
<span class="nc" id="L1702">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1704">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1705">		}</span>

<span class="nc" id="L1707">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;Integer, IWOrgReportResponseBean&gt; fetchDirPlyPWTDataGameWiseMultipleAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1720">		Map&lt;Integer, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1721">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1722">		Statement stmt = null;</span>
<span class="nc" id="L1723">		ResultSet rs = null;</span>
<span class="nc" id="L1724">		StringBuilder pwtDirQueryBuilder = null;</span>
		try {
<span class="nc" id="L1726">			responseBeanMap = new HashMap&lt;Integer, IWOrgReportResponseBean&gt;();</span>

<span class="nc" id="L1728">			String archiveAppender = &quot; UNION ALL select organization_id,sum(direct_pwt_net_amt) as pwtDir from st_rep_iw_agent where organization_id in (select organization_id from st_lms_user_master where termination_date&gt;'&quot;</span>
					+ requestBean.getFromDate()
					+ &quot;' or registration_date &lt;'&quot;
					+ requestBean.getToDate()
					+ &quot;' and isrolehead='Y' and organization_type='AGENT' ) and  game_id=&quot;
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by organization_id&quot;;

<span class="nc" id="L1742">			pwtDirQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1743">			pwtDirQueryBuilder</span>
					.append(
							&quot;select parent_id,sum(main.pwtDir) as pwtDir from (select organization_id as parent_id,ifnull(sum(pwt_amt+agt_claim_comm),0.0) pwtDir from st_lms_organization_master left outer join st_iw_agent_direct_plr_pwt on organization_id=agent_org_id where agent_org_id in (select organization_id from st_lms_user_master where termination_date&gt;'&quot;
									+ requestBean.getFromDate()
									+ &quot;' or registration_date &lt;'&quot;
									+ requestBean.getToDate()
									+ &quot;' and isrolehead='Y' and organization_type='AGENT' ) and  transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate()).append(&quot;'&quot;).append(
							&quot; and transaction_date&lt;='&quot;).append(
							requestBean.getToDate()).append(&quot;'&quot;).append(
							&quot; and organization_type='AGENT' &quot;)
					/*.append(requestBean.getGameId())*/
							.append(&quot; group by agent_org_id&quot;).append(archiveAppender).append(&quot;)as main group by main.parent_id&quot;);
			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot; +
			// saleQueryBuilder.toString());

<span class="nc" id="L1759">			System.out.println(&quot;fetchPWTDirDataMultipleAgent - &quot;</span>
					+ pwtDirQueryBuilder.toString());

<span class="nc" id="L1762">			stmt = connection.createStatement();</span>
<span class="nc" id="L1763">			rs = stmt.executeQuery(pwtDirQueryBuilder.toString());</span>
<span class="nc bnc" id="L1764" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1765">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L1766">				responseBean.setPwtDirAmt(rs.getDouble(&quot;pwtDir&quot;));</span>
<span class="nc" id="L1767">				responseBeanMap.put(rs.getInt(&quot;parent_id&quot;), responseBean);</span>
			}
<span class="nc" id="L1769">		} catch (SQLException se) {</span>
<span class="nc" id="L1770">			se.printStackTrace();</span>
<span class="nc" id="L1771">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1772">		} catch (Exception e) {</span>
<span class="nc" id="L1773">			e.printStackTrace();</span>
<span class="nc" id="L1774">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1776">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1777">		}</span>
<span class="nc" id="L1778">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;Integer, IWOrgReportResponseBean&gt; fetchDirPlyPWTDataAllGameMultipleAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1791">		Map&lt;Integer, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1792">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1793">		Statement stmt = null;</span>
<span class="nc" id="L1794">		ResultSet rs = null;</span>
<span class="nc" id="L1795">		StringBuilder pwtDirQueryBuilder = null;</span>
		try {
<span class="nc" id="L1797">			responseBeanMap = new HashMap&lt;Integer, IWOrgReportResponseBean&gt;();</span>

<span class="nc" id="L1799">			String archiveAppender = &quot; UNION ALL select organization_id,sum(direct_pwt_net_amt) as pwtDir from st_rep_iw_agent where finaldate&gt;=date('&quot;</span>
					// + requestBean.getGameId()
					// + &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; group by organization_id&quot;;

<span class="nc" id="L1809">			pwtDirQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1810">			pwtDirQueryBuilder</span>
					.append(
							&quot;select parent_id,sum(main.pwtDir) as pwtDir from (select organization_id as parent_id,ifnull(sum(pwt_amt+agt_claim_comm),0.0) pwtDir from st_lms_organization_master left outer join st_iw_agent_direct_plr_pwt on organization_id=agent_org_id where transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate()).append(&quot;'&quot;).append(
							&quot; and transaction_date&lt;='&quot;).append(
							requestBean.getToDate()).append(&quot;'&quot;).append(
					// &quot; and organization_type='AGENT' and game_id=&quot;)
							// .append(requestBean.getGameId()).append(
							&quot; and organization_type='AGENT'&quot;).append(
							&quot; group by agent_org_id&quot;).append(archiveAppender)
					.append(&quot;)as main group by main.parent_id&quot;);
			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L1824">			System.out.println(&quot;fetchPWTDirDataMultipleAgent - &quot;</span>
					+ pwtDirQueryBuilder.toString());

<span class="nc" id="L1827">			stmt = connection.createStatement();</span>
<span class="nc" id="L1828">			rs = stmt.executeQuery(pwtDirQueryBuilder.toString());</span>
<span class="nc bnc" id="L1829" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1830">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L1831">				responseBean.setPwtDirAmt(rs.getDouble(&quot;pwtDir&quot;));</span>
<span class="nc" id="L1832">				responseBeanMap.put(rs.getInt(&quot;parent_id&quot;), responseBean);</span>
			}
<span class="nc" id="L1834">		} catch (SQLException se) {</span>
<span class="nc" id="L1835">			se.printStackTrace();</span>
<span class="nc" id="L1836">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1837">		} catch (Exception e) {</span>
<span class="nc" id="L1838">			e.printStackTrace();</span>
<span class="nc" id="L1839">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1841">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1842">		}</span>

<span class="nc" id="L1844">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchDirPlyPWTDataDayWisePerGameForBO(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1857">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1858">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1859">		Statement stmt = null;</span>
<span class="nc" id="L1860">		ResultSet rs = null;</span>
<span class="nc" id="L1861">		StringBuilder dirPWTQueryBuilder = null;</span>
		try {
<span class="nc" id="L1863">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L1868">			String archiveAppender = &quot; union all select finaldate as alldate, SUM(direct_pwt_net_amt) as pwtDir from st_rep_iw_agent where organization_id in (select organization_id from st_lms_user_master  where (termination_date &gt; '&quot;+requestBean.getFromDate()+&quot;' or registration_date&lt; '&quot;+requestBean.getToDate()+&quot;') and isrolehead='Y' and organization_type='AGENT') and  game_id=&quot;</span>
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY finaldate&quot;;

<span class="nc" id="L1878">			dirPWTQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1879">			dirPWTQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.pwtDir)as pwtDir from (select pwtDir.alldate,ifnull(pwtDir,0.0) pwtDir from(select alldate,pwtDir from tempdate left outer join (select date(transaction_date) tx_date ,sum(pwt_amt+agt_claim_comm) pwtDir from st_iw_agent_direct_plr_pwt where agent_org_id not in (select organization_id from st_lms_user_master where (termination_date &lt; '&quot;+requestBean.getFromDate()+&quot;' or registration_date&gt; '&quot;+requestBean.getToDate()+&quot;') and isrolehead='Y' and organization_type='AGENT' ) and transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(&quot; and game_id=&quot;)
					.append(requestBean.getGameId())
					.append(
							&quot; group by tx_date) pwtDir on alldate=pwtDir.tx_date) pwtDir&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L1897">			System.out.println(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;</span>
					+ dirPWTQueryBuilder.toString());

<span class="nc" id="L1900">			stmt = connection.createStatement();</span>
<span class="nc" id="L1901">			rs = stmt.executeQuery(dirPWTQueryBuilder.toString());</span>
<span class="nc bnc" id="L1902" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1903">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L1904">				responseBean.setPwtDirAmt(rs.getDouble(&quot;pwtDir&quot;));</span>
<span class="nc" id="L1905">				responseBeanMap.put(rs.getDate(&quot;alldate&quot;).toString(), responseBean);</span>
			}
<span class="nc" id="L1907">		} catch (SQLException se) {</span>
<span class="nc" id="L1908">			se.printStackTrace();</span>
<span class="nc" id="L1909">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1910">		} catch (Exception e) {</span>
<span class="nc" id="L1911">			e.printStackTrace();</span>
<span class="nc" id="L1912">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1914">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1915">		}</span>

<span class="nc" id="L1917">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchDirPlyPWTDataDayWiseAllGameForBO(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L1930">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L1931">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L1932">		Statement stmt = null;</span>
<span class="nc" id="L1933">		ResultSet rs = null;</span>
<span class="nc" id="L1934">		StringBuilder dirPWTQueryBuilder = null;</span>
		try {
<span class="nc" id="L1936">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L1941">			String archiveAppender = &quot; union all select finaldate as alldate, SUM(direct_pwt_net_amt) as pwtDir from st_rep_iw_agent where game_id=&quot;</span>
					+ requestBean.getGameId()
					+ &quot; AND finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY organization_id&quot;;

<span class="nc" id="L1951">			dirPWTQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L1952">			dirPWTQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.pwtDir)as pwtDir from (select pwtDir.alldate,ifnull(pwtDir,0.0) pwtDir from(select alldate,pwtDir from tempdate left outer join (select date(transaction_date) tx_date ,sum(pwt_amt+agt_claim_comm) pwtDir from st_iw_agent_direct_plr_pwt where transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					// .append(&quot; and game_id=&quot;)
					// .append(requestBean.getGameId())
					.append(
							&quot; group by tx_date) pwtDir on alldate=pwtDir.tx_date) pwtDir&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L1970">			System.out.println(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;</span>
					+ dirPWTQueryBuilder.toString());

<span class="nc" id="L1973">			stmt = connection.createStatement();</span>
<span class="nc" id="L1974">			rs = stmt.executeQuery(dirPWTQueryBuilder.toString());</span>
<span class="nc bnc" id="L1975" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L1976">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L1977">				responseBean.setPwtDirAmt(rs.getDouble(&quot;pwtDir&quot;));</span>
<span class="nc" id="L1978">				responseBeanMap.put(rs.getString(&quot;alldate&quot;), responseBean);</span>
			}
<span class="nc" id="L1980">		} catch (SQLException se) {</span>
<span class="nc" id="L1981">			se.printStackTrace();</span>
<span class="nc" id="L1982">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L1983">		} catch (Exception e) {</span>
<span class="nc" id="L1984">			e.printStackTrace();</span>
<span class="nc" id="L1985">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L1987">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L1988">		}</span>

<span class="nc" id="L1990">		return responseBeanMap;</span>
	}

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchDirPlyPWTDataDayWisePerGameForAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L2003">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L2004">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L2005">		Statement stmt = null;</span>
<span class="nc" id="L2006">		ResultSet rs = null;</span>
<span class="nc" id="L2007">		StringBuilder dirPWTQueryBuilder = null;</span>
		try {
<span class="nc" id="L2009">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L2014">			String archiveAppender = &quot; union all select sgr.finaldate as alldate,sum(ifnull(sga.direct_pwt_net_amt,0.00))as pwtDir from st_rep_iw_retailer as sgr left outer join  st_rep_iw_agent as sga on sgr.finaldate=sga.finaldate and sgr.parent_id=sga.parent_id where sgr.parent_id=&quot;</span>
					+ requestBean.getOrgId()
					+ &quot; AND sgr.game_id=&quot;
					+ requestBean.getGameId()
					+ &quot; AND sgr.finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND sgr.finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot; + &quot; GROUP BY sgr.finaldate&quot;;

<span class="nc" id="L2025">			dirPWTQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L2026">			dirPWTQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.pwtDir)as pwtDir from (select pwtDir.alldate,ifnull(pwtDir,0.0) pwtDir from(select alldate,pwtDir from tempdate left outer join (select date(transaction_date) tx_date ,sum(pwt_amt+agt_claim_comm) pwtDir from st_iw_agent_direct_plr_pwt where transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(&quot; and game_id=&quot;)
					.append(requestBean.getGameId())
					.append(&quot; and agent_org_id=&quot;)
					.append(requestBean.getOrgId())
					.append(
							&quot; group by tx_date) pwtDir on alldate=pwtDir.tx_date) pwtDir&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L2046">			System.out.println(&quot;fetchDirPWTDataDayWisePerGameForAgent - &quot;</span>
					+ dirPWTQueryBuilder.toString());

<span class="nc" id="L2049">			stmt = connection.createStatement();</span>
<span class="nc" id="L2050">			rs = stmt.executeQuery(dirPWTQueryBuilder.toString());</span>
<span class="nc bnc" id="L2051" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L2052">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L2053">				responseBean.setPwtDirAmt(rs.getDouble(&quot;pwtDir&quot;));</span>
<span class="nc" id="L2054">				responseBeanMap.put(rs.getString(&quot;alldate&quot;).split(&quot; &quot;)[0], responseBean);</span>
			}
<span class="nc" id="L2056">		} catch (SQLException se) {</span>
<span class="nc" id="L2057">			se.printStackTrace();</span>
<span class="nc" id="L2058">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L2059">		} catch (Exception e) {</span>
<span class="nc" id="L2060">			e.printStackTrace();</span>
<span class="nc" id="L2061">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L2063">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L2064">		}</span>

<span class="nc" id="L2066">		return responseBeanMap;</span>
	}
	
	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static void fetchPWTDataAllGameSingleAgent(
			IWOrgReportRequestBean requestBean, IWOrgReportResponseBean responseBean, Connection connection)
			throws GenericException {
<span class="nc" id="L2079">		Statement stmt = null;</span>
<span class="nc" id="L2080">		ResultSet rs = null;</span>
<span class="nc" id="L2081">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L2083">			String archiveAppender = &quot; UNION ALL SELECT organization_id as parent_id,IFNULL(SUM(pwt_net_amt),0.0) AS pwt FROM st_rep_iw_agent WHERE organization_id=&quot;</span>
					+ requestBean.getOrgId()
					+ &quot; AND finaldate&gt;=DATE('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND finaldate&lt;=DATE('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;;

<span class="nc" id="L2092">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L2093">			saleQueryBuilder</span>
					.append(
							&quot;SELECT parent_id,SUM(main.pwt) AS pwt FROM (SELECT pwt.parent_id,SUM(pwt) pwt FROM (SELECT organization_id,parent_id,IFNULL(pwt,0.0) pwt FROM st_lms_organization_master om LEFT OUTER JOIN (SELECT retailer_org_id,SUM(pwt_amt+agt_claim_comm) AS pwt FROM st_iw_ret_pwt WHERE transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; AND transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					.append(&quot; GROUP BY retailer_org_id) pwt on om.organization_id=retailer_org_id WHERE om.organization_type='RETAILER' AND om.parent_id=&quot;)
					.append(requestBean.getOrgId())
					.append(&quot;) pwt&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.parent_id&quot;);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L2110">			System.out.println(&quot;fetchPWTDataAllGameSingleAgent - &quot;+saleQueryBuilder.toString());</span>
			
<span class="nc" id="L2112">			stmt = connection.createStatement();</span>
<span class="nc" id="L2113">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L2114" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L2115">				responseBean.setPwtAmt(responseBean.getPwtAmt() + rs.getDouble(&quot;pwt&quot;));</span>
			}
<span class="nc" id="L2117">		} catch (SQLException se) {</span>
<span class="nc" id="L2118">			se.printStackTrace();</span>
<span class="nc" id="L2119">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L2120">		} catch (Exception e) {</span>
<span class="nc" id="L2121">			e.printStackTrace();</span>
<span class="nc" id="L2122">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L2124">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L2125">		}</span>


<span class="nc" id="L2128">	}</span>

	/**
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchDirPlyPWTDataDayWiseAllGameForAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L2140">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L2141">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L2142">		Statement stmt = null;</span>
<span class="nc" id="L2143">		ResultSet rs = null;</span>
<span class="nc" id="L2144">		StringBuilder dirPWTQueryBuilder = null;</span>
		try {
<span class="nc" id="L2146">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

			// String walletAppender = (requestBean.getWalletId() == 0) ? &quot;&quot;
			// : &quot; AND wallet_id=&quot; + requestBean.getWalletId();

<span class="nc" id="L2151">			String archiveAppender = &quot; union all select sgr.finaldate as alldate,sum(ifnull(sga.direct_pwt_net_amt,0.00))as pwtDir from st_rep_iw_retailer as sgr left outer join  st_rep_iw_agent as sga on sgr.finaldate=sga.finaldate and sgr.parent_id=sga.parent_id where sgr.parent_id=&quot;</span>
					+ requestBean.getOrgId()
					// + &quot; AND sgr.game_id=&quot;
					// + requestBean.getGameId()
					+ &quot; AND sgr.finaldate&gt;=date('&quot;
					+ requestBean.getFromDate()
					+ &quot;')&quot;
					+ &quot; AND sgr.finaldate&lt;=date('&quot;
					+ requestBean.getToDate()
					+ &quot;')&quot;
					+ &quot; GROUP BY sgr.finaldate&quot;;

<span class="nc" id="L2163">			dirPWTQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L2164">			dirPWTQueryBuilder</span>
					.append(
							&quot;select main.alldate,sum(main.pwtDir)as pwtDir from (select pwtDir.alldate,ifnull(pwtDir,0.0) pwtDir from(select alldate,pwtDir from tempdate left outer join (select date(transaction_date) tx_date ,sum(pwt_amt+agt_claim_comm) pwtDir from st_iw_agent_direct_plr_pwt where transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;'&quot;)
					.append(&quot; and transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;'&quot;)
					// .append(&quot; and game_id=&quot;)
					// .append(requestBean.getGameId())
					.append(&quot; and agent_org_id=&quot;)
					.append(requestBean.getOrgId())
					.append(
							&quot; group by tx_date) pwtDir on alldate=pwtDir.tx_date) pwtDir&quot;)
					.append(archiveAppender).append(
							&quot;) as main group by main.alldate&quot;);

			// logger.debug(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L2184">			System.out.println(&quot;fetchDirPWTDataDayWisePerGameForAgent - &quot;</span>
					+ dirPWTQueryBuilder.toString());

<span class="nc" id="L2187">			stmt = connection.createStatement();</span>
<span class="nc" id="L2188">			rs = stmt.executeQuery(dirPWTQueryBuilder.toString());</span>
<span class="nc bnc" id="L2189" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L2190">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L2191">				responseBean.setPwtDirAmt(rs.getDouble(&quot;pwtDir&quot;));</span>
<span class="nc" id="L2192">				responseBeanMap.put(rs.getString(&quot;alldate&quot;), responseBean);</span>
			}
<span class="nc" id="L2194">		} catch (SQLException se) {</span>
<span class="nc" id="L2195">			se.printStackTrace();</span>
<span class="nc" id="L2196">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L2197">		} catch (Exception e) {</span>
<span class="nc" id="L2198">			e.printStackTrace();</span>
<span class="nc" id="L2199">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L2201">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L2202">		}</span>

<span class="nc" id="L2204">		return responseBeanMap;</span>
	}

	public static void fetchIWDirectPlyPwtofAgent(
			IWOrgReportRequestBean requestBean, IWOrgReportResponseBean responseBean, Connection connection)
			throws GenericException {
<span class="nc" id="L2210">		Statement stmt = null;</span>
<span class="nc" id="L2211">		ResultSet rs = null;</span>
<span class="nc" id="L2212">		StringBuilder dirPWTQueryBuilder = null;</span>
		try {
<span class="nc" id="L2214">			String archiveAppender = &quot; UNION ALL select organization_id as agent_org_id,sum(direct_pwt_amt+direct_pwt_comm)as pwtDir from st_rep_iw_agent where organization_id=&quot;</span>
					+ requestBean.getOrgId()
					+ &quot; AND finaldate&gt;='&quot;
					+ requestBean.getFromDate()
					+ &quot;'&quot;
					+ &quot; AND finaldate&lt;='&quot;
					+ requestBean.getToDate()
					+ &quot;'&quot;
					+ &quot; GROUP BY organization_id&quot;;

<span class="nc" id="L2224">			dirPWTQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L2225">			dirPWTQueryBuilder</span>
					.append(
							&quot;select agent_org_id,sum(main.pwtDir)as pwtDir from (select agent_org_id,sum(pwt_amt+agt_claim_comm) pwtDir from st_iw_agent_direct_plr_pwt where transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate()).append(&quot;'&quot;).append(
							&quot; AND transaction_date&lt;='&quot;).append(
							requestBean.getToDate()).append(&quot;'&quot;).append(
							&quot; AND agent_org_id=&quot;)
					.append(requestBean.getOrgId()).append(
							&quot; GROUP BY agent_org_id&quot;).append(archiveAppender)
					.append(&quot;)as main GROUP BY main.agent_org_id&quot;);

			// logger.debug(&quot;fetchPWTDataDayWisePerGameSingleAgent - &quot;
			// + cancelQueryBuilder.toString());

<span class="nc" id="L2239">			stmt = connection.createStatement();</span>
<span class="nc" id="L2240">			rs = stmt.executeQuery(dirPWTQueryBuilder.toString());</span>
<span class="nc bnc" id="L2241" title="All 2 branches missed.">			if (rs.next()) {</span>
<span class="nc" id="L2242">				responseBean.setPwtDirAmt(rs.getDouble(&quot;pwtDir&quot;));</span>
			} else {
<span class="nc" id="L2244">				responseBean.setPwtDirAmt(0.0);</span>
			}
<span class="nc" id="L2246">		} catch (SQLException se) {</span>
<span class="nc" id="L2247">			se.printStackTrace();</span>
<span class="nc" id="L2248">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L2249">		} catch (Exception e) {</span>
<span class="nc" id="L2250">			e.printStackTrace();</span>
<span class="nc" id="L2251">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L2253">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L2254">		}</span>

<span class="nc" id="L2256">	}</span>
	
	/**
	 * For Payment-Ledger Report view by BO
	 * 
	 * @param requestBean
	 * @param connection
	 * @return
	 * @throws GenericException
	 */
	public static Map&lt;String, IWOrgReportResponseBean&gt; fetchDirectPlyPWTDataDayWiseAllGameSingleAgent(
			IWOrgReportRequestBean requestBean, Connection connection)
			throws GenericException {
<span class="nc" id="L2269">		Map&lt;String, IWOrgReportResponseBean&gt; responseBeanMap = null;</span>
<span class="nc" id="L2270">		IWOrgReportResponseBean responseBean = null;</span>
<span class="nc" id="L2271">		Statement stmt = null;</span>
<span class="nc" id="L2272">		ResultSet rs = null;</span>
<span class="nc" id="L2273">		StringBuilder saleQueryBuilder = null;</span>
		try {
<span class="nc" id="L2275">			responseBeanMap = new HashMap&lt;String, IWOrgReportResponseBean&gt;();</span>

<span class="nc" id="L2277">			String archiveAppender = &quot; UNION ALL SELECT finaldate,organization_id,SUM(direct_pwt_net_amt) AS pwtDir FROM st_rep_iw_agent WHERE finaldate&gt;='&quot;</span>
					+ requestBean.getFromDate()
					+ &quot;' AND finaldate&lt;='&quot;
					+ requestBean.getToDate()
					+ &quot;'AND organization_id=&quot;
					+ requestBean.getOrgId()
					+ &quot; GROUP BY finaldate&quot;;

<span class="nc" id="L2285">			saleQueryBuilder = new StringBuilder();</span>
<span class="nc" id="L2286">			saleQueryBuilder</span>
					.append(&quot;SELECT DATE(transaction_date) date,agent_org_id,SUM(pwt_amt+agt_claim_comm) pwtDir FROM st_iw_agent_direct_plr_pwt WHERE transaction_date&gt;='&quot;)
					.append(requestBean.getFromDate())
					.append(&quot;' AND transaction_date&lt;='&quot;)
					.append(requestBean.getToDate())
					.append(&quot;' AND agent_org_id=&quot;)
					.append(requestBean.getOrgId())
					.append(&quot; GROUP BY DATE(transaction_date)&quot;)
					.append(archiveAppender);

			// logger.debug(&quot;fetchDepositDataMultipleAgent - &quot;
			// + saleQueryBuilder.toString());

<span class="nc" id="L2299">			System.out.println(&quot;fetchDirectPlyPWTDataDayWiseAllGameSingleAgent - &quot;+ saleQueryBuilder.toString());</span>

<span class="nc" id="L2301">			stmt = connection.createStatement();</span>
<span class="nc" id="L2302">			rs = stmt.executeQuery(saleQueryBuilder.toString());</span>
<span class="nc bnc" id="L2303" title="All 2 branches missed.">			while (rs.next()) {</span>
<span class="nc" id="L2304">				responseBean = new IWOrgReportResponseBean();</span>
<span class="nc" id="L2305">				responseBean.setPwtDirAmt(rs.getDouble(&quot;pwtDir&quot;));</span>
<span class="nc" id="L2306">				responseBeanMap.put(rs.getString(&quot;date&quot;), responseBean);</span>
			}
<span class="nc" id="L2308">		} catch (SQLException se) {</span>
<span class="nc" id="L2309">			se.printStackTrace();</span>
<span class="nc" id="L2310">			throw new GenericException(LMSErrors.SQL_EXCEPTION_CODE, se);</span>
<span class="nc" id="L2311">		} catch (Exception e) {</span>
<span class="nc" id="L2312">			e.printStackTrace();</span>
<span class="nc" id="L2313">			throw new GenericException(LMSErrors.GENERAL_EXCEPTION_CODE, e);</span>
		} finally {
<span class="nc" id="L2315">			DBConnect.closeConnection(stmt, rs);</span>
<span class="nc" id="L2316">		}</span>

<span class="nc" id="L2318">		return responseBeanMap;</span>
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>